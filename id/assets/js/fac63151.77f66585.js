"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[7124],{3905:(e,a,n)=>{n.d(a,{Zo:()=>k,kt:()=>d});var t=n(7294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function i(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?i(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function u(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=t.createContext({}),l=function(e){var a=t.useContext(o),n=a;return e&&(n="function"==typeof e?e(a):s(s({},a),e)),n},k=function(e){var a=l(e.components);return t.createElement(o.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},m=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,k=u(e,["components","mdxType","originalType","parentName"]),m=l(n),d=r,b=m["".concat(o,".").concat(d)]||m[d]||p[d]||i;return n?t.createElement(b,s(s({ref:a},k),{},{components:n})):t.createElement(b,s({ref:a},k))}));function d(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=m;var u={};for(var o in a)hasOwnProperty.call(a,o)&&(u[o]=a[o]);u.originalType=e,u.mdxType="string"==typeof e?e:r,s[1]=u;for(var l=2;l<i;l++)s[l]=n[l];return t.createElement.apply(null,s)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3134:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>o,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>u,toc:()=>l});var t=n(7462),r=(n(7294),n(3905));const i={id:"k8s",title:"Authorization of Kubernetes",description:"Kubernetes (k8s) RBAC & ABAC otorisasi middleware berbasis Casbin",keywords:["Kubernetes authorization","Kubernetes RBAC","Kubernetes ABAC","K8s-authz"],authors:["hsluoyz"]},s=void 0,u={unversionedId:"k8s",id:"k8s",title:"Authorization of Kubernetes",description:"Kubernetes (k8s) RBAC & ABAC otorisasi middleware berbasis Casbin",source:"@site/i18n/id/docusaurus-plugin-content-docs/current/K8sAuthz.mdx",sourceDirName:".",slug:"/k8s",permalink:"/id/docs/k8s",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sAuthz.mdx",tags:[],version:"current",frontMatter:{id:"k8s",title:"Authorization of Kubernetes",description:"Kubernetes (k8s) RBAC & ABAC otorisasi middleware berbasis Casbin",keywords:["Kubernetes authorization","Kubernetes RBAC","Kubernetes ABAC","K8s-authz"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Performance Optimization",permalink:"/id/docs/performance"},next:{title:"Admission Webhook for K8s",permalink:"/id/docs/k8s-gatekeeper"}},o={},l=[{value:"Persyaratan",id:"persyaratan",level:2},{value:"Penggunaan",id:"penggunaan",level:2}],k={toc:l};function p(e){let{components:a,...n}=e;return(0,r.kt)("wrapper",(0,t.Z)({},k,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz"},"K8s-authz")," adalah middleware otorisasi Kubernetes (k8s) berbasis Casbin yang memanfaatkan RBAC (Role-Based Access Control) dan ABAC (Attribute-Based Access Control) untuk penegakan kebijakan. Middleware ini terintegrasi dengan webhook admissi validasi K8s untuk memvalidasi kebijakan yang didefinisikan oleh Casbin untuk setiap permintaan yang dibuat ke sumber daya K8s. Pengontrol admissi kustom terdaftar dengan Kubernetes menggunakan ",(0,r.kt)("inlineCode",{parentName:"p"},"ValidatingAdmissionWebhook")," untuk melakukan validasi pada objek permintaan yang diteruskan oleh server API dan memberikan respons yang menunjukkan apakah permintaan tersebut harus diizinkan atau ditolak."),(0,r.kt)("p",null,"Untuk menentukan kapan mengirim permintaan masuk ke pengontrol admissi, webhook validasi telah diterapkan. Webhook ini memproksi permintaan untuk semua jenis sumber daya K8s atau sub-sumber daya dan melakukan verifikasi kebijakan. Pengguna hanya diizinkan untuk melakukan operasi pada sumber daya ini jika mereka diotorisasi oleh enforcer Casbin. ",(0,r.kt)("a",{parentName:"p",href:"/docs/get-started#new-a-casbin-enforcer"},"Enforcer")," memeriksa peran pengguna sebagaimana didefinisikan dalam kebijakan. Kluster K8s adalah target penerapan untuk middleware ini."),(0,r.kt)("h2",{id:"persyaratan"},"Persyaratan"),(0,r.kt)("p",null,"Sebelum melanjutkan, pastikan Anda memiliki yang berikut:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Kluster Kubernetes yang sedang berjalan. Anda dapat menyiapkan kluster lokal menggunakan Docker atau menyiapkan ekosistem Kubernetes lengkap di server Anda. Untuk instruksi yang lebih detail, lihat ",(0,r.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/tutorials/kubernetes-basics/create-cluster/cluster-intro/"},"panduan")," ini untuk menyiapkan kluster Kubernetes lokal di Windows atau ",(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-create-a-kubernetes-cluster-using-kubeadm-on-ubuntu-18-04"},"panduan")," ini untuk menyiapkan kluster di Linux."),(0,r.kt)("li",{parentName:"ul"},"Kubectl CLI. Instruksi untuk menginstal Kubectl di Windows dapat ditemukan ",(0,r.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/tasks/tools/install-kubectl-windows/"},"di sini"),", dan untuk Linux ",(0,r.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/"},"di sini"),"."),(0,r.kt)("li",{parentName:"ul"},"OpenSSL")),(0,r.kt)("h2",{id:"penggunaan"},"Penggunaan"),(0,r.kt)("p",null,"Ikuti langkah-langkah ini untuk menggunakan K8s-authz:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Hasilkan sertifikat dan kunci untuk setiap pengguna menggunakan OpenSSL. Jalankan skrip di bawah ini:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"./gen_cert.sh\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Bangun gambar Docker dari ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/Dockerfile"},"Dockerfile")," secara manual dengan menjalankan perintah berikut. Ingatlah untuk mengubah versi build dalam perintah dan dalam ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/718f58c46e3dbf79063b5b1c18348c2fee5de9e9/manifests/deployment.yaml#L18"},"file")," penyebaran sesuai dengan kebutuhan."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker build -t casbin/k8s_authz:0.1 .\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Tentukan kebijakan Casbin dalam file ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/config/model.conf"},"model.conf")," dan ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/config/policy.csv"},"policy.csv"),". Untuk informasi lebih lanjut tentang bagaimana kebijakan ini bekerja, lihat ",(0,r.kt)("a",{parentName:"p",href:"/docs/how-it-works"},"dokumentasi"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Sebelum menyebar, Anda dapat mengubah port dalam file ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/main.go"},"main.go"),", serta dalam konfigurasi webhook validasi ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/manifests/deployment.yaml"},"file"),", berdasarkan kebutuhan spesifik Anda.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Sebarkan pengontrol validasi dan webhook pada kluster Kubernetes dengan menjalankan perintah berikut:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl apply -f deployment.yaml\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Untuk server produksi, disarankan untuk membuat ",(0,r.kt)("inlineCode",{parentName:"p"},"secret")," Kubernetes untuk mengamankan sertifikat:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl create secret generic casbin -n default \\\n  --from-file=key.pem=certs/casbin-key.pem \\\n  --from-file=cert.pem=certs/casbin-crt.pem\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Setelah menyelesaikan langkah-langkah di atas, Anda perlu memperbarui direktori sertifikat di ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ashish493/k8s-authz/blob/3560551427c0431a9d4594ad1206f084ede37c49/main.go#L26"},"main.go")," dan ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ashish493/k8s-authz/blob/3560551427c0431a9d4594ad1206f084ede37c49/manifests/deployment.yaml#L22"},"manifests")," dengan direktori dari ",(0,r.kt)("inlineCode",{parentName:"p"},"secret")," yang dibuat."))),(0,r.kt)("p",null,"Sekarang, server seharusnya sudah berjalan dan siap untuk memvalidasi permintaan yang dibuat ke sumber daya K8s serta menegakkan kebijakan sesuai dengan itu."))}p.isMDXComponent=!0}}]);