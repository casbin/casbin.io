"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[2133],{3905:(a,n,e)=>{e.d(n,{Zo:()=>p,kt:()=>s});var t=e(7294);function r(a,n,e){return n in a?Object.defineProperty(a,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[n]=e,a}function l(a,n){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable}))),e.push.apply(e,t)}return e}function i(a){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?l(Object(e),!0).forEach((function(n){r(a,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(e,n))}))}return a}function o(a,n){if(null==a)return{};var e,t,r=function(a,n){if(null==a)return{};var e,t,r={},l=Object.keys(a);for(t=0;t<l.length;t++)e=l[t],n.indexOf(e)>=0||(r[e]=a[e]);return r}(a,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);for(t=0;t<l.length;t++)e=l[t],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(a,e)&&(r[e]=a[e])}return r}var g=t.createContext({}),d=function(a){var n=t.useContext(g),e=n;return a&&(e="function"==typeof a?a(n):i(i({},n),a)),e},p=function(a){var n=d(a.components);return t.createElement(g.Provider,{value:n},a.children)},u={inlineCode:"code",wrapper:function(a){var n=a.children;return t.createElement(t.Fragment,{},n)}},k=t.forwardRef((function(a,n){var e=a.components,r=a.mdxType,l=a.originalType,g=a.parentName,p=o(a,["components","mdxType","originalType","parentName"]),k=d(e),s=r,m=k["".concat(g,".").concat(s)]||k[s]||u[s]||l;return e?t.createElement(m,i(i({ref:n},p),{},{components:e})):t.createElement(m,i({ref:n},p))}));function s(a,n){var e=arguments,r=n&&n.mdxType;if("string"==typeof a||r){var l=e.length,i=new Array(l);i[0]=k;var o={};for(var g in n)hasOwnProperty.call(n,g)&&(o[g]=n[g]);o.originalType=a,o.mdxType="string"==typeof a?a:r,i[1]=o;for(var d=2;d<l;d++)i[d]=e[d];return t.createElement.apply(null,i)}return t.createElement.apply(null,e)}k.displayName="MDXCreateElement"},4218:(a,n,e)=>{e.r(n),e.d(n,{assets:()=>g,contentTitle:()=>i,default:()=>m,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var t=e(7462),r=(e(7294),e(3905));const l={id:"log-error",title:"Log & Error Handling",description:"Pencatatan dan penanganan kesalahan di Casbin",keywords:["log","error","error handling"],authors:["hsluoyz"]},i=void 0,o={unversionedId:"log-error",id:"log-error",title:"Log & Error Handling",description:"Pencatatan dan penanganan kesalahan di Casbin",source:"@site/i18n/id/docusaurus-plugin-content-docs/current/LogError.mdx",sourceDirName:".",slug:"/log-error",permalink:"/id/docs/log-error",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/LogError.mdx",tags:[],version:"current",frontMatter:{id:"log-error",title:"Log & Error Handling",description:"Pencatatan dan penanganan kesalahan di Casbin",keywords:["log","error","error handling"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Casbin Service",permalink:"/id/docs/service"},next:{title:"Frontend Usage",permalink:"/id/docs/frontend"}},g={},d=[{value:"Pencatatan",id:"pencatatan",level:2},{value:"Gunakan logger yang berbeda untuk enforcer yang berbeda",id:"gunakan-logger-yang-berbeda-untuk-enforcer-yang-berbeda",level:3},{value:"Logger yang didukung",id:"logger-yang-didukung",level:4},{value:"Cara menulis pencatat",id:"cara-menulis-pencatat",level:4},{value:"Penanganan kesalahan",id:"penanganan-kesalahan",level:2},{value:"Mengaktifkan dan menonaktifkan",id:"mengaktifkan-dan-menonaktifkan",level:2}],p=a=>function(n){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",n)},u=p("Tabs"),k=p("TabItem"),s={toc:d};function m(a){let{components:n,...e}=a;return(0,r.kt)("wrapper",(0,t.Z)({},s,e,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"pencatatan"},"Pencatatan"),(0,r.kt)("p",null,"Casbin menggunakan ",(0,r.kt)("inlineCode",{parentName:"p"},"log")," bawaan untuk mencetak log ke konsol secara default, seperti:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-log"},"2017/07/15 19:43:56 [Request: alice, data1, read ---\x3e true]\n")),(0,r.kt)("p",null,"Pencatatan tidak diaktifkan secara default. Anda dapat mengaktifkannya melalui ",(0,r.kt)("inlineCode",{parentName:"p"},"Enforcer.EnableLog()")," atau parameter terakhir dari ",(0,r.kt)("inlineCode",{parentName:"p"},"NewEnforcer()"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Kami sudah mendukung pencatatan model, permintaan penerapan, peran, dan kebijakan di Golang. Anda dapat menentukan log Anda sendiri untuk mencatat Casbin.\nJika Anda menggunakan Python, pycasbin memanfaatkan mekanisme logging default Python. Paket pycasbin melakukan panggilan ke ",(0,r.kt)("inlineCode",{parentName:"p"},"logging.getLogger()")," untuk mengatur logger. Tidak diperlukan konfigurasi logging khusus selain menginisialisasi logger di aplikasi induk. Jika tidak ada logging yang diinisialisasi dalam aplikasi induk, Anda tidak akan melihat pesan log apa pun dari pycasbin. Pada saat yang sama, ketika Anda mengaktifkan log di pycasbin, itu akan menggunakan ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/pycasbin/blob/c33cabfa0ac65cd09cf812a65e71794d64cb5132/casbin/util/log.py#L6C1-L6C1"},"konfigurasi log default"),". Untuk ekstensi pycasbin lainnya, Anda dapat merujuk ke ",(0,r.kt)("a",{parentName:"p",href:"https://docs.djangoproject.com/en/4.2/topics/logging/"},"dokumentasi logging Django")," jika Anda pengguna Django. Untuk pengguna Python lainnya, Anda harus merujuk ke ",(0,r.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.config.html"},"dokumentasi logging Python")," untuk mengonfigurasi logger.")),(0,r.kt)("h3",{id:"gunakan-logger-yang-berbeda-untuk-enforcer-yang-berbeda"},"Gunakan logger yang berbeda untuk enforcer yang berbeda"),(0,r.kt)("p",null,"Setiap enforcer dapat memiliki logger sendiri untuk mencatat informasi, dan dapat diubah saat runtime."),(0,r.kt)("p",null,"Dan Anda dapat menggunakan logger yang sesuai melalui parameter terakhir dari ",(0,r.kt)("inlineCode",{parentName:"p"},"NewEnforcer()"),". Jika Anda menggunakan cara ini untuk menginisialisasi enforcer Anda, Anda tidak perlu menggunakan parameter enabled karena prioritas field enabled dalam logger lebih tinggi."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},"// Set a default logger as enforcer e1's logger.\n// This operation can also be seen as changing the logger of e1 at runtime.\ne1.SetLogger(&Log.DefaultLogger{})\n\n// Set another logger as enforcer e2's logger.\ne2.SetLogger(&YouOwnLogger)\n\n// Set your logger when initializing enforcer e3.\ne3, _ := casbin.NewEnforcer(\"examples/rbac_model.conf\", a, logger)\n")),(0,r.kt)("h4",{id:"logger-yang-didukung"},"Logger yang didukung"),(0,r.kt)("p",null,"Kami menyediakan beberapa logger untuk membantu Anda mencatat informasi."),(0,r.kt)(u,{groupId:"langs",mdxType:"Tabs"},(0,r.kt)(k,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Logger"),(0,r.kt)("th",{parentName:"tr",align:null},"Penulis"),(0,r.kt)("th",{parentName:"tr",align:null},"Deskripsi"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casbin/casbin/blob/master/log/default_logger.go"},"Logger default (bawaan)")),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Logger default menggunakan log golang.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casbin/zap-logger"},"Pencatat Zap")),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Menggunakan ",(0,r.kt)("a",{parentName:"td",href:"https://github.com/uber-go/zap"},"zap"),", berikan log yang dikodekan JSON dan Anda dapat menyesuaikan lebih banyak dengan pencatat zap Anda sendiri."))))),(0,r.kt)(k,{value:"PHP",label:"PHP",mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Pencatat"),(0,r.kt)("th",{parentName:"tr",align:null},"Penulis"),(0,r.kt)("th",{parentName:"tr",align:null},"Deskripsi"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/php-casbin/psr3-bridge"},"pencatat jembatan psr3")),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Menyediakan jembatan yang sesuai dengan ",(0,r.kt)("a",{parentName:"td",href:"https://www.php-fig.org/psr/psr-3/"},"PSR-3"),".")))))),(0,r.kt)("h4",{id:"cara-menulis-pencatat"},"Cara menulis pencatat"),(0,r.kt)("p",null,"Logger Anda harus mengimplementasikan antarmuka ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/log/logger.go#L20"},"Logger"),"."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Metode"),(0,r.kt)("th",{parentName:"tr",align:null},"Tipe"),(0,r.kt)("th",{parentName:"tr",align:null},"Deskripsi"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"EnableLog()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Mengontrol apakah akan mencetak pesan.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"IsEnabled()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Tampilkan status pengaktifan logger saat ini.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LogModel()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Catat informasi terkait model.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LogEnforce()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Catat informasi terkait penerapan.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LogRole()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Catat informasi terkait peran.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LogPolicy()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Catat info terkait kebijakan.")))),(0,r.kt)("p",null,"Anda dapat meneruskan ",(0,r.kt)("inlineCode",{parentName:"p"},"logger")," kustom Anda ke ",(0,r.kt)("inlineCode",{parentName:"p"},"Enforcer.SetLogger()"),"."),(0,r.kt)("p",null,"Berikut adalah contoh cara menyesuaikan logger untuk Golang:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'import (\n    "fmt"\n    "log"\n    "strings"\n)\n\n// DefaultLogger is the implementation for a Logger using golang log.\ntype DefaultLogger struct {\n    enabled bool\n}\n\nfunc (l *DefaultLogger) EnableLog(enable bool) {\n    l.enabled = enable\n}\n\nfunc (l *DefaultLogger) IsEnabled() bool {\n    return l.enabled\n}\n\nfunc (l *DefaultLogger) LogModel(model [][]string) {\n    if !l.enabled {\n        return\n    }\n    var str strings.Builder\n    str.WriteString("Model: ")\n    for _, v := range model {\n        str.WriteString(fmt.Sprintf("%v\\n", v))\n    }\n\n    log.Println(str.String())\n}\n\nfunc (l *DefaultLogger) LogEnforce(matcher string, request []interface{}, result bool, explains [][]string) {\n    if !l.enabled {\n        return\n    }\n\n    var reqStr strings.Builder\n    reqStr.WriteString("Request: ")\n    for i, rval := range request {\n        if i != len(request)-1 {\n            reqStr.WriteString(fmt.Sprintf("%v, ", rval))\n        } else {\n            reqStr.WriteString(fmt.Sprintf("%v", rval))\n        }\n    }\n    reqStr.WriteString(fmt.Sprintf(" ---\x3e %t\\n", result))\n\n    reqStr.WriteString("Hit Policy: ")\n    for i, pval := range explains {\n        if i != len(explains)-1 {\n            reqStr.WriteString(fmt.Sprintf("%v, ", pval))\n        } else {\n            reqStr.WriteString(fmt.Sprintf("%v \\n", pval))\n        }\n    }\n\n    log.Println(reqStr.String())\n}\n\nfunc (l *DefaultLogger) LogPolicy(policy map[string][][]string) {\n    if !l.enabled {\n        return\n    }\n\n    var str strings.Builder\n    str.WriteString("Policy: ")\n    for k, v := range policy {\n        str.WriteString(fmt.Sprintf("%s : %v\\n", k, v))\n    }\n\n    log.Println(str.String())\n}\n\nfunc (l *DefaultLogger) LogRole(roles []string) {\n    if !l.enabled {\n        return\n    }\n\n    log.Println("Roles: ", roles)\n}\n')),(0,r.kt)("h2",{id:"penanganan-kesalahan"},"Penanganan kesalahan"),(0,r.kt)("p",null,"Kesalahan atau panic dapat terjadi saat Anda menggunakan Casbin karena alasan seperti:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Sintaksis tidak valid dalam file model (.conf)."),(0,r.kt)("li",{parentName:"ol"},"Sintaksis tidak valid dalam file kebijakan (.csv)."),(0,r.kt)("li",{parentName:"ol"},"Kesalahan kustom dari adaptor penyimpanan, misalnya, MySQL gagal terhubung."),(0,r.kt)("li",{parentName:"ol"},"Bug Casbin.")),(0,r.kt)("p",null,"Ada lima fungsi utama yang mungkin perlu Anda ketahui untuk menangani kesalahan atau panik:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Fungsi"),(0,r.kt)("th",{parentName:"tr",align:null},"Perilaku saat terjadi kesalahan"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#NewEnforcer"},"NewEnforcer()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan sebuah kesalahan")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.LoadModel"},"LoadModel()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan sebuah kesalahan")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.LoadPolicy"},"LoadPolicy()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan sebuah kesalahan")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.SavePolicy"},"SavePolicy()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan sebuah kesalahan")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.Enforce"},"Enforce()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan sebuah kesalahan")))),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"NewEnforcer()")," memanggil ",(0,r.kt)("inlineCode",{parentName:"p"},"LoadModel()")," dan ",(0,r.kt)("inlineCode",{parentName:"p"},"LoadPolicy()")," secara internal. Jadi, Anda tidak perlu memanggil dua yang terakhir ketika menggunakan ",(0,r.kt)("inlineCode",{parentName:"p"},"NewEnforcer()"),".")),(0,r.kt)("h2",{id:"mengaktifkan-dan-menonaktifkan"},"Mengaktifkan dan menonaktifkan"),(0,r.kt)("p",null,"Enforcer dapat dinonaktifkan melalui fungsi ",(0,r.kt)("inlineCode",{parentName:"p"},"Enforcer.EnableEnforce()"),". Ketika dinonaktifkan, ",(0,r.kt)("inlineCode",{parentName:"p"},"Enforcer.Enforce()")," akan selalu mengembalikan ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),". Operasi lain seperti menambahkan atau menghapus kebijakan tidak terpengaruh. Berikut adalah contohnya:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'e := casbin.NewEnforcer("examples/basic_model.conf", "examples/basic_policy.csv")\n\n// Will return false.\n// By default, the enforcer is enabled.\ne.Enforce("non-authorized-user", "data1", "read")\n\n// Disable the enforcer at runtime.\ne.EnableEnforce(false)\n\n// Will return true for any request.\ne.Enforce("non-authorized-user", "data1", "read")\n\n// Enable the enforcer again.\ne.EnableEnforce(true)\n\n// Will return false.\ne.Enforce("non-authorized-user", "data1", "read")\n')))}m.isMDXComponent=!0}}]);