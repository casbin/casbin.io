<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-k8s-gatekeeper" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Admission Webhook for K8s | Casbin</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://casbin.org/ja/docs/k8s-gatekeeper"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="Casbin" content="An authorization library that supports access control models like ACL, RBAC, ABAC for Golang, Java, C/C++, Node.js, Javascript, PHP, Laravel, Python, .NET (C#), Delphi, Rust, Ruby, Swift (Objective-C), Lua (OpenResty), Dart (Flutter) and Elixir"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Admission Webhook for K8s | Casbin"><meta data-rh="true" name="description" content="Casbinã«åŸºã¥ãKubernetesï¼ˆK8sï¼‰RBACï¼†ABACèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢"><meta data-rh="true" property="og:description" content="Casbinã«åŸºã¥ãKubernetesï¼ˆK8sï¼‰RBACï¼†ABACèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢"><meta data-rh="true" name="keywords" content="k8s-gatekeeper,Kubernetes,K8s"><link data-rh="true" rel="icon" href="/ja/img/favicon.png"><link data-rh="true" rel="canonical" href="https://casbin.org/ja/docs/k8s-gatekeeper"><link data-rh="true" rel="alternate" href="https://casbin.org/docs/k8s-gatekeeper" hreflang="en"><link data-rh="true" rel="alternate" href="https://casbin.org/zh/docs/k8s-gatekeeper" hreflang="zh"><link data-rh="true" rel="alternate" href="https://casbin.org/ko/docs/k8s-gatekeeper" hreflang="ko"><link data-rh="true" rel="alternate" href="https://casbin.org/ru/docs/k8s-gatekeeper" hreflang="ru"><link data-rh="true" rel="alternate" href="https://casbin.org/fr/docs/k8s-gatekeeper" hreflang="fr"><link data-rh="true" rel="alternate" href="https://casbin.org/de/docs/k8s-gatekeeper" hreflang="de"><link data-rh="true" rel="alternate" href="https://casbin.org/ja/docs/k8s-gatekeeper" hreflang="ja"><link data-rh="true" rel="alternate" href="https://casbin.org/es/docs/k8s-gatekeeper" hreflang="es"><link data-rh="true" rel="alternate" href="https://casbin.org/pt/docs/k8s-gatekeeper" hreflang="pt"><link data-rh="true" rel="alternate" href="https://casbin.org/uk/docs/k8s-gatekeeper" hreflang="uk"><link data-rh="true" rel="alternate" href="https://casbin.org/th/docs/k8s-gatekeeper" hreflang="th"><link data-rh="true" rel="alternate" href="https://casbin.org/ar/docs/k8s-gatekeeper" hreflang="ar"><link data-rh="true" rel="alternate" href="https://casbin.org/docs/k8s-gatekeeper" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6NBEV8TOFK-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/ja/blog/rss.xml" title="Casbin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ja/blog/atom.xml" title="Casbin Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8S2TKCJ27X"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8S2TKCJ27X",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Casbin" href="/ja/opensearch.xml">
<script src="/js/isMainland.js" async></script>
<script src="/js/tawk.js" async></script>
<script src="/js/hotjar.js" async></script>
<script src="/js/probe.js" async></script>
<script src="/js/clarity.js" async></script><link rel="stylesheet" href="/ja/assets/css/styles.c57d47b6.css">
<link rel="preload" href="/ja/assets/js/runtime~main.e29b42b5.js" as="script">
<link rel="preload" href="/ja/assets/js/main.9b136725.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã‚¹ã‚­ãƒƒãƒ—"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã‚¹ã‚­ãƒƒãƒ—</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><a href="https://casdoor.org/">ğŸ’– Looking for an open-source identity and access management solution like Okta, Auth0, Keycloak ? Learn more about: Casdoor</a></div><button type="button" aria-label="é–‰ã˜ã‚‹" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="ãƒ¡ã‚¤ãƒ³" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆ" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ja/"><div class="navbar__logo"><img src="/ja/img/casbin.svg" alt="ãƒã‚¤ã‚µã‚¤ãƒˆãƒ­ã‚´" class="themedImage_ToTc themedImage--light_HNdA"><img src="/ja/img/casbin.svg" alt="ãƒã‚¤ã‚µã‚¤ãƒˆãƒ­ã‚´" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Casbin</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/ja/docs/overview">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ja/docs/get-started">ã¯ã˜ã‚ã‚ˆã†</a></li><li><a class="dropdown__link" href="/ja/docs/category/model">ãƒ¢ãƒ‡ãƒ«</a></li><li><a class="dropdown__link" href="/ja/docs/category/storage">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</a></li><li><a class="dropdown__link" href="/ja/docs/adapters">ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼</a></li><li><a class="dropdown__link" href="/ja/docs/category/api">API</a></li><li><a class="dropdown__link" href="/ja/docs/ide-plugins">IDE ãƒ—ãƒ©ã‚°ã‚¤ãƒ³</a></li><li><a class="dropdown__link" href="/ja/docs/contributing">è²¢çŒ®ã‚’é–‹å§‹</a></li></ul></div><a class="navbar__item navbar__link" href="/ja/ecosystem">ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ </a><a class="navbar__item navbar__link" href="/ja/blog">ãƒ–ãƒ­ã‚°</a><a class="navbar__item navbar__link" href="/ja/help">ãƒ˜ãƒ«ãƒ—</a><a class="navbar__item navbar__link" href="/ja/editor">ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼</a><a href="https://casdoor.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ä¼æ¥­å‘ã‘<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://casdoor.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ—ãƒ©ãƒ³ï¼ˆSaaSï¼‰<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>æ—¥æœ¬èª</a><ul class="dropdown__menu"><li><a href="/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">ä¸­æ–‡</a></li><li><a href="/ko/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">í•œêµ­ì–´</a></li><li><a href="/ru/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a></li><li><a href="/fr/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">FranÃ§ais</a></li><li><a href="/de/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="/ja/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">æ—¥æœ¬èª</a></li><li><a href="/es/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">EspaÃ±ol</a></li><li><a href="/pt/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">PortuguÃªs</a></li><li><a href="/uk/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°</a></li><li><a href="/th/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="th">à¹„à¸—à¸¢</a></li><li><a href="/ar/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://crowdin.com/project/casbin-website" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/casbin/casbin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://discord.gg/S5UjpzGZjN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-community-discord"></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="æ¤œç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æ¤œç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://casdoor.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link casdoor-signup casdoor-link">æ–°è¦ç™»éŒ²<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://casdoor.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link casdoor-login casdoor-link">ãƒ­ã‚°ã‚¤ãƒ³<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¨ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ï¼ˆç¾åœ¨ã¯ ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰" aria-label="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¨ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ï¼ˆç¾åœ¨ã¯ ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/ja/"><img src="/ja/img/casbin.svg" alt="ãƒã‚¤ã‚µã‚¤ãƒˆãƒ­ã‚´" class="themedImage_ToTc themedImage--light_HNdA"><img src="/ja/img/casbin.svg" alt="ãƒã‚¤ã‚µã‚¤ãƒˆãƒ­ã‚´" class="themedImage_ToTc themedImage--dark_i4oU"><b>Casbin</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/the-basics">åŸºæœ¬</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;åŸºæœ¬ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/get-started">Get Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/how-it-works">How It Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/tutorials">Tutorials</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/understanding-casbin-detail">Understanding How Casbin Matching Works in Detail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/pdf">PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/model">ãƒ¢ãƒ‡ãƒ«</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ãƒ¢ãƒ‡ãƒ« &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/supported-models">Supported Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/syntax-for-models">Syntax for Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/effector">Effector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/function">Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac">RBAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-pattern">RBAC with Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-domains">RBAC with Domains</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-conditions">RBAC with Conditions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-96">Casbin RBAC vs. RBAC96</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/abac">ABAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/priority-model">Priority Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/superadmin">Super Admin</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/storage">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/model-storage">Model Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/policy-storage">Policy Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/policy-subset-loading">Policy Subset Loading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/scenarios">Scenarios</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;Scenarios &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/data-permissions">Data Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/menu-permissions">Menu Permissions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/extensions">æ‹¡å¼µ</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;æ‹¡å¼µ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/enforcers">Enforcers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/adapters">Adapters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/watchers">Watchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/dispatchers">Dispatchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/role-managers">Role Managers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/middlewares">Middlewares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/graphql-middlewares">GraphQL Middlewares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/cloud-native">Cloud Native Middlewares</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/api">API</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;API &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/api-overview">API Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/management-api">Management API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-api">RBAC API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-domains-api">RBAC with Domains API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-conditions-api">RBAC with Conditions API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rolemanager-api">RoleManager API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/ja/docs/category/advanced-usage">é«˜åº¦ãªä½¿ã„æ–¹</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;é«˜åº¦ãªä½¿ã„æ–¹ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/multi-threading">Multi-threading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/benchmark">Benchmarks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/performance">Performance Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/k8s">Authorization of Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ja/docs/k8s-gatekeeper">Admission Webhook for K8s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/envoy">Authorization of Service Mesh through Envoy</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/management">ç®¡ç†</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ç®¡ç† &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/admin-portal">Admin Portal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/service">Casbin Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/log-error">Log &amp; Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/frontend">Frontend Usage</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/editor">ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/online-editor">Online Editor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/ide-plugins">IDE Plugins</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/more">ã‚‚ã£ã¨è¦‹ã‚‹</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ã‚‚ã£ã¨è¦‹ã‚‹ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/adopters">Our Adopters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/contributing">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/privacy-policy">Privacy Policy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/terms-of-service">Terms of Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/refund-policy">Refund Policy</a></li></ul></li></ul></nav><button type="button" title="ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’é–‰ã˜ã‚‹" aria-label="ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’é–‰ã˜ã‚‹" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸" class="breadcrumbs__link" href="/ja/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/ja/docs/category/advanced-usage"><span itemprop="name">é«˜åº¦ãªä½¿ã„æ–¹</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Admission Webhook for K8s</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">ã“ã®ãƒšãƒ¼ã‚¸</button></div><div class="theme-doc-markdown markdown"><header><h1>Admission Webhook for K8s</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-casbin-k8s-gatekeeperã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ">1. Casbin K8s-Gatekeeperã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ<a href="#1-casbin-k8s-gatekeeperã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ" class="hash-link" aria-label="1. Casbin K8s-Gatekeeperã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1. Casbin K8s-Gatekeeperã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><p>Casbin K8s-GateKeeperã¯ã€ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦Casbinã‚’çµ±åˆã—ãŸKubernetesã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã§ã™ã€‚ Casbin K8s-GateKeeperã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ã‚’ä¸€åˆ‡æ›¸ã‹ãšã«ã€Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®å®£è¨€çš„ãªè¨­å®šã®ã¿ã§ã€K8sãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ä»»æ„ã®æ“ä½œã‚’èªè¨¼ã¾ãŸã¯ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ãƒˆã™ã‚‹æŸ”è»Ÿãªãƒ«ãƒ¼ãƒ«ã‚’ç¢ºç«‹ã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã¯Casbin ACLï¼ˆã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒªã‚¹ãƒˆï¼‰è¨€èªã®ä¸€éƒ¨ã§ã™ã€‚</p><p>Casbin K8s-GateKeeperã¯Casbinã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã£ã¦é–‹ç™ºãƒ»ç¶­æŒã•ã‚Œã¦ã„ã¾ã™ã€‚ ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã“ã¡ã‚‰ã§åˆ©ç”¨ã§ãã¾ã™ï¼š<a href="https://github.com/casbin/k8s-gatekeeper" target="_blank" rel="noopener noreferrer">https://github.com/casbin/k8s-gatekeeper</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="01-ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹">0.1 ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹<a href="#01-ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹" class="hash-link" aria-label="0.1 ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="0.1 ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>ä¾‹ãˆã°ã€ã‚³ãƒ¼ãƒ‰ã‚’ä¸€åˆ‡æ›¸ã‹ãšã«ã€ä»¥ä¸‹ã®è¨­å®šè¡Œã‚’ä½¿ç”¨ã—ã¦ã“ã®æ©Ÿèƒ½ã‚’å®Ÿç¾ã§ãã¾ã™ï¼šã€Œç‰¹å®šã®ã‚¿ã‚°ã‚’æŒã¤ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒä»»æ„ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã§ä½¿ç”¨ã•ã‚Œã‚‹ã®ã‚’ç¦æ­¢ã™ã‚‹ã€ï¼š</p><p>Model:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj,eft</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">!some(where (p.eft == deny))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contain(split(accessWithWildcard(${OBJECT}.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And Policy:</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã‚Œã‚‰ã¯é€šå¸¸ã®Casbin ACLè¨€èªã§ã™ã€‚ ã™ã§ã«ãã‚Œã‚‰ã«ã¤ã„ã¦ã®ç« ã‚’èª­ã‚“ã§ã„ã‚Œã°ã€ç†è§£ã™ã‚‹ã®ã¯éå¸¸ã«ç°¡å˜ã§ã™ã€‚</p><p>Casbin K8s-Gatekeeperã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªåˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ï¼š</p><ul><li>ä½¿ã„ã‚„ã™ã„ã€‚ ãŸãã•ã‚“ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã‚ˆã‚Šã‚‚ã€ã„ãã¤ã‹ã®ACLè¡Œã‚’æ›¸ãæ–¹ãŒã¯ã‚‹ã‹ã«è‰¯ã„ã€‚</li><li>è¨­å®šã®ãƒ›ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’è¨±å¯ã—ã¾ã™ã€‚ è¨­å®šã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å…¨ä½“ã‚’ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li><li>æŸ”è»Ÿæ€§ãŒã‚ã‚Šã¾ã™ã€‚ ä»»æ„ã®ãƒ«ãƒ¼ãƒ«ã‚’ä»»æ„ã®K8sãƒªã‚½ãƒ¼ã‚¹ã«ä½œæˆã§ãã€<code>kubectl gatekeeper</code>ã§æ¢ç´¢ã§ãã¾ã™ã€‚</li><li>éå¸¸ã«è¤‡é›‘ãªK8sã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã®å®Ÿè£…ã‚’ç°¡ç´ åŒ–ã—ã¾ã™ã€‚ K8sã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ãŒä½•ã§ã‚ã‚‹ã‹ã€ã¾ãŸã¯ãã‚Œã®ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ã‚’ã©ã®ã‚ˆã†ã«æ›¸ãã‹ã‚’çŸ¥ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ ã‚ãªãŸãŒåˆ¶ç´„ã‚’ç½®ããŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’çŸ¥ã‚Šã€æ¬¡ã«Casbin ACLã‚’æ›¸ãã ã‘ã§ã™ã€‚ çš†ã•ã‚“ãŒK8sãŒè¤‡é›‘ã§ã‚ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã¾ã™ãŒã€Casbin K8s-Gatekeeperã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€æ™‚é–“ã‚’ç¯€ç´„ã§ãã¾ã™ã€‚</li><li>Casbinã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã£ã¦ç¶­æŒã•ã‚Œã¦ã„ã¾ã™ã€‚ ã“ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã¤ã„ã¦ä½•ã‹æ··ä¹±ã—ã¦ã„ã‚‹ã“ã¨ã‚„ã€ã“ã‚Œã‚’è©¦ã—ã¦ã„ã‚‹ã¨ãã«å•é¡Œã«é­é‡ã—ãŸå ´åˆã¯ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-casbin-k8s-gatekeeperã¯ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã®ã‹">1.1 Casbin K8s-Gatekeeperã¯ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã®ã‹ï¼Ÿ<a href="#11-casbin-k8s-gatekeeperã¯ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã®ã‹" class="hash-link" aria-label="1.1 Casbin K8s-Gatekeeperã¯ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã®ã‹ï¼Ÿ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1.1 Casbin K8s-Gatekeeperã¯ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã®ã‹ï¼Ÿ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>K8s-Gatekeeperã¯ã€ç®¡ç†è€…ãŒæœ›ã¾ãªã„K8sä¸Šã®ä»»æ„ã®æ“ä½œã‚’é˜²ããŸã‚ã«ã€ä»»æ„ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã™ã‚‹<a href="/ja/docs/overview">Casbin</a>ã‚’ä½¿ç”¨ã™ã‚‹K8sã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã§ã™ã€‚</p><p>Casbinã¯ã€å¼·åŠ›ã§åŠ¹ç‡çš„ãªã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ ã•ã¾ã–ã¾ãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ãèªè¨¼ã®å¼·åˆ¶ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ Casbinã«ã¤ã„ã¦ã®è©³ç´°ã¯ã€<a href="/ja/docs/overview">æ¦‚è¦</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p><p>K8sã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã¯ã€&#x27;ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆ&#x27;ã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚‰ã‚’å‡¦ç†ã™ã‚‹HTTPã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ã™ã€‚ ç‰¹ã«ã€K8s-Gatekeeperã¯ç‰¹åˆ¥ãªç¨®é¡ã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã§ã‚ã‚Šã€&#x27;ValidatingAdmissionWebhook&#x27;ã¨å‘¼ã°ã‚Œã€ã“ã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å…¥ã‚Œã‚‹ã‹å¦ã‹ã‚’æ±ºå®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¤ã„ã¦ã¯ã€K8sã®æŒ‡å®šã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹æ“ä½œã‚’è¨˜è¿°ã—ãŸHTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™ï¼ˆä¾‹ãˆã°ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®ä½œæˆ/å‰Šé™¤ï¼‰ã€‚ ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã«ã¤ã„ã¦ã®è©³ç´°ã¯ã€<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#what-are-admission-webhooks" target="_blank" rel="noopener noreferrer">K8så…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12-ãã‚ŒãŒã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹">1.2 ãã‚ŒãŒã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹<a href="#12-ãã‚ŒãŒã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹" class="hash-link" aria-label="1.2 ãã‚ŒãŒã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1.2 ãã‚ŒãŒã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>ä¾‹ãˆã°ã€èª°ã‹ãŒnginxã‚’å®Ÿè¡Œã™ã‚‹ãƒãƒƒãƒ‰ã‚’å«ã‚€ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ãŸã„ã¨æ€ã£ãŸã¨ãï¼ˆkubectlã¾ãŸã¯K8sã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ï¼‰ã€K8sã¯ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç”Ÿæˆã—ã€ãã‚Œã¯ï¼ˆYAMLå½¢å¼ã«å¤‰æ›ã•ã‚ŒãŸå ´åˆï¼‰æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.14.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ç”»åƒã«ç¤ºã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµŒã‚‹ã“ã¨ã«ãªã‚Šã€ãã®ä¸­ã«ã¯ç§ãŸã¡ã®K8s-Gatekeeperã‚‚å«ã¾ã‚Œã¾ã™ã€‚ K8s-Gatekeeperã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã—ç¶­æŒã—ã¦ã„ã‚‹K8sã®etcdã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®Casbinã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’æ¤œå‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆ<code>kubectl</code>ã¾ãŸã¯ç§ãŸã¡ãŒæä¾›ã™ã‚‹Goã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä»‹ã—ã¦ï¼‰ã€‚ å„ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã«ã¯ã€Casbinãƒ¢ãƒ‡ãƒ«ã¨Casbinãƒãƒªã‚·ãƒ¼ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ä¸€ã¤ä¸€ã¤ã®ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã«ã‚ˆã£ã¦å‡¦ç†ã•ã‚Œã€ã™ã¹ã¦ã®ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’é€šéã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿ãŒã“ã®K8s-Gatekeeperã«ã‚ˆã£ã¦å—ã‘å…¥ã‚Œã‚‰ã‚Œã¾ã™ã€‚</p><p>ï¼ˆCasbinã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã€ãƒ¢ãƒ‡ãƒ«ã€ãƒãƒªã‚·ãƒ¼ãŒä½•ã§ã‚ã‚‹ã‹ç†è§£ã§ããªã„å ´åˆã¯ã€ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š<a href="/ja/docs/get-started">Get Started</a>ï¼‰ã€‚</p><p>ä¾‹ãˆã°ã€ä½•ã‚‰ã‹ã®ç†ç”±ã§ã€ç®¡ç†è€…ã¯&#x27;image &#x27;nginx:1.14.1&#x27;ã®å‡ºç¾ã‚’ç¦æ­¢ã—ã¤ã¤ã€&#x27;nginx:1.3.1&#x27;ã‚’è¨±å¯ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’å«ã‚€ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã®ä½œæˆæ–¹æ³•ã€ã“ã‚Œã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ãŒä½•ã§ã‚ã‚‹ã‹ã€ãã‚Œã‚‰ã‚’ã©ã®ã‚ˆã†ã«æ›¸ãã‹ã«ã¤ã„ã¦ã¯ã€æ¬¡ã®ç« ã§èª¬æ˜ã—ã¾ã™ï¼‰ã€‚</p><p>Model:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj,eft</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">!some(where (p.eft == deny))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">= p.obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Policy:</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;nginx:1.13.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">allow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;nginx:1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä¸Šè¨˜ã®ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’å«ã‚€ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€å‰è¿°ã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã“ã®ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã«ã‚ˆã£ã¦æ‹’å¦ã•ã‚Œã€ã“ã‚Œã¯K8sãŒã“ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ãªã„ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-k8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">2 K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href="#2-k8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" class="hash-link" aria-label="2 K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2 K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><p>K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«ã¯ã€External webhookã€Internal webhookã€Helmã®3ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ãƒ¡ãƒ¢</div><div class="admonitionContent_S0QG"><p>æ³¨æ„ï¼šã“ã‚Œã‚‰ã®æ–¹æ³•ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒK8s-gatekeeperã‚’è©¦ã™ãŸã‚ã®ã‚‚ã®ã§ã‚ã‚Šã€ã‚»ã‚­ãƒ¥ã‚¢ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ ç”Ÿç”£ç’°å¢ƒã§ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€<a href="#5-advanced-settings">Chapter 5. é«˜åº¦ãªè¨­å®š</a>ã‚’èª­ã¿ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‰ã«å¿…è¦ãªå¤‰æ›´ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21-å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯">2.1 å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯<a href="#21-å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯" class="hash-link" aria-label="2.1 å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.1 å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="211-ã‚¹ãƒ†ãƒƒãƒ—1ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰">2.1.1 ã‚¹ãƒ†ãƒƒãƒ—1ï¼šã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰<a href="#211-ã‚¹ãƒ†ãƒƒãƒ—1ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰" class="hash-link" aria-label="2.1.1 ã‚¹ãƒ†ãƒƒãƒ—1ï¼šã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.1.1 ã‚¹ãƒ†ãƒƒãƒ—1ï¼šã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯æ–¹æ³•ã§ã¯ã€ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯è‡ªä½“ãŒKuberneteså†…ã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™ã€‚ å¿…è¦ãªã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã¯ã€K8s-gatekeeperã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€è‡ªåˆ†ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build --target webhook -t k8s-gatekeeper </span><span class="token builtin class-name">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€&#x27;k8s-gatekeeper:latest&#x27;ã¨ã„ã†ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ãƒ¡ãƒ¢</div><div class="admonitionContent_S0QG"><p>æ³¨æ„ï¼šminikubeã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€&#x27;docker build&#x27;ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«<code>eval $(minikube -p minikube docker-env)</code>ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="212-ã‚¹ãƒ†ãƒƒãƒ—2k8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®è¨­å®š">2.1.2 ã‚¹ãƒ†ãƒƒãƒ—2ï¼šK8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®è¨­å®š<a href="#212-ã‚¹ãƒ†ãƒƒãƒ—2k8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®è¨­å®š" class="hash-link" aria-label="2.1.2 ã‚¹ãƒ†ãƒƒãƒ—2ï¼šK8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®è¨­å®š ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.1.2 ã‚¹ãƒ†ãƒƒãƒ—2ï¼šK8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®è¨­å®š ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/rbac.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_deployment.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_internal.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã‚Œã«ã‚ˆã‚Šã€K8s-gatekeeperãŒå®Ÿè¡Œã‚’é–‹å§‹ã—ã€<code>kubectl get pods</code>ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã“ã‚Œã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="213-ã‚¹ãƒ†ãƒƒãƒ—3k8s-gatekeeperã®crdãƒªã‚½ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">2.1.3 ã‚¹ãƒ†ãƒƒãƒ—3ï¼šK8s-gatekeeperã®CRDãƒªã‚½ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href="#213-ã‚¹ãƒ†ãƒƒãƒ—3k8s-gatekeeperã®crdãƒªã‚½ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" class="hash-link" aria-label="2.1.3 ã‚¹ãƒ†ãƒƒãƒ—3ï¼šK8s-gatekeeperã®CRDãƒªã‚½ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.1.3 ã‚¹ãƒ†ãƒƒãƒ—3ï¼šK8s-gatekeeperã®CRDãƒªã‚½ãƒ¼ã‚¹ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinmodels.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinpolicies.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22-external-webhook">2.2 External webhook<a href="#22-external-webhook" class="hash-link" aria-label="2.2 External webhook ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.2 External webhook ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>For the external webhook method, K8s-gatekeeper will be running outside of Kubernetes, and Kubernetes will access K8s-gatekeeper as it would access a regular website. Kubernetes has a mandatory requirement that the admission webhook must be HTTPS. For the purpose of trying out K8s-gatekeeper, we have provided a set of certificates and a private key (although this is not secure). If you prefer to use your own certificate, please refer to <a href="#5-advanced-settings">Chapter 5. Advanced settings</a> for instructions on adjusting the certificate and private key.</p><p>The certificate we provide is issued for &#x27;webhook.domain.local&#x27;. So, modify the host (e.g., /etc/hosts) and point &#x27;webhook.domain.local&#x27; to the IP address on which K8s-gatekeeper is running.</p><p>Then execute the following command:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">go mod tidy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go mod vendor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go run cmd/webhook/main.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinmodels.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinpolicies.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_external.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="23-install-k8s-gatekeeper-via-helm">2.3 Install K8s-gatekeeper via Helm<a href="#23-install-k8s-gatekeeper-via-helm" class="hash-link" aria-label="2.3 Install K8s-gatekeeper via Helm ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.3 Install K8s-gatekeeper via Helm ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="231-step-1-build-the-image">2.3.1 Step 1: Build the image<a href="#231-step-1-build-the-image" class="hash-link" aria-label="2.3.1 Step 1: Build the image ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.3.1 Step 1: Build the image ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>Please refer to <a href="#211-step-1-build-the-image">Chapter 2.1.1</a>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="232-helm-installation">2.3.2 Helm installation<a href="#232-helm-installation" class="hash-link" aria-label="2.3.2 Helm installation ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.3.2 Helm installation ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>Run the command <code>helm install k8sgatekeeper ./k8sgatekeeper</code>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-try-k8s-gatekeeper">3. Try K8s-gatekeeper<a href="#3-try-k8s-gatekeeper" class="hash-link" aria-label="3. Try K8s-gatekeeper ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3. Try K8s-gatekeeper ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31-create-casbin-model-and-policy">3.1 Create Casbin Model and Policy<a href="#31-create-casbin-model-and-policy" class="hash-link" aria-label="3.1 Create Casbin Model and Policy ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1 Create Casbin Model and Policy ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>You have two methods to create a model and policy: via kubectl or via the go-client we provide.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="311-createupdate-casbin-model-and-policy-via-kubectl">3.1.1 Create/Update Casbin Model and Policy via kubectl<a href="#311-createupdate-casbin-model-and-policy-via-kubectl" class="hash-link" aria-label="3.1.1 Create/Update Casbin Model and Policy via kubectl ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1.1 Create/Update Casbin Model and Policy via kubectl ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>In K8s-gatekeeper, the Casbin model is stored in a CRD resource called &#x27;CasbinModel&#x27;. Its definition is located in <code>config/auth.casbin.org_casbinmodels.yaml</code>.</p><p>There are examples in <code>example/allowed_repo/model.yaml</code>. Pay attention to the following fields:</p><ul><li>metadata.name: the name of the model. This name MUST be the same as the name of the CasbinPolicy object related to this model, so that K8s-gatekeeper can pair them and create an enforcer.</li><li>spec.enable: if this field is set to &quot;false&quot;, this model (as well as the CasbinPolicy object related to this model) will be ignored.</li><li>spec.modelText: a string that contains the model text of a Casbin model.</li></ul><p>The Casbin Policy is stored in another CRD resource called &#x27;CasbinPolicy&#x27;, whose definition can be found in <code>config/auth.casbin.org_casbinpolicies.yaml</code>.</p><p>There are examples in <code>example/allowed_repo/policy.yaml</code>. Pay attention to the following fields:</p><ul><li>metadata.name: ãƒãƒªã‚·ãƒ¼ã®åå‰ã€‚ ã“ã®åå‰ã¯ã€ã“ã®ãƒãƒªã‚·ãƒ¼ã«é–¢é€£ã™ã‚‹CasbinModelã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åå‰ã¨åŒã˜ã§ãªã‘ã‚Œã°ãªã‚‰ãšã€K8s-gatekeeperãŒãã‚Œã‚‰ã‚’ãƒšã‚¢ã«ã—ã¦ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’ä½œæˆã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã§ã™ã€‚</li><li>spec.policyItem: Casbinãƒ¢ãƒ‡ãƒ«ã®ãƒãƒªã‚·ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚€æ–‡å­—åˆ—ã€‚</li></ul><p>è‡ªåˆ†è‡ªèº«ã®CasbinModelã¨CasbinPolicyãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸå¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã‚Œã‚‰ã‚’é©ç”¨ã—ã¾ã™:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">filename</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>CasbinModelã¨CasbinPolicyã®ãƒšã‚¢ãŒä½œæˆã•ã‚Œã‚‹ã¨ã€K8s-gatekeeperã¯5ç§’ä»¥å†…ã«ãã‚Œã‚’æ¤œå‡ºã§ãã¾ã™ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-ç§ãŸã¡ãŒæä¾›ã™ã‚‹go-clientã‚’é€šã˜ã¦casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆæ›´æ–°ã™ã‚‹">3.1.2 ç§ãŸã¡ãŒæä¾›ã™ã‚‹go-clientã‚’é€šã˜ã¦Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆ/æ›´æ–°ã™ã‚‹<a href="#312-ç§ãŸã¡ãŒæä¾›ã™ã‚‹go-clientã‚’é€šã˜ã¦casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆæ›´æ–°ã™ã‚‹" class="hash-link" aria-label="3.1.2 ç§ãŸã¡ãŒæä¾›ã™ã‚‹go-clientã‚’é€šã˜ã¦Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆ/æ›´æ–°ã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1.2 ç§ãŸã¡ãŒæä¾›ã™ã‚‹go-clientã‚’é€šã˜ã¦Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆ/æ›´æ–°ã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>K8sã‚¯ãƒ©ã‚¹ã‚¿ã®ãƒãƒ¼ãƒ‰ä¸Šã§ç›´æ¥ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚·ã‚§ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã®ãŒä¾¿åˆ©ã§ãªã„å ´åˆãŒã‚ã‚‹ã“ã¨ã‚’ç†è§£ã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€ã‚ãªãŸãŒè‡ªç¤¾ã®è‡ªå‹•ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹ã¨ããªã©ã§ã™ã€‚ ã—ãŸãŒã£ã¦ã€ç§ãŸã¡ã¯CasbinModelã¨CasbinPolicyã‚’ä½œæˆã—ã€ç¶­æŒã™ã‚‹ãŸã‚ã®go-clientã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚</p><p>go-clientãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯<code>pkg/client</code>ã«ä½ç½®ã—ã¦ã„ã¾ã™ã€‚</p><p><code>client.go</code>ã§ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã®é–¢æ•°ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewK8sGateKeeperClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">externalClient </span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">K8sGateKeeperClient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>externalClient</code>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€K8s-gatekeeperãŒK8sã‚¯ãƒ©ã‚¹ã‚¿å†…ã§å‹•ä½œã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚</p><p><code>model.go</code>ã§ã¯ã€CasbinModelã‚’ä½œæˆã€å‰Šé™¤ã€ä¿®æ­£ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªé–¢æ•°ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ ã“ã‚Œã‚‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ä½¿ç”¨æ–¹æ³•ã¯<code>model_test.go</code>ã§ç¢ºèªã§ãã¾ã™ã€‚</p><p><code>policy.go</code>ã§ã¯ã€CasbiPolicyã‚’ä½œæˆã€å‰Šé™¤ã€ä¿®æ­£ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªé–¢æ•°ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ ã“ã‚Œã‚‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ä½¿ç”¨æ–¹æ³•ã¯<code>policy_test.go</code>ã§ç¢ºèªã§ãã¾ã™ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-k8s-gatekeeperãŒå‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã™">3.1.2 K8s-gatekeeperãŒå‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã™<a href="#312-k8s-gatekeeperãŒå‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã™" class="hash-link" aria-label="3.1.2 K8s-gatekeeperãŒå‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã™ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1.2 K8s-gatekeeperãŒå‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã™ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>ã‚ãªãŸãŒã™ã§ã«<code>example/allowed_repo</code>ã§æ­£ç¢ºãªãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆã—ãŸã¨ä»®å®šã—ã¾ã™ã€‚ æ¬¡ã«ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/allowed_repo/testcase/reject_1.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>K8sã¯ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ‹’å¦ã—ã€ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ‹’å¦ã•ã‚ŒãŸç†ç”±ãŒwebhookã§ã‚ã£ãŸã“ã¨ã‚’ç¤ºã™ã¯ãšã§ã™ã€‚ ã—ã‹ã—ã€<code>example/allowed_repo/testcase/approve_2.yaml</code>ã‚’é©ç”¨ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ãã‚Œã¯å—ã‘å…¥ã‚Œã‚‰ã‚Œã¾ã™ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-k8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•">4. K8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•<a href="#4-k8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•" class="hash-link" aria-label="4. K8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³• ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4. K8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³• ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><p>ã¾ãšæœ€åˆã«ã€Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®åŸºæœ¬çš„ãªæ–‡æ³•ã«ç²¾é€šã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ ã‚‚ã—ç²¾é€šã—ã¦ã„ãªã„ãªã‚‰ã€ã¾ãš<a href="/ja/docs/get-started">Get Started</a>ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚ ã“ã®ç« ã§ã¯ã€ã‚ãªãŸãŒã™ã§ã«Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ãŒä½•ã§ã‚ã‚‹ã‹ã‚’ç†è§£ã—ã¦ã„ã‚‹ã¨ä»®å®šã—ã¦ã„ã¾ã™ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41-ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©">4.1 ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©<a href="#41-ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©" class="hash-link" aria-label="4.1 ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾© ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.1 ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾© ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>K8s-gatekeeperãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’èªè¨¼ã™ã‚‹ã¨ãã€å…¥åŠ›ã¯å¸¸ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™: Admission Requestã®Goã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚ ã“ã‚Œã¯ã€ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã¯å¸¸ã«ã“ã®ã‚ˆã†ã«ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ok</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> enforcer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Enforce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">admission</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã“ã§<code>admission</code>ã¯ã€K8sã®å…¬å¼go api<code>&quot;k8s.io/api/admission/v1&quot;</code>ã§å®šç¾©ã•ã‚ŒãŸ<code>AdmissionReview</code>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚ ã“ã®æ§‹é€ ä½“ã®å®šç¾©ã¯ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™: <a href="https://github.com/kubernetes/api/blob/master/admission/v1/types.go" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/api/blob/master/admission/v1/types.go</a>ã€‚ è©³ç´°ã«ã¤ã„ã¦ã¯ã€<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response</a>ã‚‚å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p><p>ã—ãŸãŒã£ã¦ã€K8s-gatekeeperã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã‚‹ä»»æ„ã®ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦ã¯ã€<code>request_definition</code>ã®å®šç¾©ã¯å¸¸ã«ã“ã®ã‚ˆã†ã«ãªã‚‹ã¹ãã§ã™ï¼š</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>åå‰&#x27;obj&#x27;ã¯å¿…é ˆã§ã¯ãªãã€åå‰ãŒ<code>[matchers]</code>éƒ¨åˆ†ã§ä½¿ç”¨ã•ã‚Œã‚‹åå‰ã¨ä¸€è‡´ã—ã¦ã„ã‚Œã°ã‚ˆã„ã§ã™ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42-ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼">4.2 ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼<a href="#42-ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼" class="hash-link" aria-label="4.2 ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2 ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>ã‚ãªãŸã¯Casbinã®ABACæ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ãƒ«ãƒ¼ãƒ«ã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ãŒæƒ³å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ ã—ã‹ã—ã€Casbinã«çµ„ã¿è¾¼ã¾ã‚ŒãŸå¼è©•ä¾¡å™¨ã¯ã€ãƒãƒƒãƒ—ã‚„é…åˆ—ï¼ˆã‚¹ãƒ©ã‚¤ã‚¹ï¼‰ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ã‘ã€ã¾ãŸã¯é…åˆ—ã®å±•é–‹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ ã—ãŸãŒã£ã¦ã€K8s-gatekeeperã¯ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®æ‹¡å¼µã¨ã—ã¦ã•ã¾ã–ã¾ãª&#x27;Casbiné–¢æ•°&#x27;ã‚’æä¾›ã—ã¾ã™ã€‚ ãã‚Œã§ã‚‚ãªãŠã€ã“ã‚Œã‚‰ã®æ‹¡å¼µæ©Ÿèƒ½ã§è¦æ±‚ã‚’æº€ãŸã›ãªã„å ´åˆã¯ã€è‡ªç”±ã«å•é¡Œã‚’èµ·ã“ã™ã‹ã€ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p><p>Casbiné–¢æ•°ã«æ…£ã‚Œã¦ã„ãªã„å ´åˆã¯ã€è©³ç´°ã«ã¤ã„ã¦ã¯<a href="/ja/docs/function">Function</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p><p>ä»¥ä¸‹ã«æ‹¡å¼µé–¢æ•°ã‚’ç¤ºã—ã¾ã™ï¼š</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="421-æ‹¡å¼µé–¢æ•°">4.2.1 æ‹¡å¼µé–¢æ•°<a href="#421-æ‹¡å¼µé–¢æ•°" class="hash-link" aria-label="4.2.1 æ‹¡å¼µé–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1 æ‹¡å¼µé–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4211-access">4.2.1.1 access<a href="#4211-access" class="hash-link" aria-label="4.2.1.1 access ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1.1 access ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>Accessã¯ã€CasbinãŒãƒãƒƒãƒ—ã‚„é…åˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ã‘ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ ã“ã®é–¢æ•°ã®ä½¿ç”¨ä¾‹ã¯<code>example/allowed_repo/model.yaml</code>ã§ç¤ºã•ã‚Œã¦ã„ã¾ã™ï¼š</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">= p.obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã®ãƒãƒƒãƒãƒ£ãƒ¼ã§ã¯ã€<code>access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</code>ã¯<code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Image</code>ã¨åŒç­‰ã§ã€ã“ã“ã§<code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers</code>ã¯ã‚¹ãƒ©ã‚¤ã‚¹ã§ã™ã€‚</p><p>Accessã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒãŸãšå˜ä¸€ã®å€¤ã‚’è¿”ã™ã‚·ãƒ³ãƒ—ãƒ«ãªé–¢æ•°ã‚‚å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ ã“ã®ä¾‹ã¯<code>example/container_resource_limit/model.yaml</code>ã§ç¤ºã•ã‚Œã¦ã„ã¾ã™ï¼š</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;cpu&quot;,&quot;Value&quot;)) &gt;</span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">parseFloat(p.cpu) &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;memory&quot;,&quot;Value&quot;)) &gt;</span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">parseFloat(p.memory)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã®ãƒãƒƒãƒãƒ£ãƒ¼ã§ã¯ã€<code>access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;cpu&quot;,&quot;Value&quot;)</code>ã¯<code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits[&quot;cpu&quot;].Value()</code>ã¨åŒç­‰ã§ã€ã“ã“ã§<code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits</code>ã¯ãƒãƒƒãƒ—ã§ã‚ã‚Šã€<code>Value()</code>ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒãŸãšå˜ä¸€ã®å€¤ã‚’è¿”ã™ã‚·ãƒ³ãƒ—ãƒ«ãªé–¢æ•°ã§ã™ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4212-accesswithwildcard">4.2.1.2 accessWithWildcard<a href="#4212-accesswithwildcard" class="hash-link" aria-label="4.2.1.2 accessWithWildcard ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1.2 accessWithWildcard ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>æ™‚ã€…ã€é…åˆ—ã®ã™ã¹ã¦ã®è¦ç´ ãŒ&quot;aaa&quot;ã¨ã„ã†ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’æŒã¤ã‚ˆã†ãªè¦æ±‚ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ ã—ã‹ã—ã€Casbinã¯<code>for</code>ãƒ«ãƒ¼ãƒ—ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ <code>accessWithWildcard</code>ã¨&quot;map/slice expansion&quot;æ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã“ã®ã‚ˆã†ãªè¦æ±‚ã‚’ç°¡å˜ã«å®Ÿè£…ã§ãã¾ã™ã€‚</p><p>ä¾‹ãˆã°ã€<code>a.b.c</code>ãŒé…åˆ—<code>[aaa,bbb,ccc,ddd,eee]</code>ã§ã‚ã‚‹ã¨ä»®å®šã™ã‚‹ã¨ã€<code>accessWithWildcard(a,&quot;b&quot;,&quot;c&quot;,&quot;*&quot;)</code>ã®çµæœã¯ã‚¹ãƒ©ã‚¤ã‚¹<code>[aaa,bbb,ccc,ddd,eee]</code>ã«ãªã‚Šã¾ã™ã€‚ ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰<code>*</code>ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚¹ãƒ©ã‚¤ã‚¹ãŒå±•é–‹ã•ã‚Œã¾ã™ã€‚</p><p>åŒæ§˜ã«ã€ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã¯è¤‡æ•°å›ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ä¾‹ãˆã°ã€<code>accessWithWildcard(a,&quot;b&quot;,&quot;c&quot;,&quot;*&quot;,&quot;*&quot;)</code>ã®çµæœã¯<code>[a.b.c[0][0], a.b.c[0][1], ..., a.b.c[1][0], a.b.c[1][1], ...]</code>ã«ãªã‚Šã¾ã™ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4213-å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°">4.2.1.3 å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°<a href="#4213-å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°" class="hash-link" aria-label="4.2.1.3 å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1.3 å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>Casbinã®å¼è©•ä¾¡å™¨ã§ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒé…åˆ—ã®å ´åˆã€ãã‚Œã¯è‡ªå‹•çš„ã«å¯å¤‰é•·å¼•æ•°ã¨ã—ã¦å±•é–‹ã•ã‚Œã¾ã™ã€‚ ã“ã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦é…åˆ—/ã‚¹ãƒ©ã‚¤ã‚¹/ãƒãƒƒãƒ—ã®å±•é–‹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã€é…åˆ—/ã‚¹ãƒ©ã‚¤ã‚¹ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å—ã‘å…¥ã‚Œã‚‹ã„ãã¤ã‹ã®é–¢æ•°ã‚‚çµ±åˆã—ã¾ã—ãŸï¼š</p><ul><li>contain(): è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å…¥ã‚Œã€ä»»æ„ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆæœ€å¾Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é™¤ãï¼‰ãŒæœ€å¾Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ç­‰ã—ã„ã‹ã©ã†ã‹ã‚’è¿”ã—ã¾ã™ã€‚</li><li>split(a,b,c...,sep,index): returns a slice that contains <code>[splits(a,sep)[index], splits(b,sep)[index], splits(a,sep)[index], ...]</code>.</li><li>len(): returns the length of the variable-length argument.</li><li>matchRegex(a,b,c...,regex): returns whether all of the given parameters (<code>a</code>, <code>b</code>, <code>c</code>, ...) match the given regex.</li></ul><p>Here is an example in <code>example/disallowed_tag/model.yaml</code>:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Assuming that <code>accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;)</code> returns <code>[&quot;a:b&quot;, &quot;c:d&quot;, &quot;e:f&quot;, &quot;g:h&quot;]</code>, because splits supports variable-length arguments and performs the splits operation on each element, the element at index 1 will be selected and returned. Therefore, <code>split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1)</code> returns <code>[&quot;b&quot;,&quot;d&quot;,&quot;f&quot;,&quot;h&quot;]</code>. And <code>contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</code> returns whether <code>p.obj</code> is contained in <code>[&quot;b&quot;,&quot;d&quot;,&quot;f&quot;,&quot;h&quot;]</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4212-type-conversion-functions">4.2.1.2 Type Conversion Functions<a href="#4212-type-conversion-functions" class="hash-link" aria-label="4.2.1.2 Type Conversion Functions ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1.2 Type Conversion Functions ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><ul><li>ParseFloat(): Parses an integer to a float (this is necessary because any number used in comparison must be converted into a float).</li><li>ToString(): Converts an object to a string. This object must have a basic type of string (for example, an object of type <code>XXX</code> when there is a statement <code>type XXX string</code>).</li><li>IsNil(): Returns whether the parameter is nil.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-advanced-settings">5. Advanced Settings<a href="#5-advanced-settings" class="hash-link" aria-label="5. Advanced Settings ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5. Advanced Settings ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-about-certificates">5.1 About Certificates<a href="#51-about-certificates" class="hash-link" aria-label="5.1 About Certificates ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.1 About Certificates ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>In Kubernetes (k8s), it is mandatory that a webhook should use HTTPS. There are two approaches to achieve this:</p><ul><li>Use self-signed certificates (examples in this repository use this method)</li><li>Use a normal certificate</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="511-self-signed-certificates">5.1.1 Self-signed certificates<a href="#511-self-signed-certificates" class="hash-link" aria-label="5.1.1 Self-signed certificates ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.1.1 Self-signed certificates ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>Using a self-signed certificate means that the Certificate Authority (CA) issuing the certificate is not one of the well-known CAs. Therefore, you must let k8s know about this CA.</p><p>Currently, the example in this repository uses a self-made CA, whose private key and certificate are stored in <code>config/certificate/ca.crt</code> and <code>config/certificate/ca.key</code> respectively. The certificate for the webhook is <code>config/certificate/server.crt</code>, which is issued by the self-made CA. The domains of this certificate are &quot;webhook.domain.local&quot; (for external webhook) and &quot;casbin-webhook-svc.default.svc&quot; (for internal webhook).</p><p>Information about the CA is passed to k8s via webhook configuration files. Both <code>config/webhook_external.yaml</code> and <code>config/webhook_internal.yaml</code> have a field called &quot;CABundle&quot;, which contains a base64 encoded string of the CA&#x27;s certificate.</p><p>In case you need to change the certificate/domain (for example, if you want to put this webhook into another namespace of k8s while using an internal webhook, or if you want to change the domain while using an external webhook), the following procedures should be followed:</p><ol><li><p>Generate a new CA:</p><ul><li><p>å½ã®CAã®ãŸã‚ã®ç§˜å¯†éµã‚’ç”Ÿæˆã—ã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out ca.key </span><span class="token number" style="color:#36acaa">2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>ç§˜å¯†éµã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·ã‚’è§£é™¤ã—ã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in ca.key -out ca.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>Webhookã‚µãƒ¼ãƒãƒ¼ã®ãŸã‚ã®ç§˜å¯†éµã‚’ç”Ÿæˆã—ã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out server.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in server.key -out server.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>è‡ªå·±ç”Ÿæˆã—ãŸCAã‚’ä½¿ç”¨ã—ã¦ã€Webhookã®è¨¼æ˜æ›¸ã«ç½²åã—ã¾ã™ï¼š</p><ul><li><p>ä¸€æ™‚çš„ã«ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã€ã‚·ã‚¹ãƒ†ãƒ ã®opensslè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚ <code>openssl version -a</code>ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã‚’ç¢ºèªã§ãã¾ã™ã€‚é€šå¸¸ã¯<code>openssl.cnf</code>ã¨å‘¼ã°ã‚Œã¾ã™ã€‚</p></li><li><p>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ï¼š</p><ul><li><p><code>[req]</code>ã®æ®µè½ã‚’è¦‹ã¤ã‘ã¦ã€æ¬¡ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™ï¼š<code>req_extensions = v3_req</code></p></li><li><p><code>[v3_req]</code>ã®æ®µè½ã‚’è¦‹ã¤ã‘ã¦ã€æ¬¡ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™ï¼š<code>subjectAltName = @alt_names</code></p></li><li><p>æ¬¡ã®è¡Œã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¾ã™ï¼š</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">alt_names</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">DNS.2</span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">&lt;The domain you want&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ³¨ï¼šã‚µãƒ¼ãƒ“ã‚¹åã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã«ã—ãŸå ´åˆã€&#x27;casbin-webhook-svc.default.svc&#x27;ã‚’è‡ªåˆ†ã®ã‚µãƒ¼ãƒ“ã‚¹ã®å®Ÿéš›ã®ã‚µãƒ¼ãƒ“ã‚¹åã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚</p></li></ul></li><li><p>å¤‰æ›´ã—ãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦è¨¼æ˜æ›¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -nodes -keyout server.key -out server.csr -config openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>è‡ªä½œã®CAã‚’ä½¿ç”¨ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¿œç­”ã—ã€è¨¼æ˜æ›¸ã«ç½²åã—ã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">3650</span><span class="token plain"> -in server.csr -out server.crt -CA ca.crt -CAkey ca.key -CAcreateserial -extensions v3_req -extensions SAN -extfile openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>&#x27;CABundle&#x27;ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç½®ãæ›ãˆã¾ã™ï¼š<code>config/webhook_external.yaml</code>ã¨<code>config/webhook_internal.yaml</code>ã®ä¸¡æ–¹ã«ã¯&quot;CABundle&quot;ã¨ã„ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Šã€ã“ã‚Œã¯CAã®è¨¼æ˜æ›¸ã®base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚ ã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ–°ã—ã„è¨¼æ˜æ›¸ã§æ›´æ–°ã—ã¾ã™ã€‚</p></li><li><p>helmã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€åŒæ§˜ã®å¤‰æ›´ã‚’helmãƒãƒ£ãƒ¼ãƒˆã«é©ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p></li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="512-åˆæ³•çš„ãªè¨¼æ˜æ›¸">5.1.2 åˆæ³•çš„ãªè¨¼æ˜æ›¸<a href="#512-åˆæ³•çš„ãªè¨¼æ˜æ›¸" class="hash-link" aria-label="5.1.2 åˆæ³•çš„ãªè¨¼æ˜æ›¸ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.1.2 åˆæ³•çš„ãªè¨¼æ˜æ›¸ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>åˆæ³•çš„ãªè¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ã“ã‚Œã‚‰ã®æ‰‹é †ã‚’ã™ã¹ã¦çµŒã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ <code>config/webhook_external.yaml</code>ã¨<code>config/webhook_internal.yaml</code>ã®&quot;CABundle&quot;ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å‰Šé™¤ã—ã€ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’æ‰€æœ‰ã—ã¦ã„ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å¤‰æ›´ã—ã¾ã™ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sGateKeeper.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ã“ã®ãƒšãƒ¼ã‚¸ã‚’ç·¨é›†</a> <a href="https://crowdin.com/project/casdoor-website/ja" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page" transurl="https://crowdin.com/project/casdoor-website/ja" style="margin-left:2rem"><svg fill="currentColor" height="20" width="20" viewBox="0 0 25 25" aria-hidden="true" style="margin-right:0.3em;vertical-align:sub"><path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>ã“ã®ãƒšãƒ¼ã‚¸ã‚’ç¿»è¨³</a></div><div class="col lastUpdated_VsjB"><span>ä½œæˆè€…:</span><a href="https://github.com/ComradeProgrammer" target="_blank" rel="noreferrer"><img alt="ComradeProgrammer" src="https://avatars.githubusercontent.com/ComradeProgrammer" width="24px" style="border-radius:12px;vertical-align:sub;margin-left:4px">  <!-- -->ComradeProgrammer</a></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒšãƒ¼ã‚¸"><a class="pagination-nav__link pagination-nav__link--prev" href="/ja/docs/k8s"><div class="pagination-nav__sublabel">å‰</div><div class="pagination-nav__label">Authorization of Kubernetes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ja/docs/envoy"><div class="pagination-nav__sublabel">æ¬¡ã¸</div><div class="pagination-nav__label">Authorization of Service Mesh through Envoy</div></a></nav><br></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-casbin-k8s-gatekeeperã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ" class="table-of-contents__link toc-highlight">1. Casbin K8s-Gatekeeperã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a><ul><li><a href="#01-ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹" class="table-of-contents__link toc-highlight">0.1 ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹</a></li><li><a href="#11-casbin-k8s-gatekeeperã¯ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã®ã‹" class="table-of-contents__link toc-highlight">1.1 Casbin K8s-Gatekeeperã¯ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã®ã‹ï¼Ÿ</a></li><li><a href="#12-ãã‚ŒãŒã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹" class="table-of-contents__link toc-highlight">1.2 ãã‚ŒãŒã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹</a></li></ul></li><li><a href="#2-k8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" class="table-of-contents__link toc-highlight">2 K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a><ul><li><a href="#21-å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯" class="table-of-contents__link toc-highlight">2.1 å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯</a></li><li><a href="#22-external-webhook" class="table-of-contents__link toc-highlight">2.2 External webhook</a></li><li><a href="#23-install-k8s-gatekeeper-via-helm" class="table-of-contents__link toc-highlight">2.3 Install K8s-gatekeeper via Helm</a></li></ul></li><li><a href="#3-try-k8s-gatekeeper" class="table-of-contents__link toc-highlight">3. Try K8s-gatekeeper</a><ul><li><a href="#31-create-casbin-model-and-policy" class="table-of-contents__link toc-highlight">3.1 Create Casbin Model and Policy</a></li><li><a href="#312-k8s-gatekeeperãŒå‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã™" class="table-of-contents__link toc-highlight">3.1.2 K8s-gatekeeperãŒå‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã™</a></li></ul></li><li><a href="#4-k8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•" class="table-of-contents__link toc-highlight">4. K8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•</a><ul><li><a href="#41-ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©" class="table-of-contents__link toc-highlight">4.1 ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©</a></li><li><a href="#42-ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼" class="table-of-contents__link toc-highlight">4.2 ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼</a></li><li><a href="#421-æ‹¡å¼µé–¢æ•°" class="table-of-contents__link toc-highlight">4.2.1 æ‹¡å¼µé–¢æ•°</a></li><li><a href="#4213-å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°" class="table-of-contents__link toc-highlight">4.2.1.3 å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°</a></li></ul></li><li><a href="#5-advanced-settings" class="table-of-contents__link toc-highlight">5. Advanced Settings</a><ul><li><a href="#51-about-certificates" class="table-of-contents__link toc-highlight">5.1 About Certificates</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ja/docs/get-started">ã¯ã˜ã‚ã«</a></li><li class="footer__item"><a class="footer__link-item" href="/ja/docs/management-api">Management API</a></li><li class="footer__item"><a class="footer__link-item" href="/ja/docs/rbac-api">RBAC API</a></li><li class="footer__item"><a class="footer__link-item" href="/ja/docs/middlewares">ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢</a></li></ul></div><div class="col footer__col"><div class="footer__title">ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://forum.casbin.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ãƒ•ã‚©ãƒ¼ãƒ©ãƒ <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/search?q=casbin" target="_blank" rel="noopener noreferrer" class="footer__link-item">ã‚¹ã‚¿ãƒƒã‚¯ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/S5UjpzGZjN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://cdn.casdoor.com/casdoor/resource/built-in/admin/qq_casbin.png" target="_blank" rel="noopener noreferrer" class="footer__link-item">QQ ã‚°ãƒ«ãƒ¼ãƒ—<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">ã‚‚ã£ã¨è¦‹ã‚‹</div><ul class="footer__items clean-list"><li class="footer__item">
                <a href="https://github.com/casbin/casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin?label=Casbin&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/jcasbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/jcasbin?label=jCasbin&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/node-casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/node-casbin?label=Node-Casbin&style=social">
                </a>
                &nbsp;&nbsp;
                <a href="https://github.com/php-casbin/php-casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/php-casbin/php-casbin?label=PHP-Casbin&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/pycasbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/pycasbin?label=PyCasbin&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/Casbin.NET" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/Casbin.NET?label=Casbin.NET&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/casbin-cpp" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin-cpp?label=Casbin-CPP&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/casbin-rs" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin-rs?label=Casbin-RS&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://twitter.com/casbinHQ" target="_blank">
                  <img alt="Twitter Follow" src="https://img.shields.io/twitter/follow/casbinHQ?style=social">
                </a>
              </li><li class="footer__item">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?2c0ffc6f8d49e98d964d59d7aa4cbf34";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
</li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/ja/"><img src="/ja/img/casbin_min.svg" alt="Casbin ãƒ­ã‚´" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/ja/img/casbin_min.svg" alt="Casbin ãƒ­ã‚´" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright Â©ï¸ 2024 Casbin Organization</div></div></div></footer></div>
<script src="/ja/assets/js/runtime~main.e29b42b5.js"></script>
<script src="/ja/assets/js/main.9b136725.js"></script>
</body>
</html>