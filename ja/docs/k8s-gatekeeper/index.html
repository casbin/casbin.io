<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-k8s-gatekeeper" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Admission Webhook for K8s | Casbin</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://casbin.org/ja/docs/k8s-gatekeeper"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="Casbin" content="An authorization library that supports access control models like ACL, RBAC, ABAC for Golang, Java, C/C++, Node.js, Javascript, PHP, Laravel, Python, .NET (C#), Delphi, Rust, Ruby, Swift (Objective-C), Lua (OpenResty), Dart (Flutter) and Elixir"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Admission Webhook for K8s | Casbin"><meta data-rh="true" name="description" content="Kubernetes (K8s) RBAC &amp; ABAC èªå¯ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€Casbin ãƒ™ãƒ¼ã‚¹"><meta data-rh="true" property="og:description" content="Kubernetes (K8s) RBAC &amp; ABAC èªå¯ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€Casbin ãƒ™ãƒ¼ã‚¹"><meta data-rh="true" name="keywords" content="k8s-gatekeeper,Kubernetes,K8s"><link data-rh="true" rel="icon" href="/ja/img/favicon.png"><link data-rh="true" rel="canonical" href="https://casbin.org/ja/docs/k8s-gatekeeper"><link data-rh="true" rel="alternate" href="https://casbin.org/docs/k8s-gatekeeper" hreflang="en"><link data-rh="true" rel="alternate" href="https://casbin.org/zh/docs/k8s-gatekeeper" hreflang="zh"><link data-rh="true" rel="alternate" href="https://casbin.org/ko/docs/k8s-gatekeeper" hreflang="ko"><link data-rh="true" rel="alternate" href="https://casbin.org/ru/docs/k8s-gatekeeper" hreflang="ru"><link data-rh="true" rel="alternate" href="https://casbin.org/fr/docs/k8s-gatekeeper" hreflang="fr"><link data-rh="true" rel="alternate" href="https://casbin.org/de/docs/k8s-gatekeeper" hreflang="de"><link data-rh="true" rel="alternate" href="https://casbin.org/ja/docs/k8s-gatekeeper" hreflang="ja"><link data-rh="true" rel="alternate" href="https://casbin.org/es/docs/k8s-gatekeeper" hreflang="es"><link data-rh="true" rel="alternate" href="https://casbin.org/pt/docs/k8s-gatekeeper" hreflang="pt"><link data-rh="true" rel="alternate" href="https://casbin.org/uk/docs/k8s-gatekeeper" hreflang="uk"><link data-rh="true" rel="alternate" href="https://casbin.org/th/docs/k8s-gatekeeper" hreflang="th"><link data-rh="true" rel="alternate" href="https://casbin.org/ar/docs/k8s-gatekeeper" hreflang="ar"><link data-rh="true" rel="alternate" href="https://casbin.org/id/docs/k8s-gatekeeper" hreflang="id"><link data-rh="true" rel="alternate" href="https://casbin.org/vi/docs/k8s-gatekeeper" hreflang="vi"><link data-rh="true" rel="alternate" href="https://casbin.org/it/docs/k8s-gatekeeper" hreflang="it"><link data-rh="true" rel="alternate" href="https://casbin.org/ms/docs/k8s-gatekeeper" hreflang="ms"><link data-rh="true" rel="alternate" href="https://casbin.org/tr/docs/k8s-gatekeeper" hreflang="tr"><link data-rh="true" rel="alternate" href="https://casbin.org/docs/k8s-gatekeeper" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6NBEV8TOFK-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/ja/blog/rss.xml" title="Casbin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ja/blog/atom.xml" title="Casbin Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8S2TKCJ27X"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8S2TKCJ27X",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Casbin" href="/ja/opensearch.xml">
<script src="/js/isMainland.js" async></script>
<script src="/js/hotjar.js" async></script>
<script src="/js/probe.js" async></script>
<script src="/js/clarity.js" async></script>
<script src="/js/casibase.js" async></script><link rel="stylesheet" href="/ja/assets/css/styles.e1532f30.css">
<link rel="preload" href="/ja/assets/js/runtime~main.6d77dd43.js" as="script">
<link rel="preload" href="/ja/assets/js/main.6a3e55ae.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã‚¹ã‚­ãƒƒãƒ—"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã‚¹ã‚­ãƒƒãƒ—</a></div><div class="announcementBar_mb4j" role="banner"><div class="content_knG7 announcementBarContent_xLdY"><a target="_blank" href="https://github.com/casibase/casibase/">ğŸ’– Looking for an open-source LangChain-like AI knowledge database & chat bot with admin UI and multi-model support (ChatGPT, Claude, Llama 3, DeepSeek R1, HuggingFace, etc.) ? Learn more about: Casibase</a></div></div><nav aria-label="ãƒ¡ã‚¤ãƒ³" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆ" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ja/"><div class="navbar__logo"><img src="/ja/img/casbin.svg" alt="ãƒã‚¤ã‚µã‚¤ãƒˆãƒ­ã‚´" class="themedImage_ToTc themedImage--light_HNdA"><img src="/ja/img/casbin.svg" alt="ãƒã‚¤ã‚µã‚¤ãƒˆãƒ­ã‚´" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Casbin</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/ja/docs/overview">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ja/docs/get-started">ã¯ã˜ã‚ã‚ˆã†</a></li><li><a class="dropdown__link" href="/ja/docs/category/model">ãƒ¢ãƒ‡ãƒ«</a></li><li><a class="dropdown__link" href="/ja/docs/category/storage">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</a></li><li><a class="dropdown__link" href="/ja/docs/adapters">ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼</a></li><li><a class="dropdown__link" href="/ja/docs/category/api">API</a></li><li><a class="dropdown__link" href="/ja/docs/ide-plugins">IDE ãƒ—ãƒ©ã‚°ã‚¤ãƒ³</a></li><li><a class="dropdown__link" href="/ja/docs/contributing">è²¢çŒ®ã‚’é–‹å§‹</a></li></ul></div><a class="navbar__item navbar__link" href="/ja/ecosystem">ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ </a><a class="navbar__item navbar__link" href="/ja/blog">ãƒ–ãƒ­ã‚°</a><a class="navbar__item navbar__link" href="/ja/help">ãƒ˜ãƒ«ãƒ—</a><a class="navbar__item navbar__link" href="/ja/editor">ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>æ—¥æœ¬èª</a><ul class="dropdown__menu"><li><a href="/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">ä¸­æ–‡</a></li><li><a href="/ko/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">í•œêµ­ì–´</a></li><li><a href="/ru/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a></li><li><a href="/fr/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">FranÃ§ais</a></li><li><a href="/de/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="/ja/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">æ—¥æœ¬èª</a></li><li><a href="/es/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">EspaÃ±ol</a></li><li><a href="/pt/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">PortuguÃªs</a></li><li><a href="/uk/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°</a></li><li><a href="/th/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="th">à¹„à¸—à¸¢</a></li><li><a href="/ar/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a></li><li><a href="/id/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="id">Indonesia</a></li><li><a href="/vi/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="vi">Tiáº¿ng Viá»‡t</a></li><li><a href="/it/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="it">Italiano</a></li><li><a href="/ms/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ms">Melayu</a></li><li><a href="/tr/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="tr">TÃ¼rkÃ§e</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://crowdin.com/project/casbin-website" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/casbin/casbin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://discord.gg/S5UjpzGZjN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-community-discord"></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="æ¤œç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æ¤œç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¨ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ï¼ˆç¾åœ¨ã¯ ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰" aria-label="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¨ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ï¼ˆç¾åœ¨ã¯ ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/ja/"><img src="/ja/img/casbin.svg" alt="ãƒã‚¤ã‚µã‚¤ãƒˆãƒ­ã‚´" class="themedImage_ToTc themedImage--light_HNdA"><img src="/ja/img/casbin.svg" alt="ãƒã‚¤ã‚µã‚¤ãƒˆãƒ­ã‚´" class="themedImage_ToTc themedImage--dark_i4oU"><b>Casbin</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/the-basics">åŸºæœ¬</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;åŸºæœ¬ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/get-started">Get Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/how-it-works">How It Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/tutorials">Tutorials</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/understanding-casbin-detail">Understanding How Casbin Matching Works in Detail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/pdf">PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/model">ãƒ¢ãƒ‡ãƒ«</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ãƒ¢ãƒ‡ãƒ« &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/supported-models">Supported Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/syntax-for-models">Syntax for Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/effector">Effector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/function">Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac">RBAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-pattern">RBAC with Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-domains">RBAC with Domains</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-conditions">RBAC with Conditions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-96">Casbin RBAC vs. RBAC96</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rebac">ReBAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/abac">ABAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/blp">BLP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/biba">Biba</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/lbac">LBAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/priority-model">Priority Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/superadmin">Super Admin</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/storage">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/model-storage">Model Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/policy-storage">Policy Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/policy-subset-loading">Policy Subset Loading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/scenarios">Scenarios</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;Scenarios &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/data-permissions">Data Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/menu-permissions">Menu Permissions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/extensions">æ‹¡å¼µ</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;æ‹¡å¼µ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/enforcers">Enforcers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/adapters">Adapters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/watchers">Watchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/dispatchers">Dispatchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/role-managers">Role Managers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/middlewares">Middlewares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/graphql-middlewares">GraphQL Middlewares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/cloud-native">Cloud Native Middlewares</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/api">API</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;API &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/api-overview">API Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/management-api">Management API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-api">RBAC API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-domains-api">RBAC with Domains API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rbac-with-conditions-api">RBAC with Conditions API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/rolemanager-api">RoleManager API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/ja/docs/category/advanced-usage">é«˜åº¦ãªä½¿ã„æ–¹</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;é«˜åº¦ãªä½¿ã„æ–¹ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/multi-threading">Multi-threading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/benchmark">Benchmarks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/performance">Performance Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/k8s">Authorization of Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ja/docs/k8s-gatekeeper">Admission Webhook for K8s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/envoy">Authorization of Service Mesh through Envoy</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/management">ç®¡ç†</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ç®¡ç† &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/admin-portal">Admin Portal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/service">Casbin Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/command-line-tools">Command-line Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/log-error">Log &amp; Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/frontend">Frontend Usage</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/editor">ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/online-editor">Online Editor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/ide-plugins">IDE Plugins</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/ja/docs/category/more">ã‚‚ã£ã¨è¦‹ã‚‹</a><button aria-label="æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚«ãƒ†ã‚´ãƒª&#x27;ã‚‚ã£ã¨è¦‹ã‚‹ &#x27; ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/adopters">Our Adopters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/contributing">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/privacy-policy">Privacy Policy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/terms-of-service">Terms of Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/refund-policy">Refund Policy</a></li></ul></li></ul></nav><button type="button" title="ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’é–‰ã˜ã‚‹" aria-label="ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’é–‰ã˜ã‚‹" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸" class="breadcrumbs__link" href="/ja/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/ja/docs/category/advanced-usage"><span itemprop="name">é«˜åº¦ãªä½¿ã„æ–¹</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Admission Webhook for K8s</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">ã“ã®ãƒšãƒ¼ã‚¸</button></div><div class="theme-doc-markdown markdown"><header><h1>Admission Webhook for K8s</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-casbin-k8s-gatekeeper-ã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ">1. Casbin K8s-Gatekeeper ã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ<a href="#1-casbin-k8s-gatekeeper-ã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ" class="hash-link" aria-label="1. Casbin K8s-Gatekeeper ã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1. Casbin K8s-Gatekeeper ã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><p>Casbin K8s-GateKeeper ã¯ã€Casbin ã‚’ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦çµ±åˆã™ã‚‹ Kubernetes ã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã§ã™ã€‚ Casbin K8s-GateKeeper ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚³ãƒ¼ãƒ‰ã‚’ä¸€è¡Œã‚‚æ›¸ã‹ãšã«ã€Casbin ã® ACLï¼ˆã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒªã‚¹ãƒˆï¼‰è¨€èªã®ä¸€éƒ¨ã§ã‚ã‚‹ Casbin ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®å®£è¨€çš„ãªè¨­å®šã‚’æ•°è¡Œæ›¸ãã ã‘ã§ã€K8s ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ã‚ã‚‰ã‚†ã‚‹æ“ä½œã‚’èªå¯ã¾ãŸã¯é®æ–­ã™ã‚‹æŸ”è»Ÿãªãƒ«ãƒ¼ãƒ«ã‚’ç¢ºç«‹ã§ãã¾ã™ã€‚</p><p>Casbin K8s-GateKeeper ã¯ã€Casbin ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã£ã¦é–‹ç™ºãŠã‚ˆã³ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™ã€‚ ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã“ã¡ã‚‰ã§ã™: <a href="https://github.com/casbin/k8s-gatekeeper" target="_blank" rel="noopener noreferrer">https://github.com/casbin/k8s-gatekeeper</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="01-ç°¡å˜ãªä¾‹">0.1 ç°¡å˜ãªä¾‹<a href="#01-ç°¡å˜ãªä¾‹" class="hash-link" aria-label="0.1 ç°¡å˜ãªä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="0.1 ç°¡å˜ãªä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>ä¾‹ãˆã°ã€ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ä»¥ä¸‹ã®è¨­å®šè¡Œã‚’ä½¿ç”¨ã—ã¦ã“ã®æ©Ÿèƒ½ã‚’å®Ÿç¾ã—ã¾ã™ï¼šã€Œç‰¹å®šã®ã‚¿ã‚°ã‚’æŒã¤ç”»åƒã‚’ã©ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã§ã‚‚ä½¿ç”¨ã§ããªã„ã‚ˆã†ã«ã™ã‚‹ã€ï¼š</p><p>Model:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj,eft</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">!some(where (p.eft == deny))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contain(split(accessWithWildcard(${OBJECT}.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And Policy:</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã‚Œã‚‰ã¯é€šå¸¸ã®Casbin ACLè¨€èªã§ã™ã€‚ ãã‚Œã‚‰ã«ã¤ã„ã¦ã®ç« ã‚’æ—¢ã«èª­ã‚“ã§ã„ã‚‹ã¨ä»®å®šã™ã‚‹ã¨ã€ç†è§£ã™ã‚‹ã®ã¯éå¸¸ã«ç°¡å˜ã§ã™ã€‚</p><p>Casbin K8s-Gatekeeperã«ã¯ä»¥ä¸‹ã®åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ï¼š</p><ul><li>ä½¿ã„ã‚„ã™ã„ã€‚ å¤šãã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã‚ˆã‚Šã‚‚ã€æ•°è¡Œã®ACLã‚’æ›¸ãæ–¹ãŒã¯ã‚‹ã‹ã«å„ªã‚Œã¦ã„ã¾ã™ã€‚</li><li>è¨­å®šã®ãƒ›ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚ è¨­å®šã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å…¨ä½“ã‚’ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li><li>æŸ”è»Ÿã§ã™ã€‚ ä»»æ„ã®K8sãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ä»»æ„ã®ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã§ãã€<code>kubectl gatekeeper</code>ã§èª¿æŸ»ã§ãã¾ã™ã€‚</li><li>éå¸¸ã«è¤‡é›‘ãªK8sã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã®å®Ÿè£…ã‚’ç°¡ç´ åŒ–ã—ã¾ã™ã€‚ K8sã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ãŒä½•ã§ã‚ã‚‹ã‹ã€ã¾ãŸã¯ãã‚Œã«å¯¾ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãæ–¹æ³•ã‚’çŸ¥ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ å¿…è¦ãªã®ã¯ã€åˆ¶ç´„ã‚’ã‹ã‘ãŸã„ãƒªã‚½ãƒ¼ã‚¹ã‚’çŸ¥ã‚‹ã“ã¨ã¨ã€Casbin ACLã‚’æ›¸ãã“ã¨ã ã‘ã§ã™ã€‚ K8sãŒè¤‡é›‘ã§ã‚ã‚‹ã“ã¨ã¯èª°ã‚‚ãŒçŸ¥ã£ã¦ã„ã¾ã™ãŒã€Casbin K8s-Gatekeeperã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§æ™‚é–“ã‚’ç¯€ç´„ã§ãã¾ã™ã€‚</li><li>Casbinã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã£ã¦ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™ã€‚ ã“ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã¤ã„ã¦ä½•ã‹æ··ä¹±ã™ã‚‹ç‚¹ãŒã‚ã‚‹å ´åˆã‚„ã€è©¦ã—ã¦ã¿ã¦å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-casbin-k8s-gatekeeperã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹">1.1 Casbin K8s-Gatekeeperã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿ<a href="#11-casbin-k8s-gatekeeperã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹" class="hash-link" aria-label="1.1 Casbin K8s-Gatekeeperã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1.1 Casbin K8s-Gatekeeperã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>K8s-Gatekeeperã¯ã€ç®¡ç†è€…ãŒæœ›ã¾ãªã„K8sä¸Šã®æ“ä½œã‚’é˜²ããŸã‚ã«ã€<a href="/ja/docs/overview">Casbin</a>ã‚’ä½¿ç”¨ã—ã¦ä»»æ„ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã™ã‚‹K8sã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã§ã™ã€‚</p><p>Casbinã¯ã€å¼·åŠ›ã§åŠ¹ç‡çš„ãªã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ ã•ã¾ã–ã¾ãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ã„ã¦èªå¯ã‚’å®Ÿæ–½ã™ã‚‹ãŸã‚ã®ã‚µãƒãƒ¼ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚ Casbinã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€<a href="/ja/docs/overview">æ¦‚è¦</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p><p>K8sã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã¯ã€&#x27;admission requests&#x27;ã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚‰ã«å¯¾ã—ã¦ä½•ã‚‰ã‹ã®å‡¦ç†ã‚’è¡Œã†HTTPã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ã™ã€‚ ç‰¹ã«ã€K8s-Gatekeeperã¯ç‰¹æ®Šãªã‚¿ã‚¤ãƒ—ã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã§ã‚ã‚‹&#x27;ValidatingAdmissionWebhook&#x27;ã§ã€ã“ã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å…¥ã‚Œã‚‹ã‹æ‹’å¦ã™ã‚‹ã‹ã‚’æ±ºå®šã§ãã¾ã™ã€‚ ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¤ã„ã¦ã¯ã€K8sã®ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ï¼ˆä¾‹ãˆã°ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã®ä½œæˆ/å‰Šé™¤ï¼‰ã«å¯¾ã™ã‚‹æ“ä½œã‚’è¨˜è¿°ã—ãŸHTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã™ã€‚ ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#what-are-admission-webhooks" target="_blank" rel="noopener noreferrer">K8så…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12-ãã‚ŒãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹">1.2 ãã‚ŒãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹<a href="#12-ãã‚ŒãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹" class="hash-link" aria-label="1.2 ãã‚ŒãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1.2 ãã‚ŒãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>ä¾‹ãˆã°ã€èª°ã‹ãŒnginxã‚’å®Ÿè¡Œã™ã‚‹ãƒãƒƒãƒ‰ã‚’å«ã‚€ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ãŸã„å ´åˆï¼ˆkubectlã¾ãŸã¯K8sã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½¿ç”¨ï¼‰ã€K8sã¯ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã“ã‚Œã¯ï¼ˆYAMLå½¢å¼ã«ç¿»è¨³ã™ã‚‹ã¨ï¼‰æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.14.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€å›³ã«ç¤ºã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€ãã—ã¦ç§ãŸã¡ã®K8s-Gatekeeperã‚’å«ã‚€ãƒ—ãƒ­ã‚»ã‚¹ã‚’é€šéã—ã¾ã™ã€‚ K8s-Gatekeeperã¯ã€K8sã®etcdã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®Casbinã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’æ¤œå‡ºã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦ä½œæˆãŠã‚ˆã³ç®¡ç†ã•ã‚Œã¦ãŠã‚Šï¼ˆ<code>kubectl</code>ã¾ãŸã¯ç§ãŸã¡ãŒæä¾›ã™ã‚‹Goã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä»‹ã—ã¦ï¼‰ã€ å„ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã¯Casbinãƒ¢ãƒ‡ãƒ«ã¨Casbinãƒãƒªã‚·ãƒ¼ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚ ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ã™ã¹ã¦ã®ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã«ã‚ˆã£ã¦é †ç•ªã«å‡¦ç†ã•ã‚Œã€ã™ã¹ã¦ã®ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’é€šéã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿ãŒã“ã®K8s-Gatekeeperã«ã‚ˆã£ã¦å—ã‘å…¥ã‚Œã‚‰ã‚Œã¾ã™ã€‚</p><p>ï¼ˆCasbinã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã€ãƒ¢ãƒ‡ãƒ«ã€ã¾ãŸã¯ãƒãƒªã‚·ãƒ¼ãŒä½•ã‹ã‚ã‹ã‚‰ãªã„å ´åˆã¯ã€ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š<a href="/ja/docs/get-started">ã¯ã˜ã‚ã«</a>ï¼‰ã€‚</p><p>ä¾‹ãˆã°ã€ä½•ã‚‰ã‹ã®ç†ç”±ã§ã€ç®¡ç†è€…ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸&#x27;nginx:1.14.1&#x27;ã®å‡ºç¾ã‚’ç¦æ­¢ã—ã€&#x27;nginx:1.3.1&#x27;ã‚’è¨±å¯ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’å«ã‚€ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’ä½œæˆã§ãã¾ã™ï¼ˆã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã®ä½œæˆæ–¹æ³•ã€ã“ã‚Œã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ãŒä½•ã§ã‚ã‚‹ã‹ã€ãã—ã¦ãã‚Œã‚‰ã‚’ã©ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã‹ã«ã¤ã„ã¦ã¯ã€æ¬¡ã®ç« ã§èª¬æ˜ã—ã¾ã™ï¼‰ã€‚</p><p>Model:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj,eft</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">!some(where (p.eft == deny))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">= p.obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Policy:</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;nginx:1.13.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">allow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;nginx:1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä¸Šè¨˜ã®ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’å«ã‚€ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€å‰è¿°ã®ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã“ã®ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã«ã‚ˆã£ã¦æ‹’å¦ã•ã‚Œã€ã¤ã¾ã‚ŠK8sã¯ã“ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã›ã‚“ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="k8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href="#k8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" class="hash-link" aria-label="K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><p>K8s-gatekeeper ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã«ã¯ã€å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã€å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã€ãã—ã¦ Helm ã®3ã¤ã®æ–¹æ³•ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ãƒ¡ãƒ¢</div><div class="admonitionContent_S0QG"><p>æ³¨æ„: ã“ã‚Œã‚‰ã®æ–¹æ³•ã¯ K8s-gatekeeper ã‚’è©¦ã™ãŸã‚ã®ã‚‚ã®ã§ã‚ã‚Šã€ã‚»ã‚­ãƒ¥ã‚¢ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€<a href="#5-advanced-settings">ç¬¬5ç«  é«˜åº¦ãªè¨­å®š</a> ã‚’èª­ã¿ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‰ã«å¿…è¦ãªå¤‰æ›´ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚ 2.1 å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="211-ã‚¹ãƒ†ãƒƒãƒ—1-ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰">2.1.1 ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰<a href="#211-ã‚¹ãƒ†ãƒƒãƒ—1-ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰" class="hash-link" aria-label="2.1.1 ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.1.1 ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯æ–¹å¼ã§ã¯ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯è‡ªä½“ãŒ-kubernetes-å†…ã§ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™">å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯æ–¹å¼ã§ã¯ã€ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯è‡ªä½“ãŒ Kubernetes å†…ã§ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™ã€‚<a href="#å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯æ–¹å¼ã§ã¯ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯è‡ªä½“ãŒ-kubernetes-å†…ã§ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™" class="hash-link" aria-label="å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯æ–¹å¼ã§ã¯ã€ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯è‡ªä½“ãŒ Kubernetes å†…ã§ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™ã€‚ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯æ–¹å¼ã§ã¯ã€ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯è‡ªä½“ãŒ Kubernetes å†…ã§ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¾ã™ã€‚ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>å¿…è¦ãªã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ã€K8s-gatekeeper ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ç‹¬è‡ªã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã§ãã¾ã™: ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€&#x27;k8s-gatekeeper:latest&#x27; ã¨ã„ã†ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build --target webhook -t k8s-gatekeeper </span><span class="token builtin class-name">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€&#x27;k8s-gatekeeper:latest&#x27;ã¨ã„ã†ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ãƒ¡ãƒ¢</div><div class="admonitionContent_S0QG"><p>æ³¨æ„: minikubeã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€&#x27;docker build&#x27;ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«<code>eval $(minikube -p minikube docker-env)</code>ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="212-ã‚¹ãƒ†ãƒƒãƒ—2-k8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’è¨­å®šã™ã‚‹">2.1.2 ã‚¹ãƒ†ãƒƒãƒ—2: K8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’è¨­å®šã™ã‚‹<a href="#212-ã‚¹ãƒ†ãƒƒãƒ—2-k8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’è¨­å®šã™ã‚‹" class="hash-link" aria-label="2.1.2 ã‚¹ãƒ†ãƒƒãƒ—2: K8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’è¨­å®šã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.1.2 ã‚¹ãƒ†ãƒƒãƒ—2: K8s-gatekeeperã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’è¨­å®šã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/rbac.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_deployment.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_internal.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã‚Œã«ã‚ˆã‚ŠK8s-gatekeeperãŒèµ·å‹•ã—ã€<code>kubectl get pods</code>ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ç¢ºèªã§ãã¾ã™ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="213-ã‚¹ãƒ†ãƒƒãƒ—3-k8s-gatekeeperã®crdãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹">2.1.3 ã‚¹ãƒ†ãƒƒãƒ—3: K8s-gatekeeperã®CRDãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹<a href="#213-ã‚¹ãƒ†ãƒƒãƒ—3-k8s-gatekeeperã®crdãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹" class="hash-link" aria-label="2.1.3 ã‚¹ãƒ†ãƒƒãƒ—3: K8s-gatekeeperã®CRDãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.1.3 ã‚¹ãƒ†ãƒƒãƒ—3: K8s-gatekeeperã®CRDãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinmodels.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinpolicies.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22-å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯">2.2 å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯<a href="#22-å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯" class="hash-link" aria-label="2.2 å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.2 å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯æ–¹å¼ã§ã¯ã€K8s-gatekeeperã¯Kubernetesã®å¤–éƒ¨ã§å®Ÿè¡Œã•ã‚Œã€Kubernetesã¯é€šå¸¸ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã®ã¨åŒã˜ã‚ˆã†ã«K8s-gatekeeperã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚ Kubernetesã«ã¯ã€ã‚¢ãƒ‰ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ãŒHTTPSã§ã‚ã‚‹ã“ã¨ãŒå¿…é ˆè¦ä»¶ã¨ãªã£ã¦ã„ã¾ã™ã€‚ K8s-gatekeeperã‚’è©¦ã™ç›®çš„ã§ã€è¨¼æ˜æ›¸ã¨ç§˜å¯†éµã®ã‚»ãƒƒãƒˆã‚’æä¾›ã—ã¦ã„ã¾ã™ï¼ˆãŸã ã—ã€ã“ã‚Œã¯å®‰å…¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚ ç‹¬è‡ªã®è¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€è¨¼æ˜æ›¸ã¨ç§˜å¯†éµã®èª¿æ•´ã«é–¢ã™ã‚‹æ‰‹é †ã«ã¤ã„ã¦ã€<a href="#5-advanced-settings">ç¬¬5ç«  é«˜åº¦ãªè¨­å®š</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ ç§ãŸã¡ãŒæä¾›ã™ã‚‹è¨¼æ˜æ›¸ã¯ã€&#x27;webhook.domain.local&#x27; ç”¨ã«ç™ºè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚</p><p>ãã®ãŸã‚ã€ãƒ›ã‚¹ãƒˆï¼ˆä¾‹ï¼š/etc/hostsï¼‰ã‚’å¤‰æ›´ã—ã€&#x27;webhook.domain.local&#x27; ã‚’ K8s-gatekeeper ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å‘ã‘ã¦ãã ã•ã„ã€‚ ãã®å¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</p><p>2.3 Helm ã‚’ä»‹ã—ã¦ K8s-gatekeeper ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">go mod tidy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go mod vendor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go run cmd/webhook/main.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinmodels.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinpolicies.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_external.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="231-ã‚¹ãƒ†ãƒƒãƒ—-1-ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹">2.3.1 ã‚¹ãƒ†ãƒƒãƒ— 1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹<a href="#231-ã‚¹ãƒ†ãƒƒãƒ—-1-ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹" class="hash-link" aria-label="2.3.1 ã‚¹ãƒ†ãƒƒãƒ— 1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.3.1 ã‚¹ãƒ†ãƒƒãƒ— 1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¬¬211ç« ã‚’å‚ç…§ã—ã¦ãã ã•ã„"><a href="#211-step-1-build-the-image">ç¬¬2.1.1ç« </a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚<a href="#ç¬¬211ç« ã‚’å‚ç…§ã—ã¦ãã ã•ã„" class="hash-link" aria-label="ç¬¬211ç« ã‚’å‚ç…§ã—ã¦ãã ã•ã„ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ç¬¬211ç« ã‚’å‚ç…§ã—ã¦ãã ã•ã„ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>2.3.2 Helm ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="helm-install-k8sgatekeeper-k8sgatekeeper-ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"><code>helm install k8sgatekeeper ./k8sgatekeeper</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚<a href="#helm-install-k8sgatekeeper-k8sgatekeeper-ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„" class="hash-link" aria-label="helm-install-k8sgatekeeper-k8sgatekeeper-ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="helm-install-k8sgatekeeper-k8sgatekeeper-ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>ã‚³ãƒãƒ³ãƒ‰ <code>helm install k8sgatekeeper ./k8sgatekeeper</code> ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-k8s-gatekeeperã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„">3. K8s-gatekeeperã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„<a href="#3-k8s-gatekeeperã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„" class="hash-link" aria-label="3. K8s-gatekeeperã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3. K8s-gatekeeperã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31-casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ">3.1 Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ<a href="#31-casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ" class="hash-link" aria-label="3.1 Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1 Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€kubectlã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€ç§ãŸã¡ãŒæä¾›ã™ã‚‹go-clientã‚’ä½¿ç”¨ã™ã‚‹ã‹ã®2ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="311-kubectlã‚’ä»‹ã—ãŸcasbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆæ›´æ–°">3.1.1 kubectlã‚’ä»‹ã—ãŸCasbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ/æ›´æ–°<a href="#311-kubectlã‚’ä»‹ã—ãŸcasbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆæ›´æ–°" class="hash-link" aria-label="3.1.1 kubectlã‚’ä»‹ã—ãŸCasbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ/æ›´æ–° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1.1 kubectlã‚’ä»‹ã—ãŸCasbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ/æ›´æ–° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>K8s-gatekeeperã§ã¯ã€Casbinãƒ¢ãƒ‡ãƒ«ã¯ã€ŒCasbinModelã€ã¨å‘¼ã°ã‚Œã‚‹CRDãƒªã‚½ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚ ãã®å®šç¾©ã¯<code>config/auth.casbin.org_casbinmodels.yaml</code>ã«ã‚ã‚Šã¾ã™ã€‚</p><p><code>example/allowed_repo/model.yaml</code>ã«ä¾‹ãŒã‚ã‚Šã¾ã™ã€‚ ä»¥ä¸‹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š</p><ul><li>metadata.name: ãƒ¢ãƒ‡ãƒ«ã®åå‰ ã“ã®åå‰ã¯ã€ã“ã®ãƒ¢ãƒ‡ãƒ«ã«é–¢é€£ã™ã‚‹CasbinPolicyã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åå‰ã¨åŒã˜ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ãã†ã™ã‚‹ã“ã¨ã§ã€K8s-gatekeeperã¯ãã‚Œã‚‰ã‚’ãƒšã‚¢ãƒªãƒ³ã‚°ã—ã€ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’ä½œæˆã§ãã¾ã™ã€‚</li><li>spec.enable: ã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ &quot;false&quot; ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã“ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆãŠã‚ˆã³ã“ã®ãƒ¢ãƒ‡ãƒ«ã«é–¢é€£ã™ã‚‹CasbinPolicyã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚</li><li>spec.modelText: Casbinãƒ¢ãƒ‡ãƒ«ã®ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚€æ–‡å­—åˆ—ã§ã™ã€‚</li></ul><p>Casbinãƒãƒªã‚·ãƒ¼ã¯ã€<code>config/auth.casbin.org_casbinpolicies.yaml</code> ã§å®šç¾©ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ &#x27;CasbinPolicy&#x27; ã¨å‘¼ã°ã‚Œã‚‹åˆ¥ã®CRDãƒªã‚½ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><p><code>example/allowed_repo/policy.yaml</code> ã«ä¾‹ãŒã‚ã‚Šã¾ã™ã€‚ ä»¥ä¸‹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š</p><ul><li>metadata.name: ãƒãƒªã‚·ãƒ¼ã®åå‰ã€‚ ã“ã®åå‰ã¯ã€ã“ã®ãƒãƒªã‚·ãƒ¼ã«é–¢é€£ã™ã‚‹CasbinModelã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åå‰ã¨åŒã˜ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ãã†ã™ã‚‹ã“ã¨ã§ã€K8s-gatekeeperã¯ãã‚Œã‚‰ã‚’ãƒšã‚¢ãƒªãƒ³ã‚°ã—ã€ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ã‚’ä½œæˆã§ãã¾ã™ã€‚</li><li>spec.policyItem: Casbinãƒ¢ãƒ‡ãƒ«ã®ãƒãƒªã‚·ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚€æ–‡å­—åˆ—ã§ã™ã€‚</li></ul><p>ç‹¬è‡ªã®CasbinModelãŠã‚ˆã³CasbinPolicyãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸå¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã‚Œã‚‰ã‚’é©ç”¨ã—ã¾ã™ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">filename</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä¸€å¯¾ã®CasbinModelã¨CasbinPolicyãŒä½œæˆã•ã‚Œã‚‹ã¨ã€K8s-gatekeeperã¯5ç§’ä»¥å†…ã«ãã‚Œã‚’æ¤œå‡ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-go-clientã‚’ä»‹ã—ã¦casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆæ›´æ–°ã™ã‚‹">3.1.2 go-clientã‚’ä»‹ã—ã¦Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆ/æ›´æ–°ã™ã‚‹<a href="#312-go-clientã‚’ä»‹ã—ã¦casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆæ›´æ–°ã™ã‚‹" class="hash-link" aria-label="3.1.2 go-clientã‚’ä»‹ã—ã¦Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆ/æ›´æ–°ã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1.2 go-clientã‚’ä»‹ã—ã¦Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ä½œæˆ/æ›´æ–°ã™ã‚‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>K8sã‚¯ãƒ©ã‚¹ã‚¿ã®ãƒãƒ¼ãƒ‰ä¸Šã§ç›´æ¥ã‚·ã‚§ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã®ãŒä¸ä¾¿ãªå ´åˆãŒã‚ã‚‹ã“ã¨ã‚’ç†è§£ã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€ä¼æ¥­å‘ã‘ã®è‡ªå‹•ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹å ´åˆãªã©ã§ã™ã€‚ ãã®ãŸã‚ã€CasbinModelã¨CasbinPolicyã‚’ä½œæˆãŠã‚ˆã³ç¶­æŒã™ã‚‹ãŸã‚ã®go-clientã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚</p><p>go-clientãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯<code>pkg/client</code>ã«ã‚ã‚Šã¾ã™ã€‚</p><p><code>client.go</code>ã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã®é–¢æ•°ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewK8sGateKeeperClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">externalClient </span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">K8sGateKeeperClient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>externalClient</code>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€K8s-gatekeeperãŒK8sã‚¯ãƒ©ã‚¹ã‚¿å†…ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚</p><p><code>model.go</code>ã§ã€CasbinModelã‚’ä½œæˆã€å‰Šé™¤ã€ãŠã‚ˆã³å¤‰æ›´ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªé–¢æ•°ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ ã“ã‚Œã‚‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ä½¿ç”¨æ–¹æ³•ã¯<code>model_test.go</code>ã§ç¢ºèªã§ãã¾ã™ã€‚</p><p><code>policy.go</code>ã§ã€CasbinPolicyã‚’ä½œæˆã€å‰Šé™¤ã€ãŠã‚ˆã³å¤‰æ›´ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªé–¢æ•°ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ <code>policy_test.go</code>ã§ã“ã‚Œã‚‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ä½¿ã„æ–¹ã‚’èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-k8s-gatekeeperãŒæ©Ÿèƒ½ã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„">3.1.2 K8s-gatekeeperãŒæ©Ÿèƒ½ã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚<a href="#312-k8s-gatekeeperãŒæ©Ÿèƒ½ã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„" class="hash-link" aria-label="3.1.2 K8s-gatekeeperãŒæ©Ÿèƒ½ã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1.2 K8s-gatekeeperãŒæ©Ÿèƒ½ã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p><code>example/allowed_repo</code>ã«æ­£ç¢ºãªãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’ã™ã§ã«ä½œæˆã—ã¦ã„ã‚‹ã¨ä»®å®šã—ã¾ã™ã€‚ æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/allowed_repo/testcase/reject_1.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>K8sãŒã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ‹’å¦ã—ã€ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ‹’å¦ã•ã‚ŒãŸç†ç”±ã¨ã—ã¦ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ãŒåŸå› ã§ã‚ã‚‹ã“ã¨ã‚’æŒ‡æ‘˜ã™ã‚‹ã¯ãšã§ã™ã€‚ ã—ã‹ã—ã€<code>example/allowed_repo/testcase/approve_2.yaml</code>ã‚’é©ç”¨ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ãã‚Œã¯å—ã‘å…¥ã‚Œã‚‰ã‚Œã¾ã™ã€‚</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-k8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•">4. K8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•<a href="#4-k8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•" class="hash-link" aria-label="4. K8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³• ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4. K8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³• ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><p>ã¾ãšã€Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®åŸºæœ¬æ–‡æ³•ã«æ…£ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ ãã†ã§ãªã„å ´åˆã¯ã€ã¾ãš<a href="/ja/docs/get-started">ã¯ã˜ã‚ã«</a>ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚ ã“ã®ç« ã§ã¯ã€ã‚ãªãŸãŒã™ã§ã«Casbinã®ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã«ã¤ã„ã¦ç†è§£ã—ã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41-ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©">4.1 ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©<a href="#41-ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©" class="hash-link" aria-label="4.1 ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾© ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.1 ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾© ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>K8s-gatekeeperãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ‰¿èªã™ã‚‹éš›ã€å…¥åŠ›ã¯å¸¸ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ï¼šAdmission Requestã®Goã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚ ã“ã‚Œã¯ã€ã‚¨ãƒ³ãƒ•ã‚©ãƒ¼ã‚µãƒ¼ãŒå¸¸ã«æ¬¡ã®ã‚ˆã†ã«ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ï¼š</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ok</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> enforcer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Enforce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">admission</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã“ã§ã€<code>admission</code>ã¯K8sã®å…¬å¼go api <code>&quot;k8s.io/api/admission/v1&quot;</code>ã§å®šç¾©ã•ã‚ŒãŸ<code>AdmissionReview</code>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚ ã“ã®æ§‹é€ ä½“ã®å®šç¾©ã¯ã€ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š<a href="https://github.com/kubernetes/api/blob/master/admission/v1/types.go" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/api/blob/master/admission/v1/types.go</a>ã€‚ è©³ç´°ã«ã¤ã„ã¦ã¯ã€<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response</a>ã‚‚å‚ç…§ã§ãã¾ã™ã€‚</p><p>ã—ãŸãŒã£ã¦ã€K8s-gatekeeperã§ä½¿ç”¨ã•ã‚Œã‚‹ä»»æ„ã®ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦ã€<code>request_definition</code>ã®å®šç¾©ã¯å¸¸ã«æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>åå‰ &#x27;obj&#x27; ã¯å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<code>[matchers]</code>éƒ¨åˆ†ã§ä½¿ç”¨ã•ã‚Œã‚‹åå‰ã¨ä¸€è‡´ã—ã¦ã„ã‚Œã°ã‚ˆã„ã§ã™ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42-ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼">4.2 ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼<a href="#42-ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼" class="hash-link" aria-label="4.2 ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2 ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>Casbinã®ABACæ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ãƒ«ãƒ¼ãƒ«ã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ãŒæƒ³å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ ãŸã ã—ã€Casbinã«çµ±åˆã•ã‚ŒãŸå¼è©•ä¾¡å™¨ã¯ã€ãƒãƒƒãƒ—ã‚„é…åˆ—ï¼ˆã‚¹ãƒ©ã‚¤ã‚¹ï¼‰ã§ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ã‘ã€ã¾ãŸã¯é…åˆ—ã®å±•é–‹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ ãã®ãŸã‚ã€K8s-gatekeeperã¯ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªã€ŒCasbiné–¢æ•°ã€ã‚’æ‹¡å¼µæ©Ÿèƒ½ã¨ã—ã¦æä¾›ã—ã¦ã„ã¾ã™ã€‚ ã“ã‚Œã‚‰ã®æ‹¡å¼µæ©Ÿèƒ½ã§ã‚‚ãŠå®¢æ§˜ã®ãƒ‹ãƒ¼ã‚ºã‚’æº€ãŸã›ãªã„å ´åˆã¯ã€ãŠæ°—è»½ã«ã‚¤ã‚·ãƒ¥ãƒ¼ã‚’é–‹å§‹ã™ã‚‹ã‹ã€ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p><p>Casbiné–¢æ•°ã«ã¤ã„ã¦ã”å­˜çŸ¥ãªã„å ´åˆã¯ã€è©³ç´°ã«ã¤ã„ã¦<a href="/ja/docs/function">Function</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p><p>ä»¥ä¸‹ã¯æ‹¡å¼µé–¢æ•°ã§ã™ï¼š</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="421-æ‹¡å¼µé–¢æ•°">4.2.1 æ‹¡å¼µé–¢æ•°<a href="#421-æ‹¡å¼µé–¢æ•°" class="hash-link" aria-label="4.2.1 æ‹¡å¼µé–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1 æ‹¡å¼µé–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4211-ã‚¢ã‚¯ã‚»ã‚¹">4.2.1.1 ã‚¢ã‚¯ã‚»ã‚¹<a href="#4211-ã‚¢ã‚¯ã‚»ã‚¹" class="hash-link" aria-label="4.2.1.1 ã‚¢ã‚¯ã‚»ã‚¹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1.1 ã‚¢ã‚¯ã‚»ã‚¹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>ã‚¢ã‚¯ã‚»ã‚¹ã¯ã€CasbinãŒãƒãƒƒãƒ—ã‚„é…åˆ—ã§ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ã‘ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ <code>example/allowed_repo/model.yaml</code>ã®ä¾‹ã¯ã€ã“ã®é–¢æ•°ã®ä½¿ç”¨æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">= p.obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã®ãƒãƒƒãƒãƒ£ãƒ¼ã§ã¯ã€<code>access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</code> ã¯ <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Image</code> ã¨åŒç­‰ã§ã™ã€‚ã“ã“ã§ã€<code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers</code> ã¯ã‚¹ãƒ©ã‚¤ã‚¹ã§ã™ã€‚</p><p>ã‚¢ã‚¯ã‚»ã‚¹ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒãŸãšã€å˜ä¸€ã®å€¤ã‚’è¿”ã™å˜ç´”ãªé–¢æ•°ã‚‚å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ <code>example/container_resource_limit/model.yaml</code> ã®ä¾‹ã¯ã“ã‚Œã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;cpu&quot;,&quot;Value&quot;)) &gt;</span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">parseFloat(p.cpu) &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;memory&quot;,&quot;Value&quot;)) &gt;</span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">parseFloat(p.memory)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ã“ã®ãƒãƒƒãƒãƒ£ãƒ¼ã§ã¯ã€<code>access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;cpu&quot;,&quot;Value&quot;)</code> ã¯ <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits[&quot;cpu&quot;].Value()</code> ã¨åŒç­‰ã§ã™ã€‚ã“ã“ã§ã€<code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits</code> ã¯ãƒãƒƒãƒ—ã§ã‚ã‚Šã€<code>Value()</code> ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒãŸãšã€å˜ä¸€ã®å€¤ã‚’è¿”ã™å˜ç´”ãªé–¢æ•°ã§ã™ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4212-accesswithwildcard">4.2.1.2 accessWithWildcard<a href="#4212-accesswithwildcard" class="hash-link" aria-label="4.2.1.2 accessWithWildcard ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1.2 accessWithWildcard ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>æ™‚ã«ã¯ã€ã“ã®ã‚ˆã†ãªè¦æ±‚ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼šé…åˆ—å†…ã®ã™ã¹ã¦ã®è¦ç´ ã¯ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ &quot;aaa&quot; ã‚’æŒã¤å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ã—ã‹ã—ã€Casbin ã¯ <code>for</code> ãƒ«ãƒ¼ãƒ—ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ <code>accessWithWildcard</code> ã¨ &quot;map/slice expansion&quot; æ©Ÿèƒ½ã‚’ä½¿ã†ã“ã¨ã§ã€ã“ã®ã‚ˆã†ãªè¦æ±‚ã‚’ç°¡å˜ã«å®Ÿè£…ã§ãã¾ã™ã€‚</p><p>ä¾‹ãˆã°ã€<code>a.b.c</code> ãŒé…åˆ— <code>[aaa,bbb,ccc,ddd,eee]</code> ã§ã‚ã‚‹ã¨ã™ã‚‹ã¨ã€<code>accessWithWildcard(a,&quot;b&quot;,&quot;c&quot;,&quot;*&quot;)</code> ã®çµæœã¯ã‚¹ãƒ©ã‚¤ã‚¹ <code>[aaa,bbb,ccc,ddd,eee]</code> ã«ãªã‚Šã¾ã™ã€‚ ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ <code>*</code> ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¹ãƒ©ã‚¤ã‚¹ãŒå±•é–‹ã•ã‚Œã¾ã™ã€‚</p><p>åŒæ§˜ã«ã€ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã¯è¤‡æ•°å›ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ä¾‹ãˆã°ã€<code>accessWithWildcard(a,&quot;b&quot;,&quot;c&quot;,&quot;*&quot;,&quot;*&quot;)</code> ã®çµæœã¯ <code>[a.b.c[0][0], a.b.c[0][1], ..., a.b.c[1][0], a.b.c[1][1], ...]</code> ã«ãªã‚Šã¾ã™ã€‚</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4213-å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°">4.2.1.3 å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°<a href="#4213-å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°" class="hash-link" aria-label="4.2.1.3 å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1.3 å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>Casbinã®å¼è©•ä¾¡å™¨ã§ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒé…åˆ—ã§ã‚ã‚‹å ´åˆã€è‡ªå‹•çš„ã«å¯å¤‰é•·å¼•æ•°ã¨ã—ã¦å±•é–‹ã•ã‚Œã¾ã™ã€‚ ã“ã®æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ã¦é…åˆ—/ã‚¹ãƒ©ã‚¤ã‚¹/ãƒãƒƒãƒ—ã®å±•é–‹ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã€é…åˆ—/ã‚¹ãƒ©ã‚¤ã‚¹ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å—ã‘å–ã‚‹ã„ãã¤ã‹ã®é–¢æ•°ã‚‚çµ±åˆã—ã¦ã„ã¾ã™ã€‚</p><ul><li>contain(): è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€æœ€å¾Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é™¤ãã„ãšã‚Œã‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæœ€å¾Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ç­‰ã—ã„ã‹ã©ã†ã‹ã‚’è¿”ã—ã¾ã™ã€‚</li><li>split(a,b,c...,sep,index): <code>[splits(a,sep)[index], splits(b,sep)[index], splits(a,sep)[index], ...]</code> ã‚’å«ã‚€ã‚¹ãƒ©ã‚¤ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚</li><li>len(): å¯å¤‰é•·å¼•æ•°ã®é•·ã•ã‚’è¿”ã—ã¾ã™ã€‚</li><li>matchRegex(a,b,c...,regex): ä¸ãˆã‚‰ã‚ŒãŸã™ã¹ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ (<code>a</code>, <code>b</code>, <code>c</code>, ...) ãŒ ä¸ãˆã‚‰ã‚ŒãŸæ­£è¦è¡¨ç¾ã«ãƒãƒƒãƒã™ã‚‹ã‹ã©ã†ã‹ã‚’è¿”ã—ã¾ã™ã€‚</li></ul><p>ã“ã‚Œã¯ <code>example/disallowed_tag/model.yaml</code> ã®ä¾‹ã§ã™ã€‚</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;)</code> ãŒ <code>[&quot;a:b&quot;, &quot;c:d&quot;, &quot;e:f&quot;, &quot;g:h&quot;]</code> ã‚’è¿”ã™ã¨ä»®å®šã—ã¾ã™ã€‚split ã¯å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã€å„è¦ç´ ã«å¯¾ã—ã¦åˆ†å‰²æ“ä½œã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ 1 ã®è¦ç´ ãŒé¸æŠã•ã‚Œã¦è¿”ã•ã‚Œã¾ã™ã€‚ ã—ãŸãŒã£ã¦ã€<code>split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1)</code> ã¯ <code>[&quot;b&quot;,&quot;d&quot;,&quot;f&quot;,&quot;h&quot;]</code> ã‚’è¿”ã—ã¾ã™ã€‚ ãã—ã¦ã€<code>contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</code> ã¯ <code>p.obj</code> ãŒ <code>[&quot;b&quot;,&quot;d&quot;,&quot;f&quot;,&quot;h&quot;]</code> ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’è¿”ã—ã¾ã™ã€‚</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4212-å‹å¤‰æ›é–¢æ•°">4.2.1.2 å‹å¤‰æ›é–¢æ•°<a href="#4212-å‹å¤‰æ›é–¢æ•°" class="hash-link" aria-label="4.2.1.2 å‹å¤‰æ›é–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2.1.2 å‹å¤‰æ›é–¢æ•° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><ul><li>ParseFloat(): æ•´æ•°ã‚’æµ®å‹•å°æ•°ç‚¹æ•°ã«è§£æã—ã¾ã™ï¼ˆæ¯”è¼ƒã«ä½¿ç”¨ã•ã‚Œã‚‹æ•°å€¤ã¯æµ®å‹•å°æ•°ç‚¹æ•°ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ï¼‰ã€‚</li><li>ToString(): ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–‡å­—åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚ ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯æ–‡å­—åˆ—ã®åŸºæœ¬å‹ã‚’æŒã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆä¾‹ãˆã°ã€<code>type XXX string</code> ã¨ã„ã†å®£è¨€ãŒã‚ã‚‹å ´åˆã® <code>XXX</code> å‹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã€‚</li><li>IsNil(): ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒ nil ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’è¿”ã—ã¾ã™ã€‚</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-é«˜åº¦ãªè¨­å®š">5. é«˜åº¦ãªè¨­å®š<a href="#5-é«˜åº¦ãªè¨­å®š" class="hash-link" aria-label="5. é«˜åº¦ãªè¨­å®š ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5. é«˜åº¦ãªè¨­å®š ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-è¨¼æ˜æ›¸ã«ã¤ã„ã¦">5.1 è¨¼æ˜æ›¸ã«ã¤ã„ã¦<a href="#51-è¨¼æ˜æ›¸ã«ã¤ã„ã¦" class="hash-link" aria-label="5.1 è¨¼æ˜æ›¸ã«ã¤ã„ã¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.1 è¨¼æ˜æ›¸ã«ã¤ã„ã¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3><p>Kubernetesï¼ˆk8sï¼‰ã§ã¯ã€ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ãŒHTTPSã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒå¿…é ˆã§ã™ã€‚ ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯äºŒã¤ã‚ã‚Šã¾ã™ï¼š</p><ul><li>è‡ªå·±ç½²åè¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹ï¼ˆã“ã®ãƒªãƒã‚¸ãƒˆãƒªã®ä¾‹ã§ã¯ã“ã®æ–¹æ³•ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ï¼‰</li><li>é€šå¸¸ã®è¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="511-è‡ªå·±ç½²åè¨¼æ˜æ›¸">5.1.1 è‡ªå·±ç½²åè¨¼æ˜æ›¸<a href="#511-è‡ªå·±ç½²åè¨¼æ˜æ›¸" class="hash-link" aria-label="5.1.1 è‡ªå·±ç½²åè¨¼æ˜æ›¸ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.1.1 è‡ªå·±ç½²åè¨¼æ˜æ›¸ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>è‡ªå·±ç½²åè¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã„ã†ã“ã¨ã¯ã€è¨¼æ˜æ›¸ã‚’ç™ºè¡Œã™ã‚‹èªè¨¼å±€ï¼ˆCAï¼‰ãŒåºƒãçŸ¥ã‚‰ã‚ŒãŸCAã§ã¯ãªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚ ãã®ãŸã‚ã€ã“ã®CAã«ã¤ã„ã¦k8sã«çŸ¥ã‚‰ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ç¾åœ¨ã€ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã®ä¾‹ã§ã¯ã€è‡ªä½œã®CAã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ãã®ç§˜å¯†éµã¨è¨¼æ˜æ›¸ã¯ãã‚Œãã‚Œ<code>config/certificate/ca.crt</code>ã¨<code>config/certificate/ca.key</code>ã«ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚ ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã®è¨¼æ˜æ›¸ã¯ <code>config/certificate/server.crt</code> ã§ã€è‡ªå·±ä½œæˆã®CAã«ã‚ˆã£ã¦ç™ºè¡Œã•ã‚Œã¦ã„ã¾ã™ã€‚ ã“ã®è¨¼æ˜æ›¸ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯ &quot;webhook.domain.local&quot;ï¼ˆå¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ç”¨ï¼‰ã¨ &quot;casbin-webhook-svc.default.svc&quot;ï¼ˆå†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ç”¨ï¼‰ã§ã™ã€‚</p><p>CAã«é–¢ã™ã‚‹æƒ…å ±ã¯ã€ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»‹ã—ã¦k8sã«æ¸¡ã•ã‚Œã¾ã™ã€‚ <code>config/webhook_external.yaml</code> ã¨ <code>config/webhook_internal.yaml</code> ã®ä¸¡æ–¹ã« &quot;CABundle&quot; ã¨ã„ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Šã€ãã“ã«ã¯CAã®è¨¼æ˜æ›¸ã®base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ–‡å­—åˆ—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</p><p>è¨¼æ˜æ›¸ã‚„ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆï¼ˆä¾‹ãˆã°ã€å†…éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ãªãŒã‚‰k8sã®åˆ¥ã®åå‰ç©ºé–“ã«ã“ã®ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã‚’é…ç½®ã—ãŸã„å ´åˆã€ã¾ãŸã¯å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ãªãŒã‚‰ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å¤‰æ›´ã—ãŸã„å ´åˆï¼‰ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã†ã¹ãã§ã™ï¼š</p><ol><li><p>æ–°ã—ã„CAã‚’ç”Ÿæˆã™ã‚‹ï¼š</p><ul><li><p>å½ã®CAã®ãŸã‚ã®ç§˜å¯†éµã‚’ç”Ÿæˆã™ã‚‹ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out ca.key </span><span class="token number" style="color:#36acaa">2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>ç§˜å¯†éµã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿è­·ã‚’è§£é™¤ã™ã‚‹ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in ca.key -out ca.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã‚µãƒ¼ãƒãƒ¼ã®ãŸã‚ã®ç§˜å¯†éµã‚’ç”Ÿæˆã™ã‚‹ï¼š</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out server.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in server.key -out server.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>è‡ªå·±ç”Ÿæˆã®CAã‚’ä½¿ç”¨ã—ã¦ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã®è¨¼æ˜æ›¸ã«ç½²åã™ã‚‹ï¼š</p><ul><li><p>ã‚·ã‚¹ãƒ†ãƒ ã®opensslè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ™‚çš„ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚ <code>openssl version -a</code>ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã‚’ç¢ºèªã§ãã¾ã™ã€‚é€šå¸¸ã¯<code>openssl.cnf</code>ã¨ã„ã†åå‰ã§ã™ã€‚</p></li><li><p>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å†…ã§:</p><ul><li><p><code>[req]</code>ã®æ®µè½ã‚’è¦‹ã¤ã‘ã€ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™: <code>req_extensions = v3_req</code></p></li><li><p><code>[v3_req]</code>ã®æ®µè½ã‚’è¦‹ã¤ã‘ã€ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™: <code>subjectAltName = @alt_names</code></p></li><li><p>ä»¥ä¸‹ã®è¡Œã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¾ã™:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">alt_names</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">DNS.2</span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">&lt;The domain you want&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ³¨æ„: ã‚µãƒ¼ãƒ“ã‚¹åã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€&#x27;casbin-webhook-svc.default.svc&#x27;ã‚’å®Ÿéš›ã®ã‚µãƒ¼ãƒ“ã‚¹åã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚</p></li></ul></li><li><p>å¤‰æ›´ã—ãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦è¨¼æ˜æ›¸è¦æ±‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -nodes -keyout server.key -out server.csr -config openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>è‡ªä½œã®CAã‚’ä½¿ç”¨ã—ã¦è¦æ±‚ã«å¿œç­”ã—ã€è¨¼æ˜æ›¸ã«ç½²åã—ã¾ã™:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">3650</span><span class="token plain"> -in server.csr -out server.crt -CA ca.crt -CAkey ca.key -CAcreateserial -extensions v3_req -extensions SAN -extfile openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>&#x27;CABundle&#x27;ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç½®ãæ›ãˆã¾ã™: ã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ–°ã—ã„è¨¼æ˜æ›¸ã§æ›´æ–°ã—ã¦ãã ã•ã„ã€‚</p></li><li><p>Helmã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€åŒæ§˜ã®å¤‰æ›´ã‚’Helmãƒãƒ£ãƒ¼ãƒˆã«é©ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p></li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="512-æ³•çš„è¨¼æ˜æ›¸">5.1.2 æ³•çš„è¨¼æ˜æ›¸<a href="#512-æ³•çš„è¨¼æ˜æ›¸" class="hash-link" aria-label="5.1.2 æ³•çš„è¨¼æ˜æ›¸ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.1.2 æ³•çš„è¨¼æ˜æ›¸ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4><p>æ³•çš„è¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ã“ã‚Œã‚‰ã™ã¹ã¦ã®æ‰‹ç¶šãã‚’è¡Œã†å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ <code>config/webhook_external.yaml</code>ã¨<code>config/webhook_internal.yaml</code>ã®&quot;CABundle&quot;ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å‰Šé™¤ã—ã€ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ã‚ãªãŸãŒæ‰€æœ‰ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sGateKeeper.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ã“ã®ãƒšãƒ¼ã‚¸ã‚’ç·¨é›†</a> <a href="https://crowdin.com/project/casdoor-website/ja" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page" transurl="https://crowdin.com/project/casdoor-website/ja" style="margin-left:2rem"><svg fill="currentColor" height="20" width="20" viewBox="0 0 25 25" aria-hidden="true" style="margin-right:0.3em;vertical-align:sub"><path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>ã“ã®ãƒšãƒ¼ã‚¸ã‚’ç¿»è¨³</a></div><div class="col lastUpdated_VsjB"><span>ä½œæˆè€…:</span><a href="https://github.com/ComradeProgrammer" target="_blank" rel="noreferrer"><img alt="ComradeProgrammer" src="https://avatars.githubusercontent.com/ComradeProgrammer" width="24px" style="border-radius:12px;vertical-align:sub;margin-left:4px">  <!-- -->ComradeProgrammer</a></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒšãƒ¼ã‚¸"><a class="pagination-nav__link pagination-nav__link--prev" href="/ja/docs/k8s"><div class="pagination-nav__sublabel">å‰</div><div class="pagination-nav__label">Authorization of Kubernetes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ja/docs/envoy"><div class="pagination-nav__sublabel">æ¬¡ã¸</div><div class="pagination-nav__label">Authorization of Service Mesh through Envoy</div></a></nav><br></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-casbin-k8s-gatekeeper-ã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ" class="table-of-contents__link toc-highlight">1. Casbin K8s-Gatekeeper ã®æ¦‚è¦ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a><ul><li><a href="#01-ç°¡å˜ãªä¾‹" class="table-of-contents__link toc-highlight">0.1 ç°¡å˜ãªä¾‹</a></li><li><a href="#11-casbin-k8s-gatekeeperã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹" class="table-of-contents__link toc-highlight">1.1 Casbin K8s-Gatekeeperã¯ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿ</a></li><li><a href="#12-ãã‚ŒãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹" class="table-of-contents__link toc-highlight">1.2 ãã‚ŒãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’ç¤ºã™ä¾‹</a></li></ul></li><li><a href="#k8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" class="table-of-contents__link toc-highlight">K8s-gatekeeperã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a><ul><li><a href="#211-ã‚¹ãƒ†ãƒƒãƒ—1-ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰" class="table-of-contents__link toc-highlight">2.1.1 ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰</a></li><li><a href="#22-å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯" class="table-of-contents__link toc-highlight">2.2 å¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯</a></li><li><a href="#231-ã‚¹ãƒ†ãƒƒãƒ—-1-ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹" class="table-of-contents__link toc-highlight">2.3.1 ã‚¹ãƒ†ãƒƒãƒ— 1: ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹</a></li></ul></li><li><a href="#3-k8s-gatekeeperã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„" class="table-of-contents__link toc-highlight">3. K8s-gatekeeperã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„</a><ul><li><a href="#31-casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ" class="table-of-contents__link toc-highlight">3.1 Casbinãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ</a></li><li><a href="#312-k8s-gatekeeperãŒæ©Ÿèƒ½ã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„" class="table-of-contents__link toc-highlight">3.1.2 K8s-gatekeeperãŒæ©Ÿèƒ½ã™ã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</a></li></ul></li><li><a href="#4-k8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•" class="table-of-contents__link toc-highlight">4. K8s-gatekeeperã§ãƒ¢ãƒ‡ãƒ«ã¨ãƒãƒªã‚·ãƒ¼ã‚’æ›¸ãæ–¹æ³•</a><ul><li><a href="#41-ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©" class="table-of-contents__link toc-highlight">4.1 ãƒ¢ãƒ‡ãƒ«ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®šç¾©</a></li><li><a href="#42-ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼" class="table-of-contents__link toc-highlight">4.2 ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒƒãƒãƒ£ãƒ¼</a></li><li><a href="#421-æ‹¡å¼µé–¢æ•°" class="table-of-contents__link toc-highlight">4.2.1 æ‹¡å¼µé–¢æ•°</a></li><li><a href="#4213-å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°" class="table-of-contents__link toc-highlight">4.2.1.3 å¯å¤‰é•·å¼•æ•°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é–¢æ•°</a></li></ul></li><li><a href="#5-é«˜åº¦ãªè¨­å®š" class="table-of-contents__link toc-highlight">5. é«˜åº¦ãªè¨­å®š</a><ul><li><a href="#51-è¨¼æ˜æ›¸ã«ã¤ã„ã¦" class="table-of-contents__link toc-highlight">5.1 è¨¼æ˜æ›¸ã«ã¤ã„ã¦</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ja/docs/get-started">ã¯ã˜ã‚ã«</a></li><li class="footer__item"><a class="footer__link-item" href="/ja/docs/management-api">Management API</a></li><li class="footer__item"><a class="footer__link-item" href="/ja/docs/rbac-api">RBAC API</a></li><li class="footer__item"><a class="footer__link-item" href="/ja/docs/middlewares">ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢</a></li></ul></div><div class="col footer__col"><div class="footer__title">ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://forum.casbin.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ãƒ•ã‚©ãƒ¼ãƒ©ãƒ <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/search?q=casbin" target="_blank" rel="noopener noreferrer" class="footer__link-item">ã‚¹ã‚¿ãƒƒã‚¯ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/S5UjpzGZjN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://cdn.casdoor.com/casdoor/resource/built-in/admin/qq_casbin.png" target="_blank" rel="noopener noreferrer" class="footer__link-item">QQ ã‚°ãƒ«ãƒ¼ãƒ—<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">ã‚‚ã£ã¨è¦‹ã‚‹</div><ul class="footer__items clean-list"><li class="footer__item">
                <a href="https://github.com/casbin/casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin?label=Casbin&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/jcasbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/jcasbin?label=jCasbin&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/node-casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/node-casbin?label=Node-Casbin&style=social">
                </a>
                &nbsp;&nbsp;
                <a href="https://github.com/php-casbin/php-casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/php-casbin/php-casbin?label=PHP-Casbin&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/pycasbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/pycasbin?label=PyCasbin&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/Casbin.NET" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/Casbin.NET?label=Casbin.NET&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/casbin-cpp" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin-cpp?label=Casbin-CPP&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/casbin-rs" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin-rs?label=Casbin-RS&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://twitter.com/casbinHQ" target="_blank">
                  <img alt="Twitter Follow" src="https://img.shields.io/twitter/follow/casbinHQ?style=social">
                </a>
              </li><li class="footer__item">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?2c0ffc6f8d49e98d964d59d7aa4cbf34";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
</li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/ja/"><img src="/ja/img/casbin_min.svg" alt="Casbin ãƒ­ã‚´" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/ja/img/casbin_min.svg" alt="Casbin ãƒ­ã‚´" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2025 Casbin Organization</div></div></div></footer></div>
<script src="/ja/assets/js/runtime~main.6d77dd43.js"></script>
<script src="/ja/assets/js/main.6a3e55ae.js"></script>
</body>
</html>