"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[8271],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=i,g=d["".concat(s,".").concat(m)]||d[m]||u[m]||r;return n?a.createElement(g,o(o({ref:t},p),{},{components:n})):a.createElement(g,o({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var c=2;c<r;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7447:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var a=n(7462),i=(n(7294),n(3905));const r={id:"frontend",title:"Frontend Usage",description:"Casbin.js \xe8 un addon di Casbin che facilita la gestione del controllo degli accessi nell'applicazione frontend.",keywords:["Casbin.js","react-authz","rbac-react","vue-authz","angular-authz"],authors:["hsluoyz"]},o=void 0,l={unversionedId:"frontend",id:"frontend",title:"Frontend Usage",description:"Casbin.js \xe8 un addon di Casbin che facilita la gestione del controllo degli accessi nell'applicazione frontend.",source:"@site/i18n/it/docusaurus-plugin-content-docs/current/FrontendUsage.mdx",sourceDirName:".",slug:"/frontend",permalink:"/it/docs/frontend",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/FrontendUsage.mdx",tags:[],version:"current",frontMatter:{id:"frontend",title:"Frontend Usage",description:"Casbin.js \xe8 un addon di Casbin che facilita la gestione del controllo degli accessi nell'applicazione frontend.",keywords:["Casbin.js","react-authz","rbac-react","vue-authz","angular-authz"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Log & Error Handling",permalink:"/it/docs/log-error"},next:{title:"Editor",permalink:"/it/docs/category/editor"}},s={},c=[{value:"Installazione",id:"installazione",level:2},{value:"Middleware Frontend",id:"middleware-frontend",level:2},{value:"Guida introduttiva",id:"guida-introduttiva",level:2},{value:"Oggetto Permesso",id:"oggetto-permesso",level:3},{value:"Utilizzo Avanzato",id:"utilizzo-avanzato",level:2},{value:"Elenco API",id:"elenco-api",level:2},{value:"<code>setPermission(permission: string)</code>",id:"setpermissionpermission-string",level:3},{value:"<code>setUser(user: string)</code>",id:"setuseruser-string",level:3},{value:"<code>can(action: string, object: string)</code>",id:"canaction-string-object-string",level:3},{value:"<code>cannot(action: string, object: string)</code>",id:"cannotaction-string-object-string",level:3},{value:"<code>canAll(action: string, objects: Array&lt;object&gt;)</code>",id:"canallaction-string-objects-arrayobject",level:3},{value:"<code>canAny(action: string, objects: Array&lt;object&gt;)</code>",id:"cananyaction-string-objects-arrayobject",level:3},{value:"Perch\xe9 Casbin.js",id:"perch\xe9-casbinjs",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin.js"},"Casbin.js")," \xe8 un addon di Casbin che facilita la gestione del controllo degli accessi nell'applicazione frontend."),(0,i.kt)("h2",{id:"installazione"},"Installazione"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install casbin.js\nnpm install casbin\n")),(0,i.kt)("p",null,"o"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add casbin.js\n")),(0,i.kt)("h2",{id:"middleware-frontend"},"Middleware Frontend"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Middleware"),(0,i.kt)("th",{parentName:"tr",align:null},"Tipo"),(0,i.kt)("th",{parentName:"tr",align:null},"Autore"),(0,i.kt)("th",{parentName:"tr",align:null},"Descrizione"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/casbin-js/react-authz"},"react-authz")),(0,i.kt)("td",{parentName:"tr",align:null},"React"),(0,i.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,i.kt)("td",{parentName:"tr",align:null},"Wrapper React per Casbin.js")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/daobeng/rbac-react"},"rbac-react")),(0,i.kt)("td",{parentName:"tr",align:null},"React"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/daobeng"},"@daobeng")),(0,i.kt)("td",{parentName:"tr",align:null},"Controllo degli Accessi Basato sui Ruoli in React utilizzando HOCs, CASL e Casbin.js")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/casbin-js/vue-authz"},"vue-authz")),(0,i.kt)("td",{parentName:"tr",align:null},"Vue"),(0,i.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,i.kt)("td",{parentName:"tr",align:null},"Wrapper Vue per Casbin.js")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/casbin-js/angular-authz"},"angular-authz")),(0,i.kt)("td",{parentName:"tr",align:null},"Angular"),(0,i.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,i.kt)("td",{parentName:"tr",align:null},"Wrapper Angular per Casbin.js")))),(0,i.kt)("h2",{id:"guida-introduttiva"},"Guida introduttiva"),(0,i.kt)("p",null,"Puoi utilizzare la modalit\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"manual")," nella tua applicazione frontend e impostare le autorizzazioni ogni volta che desideri."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'const casbinjs = require("casbin.js");\n// Set the user\'s permission:\n// He/She can read `data1` and `data2` objects and can write `data1` object\nconst permission = {\n    "read": ["data1", "data2"],\n    "write": ["data1"]\n}\n\n// Run casbin.js in manual mode, which requires you to set the permission manually.\nconst authorizer = new casbinjs.Authorizer("manual");\n')),(0,i.kt)("p",null,"Ora abbiamo un autorizzatore, ",(0,i.kt)("inlineCode",{parentName:"p"},"authorizer"),". Possiamo ottenere le regole di autorizzazione da esso utilizzando le API ",(0,i.kt)("inlineCode",{parentName:"p"},"authorizer.can()")," e ",(0,i.kt)("inlineCode",{parentName:"p"},"authorizer.cannot()"),". I valori di ritorno di queste 2 API sono Promesse JavaScript (",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises"},"dettagli qui"),"), quindi dovremmo utilizzare il metodo ",(0,i.kt)("inlineCode",{parentName:"p"},"then()")," del valore di ritorno in questo modo:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'result = authorizer.can("write", "data1");\nresult.then((success, failed) => {\n    if (success) {\n        console.log("you can write data1");\n    } else {\n        console.log("you cannot write data1");\n    }\n});\n// output: you can write data1\n')),(0,i.kt)("p",null,"L'API ",(0,i.kt)("inlineCode",{parentName:"p"},"cannot()")," viene utilizzata allo stesso modo:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'result = authorizer.cannot("read", "data2");\nresult.then((success, failed) => {\n    if (success) {\n        console.log("you cannot read data2");\n    } else {\n        console.log("you can read data2");\n    }\n});\n// output: you can read data2\n')),(0,i.kt)("p",null,"Nel codice sopra, la variabile ",(0,i.kt)("inlineCode",{parentName:"p"},"success")," nei parametri significa che la richiesta ottiene il risultato senza generare un errore e non significa che la regola di autorizzazione sia ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),". La variabile ",(0,i.kt)("inlineCode",{parentName:"p"},"failed")," \xe8 anche non correlata alle regole di autorizzazione. Ha senso solo quando qualcosa va storto nel processo della richiesta."),(0,i.kt)("p",null,"Puoi fare riferimento al nostro ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin-js/examples"},"esempio React")," per vedere un utilizzo pratico di Casbin.js."),(0,i.kt)("h3",{id:"oggetto-permesso"},"Oggetto Permesso"),(0,i.kt)("p",null,"Casbin.js accetter\xe0 un oggetto JSON per manipolare il corrispondente permesso di un visitatore. Ad esempio:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "read": ["data1", "data2"],\n    "write": ["data1"]\n}\n')),(0,i.kt)("p",null,"L'oggetto permesso sopra mostra che il visitatore pu\xf2 ",(0,i.kt)("inlineCode",{parentName:"p"},"leggere")," gli oggetti ",(0,i.kt)("inlineCode",{parentName:"p"},"data1")," e ",(0,i.kt)("inlineCode",{parentName:"p"},"data2"),", mentre pu\xf2 solo ",(0,i.kt)("inlineCode",{parentName:"p"},"scrivere")," gli oggetti ",(0,i.kt)("inlineCode",{parentName:"p"},"data1"),"."),(0,i.kt)("h2",{id:"utilizzo-avanzato"},"Utilizzo Avanzato"),(0,i.kt)("p",null,"Casbin.js fornisce una soluzione perfetta per integrare la gestione degli accessi del tuo frontend con il tuo servizio backend Casbin."),(0,i.kt)("p",null,"Usa la modalit\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"auto")," e specifica il tuo endpoint durante l'inizializzazione dell'",(0,i.kt)("inlineCode",{parentName:"p"},"Authorizer")," di Casbin.js, sincronizzer\xe0 automaticamente i permessi e manipoler\xe0 lo stato del frontend."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"const casbinjs = require('casbin.js');\n\n// Set your backend Casbin service URL\nconst authorizer = new casbinjs.Authorizer(\n    'auto', // mode\n    {endpoint: 'http://your_endpoint/api/casbin'}\n);\n\n// Set your visitor.\n// Casbin.js will automatically sync the permission with your backend Casbin service.\nauthorizer.setUser(\"Tom\");\n\n// Evaluate the permission\nresult = authorizer.can(\"read\", \"data1\");\nresult.then((success, failed) => {\n    if (success) {\n        // Some frontend procedure ...\n    }\n});\n")),(0,i.kt)("p",null,"Di conseguenza, devi esporre un'interfaccia (ad esempio, un RestAPI) per generare l'oggetto permesso e passarlo al frontend. Nel tuo controller API, chiama ",(0,i.kt)("inlineCode",{parentName:"p"},"CasbinJsGetUserPermission")," per costruire l'oggetto permesso. Ecco un esempio in Beego:"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Il tuo server endpoint dovrebbe restituire qualcosa del genere"),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "other":"other",\n    "data": "What you get from `CasbinJsGetPermissionForUser`"\n}\n'))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'// Router\nbeego.Router("api/casbin", &controllers.APIController{}, "GET:GetFrontendPermission")\n\n// Controller\nfunc (c *APIController) GetFrontendPermission() {\n    // Get the visitor from the GET parameters. (The key is "casbin_subject")\n    visitor := c.Input().Get("casbin_subject")\n    // `e` is an initialized instance of Casbin Enforcer\n    c.Data["perm"] = casbin.CasbinJsGetPermissionForUser(e, visitor)\n    // Pass the data to the frontend.\n    c.ServeJSON()\n}\n')),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Attualmente, l'API ",(0,i.kt)("inlineCode",{parentName:"p"},"CasbinJsGetPermissionForUser")," \xe8 supportata solo in Go Casbin e Node-Casbin. Se desideri che questa API sia supportata in altre lingue, per favore ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin.js/issues"},"segnala un problema")," o lascia un commento qui sotto.")),(0,i.kt)("h2",{id:"elenco-api"},"Elenco API"),(0,i.kt)("h3",{id:"setpermissionpermission-string"},(0,i.kt)("inlineCode",{parentName:"h3"},"setPermission(permission: string)")),(0,i.kt)("p",null,"Imposta l'oggetto permesso. Sempre utilizzato in modalit\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"manual"),"."),(0,i.kt)("h3",{id:"setuseruser-string"},(0,i.kt)("inlineCode",{parentName:"h3"},"setUser(user: string)")),(0,i.kt)("p",null,"Imposta l'identit\xe0 del visitatore e aggiorna il permesso. Sempre utilizzato in modalit\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"auto"),"."),(0,i.kt)("h3",{id:"canaction-string-object-string"},(0,i.kt)("inlineCode",{parentName:"h3"},"can(action: string, object: string)")),(0,i.kt)("p",null,"Controlla se l'utente pu\xf2 eseguire ",(0,i.kt)("inlineCode",{parentName:"p"},"azione")," su ",(0,i.kt)("inlineCode",{parentName:"p"},"oggetto"),"."),(0,i.kt)("h3",{id:"cannotaction-string-object-string"},(0,i.kt)("inlineCode",{parentName:"h3"},"cannot(action: string, object: string)")),(0,i.kt)("p",null,"Controlla se l'utente ",(0,i.kt)("strong",{parentName:"p"},"non pu\xf2")," eseguire ",(0,i.kt)("inlineCode",{parentName:"p"},"azione")," su ",(0,i.kt)("inlineCode",{parentName:"p"},"oggetto"),"."),(0,i.kt)("h3",{id:"canallaction-string-objects-arrayobject"},(0,i.kt)("inlineCode",{parentName:"h3"},"canAll(action: string, objects: Array<object>)")),(0,i.kt)("p",null,"Controlla se l'utente pu\xf2 eseguire ",(0,i.kt)("inlineCode",{parentName:"p"},"azione")," su ",(0,i.kt)("strong",{parentName:"p"},"tutti")," gli oggetti in ",(0,i.kt)("inlineCode",{parentName:"p"},"oggetti"),"."),(0,i.kt)("h3",{id:"cananyaction-string-objects-arrayobject"},(0,i.kt)("inlineCode",{parentName:"h3"},"canAny(action: string, objects: Array<object>)")),(0,i.kt)("p",null,"Controlla se l'utente pu\xf2 eseguire ",(0,i.kt)("inlineCode",{parentName:"p"},"azione")," su ",(0,i.kt)("strong",{parentName:"p"},"almeno uno")," degli ",(0,i.kt)("inlineCode",{parentName:"p"},"oggetti"),"."),(0,i.kt)("h2",{id:"perch\xe9-casbinjs"},"Perch\xe9 Casbin.js"),(0,i.kt)("p",null,"Le persone potrebbero chiedersi qual \xe8 la differenza tra Node-Casbin e Casbin.js. In parole povere, Node-Casbin \xe8 il nucleo di Casbin implementato nell'ambiente NodeJS e viene normalmente utilizzato come toolkit di gestione del controllo degli accessi ai lati del server. Casbin.js \xe8 una libreria per il frontend che ti aiuta a utilizzare Casbin per autorizzare gli utenti della tua pagina web sul lato client."),(0,i.kt)("p",null,"Normalmente, non \xe8 appropriato costruire direttamente un servizio Casbin e svolgere le attivit\xe0 di autorizzazione/imposizione in un'applicazione web frontend a causa dei seguenti problemi:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Quando qualcuno accende il client, l'enforcer verr\xe0 inizializzato e tirer\xe0 tutte le policy dai livelli persistenti del backend. Un'elevata concorrenza potrebbe portare una forte pressione sui database e costare molta larghezza di banda di rete."),(0,i.kt)("li",{parentName:"ol"},"Caricare tutte le policy sul lato client potrebbe portare rischi per la sicurezza."),(0,i.kt)("li",{parentName:"ol"},"\xc8 difficile separare client e server e facilitare lo sviluppo agile.")),(0,i.kt)("p",null,"Abbiamo bisogno di uno strumento che faciliti l'uso di Casbin sul frontend. In realt\xe0, il nucleo di Casbin.js \xe8 la manipolazione del permesso dell'utente corrente sul lato client. Come hai menzionato, Casbin.js esegue un fetch da un endpoint specificato. Questa procedura sincronizzer\xe0 le autorizzazioni dell'utente con il servizio backend di Casbin. Dopo aver ottenuto i dati delle autorizzazioni, gli sviluppatori possono utilizzare le interfacce di Casbin.js per gestire il comportamento dell'utente sul lato frontend."),(0,i.kt)("p",null,"Casbin.js evita i due problemi sopra menzionati: il servizio Casbin non verr\xe0 pi\xf9 tirato su ripetutamente e la dimensione dei messaggi scambiati tra il client e il server \xe8 ridotta. Evitiamo anche di memorizzare tutte le politiche sul frontend. L'utente pu\xf2 accedere solo alle proprie autorizzazioni, ma non ha conoscenza del modello di controllo degli accessi e delle autorizzazioni degli altri utenti. Inoltre, Casbin.js pu\xf2 anche efficacemente disaccoppiare il client e il server nella gestione delle autorizzazioni."))}u.isMDXComponent=!0}}]);