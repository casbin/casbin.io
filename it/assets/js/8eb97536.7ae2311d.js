"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[531],{3905:(e,i,a)=>{a.d(i,{Zo:()=>c,kt:()=>d});var t=a(7294);function n(e,i,a){return i in e?Object.defineProperty(e,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[i]=a,e}function o(e,i){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);i&&(t=t.filter((function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable}))),a.push.apply(a,t)}return a}function r(e){for(var i=1;i<arguments.length;i++){var a=null!=arguments[i]?arguments[i]:{};i%2?o(Object(a),!0).forEach((function(i){n(e,i,a[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(a,i))}))}return e}function l(e,i){if(null==e)return{};var a,t,n=function(e,i){if(null==e)return{};var a,t,n={},o=Object.keys(e);for(t=0;t<o.length;t++)a=o[t],i.indexOf(a)>=0||(n[a]=e[a]);return n}(e,i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)a=o[t],i.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=t.createContext({}),p=function(e){var i=t.useContext(s),a=i;return e&&(a="function"==typeof e?e(i):r(r({},i),e)),a},c=function(e){var i=p(e.components);return t.createElement(s.Provider,{value:i},e.children)},u={inlineCode:"code",wrapper:function(e){var i=e.children;return t.createElement(t.Fragment,{},i)}},m=t.forwardRef((function(e,i){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(a),d=n,k=m["".concat(s,".").concat(d)]||m[d]||u[d]||o;return a?t.createElement(k,r(r({ref:i},c),{},{components:a})):t.createElement(k,r({ref:i},c))}));function d(e,i){var a=arguments,n=i&&i.mdxType;if("string"==typeof e||n){var o=a.length,r=new Array(o);r[0]=m;var l={};for(var s in i)hasOwnProperty.call(i,s)&&(l[s]=i[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,r[1]=l;for(var p=2;p<o;p++)r[p]=a[p];return t.createElement.apply(null,r)}return t.createElement.apply(null,a)}m.displayName="MDXCreateElement"},5232:(e,i,a)=>{a.r(i),a.d(i,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var t=a(7462),n=(a(7294),a(3905));const o={id:"k8s-gatekeeper",title:"Admission Webhook for K8s",description:"Middleware di autorizzazione Kubernetes (K8s) RBAC & ABAC basato su Casbin",keywords:["k8s-gatekeeper","Kubernetes","K8s"],authors:["ComradeProgrammer"]},r=void 0,l={unversionedId:"k8s-gatekeeper",id:"k8s-gatekeeper",title:"Admission Webhook for K8s",description:"Middleware di autorizzazione Kubernetes (K8s) RBAC & ABAC basato su Casbin",source:"@site/i18n/it/docusaurus-plugin-content-docs/current/K8sGateKeeper.mdx",sourceDirName:".",slug:"/k8s-gatekeeper",permalink:"/it/docs/k8s-gatekeeper",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sGateKeeper.mdx",tags:[],version:"current",frontMatter:{id:"k8s-gatekeeper",title:"Admission Webhook for K8s",description:"Middleware di autorizzazione Kubernetes (K8s) RBAC & ABAC basato su Casbin",keywords:["k8s-gatekeeper","Kubernetes","K8s"],authors:["ComradeProgrammer"]},sidebar:"docs",previous:{title:"Authorization of Kubernetes",permalink:"/it/docs/k8s"},next:{title:"Authorization of Service Mesh through Envoy",permalink:"/it/docs/envoy"}},s={},p=[{value:"1. Panoramica e documenti per Casbin K8s-Gatekeeper",id:"1-panoramica-e-documenti-per-casbin-k8s-gatekeeper",level:2},{value:"0.1 Un Esempio Semplice",id:"01-un-esempio-semplice",level:3},{value:"1.1 Come funziona Casbin K8s-Gatekeeper?",id:"11-come-funziona-casbin-k8s-gatekeeper",level:3},{value:"1.2 Un Esempio Illustrativo di Come Funziona",id:"12-un-esempio-illustrativo-di-come-funziona",level:3},{value:"2 Installa K8s-gatekeeper",id:"2-installa-k8s-gatekeeper",level:2},{value:"2.1 Webhook interno",id:"21-webhook-interno",level:3},{value:"2.1.1 Passo 1: Costruire l&#39;immagine",id:"211-passo-1-costruire-limmagine",level:4},{value:"2.1.2 Passo 2: Configurare servizi e distribuzioni per K8s-gatekeeper",id:"212-passo-2-configurare-servizi-e-distribuzioni-per-k8s-gatekeeper",level:4},{value:"2.1.3 Passo 3: Installare le risorse CRD per K8s-gatekeeper",id:"213-passo-3-installare-le-risorse-crd-per-k8s-gatekeeper",level:4},{value:"2.2 Webhook esterno",id:"22-webhook-esterno",level:3},{value:"2.3 Installa K8s-gatekeeper tramite Helm",id:"23-installa-k8s-gatekeeper-tramite-helm",level:3},{value:"2.3.1 Passo 1: Costruisci l&#39;immagine",id:"231-passo-1-costruisci-limmagine",level:4},{value:"2.3.2 Installazione di Helm",id:"232-installazione-di-helm",level:4},{value:"3. Prova K8s-gatekeeper",id:"3-prova-k8s-gatekeeper",level:2},{value:"3.1 Creare Modello e Policy di Casbin",id:"31-creare-modello-e-policy-di-casbin",level:3},{value:"3.1.1 Creare/Aggiornare Modello e Policy di Casbin tramite kubectl",id:"311-creareaggiornare-modello-e-policy-di-casbin-tramite-kubectl",level:4},{value:"3.1.2 Creare/Aggiornare il Modello e la Policy Casbin tramite il go-client che forniamo",id:"312-creareaggiornare-il-modello-e-la-policy-casbin-tramite-il-go-client-che-forniamo",level:4},{value:"3.1.2 Prova se K8s-gatekeeper funziona",id:"312-prova-se-k8s-gatekeeper-funziona",level:3},{value:"4. Come Scrivere Modelli e Politiche con K8s-gatekeeper",id:"4-come-scrivere-modelli-e-politiche-con-k8s-gatekeeper",level:2},{value:"4.1 Definizione della Richiesta del Modello",id:"41-definizione-della-richiesta-del-modello",level:3},{value:"4.2 Matchers del Modello",id:"42-matchers-del-modello",level:3},{value:"4.2.1 Funzioni di Estensione",id:"421-funzioni-di-estensione",level:3},{value:"4.2.1.1 access",id:"4211-access",level:4},{value:"4.2.1.2 accessWithWildcard",id:"4212-accesswithwildcard",level:4},{value:"4.2.1.3 Funzioni che supportano argomenti a lunghezza variabile",id:"4213-funzioni-che-supportano-argomenti-a-lunghezza-variabile",level:3},{value:"4.2.1.2 Funzioni di Conversione del Tipo",id:"4212-funzioni-di-conversione-del-tipo",level:4},{value:"5. Impostazioni Avanzate",id:"5-impostazioni-avanzate",level:2},{value:"5.1 Informazioni sui Certificati",id:"51-informazioni-sui-certificati",level:3},{value:"5.1.1 Certificati autofirmati",id:"511-certificati-autofirmati",level:4},{value:"5.1.2 Certificati legali",id:"512-certificati-legali",level:4}],c={toc:p};function u(e){let{components:i,...a}=e;return(0,n.kt)("wrapper",(0,t.Z)({},c,a,{components:i,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"1-panoramica-e-documenti-per-casbin-k8s-gatekeeper"},"1. Panoramica e documenti per Casbin K8s-Gatekeeper"),(0,n.kt)("p",null,"Casbin K8s-GateKeeper \xe8 un webhook di ammissione Kubernetes che integra Casbin come strumento di Controllo di Accesso. Utilizzando Casbin K8s-GateKeeper, puoi stabilire regole flessibili per autorizzare o intercettare qualsiasi operazione su risorse K8s, SENZA scrivere alcun pezzo di codice, ma solo poche righe di configurazioni dichiarative di modelli e politiche di Casbin, che fanno parte del linguaggio ACL (Access Control List) di Casbin."),(0,n.kt)("p",null,"Casbin K8s-GateKeeper \xe8 sviluppato e mantenuto dalla comunit\xe0 Casbin. Il repository di questo progetto \xe8 disponibile qui: ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-gatekeeper"},"https://github.com/casbin/k8s-gatekeeper")),(0,n.kt)("h3",{id:"01-un-esempio-semplice"},"0.1 Un Esempio Semplice"),(0,n.kt)("p",null,'Ad esempio, non \xe8 necessario scrivere alcun codice, ma utilizzare le seguenti righe di configurazione per ottenere questa funzione: "Proibire l\'uso di immagini con alcuni tag specificati in qualsiasi distribuzione":'),(0,n.kt)("p",null,"Model:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},'[request_definition]\nr =  obj\n\n[policy_definition]\np =  obj,eft\n\n[policy_effect]\ne = !some(where (p.eft == deny))\n\n[matchers]\nm = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\ncontain(split(accessWithWildcard(${OBJECT}.Spec.Template.Spec.Containers , "*", "Image"),":",1) , p.obj)\n')),(0,n.kt)("p",null,"And Policy:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-csv"},'p, "1.14.1",deny\n')),(0,n.kt)("p",null,"Questi sono scritti nel linguaggio ordinario Casbin ACL. Supponendo che tu abbia gi\xe0 letto i capitoli su di essi, sar\xe0 molto facile da capire."),(0,n.kt)("p",null,"Casbin K8s-GateKeeper presenta i seguenti vantaggi:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Facile da usare. Scrivere diverse righe di ACL \xe8 molto meglio che scrivere molto codice."),(0,n.kt)("li",{parentName:"ul"},"Permette aggiornamenti dinamici delle configurazioni. Non \xe8 necessario spegnere l'intero plugin per modificare le configurazioni."),(0,n.kt)("li",{parentName:"ul"},"\xc8 flessibile. \xc8 possibile creare regole arbitrarie su qualsiasi risorsa K8s, che possono essere esplorate con ",(0,n.kt)("inlineCode",{parentName:"li"},"kubectl gatekeeper"),"."),(0,n.kt)("li",{parentName:"ul"},"Semplifica l'implementazione del webhook di ammissione K8s, che \xe8 molto complicato. Non \xe8 necessario sapere cos'\xe8 il webhook di ammissione K8s o come scrivere codice per esso. Tutto ci\xf2 che devi fare \xe8 conoscere la risorsa su cui vuoi mettere vincoli e poi scrivere ACL di Casbin. Tutti sanno che K8s \xe8 complesso, ma utilizzando Casbin K8s-Gatekeeper, puoi risparmiare tempo."),(0,n.kt)("li",{parentName:"ul"},"\xc8 mantenuto dalla comunit\xe0 di Casbin. Sentiti libero di contattarci se qualcosa riguardo questo plugin ti confonde o se incontri problemi durante il tentativo.")),(0,n.kt)("h3",{id:"11-come-funziona-casbin-k8s-gatekeeper"},"1.1 Come funziona Casbin K8s-Gatekeeper?"),(0,n.kt)("p",null,"K8s-Gatekeeper \xe8 un webhook di ammissione per K8s che utilizza ",(0,n.kt)("a",{parentName:"p",href:"/docs/overview"},"Casbin")," per applicare regole di controllo degli accessi arbitrarie definite dall'utente, aiutando a prevenire qualsiasi operazione su K8s che l'amministratore non desidera."),(0,n.kt)("p",null,"Casbin \xe8 una potente e efficiente libreria open-source per il controllo degli accessi. Fornisce supporto per l'applicazione dell'autorizzazione basata su vari modelli di controllo degli accessi. Per maggiori dettagli su Casbin, consulta ",(0,n.kt)("a",{parentName:"p",href:"/docs/overview"},"Panoramica"),"."),(0,n.kt)("p",null,"I webhook di ammissione in K8s sono callback HTTP che ricevono richieste di ammissione e fanno qualcosa con esse. In particolare, K8s-Gatekeeper \xe8 un tipo speciale di webhook di ammissione: 'ValidatingAdmissionWebhook', che pu\xf2 decidere se accettare o rifiutare questa richiesta di ammissione o meno. Per quanto riguarda le richieste di ammissione, sono richieste HTTP che descrivono un'operazione su risorse specifiche di K8s (ad esempio, la creazione/eliminazione di una distribuzione). Per ulteriori informazioni sui webhook di ammissione, consulta la ",(0,n.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#what-are-admission-webhooks"},"documentazione ufficiale di K8s"),"."),(0,n.kt)("h3",{id:"12-un-esempio-illustrativo-di-come-funziona"},"1.2 Un Esempio Illustrativo di Come Funziona"),(0,n.kt)("p",null,"Ad esempio, quando qualcuno desidera creare un deployment contenente un pod che esegue nginx (utilizzando kubectl o i client K8s), K8s generer\xe0 una richiesta di ammissione, che (se tradotta in formato YAML) potrebbe essere simile a questa:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.1\n        ports:\n        - containerPort: 80\n")),(0,n.kt)("p",null,"Questa richiesta passer\xe0 attraverso il processo di tutti i middleware mostrati nell'immagine, incluso il nostro K8s-Gatekeeper. K8s-Gatekeeper pu\xf2 rilevare tutti gli enforcer di Casbin memorizzati in etcd di K8s, che viene creato e mantenuto dall'utente (tramite ",(0,n.kt)("inlineCode",{parentName:"p"},"kubectl")," o il client Go che forniamo). Ogni enforcer contiene un modello Casbin e una politica Casbin. La richiesta di ammissione sar\xe0 elaborata da ogni enforcer, uno alla volta, e solo superando tutti gli enforcer una richiesta pu\xf2 essere accettata da questo K8s-Gatekeeper."),(0,n.kt)("p",null,"(Se non capisci cosa sia un enforcer Casbin, un modello o una politica, consulta questo documento: ",(0,n.kt)("a",{parentName:"p",href:"/docs/get-started"},"Iniziare"),")."),(0,n.kt)("p",null,"Ad esempio, per qualche motivo, l'amministratore vuole vietare l'uso dell'immagine 'nginx:1.14.1' mentre permette 'nginx:1.3.1'. Pu\xf2 essere creato un enforcer contenente la seguente regola e politica (Spiegheremo come creare un enforcer, cosa siano questi modelli e politiche e come scriverli nel seguente capitolo)."),(0,n.kt)("p",null,"Model:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},'[request_definition]\nr =  obj\n\n[policy_definition]\np =  obj,eft\n\n[policy_effect]\ne = !some(where (p.eft == deny))\n\n[matchers]\nm = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\naccess(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Image") == p.obj\n\n')),(0,n.kt)("p",null,"Policy:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-csv"},'p, "nginx:1.13.1",allow\np, "nginx:1.14.1",deny\n')),(0,n.kt)("p",null,"Creando un enforcer contenente il modello e la politica sopra menzionati, la precedente richiesta di ammissione verr\xe0 rifiutata da questo enforcer, il che significa che K8s non creer\xe0 questo deployment."),(0,n.kt)("h2",{id:"2-installa-k8s-gatekeeper"},"2 Installa K8s-gatekeeper"),(0,n.kt)("p",null,"Esistono tre metodi disponibili per l'installazione di K8s-gatekeeper: Webhook esterno, Webhook interno e Helm."),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"Nota: Questi metodi sono destinati solo agli utenti che desiderano provare K8s-gatekeeper e non sono sicuri. Se desideri utilizzarlo in un ambiente produttivo, ti preghiamo di assicurarti di aver letto ",(0,n.kt)("a",{parentName:"p",href:"#5-impostazioni-avanzate"},"Capitolo 5. Impostazioni avanzate")," e di apportare eventuali modifiche necessarie prima dell'installazione.")),(0,n.kt)("h3",{id:"21-webhook-interno"},"2.1 Webhook interno"),(0,n.kt)("h4",{id:"211-passo-1-costruire-limmagine"},"2.1.1 Passo 1: Costruire l'immagine"),(0,n.kt)("p",null,"Per il metodo del webhook interno, il webhook stesso sar\xe0 implementato come servizio all'interno di Kubernetes. Per creare il servizio e la distribuzione necessari, \xe8 necessario creare un'immagine di K8s-gatekeeper. Puoi creare la tua immagine eseguendo il seguente comando:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"docker build --target webhook -t k8s-gatekeeper .\n")),(0,n.kt)("p",null,"Questo comando creer\xe0 un'immagine locale chiamata 'k8s-gatekeeper:latest'."),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"Nota: Se stai utilizzando minikube, esegui ",(0,n.kt)("inlineCode",{parentName:"p"},"eval $(minikube -p minikube docker-env)")," prima di eseguire 'docker build'.")),(0,n.kt)("h4",{id:"212-passo-2-configurare-servizi-e-distribuzioni-per-k8s-gatekeeper"},"2.1.2 Passo 2: Configurare servizi e distribuzioni per K8s-gatekeeper"),(0,n.kt)("p",null,"Esegui i seguenti comandi:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl apply -f config/rbac.yaml\nkubectl apply -f config/webhook_deployment.yaml \nkubectl apply -f config/webhook_internal.yaml \n")),(0,n.kt)("p",null,"Questo far\xe0 partire l'esecuzione di K8s-gatekeeper, e puoi confermarlo eseguendo ",(0,n.kt)("inlineCode",{parentName:"p"},"kubectl get pods"),"."),(0,n.kt)("h4",{id:"213-passo-3-installare-le-risorse-crd-per-k8s-gatekeeper"},"2.1.3 Passo 3: Installare le risorse CRD per K8s-gatekeeper"),(0,n.kt)("p",null,"Esegui i seguenti comandi:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl apply -f config/auth.casbin.org_casbinmodels.yaml \nkubectl apply -f config/auth.casbin.org_casbinpolicies.yaml\n")),(0,n.kt)("h3",{id:"22-webhook-esterno"},"2.2 Webhook esterno"),(0,n.kt)("p",null,"Per il metodo del webhook esterno, K8s-gatekeeper sar\xe0 in esecuzione al di fuori di Kubernetes, e Kubernetes acceder\xe0 a K8s-gatekeeper come farebbe per un sito web regolare. Kubernetes ha un requisito obbligatorio che il webhook di ammissione deve essere HTTPS. A scopo di prova di K8s-gatekeeper, abbiamo fornito un set di certificati e una chiave privata (anche se questo non \xe8 sicuro). Se preferisci utilizzare il tuo certificato, consulta ",(0,n.kt)("a",{parentName:"p",href:"#5-impostazioni-avanzate"},"Capitolo 5. Impostazioni avanzate")," per istruzioni su come regolare il certificato e la chiave privata."),(0,n.kt)("p",null,"Il certificato che forniamo \xe8 emesso per 'webhook.domain.local'. Quindi, modifica l'host (ad esempio, /etc/hosts) e indirizza 'webhook.domain.local' all'indirizzo IP su cui K8s-gatekeeper \xe8 in esecuzione."),(0,n.kt)("p",null,"Quindi esegui il seguente comando:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"go mod tidy\ngo mod vendor\ngo run cmd/webhook/main.go\nkubectl apply -f config/auth.casbin.org_casbinmodels.yaml \nkubectl apply -f config/auth.casbin.org_casbinpolicies.yaml\nkubectl apply -f config/webhook_external.yaml \n")),(0,n.kt)("h3",{id:"23-installa-k8s-gatekeeper-tramite-helm"},"2.3 Installa K8s-gatekeeper tramite Helm"),(0,n.kt)("h4",{id:"231-passo-1-costruisci-limmagine"},"2.3.1 Passo 1: Costruisci l'immagine"),(0,n.kt)("p",null,"Si prega di fare riferimento a ",(0,n.kt)("a",{parentName:"p",href:"#211-step-1-build-the-image"},"Capitolo 2.1.1"),"."),(0,n.kt)("h4",{id:"232-installazione-di-helm"},"2.3.2 Installazione di Helm"),(0,n.kt)("p",null,"Esegui il comando ",(0,n.kt)("inlineCode",{parentName:"p"},"helm install k8sgatekeeper ./k8sgatekeeper"),"."),(0,n.kt)("h2",{id:"3-prova-k8s-gatekeeper"},"3. Prova K8s-gatekeeper"),(0,n.kt)("h3",{id:"31-creare-modello-e-policy-di-casbin"},"3.1 Creare Modello e Policy di Casbin"),(0,n.kt)("p",null,"Hai due metodi per creare un modello e una policy: tramite kubectl o tramite il go-client che forniamo."),(0,n.kt)("h4",{id:"311-creareaggiornare-modello-e-policy-di-casbin-tramite-kubectl"},"3.1.1 Creare/Aggiornare Modello e Policy di Casbin tramite kubectl"),(0,n.kt)("p",null,"In K8s-gatekeeper, il modello di Casbin \xe8 memorizzato in una risorsa CRD chiamata 'CasbinModel'. La sua definizione si trova in ",(0,n.kt)("inlineCode",{parentName:"p"},"config/auth.casbin.org_casbinmodels.yaml"),"."),(0,n.kt)("p",null,"Ci sono esempi in ",(0,n.kt)("inlineCode",{parentName:"p"},"example/allowed_repo/model.yaml"),". Presta attenzione ai seguenti campi:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"metadata.name: il nome del modello. Questo nome DEVE essere lo stesso del nome dell'oggetto CasbinPolicy correlato a questo modello, in modo che K8s-gatekeeper possa accoppiarli e creare un enforcer."),(0,n.kt)("li",{parentName:"ul"},'spec.enable: se questo campo \xe8 impostato su "false", questo modello (cos\xec come l\'oggetto CasbinPolicy correlato a questo modello) sar\xe0 ignorato.'),(0,n.kt)("li",{parentName:"ul"},"spec.modelText: una stringa che contiene il testo del modello di un modello Casbin.")),(0,n.kt)("p",null,"La Politica Casbin \xe8 memorizzata in un'altra risorsa CRD chiamata 'CasbinPolicy', la cui definizione pu\xf2 essere trovata in ",(0,n.kt)("inlineCode",{parentName:"p"},"config/auth.casbin.org_casbinpolicies.yaml"),"."),(0,n.kt)("p",null,"Ci sono esempi in ",(0,n.kt)("inlineCode",{parentName:"p"},"example/allowed_repo/policy.yaml"),". Presta attenzione ai seguenti campi:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"metadata.name: il nome della politica. Questo nome DEVE essere identico al nome dell'oggetto CasbinModel correlato a questa policy, in modo che K8s-gatekeeper possa accoppiarli e creare un enforcer."),(0,n.kt)("li",{parentName:"ul"},"spec.policyItem: una stringa che contiene il testo della policy di un modello Casbin.")),(0,n.kt)("p",null,"Dopo aver creato i tuoi file CasbinModel e CasbinPolicy, utilizza il seguente comando per applicarli:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl apply -f <filename>\n")),(0,n.kt)("p",null,"Una volta creato un accoppiamento di CasbinModel e CasbinPolicy, K8s-gatekeeper sar\xe0 in grado di rilevarlo entro 5 secondi."),(0,n.kt)("h4",{id:"312-creareaggiornare-il-modello-e-la-policy-casbin-tramite-il-go-client-che-forniamo"},"3.1.2 Creare/Aggiornare il Modello e la Policy Casbin tramite il go-client che forniamo"),(0,n.kt)("p",null,"Capiamo che potrebbero esserci situazioni in cui non \xe8 conveniente utilizzare la shell per eseguire comandi direttamente su un nodo del cluster K8s, come quando si sta costruendo una piattaforma cloud automatica per la tua azienda. Pertanto, abbiamo sviluppato un go-client per creare e mantenere CasbinModel e CasbinPolicy."),(0,n.kt)("p",null,"La libreria go-client si trova in ",(0,n.kt)("inlineCode",{parentName:"p"},"pkg/client"),"."),(0,n.kt)("p",null,"In ",(0,n.kt)("inlineCode",{parentName:"p"},"client.go"),", forniamo una funzione per creare un client."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},"func NewK8sGateKeeperClient(externalClient bool) (*K8sGateKeeperClient, error) \n")),(0,n.kt)("p",null,"Il parametro ",(0,n.kt)("inlineCode",{parentName:"p"},"externalClient")," determina se K8s-gatekeeper \xe8 in esecuzione all'interno del cluster K8s o meno."),(0,n.kt)("p",null,"In ",(0,n.kt)("inlineCode",{parentName:"p"},"model.go"),", forniamo varie funzioni per creare, eliminare e modificare CasbinModel. Puoi scoprire come utilizzare queste interfacce in ",(0,n.kt)("inlineCode",{parentName:"p"},"model_test.go"),"."),(0,n.kt)("p",null,"In ",(0,n.kt)("inlineCode",{parentName:"p"},"policy.go"),", forniamo varie funzioni per creare, eliminare e modificare CasbiPolicy. Puoi scoprire come utilizzare queste interfacce in ",(0,n.kt)("inlineCode",{parentName:"p"},"policy_test.go"),"."),(0,n.kt)("h3",{id:"312-prova-se-k8s-gatekeeper-funziona"},"3.1.2 Prova se K8s-gatekeeper funziona"),(0,n.kt)("p",null,"Supponiamo che tu abbia gi\xe0 creato il modello e la politica esatti in ",(0,n.kt)("inlineCode",{parentName:"p"},"example/allowed_repo"),". Ora, prova il seguente comando:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl apply -f example/allowed_repo/testcase/reject_1.yaml\n")),(0,n.kt)("p",null,"Dovresti scoprire che K8s rifiuter\xe0 questa richiesta e menzioner\xe0 che il webhook \xe8 il motivo per cui questa richiesta \xe8 stata rifiutata. Tuttavia, quando provi ad applicare ",(0,n.kt)("inlineCode",{parentName:"p"},"example/allowed_repo/testcase/approve_2.yaml"),", sar\xe0 accettato."),(0,n.kt)("h2",{id:"4-come-scrivere-modelli-e-politiche-con-k8s-gatekeeper"},"4. Come Scrivere Modelli e Politiche con K8s-gatekeeper"),(0,n.kt)("p",null,"Prima di tutto, assicurati di essere familiare con la grammatica di base dei Modelli e delle Politiche di Casbin. Se non lo sei, per favore leggi prima la sezione ",(0,n.kt)("a",{parentName:"p",href:"/docs/get-started"},"Iniziare"),". In questo capitolo, supponiamo che tu gi\xe0 comprenda cosa sono i Modelli e le Politiche di Casbin."),(0,n.kt)("h3",{id:"41-definizione-della-richiesta-del-modello"},"4.1 Definizione della Richiesta del Modello"),(0,n.kt)("p",null,"Quando K8s-gatekeeper autorizza una richiesta, l'input \xe8 sempre un oggetto: l'oggetto Go della Richiesta di Admissione. Ci\xf2 significa che l'enforcer sar\xe0 sempre utilizzato in questo modo:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-go"},"ok, err := enforcer.Enforce(admission)\n")),(0,n.kt)("p",null,"dove ",(0,n.kt)("inlineCode",{parentName:"p"},"admission")," \xe8 un oggetto ",(0,n.kt)("inlineCode",{parentName:"p"},"AdmissionReview")," definito dall'API ufficiale di Go di K8s ",(0,n.kt)("inlineCode",{parentName:"p"},'"k8s.io/api/admission/v1"'),". Puoi trovare la definizione di questa struct in questo repository: ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/api/blob/master/admission/v1/types.go"},"https://github.com/kubernetes/api/blob/master/admission/v1/types.go"),". Per ulteriori informazioni, puoi anche fare riferimento a ",(0,n.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response"},"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response"),"."),(0,n.kt)("p",null,"Pertanto, per qualsiasi modello utilizzato da K8s-gatekeeper, la definizione di ",(0,n.kt)("inlineCode",{parentName:"p"},"request_definition")," dovrebbe sempre essere come questa:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},"    [request_definition]\n    r =  obj\n")),(0,n.kt)("p",null,"Il nome 'obj' non \xe8 obbligatorio, purch\xe9 il nome sia coerente con il nome utilizzato nella parte ",(0,n.kt)("inlineCode",{parentName:"p"},"[matchers]"),"."),(0,n.kt)("h3",{id:"42-matchers-del-modello"},"4.2 Matchers del Modello"),(0,n.kt)("p",null,"Si suppone che si utilizzi la funzionalit\xe0 ABAC di Casbin per scrivere le proprie regole. Tuttavia, l'evaluator di espressioni integrato in Casbin non supporta l'indicizzazione in mappe o array (slice), n\xe9 l'espansione di array. Pertanto, K8s-gatekeeper fornisce varie 'funzioni Casbin' come estensioni per implementare queste funzionalit\xe0. Se ritieni che la tua richiesta non possa essere soddisfatta da queste estensioni, sentiti libero di aprire un problema (issue) o creare una richiesta di pull (pull request)."),(0,n.kt)("p",null,"Se non sei familiare con le funzioni Casbin, puoi fare riferimento a ",(0,n.kt)("a",{parentName:"p",href:"/docs/function"},"Funzione")," per ulteriori informazioni."),(0,n.kt)("p",null,"Ecco le funzioni di estensione:"),(0,n.kt)("h3",{id:"421-funzioni-di-estensione"},"4.2.1 Funzioni di Estensione"),(0,n.kt)("h4",{id:"4211-access"},"4.2.1.1 access"),(0,n.kt)("p",null,"Access viene utilizzato per risolvere il problema che Casbin non supporta l'indicizzazione in mappe o array. L'esempio ",(0,n.kt)("inlineCode",{parentName:"p"},"example/allowed_repo/model.yaml")," dimostra l'uso di questa funzione:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},'[matchers]\nm = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\naccess(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Image") == p.obj\n')),(0,n.kt)("p",null,"In questo matcher, ",(0,n.kt)("inlineCode",{parentName:"p"},'access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Image")')," \xe8 equivalente a ",(0,n.kt)("inlineCode",{parentName:"p"},"r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Image"),", dove ",(0,n.kt)("inlineCode",{parentName:"p"},"r.obj.Request.Object.Object.Spec.Template.Spec.Containers")," \xe8 una slice."),(0,n.kt)("p",null,"Access pu\xf2 anche chiamare funzioni semplici che non hanno parametri e restituiscono un singolo valore. L'esempio ",(0,n.kt)("inlineCode",{parentName:"p"},"example/container_resource_limit/model.yaml")," dimostra questo:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},'[matchers]\n  m = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\n  parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Resources","Limits","cpu","Value")) >= parseFloat(p.cpu) && \\\n  parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Resources","Limits","memory","Value")) >= parseFloat(p.memory)\n')),(0,n.kt)("p",null,"In questo matcher, ",(0,n.kt)("inlineCode",{parentName:"p"},'access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Resources","Limits","cpu","Value")')," \xe8 equivalente a ",(0,n.kt)("inlineCode",{parentName:"p"},'r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits["cpu"].Value()'),", dove ",(0,n.kt)("inlineCode",{parentName:"p"},"r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits")," \xe8 una mappa, e ",(0,n.kt)("inlineCode",{parentName:"p"},"Value()")," \xe8 una funzione semplice che non ha parametri e restituisce un singolo valore."),(0,n.kt)("h4",{id:"4212-accesswithwildcard"},"4.2.1.2 accessWithWildcard"),(0,n.kt)("p",null,'A volte, potresti avere una richiesta del genere: tutti gli elementi in un array devono avere un prefisso "aaa". Tuttavia, Casbin non supporta i cicli ',(0,n.kt)("inlineCode",{parentName:"p"},"for"),". Con ",(0,n.kt)("inlineCode",{parentName:"p"},"accessWithWildcard"),' e la funzionalit\xe0 di "espansione mappa/slice", puoi facilmente implementare una tale richiesta.'),(0,n.kt)("p",null,"Ad esempio, supponiamo che ",(0,n.kt)("inlineCode",{parentName:"p"},"a.b.c")," sia un array ",(0,n.kt)("inlineCode",{parentName:"p"},"[aaa,bbb,ccc,ddd,eee]"),", allora il risultato di ",(0,n.kt)("inlineCode",{parentName:"p"},'accessWithWildcard(a,"b","c","*")')," sar\xe0 una slice ",(0,n.kt)("inlineCode",{parentName:"p"},"[aaa,bbb,ccc,ddd,eee]"),". Utilizzando il carattere jolly ",(0,n.kt)("inlineCode",{parentName:"p"},"*"),", la slice viene espansa."),(0,n.kt)("p",null,"Allo stesso modo, il carattere jolly pu\xf2 essere utilizzato pi\xf9 di una volta. Ad esempio, il risultato di ",(0,n.kt)("inlineCode",{parentName:"p"},'accessWithWildcard(a,"b","c","*","*")')," sar\xe0 ",(0,n.kt)("inlineCode",{parentName:"p"},"[a.b.c[0][0], a.b.c[0][1], ..., a.b.c[1][0], a.b.c[1][1], ...]"),"."),(0,n.kt)("h3",{id:"4213-funzioni-che-supportano-argomenti-a-lunghezza-variabile"},"4.2.1.3 Funzioni che supportano argomenti a lunghezza variabile"),(0,n.kt)("p",null,"Nell'espressione dell'evaluator di Casbin, quando un parametro \xe8 un array, verr\xe0 automaticamente espanso come argomento a lunghezza variabile. Utilizzando questa funzionalit\xe0 per supportare l'espansione di array/slice/mappe, abbiamo anche integrato diverse funzioni che accettano un array/slice come parametro:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"contain(): accetta pi\xf9 parametri e restituisce se qualche parametro (eccetto l'ultimo parametro) \xe8 uguale all'ultimo parametro."),(0,n.kt)("li",{parentName:"ul"},"split(a,b,c...,sep,index): restituisce una slice che contiene ",(0,n.kt)("inlineCode",{parentName:"li"},"[splits(a,sep)[index], splits(b,sep)[index], splits(a,sep)[index], ...]"),"."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"len()"),": restituisce la lunghezza dell'argomento a lunghezza variabile."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"matchRegex(a, b, c..., regex)"),": restituisce se tutti i parametri dati (",(0,n.kt)("inlineCode",{parentName:"li"},"a"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"b"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"c"),", ...) corrispondono alla regex data.")),(0,n.kt)("p",null,"Ecco un esempio in ",(0,n.kt)("inlineCode",{parentName:"p"},"example/disallowed_tag/model.yaml"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ini"},'    [matchers]\n    m = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\n    contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , "*", "Image"),":",1) , p.obj)\n')),(0,n.kt)("p",null,"Supponendo che ",(0,n.kt)("inlineCode",{parentName:"p"},'accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers, "*", "Image")')," restituisca ",(0,n.kt)("inlineCode",{parentName:"p"},'["a:b", "c:d", "e:f", "g:h"]'),", poich\xe9 splits supporta argomenti a lunghezza variabile e esegue l'operazione di split su ciascun elemento, verr\xe0 selezionato e restituito l'elemento all'indice 1. Pertanto, ",(0,n.kt)("inlineCode",{parentName:"p"},'split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers, "*", "Image"), ":", 1)')," restituisce ",(0,n.kt)("inlineCode",{parentName:"p"},'["b", "d", "f", "h"]'),". E ",(0,n.kt)("inlineCode",{parentName:"p"},'contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers, "*", "Image"), ":", 1), p.obj)')," restituisce se ",(0,n.kt)("inlineCode",{parentName:"p"},"p.obj")," \xe8 contenuto in ",(0,n.kt)("inlineCode",{parentName:"p"},'["b", "d", "f", "h"]'),"."),(0,n.kt)("h4",{id:"4212-funzioni-di-conversione-del-tipo"},"4.2.1.2 Funzioni di Conversione del Tipo"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"ParseFloat()"),": Converte un numero intero in un float (ci\xf2 \xe8 necessario perch\xe9 qualsiasi numero utilizzato in un confronto deve essere convertito in un float)."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"ToString()"),": Converte un oggetto in una stringa. Questo oggetto deve avere un tipo di base stringa (ad esempio, un oggetto di tipo ",(0,n.kt)("inlineCode",{parentName:"li"},"XXX")," quando c'\xe8 una dichiarazione ",(0,n.kt)("inlineCode",{parentName:"li"},"type XXX string"),")."),(0,n.kt)("li",{parentName:"ul"},"IsNil(): Restituisce se il parametro \xe8 nil.")),(0,n.kt)("h2",{id:"5-impostazioni-avanzate"},"5. Impostazioni Avanzate"),(0,n.kt)("h3",{id:"51-informazioni-sui-certificati"},"5.1 Informazioni sui Certificati"),(0,n.kt)("p",null,"In Kubernetes (k8s), \xe8 obbligatorio che un webhook utilizzi HTTPS. Ci sono due approcci per raggiungere questo obiettivo:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Utilizzare certificati autofirmati (gli esempi in questo repository utilizzano questo metodo)"),(0,n.kt)("li",{parentName:"ul"},"Utilizzare un certificato normale")),(0,n.kt)("h4",{id:"511-certificati-autofirmati"},"5.1.1 Certificati autofirmati"),(0,n.kt)("p",null,"Utilizzare un certificato autofirmato significa che l'Autorit\xe0 di Certificazione (CA) che emette il certificato non \xe8 una delle CA ben note. Pertanto, devi far conoscere questa CA a k8s."),(0,n.kt)("p",null,"Attualmente, l'esempio in questo repository utilizza una CA autocostruita, la cui chiave privata e il certificato sono memorizzati rispettivamente in ",(0,n.kt)("inlineCode",{parentName:"p"},"config/certificate/ca.crt")," e ",(0,n.kt)("inlineCode",{parentName:"p"},"config/certificate/ca.key"),". Il certificato per il webhook \xe8 ",(0,n.kt)("inlineCode",{parentName:"p"},"config/certificate/server.crt"),', che \xe8 emesso dalla CA autocostruita. I domini di questo certificato sono "webhook.domain.local" (per il webhook esterno) e "casbin-webhook-svc.default.svc" (per il webhook interno).'),(0,n.kt)("p",null,"Le informazioni sulla CA vengono passate a k8s tramite i file di configurazione del webhook. Sia ",(0,n.kt)("inlineCode",{parentName:"p"},"config/webhook_external.yaml")," che ",(0,n.kt)("inlineCode",{parentName:"p"},"config/webhook_internal.yaml"),' hanno un campo chiamato "CABundle", che contiene una stringa codificata in base64 del certificato della CA.'),(0,n.kt)("p",null,"Nel caso in cui sia necessario modificare il certificato/dominio (ad esempio, se desideri inserire questo webhook in un altro namespace di k8s utilizzando un webhook interno, o se desideri modificare il dominio utilizzando un webhook esterno), \xe8 necessario seguire le seguenti procedure:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Generare una nuova CA:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Generare la chiave privata per la CA fittizia:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"openssl genrsa -des3 -out ca.key 2048\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Rimuovi la protezione tramite password della chiave privata:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"openssl rsa -in ca.key -out ca.key\n"))))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Genera una chiave privata per il server webhook:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"openssl genrsa -des3 -out server.key 2048\nopenssl rsa -in server.key -out server.key\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Utilizza la CA autogenerata per firmare il certificato per il webhook:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Copia il file di configurazione di openssl del tuo sistema per uso temporaneo. Puoi scoprire la posizione del file di configurazione eseguendo ",(0,n.kt)("inlineCode",{parentName:"p"},"openssl version -a"),", di solito chiamato ",(0,n.kt)("inlineCode",{parentName:"p"},"openssl.cnf"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Nel file di configurazione:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Trova il paragrafo ",(0,n.kt)("inlineCode",{parentName:"p"},"[req]")," e aggiungi la seguente riga: ",(0,n.kt)("inlineCode",{parentName:"p"},"req_extensions = v3_req"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Trova il paragrafo ",(0,n.kt)("inlineCode",{parentName:"p"},"[v3_req]")," e aggiungi la seguente riga: ",(0,n.kt)("inlineCode",{parentName:"p"},"subjectAltName = @alt_names"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Aggiungi le seguenti righe al file:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-ini"},"[alt_names]\nDNS.2=<The domain you want>\n")),(0,n.kt)("p",{parentName:"li"},"Nota: Sostituisci 'casbin-webhook-svc.default.svc' con il nome del servizio reale del tuo servizio se decidi di modificare il nome del servizio.")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Utilizza il file di configurazione modificato per generare un file di richiesta di certificato:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"openssl req -new -nodes -keyout server.key -out server.csr -config openssl.cnf\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Utilizza la CA auto-prodotta per rispondere alla richiesta e firmare il certificato:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"openssl x509 -req -days 3650 -in server.csr -out server.crt -CA ca.crt -CAkey ca.key -CAcreateserial -extensions v3_req -extensions SAN -extfile openssl.cnf\n"))))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Sostituisci il campo 'CABundle': Aggiorna questo campo con il nuovo certificato.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Se stai utilizzando helm, \xe8 necessario applicare modifiche simili ai grafici helm."))),(0,n.kt)("h4",{id:"512-certificati-legali"},"5.1.2 Certificati legali"),(0,n.kt)("p",null,'Se utilizzi certificati legali, non \xe8 necessario seguire tutte queste procedure. Rimuovi il campo "CABundle" in ',(0,n.kt)("inlineCode",{parentName:"p"},"config/webhook_external.yaml")," e ",(0,n.kt)("inlineCode",{parentName:"p"},"config/webhook_internal.yaml"),", e modifica il dominio in questi file con il dominio di tua propriet\xe0."))}u.isMDXComponent=!0}}]);