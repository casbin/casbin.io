"use strict";(globalThis.webpackChunkcasbin_website_v2=globalThis.webpackChunkcasbin_website_v2||[]).push([[6820],{2273(e,i,n){n.r(i),n.d(i,{assets:()=>a,contentTitle:()=>t,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"rbac","title":"RBAC","description":"Utilizzo di Casbin RBAC","source":"@site/i18n/it/docusaurus-plugin-content-docs/current/RBAC.mdx","sourceDirName":".","slug":"/rbac","permalink":"/it/docs/rbac","draft":false,"unlisted":false,"editUrl":"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBAC.mdx","tags":[],"version":"current","frontMatter":{"id":"rbac","title":"RBAC","description":"Utilizzo di Casbin RBAC","keywords":["RBAC","role definition","role hierarchy"],"authors":["hsluoyz"]},"sidebar":"docs","previous":{"title":"Functions","permalink":"/it/docs/function"},"next":{"title":"RBAC with Pattern","permalink":"/it/docs/rbac-with-pattern"}}');var r=n(4848),l=n(8453);const s={id:"rbac",title:"RBAC",description:"Utilizzo di Casbin RBAC",keywords:["RBAC","role definition","role hierarchy"],authors:["hsluoyz"]},t=void 0,a={},c=[{value:"Definizione del Ruolo",id:"definizione-del-ruolo",level:2},{value:"Gerarchia dei Ruoli",id:"gerarchia-dei-ruoli",level:2},{value:"Come distinguere un ruolo da un utente?",id:"come-distinguere-un-ruolo-da-un-utente",level:2},{value:"Come interrogare ruoli o permessi impliciti?",id:"come-interrogare-ruoli-o-permessi-impliciti",level:2},{value:"Utilizzo del Pattern Matching in RBAC",id:"utilizzo-del-pattern-matching-in-rbac",level:2},{value:"Gestione dei Ruoli",id:"gestione-dei-ruoli",level:2}];function d(e){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.h2,{id:"definizione-del-ruolo",children:"Definizione del Ruolo"}),"\n",(0,r.jsxs)(i.p,{children:["La ",(0,r.jsx)(i.code,{children:"[role_definition]"})," viene utilizzata per definire le relazioni di ereditariet\xe0 dei ruoli RBAC. Casbin supporta pi\xf9 istanze di sistemi RBAC, dove gli utenti possono avere ruoli e le loro relazioni di ereditariet\xe0, e le risorse possono avere ruoli e le loro relazioni di ereditariet\xe0 anche. Questi due sistemi RBAC non interferiranno l'uno con l'altro."]}),"\n",(0,r.jsx)(i.p,{children:"Questa sezione \xe8 opzionale. Se non utilizzi i ruoli RBAC nel modello, ometti questa sezione."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ini",children:"[role_definition]\ng = _, _\ng2 = _, _\n"})}),"\n",(0,r.jsxs)(i.p,{children:["La definizione di ruolo sopra mostra che ",(0,r.jsx)(i.code,{children:"g"})," \xe8 un sistema RBAC e ",(0,r.jsx)(i.code,{children:"g2"})," \xe8 un altro sistema RBAC. ",(0,r.jsx)(i.code,{children:"_,_"})," significa che ci sono due parti coinvolte in una relazione di ereditariet\xe0. Nel caso pi\xf9 comune, di solito utilizzi ",(0,r.jsx)(i.code,{children:"g"})," da solo se hai bisogno solo di ruoli per gli utenti. Puoi anche utilizzare sia ",(0,r.jsx)(i.code,{children:"g"})," che ",(0,r.jsx)(i.code,{children:"g2"})," quando hai bisogno di ruoli (o gruppi) sia per utenti che per risorse. Per favore, consulta ",(0,r.jsx)(i.a,{href:"https://github.com/casbin/casbin/blob/master/examples/rbac_model.conf",children:"rbac_model.conf"})," e ",(0,r.jsx)(i.a,{href:"https://github.com/casbin/casbin/blob/master/examples/rbac_with_resource_roles_model.conf",children:"rbac_model_with_resource_roles.conf"})," per esempi."]}),"\n",(0,r.jsx)(i.p,{children:"Casbin memorizza il mapping effettivo utente-ruolo (o mapping risorsa-ruolo se stai utilizzando ruoli su risorse) nella policy. Per esempio:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-csv",children:"p, data2_admin, data2, read\ng, alice, data2_admin\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Significa che ",(0,r.jsx)(i.code,{children:"alice"})," eredita/\xe8 membro del ruolo ",(0,r.jsx)(i.code,{children:"data2_admin"}),". Qui, ",(0,r.jsx)(i.code,{children:"alice"})," pu\xf2 essere un utente, una risorsa o un ruolo. Casbin riconosce solo una stringa."]}),"\n",(0,r.jsx)(i.p,{children:"Quindi, in un matcher, dovresti controllare il ruolo come mostrato di seguito:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ini",children:"[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Significa che il ",(0,r.jsx)(i.code,{children:"sub"})," nella richiesta deve avere il ruolo ",(0,r.jsx)(i.code,{children:"sub"})," nella policy."]}),"\n",(0,r.jsx)(i.admonition,{type:"note",children:(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"Casbin memorizza solo il mapping utente-ruolo."}),"\n",(0,r.jsx)(i.li,{children:"Casbin non verifica se un utente \xe8 un utente valido o un ruolo \xe8 un ruolo valido. Questo dovrebbe essere gestito dall'autenticazione."}),"\n",(0,r.jsxs)(i.li,{children:["Non utilizzare lo stesso nome per un utente e un ruolo all'interno di un sistema RBAC, perch\xe9 Casbin riconosce utenti e ruoli come stringhe e non c'\xe8 modo per Casbin di sapere se stai specificando l'utente ",(0,r.jsx)(i.code,{children:"alice"})," o il ruolo ",(0,r.jsx)(i.code,{children:"alice"}),". Puoi risolverlo semplicemente usando ",(0,r.jsx)(i.code,{children:"role_alice"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Se ",(0,r.jsx)(i.code,{children:"A"})," ha il ruolo ",(0,r.jsx)(i.code,{children:"B"})," e ",(0,r.jsx)(i.code,{children:"B"})," ha il ruolo ",(0,r.jsx)(i.code,{children:"C"}),", allora ",(0,r.jsx)(i.code,{children:"A"})," ha il ruolo ",(0,r.jsx)(i.code,{children:"C"}),". Questa transitivit\xe0 \xe8 infinita per ora."]}),"\n"]})}),"\n",(0,r.jsxs)(i.admonition,{title:"Convenzione del Nome del Token",type:"info",children:[(0,r.jsxs)(i.p,{children:["Convenzionalmente, il nome del token del soggetto nella definizione della politica \xe8 ",(0,r.jsx)(i.code,{children:"sub"})," e viene posizionato all'inizio. Ora, Golang Casbin supporta nomi e posizioni personalizzati per i token. Se il nome del token del soggetto \xe8 ",(0,r.jsx)(i.code,{children:"sub"}),", il token del soggetto pu\xf2 essere posizionato in un luogo arbitrario senza bisogno di azioni aggiuntive. Se il nome del token del soggetto non \xe8 ",(0,r.jsx)(i.code,{children:"sub"}),", ",(0,r.jsx)(i.code,{children:"e.SetFieldIndex()"})," per ",(0,r.jsx)(i.code,{children:"constant.SubjectIndex"})," dovrebbe essere chiamato dopo l'inizializzazione dell'enforcer, indipendentemente dalla sua posizione."]}),(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ini",children:"# `subject` here is for sub\n[policy_definition]\np =  obj, act, subject\n"})}),(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-go",children:'e.SetFieldIndex("p", constant.SubjectIndex, 2) // index starts from 0\nok, err := e.DeleteUser("alice") // without SetFieldIndex, it will raise an error\n'})})]}),"\n",(0,r.jsx)(i.h2,{id:"gerarchia-dei-ruoli",children:"Gerarchia dei Ruoli"}),"\n",(0,r.jsxs)(i.p,{children:["Casbin supporta la funzionalit\xe0 di gerarchia dei ruoli di RBAC1, il che significa che se ",(0,r.jsx)(i.code,{children:"alice"})," ha ",(0,r.jsx)(i.code,{children:"role1"}),", e ",(0,r.jsx)(i.code,{children:"role1"})," ha ",(0,r.jsx)(i.code,{children:"role2"}),", allora ",(0,r.jsx)(i.code,{children:"alice"})," avr\xe0 anche ",(0,r.jsx)(i.code,{children:"role2"})," e erediter\xe0 i suoi permessi."]}),"\n",(0,r.jsxs)(i.p,{children:["Qui, abbiamo un concetto chiamato livello di gerarchia. Quindi, in questo esempio, il livello di gerarchia \xe8 2. Per il gestore dei ruoli integrato in Casbin, puoi specificare il livello massimo di gerarchia. Il valore predefinito \xe8 10. Ci\xf2 significa che un utente finale come ",(0,r.jsx)(i.code,{children:"alice"})," pu\xf2 ereditare solo 10 livelli di ruoli."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-go",children:"// NewRoleManager is the constructor for creating an instance of the\n// default RoleManager implementation.\nfunc NewRoleManager(maxHierarchyLevel int) rbac.RoleManager {\n    rm := RoleManager{}\n    rm.allRoles = &sync.Map{}\n    rm.maxHierarchyLevel = maxHierarchyLevel\n    rm.hasPattern = false\n\n    return &rm\n}\n"})}),"\n",(0,r.jsx)(i.h2,{id:"come-distinguere-un-ruolo-da-un-utente",children:"Come distinguere un ruolo da un utente?"}),"\n",(0,r.jsxs)(i.p,{children:["Casbin non distingue tra ruoli e utenti nel suo RBAC. Entrambi sono trattati come stringhe. Se utilizzi solo un RBAC a livello singolo (dove un ruolo non sar\xe0 mai membro di un altro ruolo), puoi usare ",(0,r.jsx)(i.code,{children:"e.GetAllSubjects()"})," per ottenere tutti gli utenti e ",(0,r.jsx)(i.code,{children:"e.GetAllRoles()"})," per ottenere tutti i ruoli. Elencheranno tutti ",(0,r.jsx)(i.code,{children:"u"})," e tutti ",(0,r.jsx)(i.code,{children:"r"}),", rispettivamente, in tutte le regole ",(0,r.jsx)(i.code,{children:"g, u, r"}),"."]}),"\n",(0,r.jsxs)(i.p,{children:["Ma se stai utilizzando un RBAC a pi\xf9 livelli (con gerarchia dei ruoli) e la tua applicazione non registra se un nome (stringa) \xe8 un utente o un ruolo, o hai un utente e un ruolo con lo stesso nome, puoi aggiungere un prefisso al ruolo come ",(0,r.jsx)(i.code,{children:"role::admin"})," prima di passarlo a Casbin. In questo modo, saprai se si tratta di un ruolo controllando questo prefisso."]}),"\n",(0,r.jsx)(i.h2,{id:"come-interrogare-ruoli-o-permessi-impliciti",children:"Come interrogare ruoli o permessi impliciti?"}),"\n",(0,r.jsxs)(i.p,{children:['Quando un utente eredita un ruolo o un permesso attraverso la gerarchia RBAC invece di essere assegnato direttamente in una regola di politica, chiamiamo questo tipo di assegnazione "implicita". Per interrogare tali relazioni implicite, \xe8 necessario utilizzare queste due API: ',(0,r.jsx)(i.code,{children:"GetImplicitRolesForUser()"})," e ",(0,r.jsx)(i.code,{children:"GetImplicitPermissionsForUser()"})," invece di ",(0,r.jsx)(i.code,{children:"GetRolesForUser()"})," e ",(0,r.jsx)(i.code,{children:"GetPermissionsForUser()"}),". Per maggiori dettagli, si prega di vedere ",(0,r.jsx)(i.a,{href:"https://github.com/casbin/casbin/issues/137",children:"questo problema GitHub"}),"."]}),"\n",(0,r.jsx)(i.h2,{id:"utilizzo-del-pattern-matching-in-rbac",children:"Utilizzo del Pattern Matching in RBAC"}),"\n",(0,r.jsxs)(i.p,{children:["Vedere ",(0,r.jsx)(i.a,{href:"/docs/rbac-with-pattern",children:"RBAC con Pattern"})]}),"\n",(0,r.jsx)(i.h2,{id:"gestione-dei-ruoli",children:"Gestione dei Ruoli"}),"\n",(0,r.jsxs)(i.p,{children:["Vedere la sezione ",(0,r.jsx)(i.a,{href:"/docs/role-managers",children:"Gestione dei Ruoli"})," per i dettagli."]})]})}function u(e={}){const{wrapper:i}={...(0,l.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,i,n){n.d(i,{R:()=>s,x:()=>t});var o=n(6540);const r={},l=o.createContext(r);function s(e){const i=o.useContext(l);return o.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function t(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(l.Provider,{value:i},e.children)}}}]);