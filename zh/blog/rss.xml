<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Casbin Blog</title>
        <link>https://casbin.org/zh/blog</link>
        <description>Casbin Blog</description>
        <lastBuildDate>Thu, 19 Aug 2021 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh</language>
        <item>
            <title><![CDATA[使用 Casbin 在 APISX 中授权]]></title>
            <link>https://casbin.org/zh/blog/2021/08/19/apisix-casbin-authorization</link>
            <guid>https://casbin.org/zh/blog/2021/08/19/apisix-casbin-authorization</guid>
            <pubDate>Thu, 19 Aug 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[简介]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="简介">简介<a href="#简介" class="hash-link" aria-label="Direct link to 简介" title="Direct link to 简介">​</a></h2><p><a href="https://apisix.apache.org/" target="_blank" rel="noopener noreferrer">APISIX</a> 是一个基于Nginx 等的高性能和可缩放云端本地的 API 网关。 这是Apache Software 基金会的一个开放源码项目。 除此以外，APIIX 非常好的是在可以用于实现认证等功能的插件中建立的许多强大的支持。 监视、路由等。 APISIX中的插件被热重新加载(未重启) 这一事实使其非常活跃。</p><p>但在使用 APISIX时，可能会出现您想要在应用程序中添加复杂的授权逻辑的情况。 Authz-casbin可能会帮助您。 authz-casbin 是基于 <a href="https://github.com/casbin/lua-casbin/" target="_blank" rel="noopener noreferrer">Lua Casbin</a> 的APIIX 插件，它允许基于各种访问控制模型的强大授权。 <a href="/zh/">Casbin</a> is an authorization library which supports access control models like ACL, RBAC, ABAC. 它最初是用Go编写的，已被移植到许多语言，Lua Casbin是Casbin的Lua实现。 Authz-casbin的开发始于我们在APISIX 存储库中提出了一个新的授权插件(<a href="https://github.com/apache/apisix/issues/4674" target="_blank" rel="noopener noreferrer">#4674</a>)，核心成员同意了这个插件。 经过一些有助益的审查导致了一些重大变化和改进，最终合并了PR (<a href="https://github.com/apache/apisix/pull/4710" target="_blank" rel="noopener noreferrer">#4710</a>)。</p><p>在这个博客中， 我们将使用authz-casbin 插件来显示您如何在 APISIX中实现基于角色访问控制的授权模式。</p><p><strong>备注</strong>: 您将需要使用其他插件或自定义工作流来验证用户，因为Casbin只会进行授权而不是身份验证。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建模型">创建模型<a href="#创建模型" class="hash-link" aria-label="Direct link to 创建模型" title="Direct link to 创建模型">​</a></h2><p>插件使用三个参数授权任何请求 - 主题(subject)、对象(object) 和动作(action)。 这里的主题是用户名头的值，可能是 <code>[用户名：别名]</code>。 然后，对象是正在访问的 URL 路径和正在使用的请求方法。</p><p>让我们说我们想要在路径上用三个资源创建一个模型 - <code>/</code> <code>/res1</code> 和 <code>/res2</code>。 我们希望有这样的模式：</p><p><img loading="lazy" src="https://i.imgur.com/7BlvBNR.png" alt="图像" class="img_ev3q"></p><p>这将意味着所有用户 (<code>*</code>) 都像 <code>jack</code> 可以访问首页 (<code>/</code>)。 并且拥有 <code>管理员</code> 权限的用户，比如 `<code>和</code>bob<code>可以访问所有页面和资源 (例如</code>res1<code>和</code>res2<code>)。 另外，让我们限制没有任何管理员权限的用户仅使用 </code>GET` 请求方法。 在这种情况下，我们可以将模式定义为：</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">sub, obj, act</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">sub, obj, act</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">role_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">g</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">_, _</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">some(where (p.eft == allow))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">(g(r.sub, p.sub) || keyMatch(r.sub, p.sub)) &amp;&amp; keyMatch(r.obj, p.obj) &amp;&amp; keyMatch(r.act, p.act)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建策略">创建策略<a href="#创建策略" class="hash-link" aria-label="Direct link to 创建策略" title="Direct link to 创建策略">​</a></h2><p>根据上述设想，策略将是：</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> *</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> /</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> GET</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> admin</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> *</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> *</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token value">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> alice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> admin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token value">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> bob</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> admin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>来自模型的匹配器是指：</p><ol><li><code>(g(r.sub, p.sub) || keyMatch(r.sub, p.sub))</code>: 请求的主题作为策略的主题或请求的主题与策略的主题匹配 <code>keyMatch</code>。 <code>keyMatch</code> 是在 Lua Casbin 中构建的。 您可以在这里查看函数的描述和更多可能有用的函数 <a href="https://github.com/casbin/lua-casbin/blob/master/src/util/BuiltInFunctions.lua" target="_blank" rel="noopener noreferrer"></a></li><li><code>keyMatch(r.obj, p.obj)</code>: 请求的对象匹配策略的对象(URL路径在这里)。</li><li><code>keyMatch(r.act, p.act)</code>: 请求的动作与策略的动作匹配(HTTP 请求方法在这里)。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="启用路由插件">启用路由插件<a href="#启用路由插件" class="hash-link" aria-label="Direct link to 启用路由插件" title="Direct link to 启用路由插件">​</a></h2><p>创建模型和策略后，您可以使用APISIX Admin API在路由上启用它。 要使用模型和策略文件路径启用它：</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://127.0.0.1:9080/apisix/admin/routes/1 -H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -X PUT -d '</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "plugins": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "authz-casbin": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "model_path": "/path/to/model.conf",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "policy_path": "/path/to/policy.csv",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "username": "username"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "upstream": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "nodes": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "127.0.0.1:1980": 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "roundrobin"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "uri": "/*"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在这里，用户名字段是您将要在主题中传递的标题名称。 例如，如果您将通过用户名头以 <code>user: Alice</code>, 您将使用 <code>"username": "user"</code>.</p><p>对于使用模型/策略文本而不是文件，您可以使用 <code>模型</code> 和 <code>策略</code> 字段替代：</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://127.0.0.1:9080/apisix/admin/routes/1 -H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -X PUT -d '</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "plugins": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "authz-casbin": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "model": "[request_definition]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r = sub, obj, act</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [policy_definition]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            p = sub, obj, act</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [role_definition]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            g = _, _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [policy_effect]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e = some(where (p.eft == allow))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [matchers]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            m = (g(r.sub, p.sub) || keyMatch(r.sub, p.sub)) &amp;&amp; keyMatch(r.obj, p.obj) &amp;&amp; keyMatch(r.act, p.act)",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "policy": "p, *, /, GET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            p, admin, *, *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            g, alice, admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            g, bob, admin",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "username": "username"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "upstream": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "nodes": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "127.0.0.1:1980": 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "roundrobin"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "uri": "/*"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="启用使用全局模型策略的插件">启用使用全局模型/策略的插件<a href="#启用使用全局模型策略的插件" class="hash-link" aria-label="Direct link to 启用使用全局模型/策略的插件" title="Direct link to 启用使用全局模型/策略的插件">​</a></h2><p>在某些情况下，您可能希望跨多个路由使用单个模型和策略配置。 您可以首先发送<code>PUT</code>请求，通过以下方式将模型和策略配置添加到插件的元数据中：</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://127.0.0.1:9080/apisix/admin/plugin_metadata/authz-casbin -H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -i -X PUT -d '</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">"model": "[request_definition]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r = sub, obj, act</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[policy_definition]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p = sub, obj, act</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[role_definition]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g = _, _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[policy_effect]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e = some(where (p.eft == allow))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[matchers]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m = (g(r.sub, p.sub) || keyMatch(r.sub, p.sub)) &amp;&amp; keyMatch(r.obj, p.obj) &amp;&amp; keyMatch(r.act, p.act)",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">"policy": "p, *, /, GET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p, admin, *, *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g, alice, admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g, bob, admin"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后在某些路由上启用相同的配置，使用管理员API发送请求：</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://127.0.0.1:9080/apisix/admin/routes/1 -H 'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1' -X PUT -d '</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "plugins": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "authz-casbin": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "username": "username"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "upstream": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "nodes": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "127.0.0.1:1980": 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "type": "roundrobin"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "uri": "/route1/*"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这将添加插件元数据配置到路由中。 您也可以轻松地更新插件元数据配置，通过更新模型和政策配置重新发送插件元数据请求， 插件将使用插件元数据自动更新所有路由。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="应用案例">应用案例<a href="#应用案例" class="hash-link" aria-label="Direct link to 应用案例" title="Direct link to 应用案例">​</a></h2><ul><li>此插件的主要用途是在您的 API 中执行授权。 您可以轻松地将此插件添加到您正在使用的任何API路径中，并使用您的授权模型和策略配置。</li><li>如果您想要为您的所有API使用单一授权模式，您可以使用全局模式/策略方法。 这使得更新策略对所有路由都很容易，因为您只需要更新元数据等。</li><li>如果你想对每个不同的路由使用不同的模型，你可以使用路由方法。 当不同的 API 路由拥有不同的用户权限时，这是有用的。 当您处理更大的策略时，您也可以使用这个策略，因为当过滤多条路由时，它会使授权变得更快。</li></ul>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Yang Luo - 谷歌开源同行奖金得主]]></title>
            <link>https://casbin.org/zh/blog/2020/04/21/google-award</link>
            <guid>https://casbin.org/zh/blog/2020/04/21/google-award</guid>
            <pubDate>Tue, 21 Apr 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[今天，我们很高兴地宣布，Casbin 的创始人Yang Luo因其在 2019 年第三季度在 Casbin、Npcap 和 Nmap 上的工作而被授予 "谷歌开源同行奖金得主"。]]></description>
            <content:encoded><![CDATA[<p>今天，我们很高兴地宣布，Casbin 的创始人<a href="https://github.com/hsluoyz" target="_blank" rel="noopener noreferrer">Yang Luo</a>因其在 2019 年第三季度在 <a href="/zh/">Casbin</a>、<a href="https://nmap.org/npcap/" target="_blank" rel="noopener noreferrer">Npcap</a> 和 <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">Nmap</a> 上的工作而被授予 "谷歌开源同行奖金得主"。</p><p><img loading="lazy" src="https://hsluoyz.github.io/download/Open%20Source%20Peer%20Bonus%20Q3%202019%20-%20Yang%20Luo%20-%20OSPB%20Award%20Letter.png" alt="ospb" class="img_ev3q"></p><blockquote><p>原始授予信可以访问 <a href="https://github.com/hsluoyz/hsluoyz.github.io/blob/master/download/Open%20Source%20Peer%20Bonus%20Q3%202019%20-%20Yang%20Luo%20-%20OSPB%20Award%20Letter.pdf" target="_blank" rel="noopener noreferrer">这里</a>。</p></blockquote><p><a href="https://opensource.google.com/docs/growing/peer-bonus/" target="_blank" rel="noopener noreferrer">谷歌开源同伴奖金</a>计划被描述为：</p><blockquote><p><em>正如谷歌同伴奖金用于表彰超越一切的谷歌同事一样，开源同伴奖金也表彰对开源做出杰出贡献的外部人员。</em></p></blockquote><p>适用于 <a href="https://opensource.googleblog.com/2020/01/announcing-2019-second-cycle-google.html" target="_blank" rel="noopener noreferrer">2019 获胜者</a> 的公告可在以下网址获取：</p><blockquote><p><a href="https://opensource.googleblog.com/2020/01/announcing-2019-second-cycle-google.html" target="_blank" rel="noopener noreferrer">https://opensource.googleblog.com/2020/01/announcing-2019-second-cycle-google.html</a></p></blockquote><p>Yang 和 Casbin 被列为具有相关影响的开源开发人员和项目，如 Git、TensorFlow、V8、CPython、LLVM、Apache 项目、Angular 或 Jenkins。</p><p>我们很高兴看到 Casbin 因其对开源和云安全的贡献而获得认可！</p><p><em>感谢你！Casbin！</em></p>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[正在重新编写我们的文档]]></title>
            <link>https://casbin.org/zh/blog/2018/09/23/new-website</link>
            <guid>https://casbin.org/zh/blog/2018/09/23/new-website</guid>
            <pubDate>Sun, 23 Sep 2018 00:00:00 GMT</pubDate>
            <description><![CDATA[今天，我们已将Casbin的文档从 GitHub Wiki 迁移到此网站的 Docs 文档， 由 Docusaurus 提供支持。 Docusaurus提供了许多优秀的功能，例如更好的 Markdown风格，全文搜索，版本设置，翻译。]]></description>
            <content:encoded><![CDATA[<p>今天，我们已将Casbin的文档从 GitHub Wiki 迁移到此网站的 <code>Docs</code> 文档， 由 Docusaurus 提供支持。 Docusaurus提供了许多优秀的功能，例如更好的 Markdown风格，全文搜索，版本设置，翻译。</p><p>文件尚不完善，仍然需要调整。 源代码托管在 GitHub 上： <a href="https://github.com/casbin/casbin-website" target="_blank" rel="noopener noreferrer">https://github.com/casbin/casbin-website</a>.</p><p>欢迎任何贡献或建议！</p>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[node-Casbin：Casbin家庭新成员]]></title>
            <link>https://casbin.org/zh/blog/2018/08/27/node-casbin</link>
            <guid>https://casbin.org/zh/blog/2018/08/27/node-casbin</guid>
            <pubDate>Mon, 27 Aug 2018 00:00:00 GMT</pubDate>
            <description><![CDATA[今天，我们成功地将Casbin移植到 Node.js，命名为： node-Casbin]]></description>
            <content:encoded><![CDATA[<p>今天，我们成功地将Casbin移植到 Node.js，命名为： <a href="https://github.com/casbin/node-casbin" target="_blank" rel="noopener noreferrer">node-Casbin</a></p><p><strong>node-Casbin</strong> 分享了类似的用法和 API 与其他Casbin 的实现。 Express、 Koa2 和 Egg.js 的中间件已准备好使用 。 序列化的存储适配器也已准备好。</p><p>希望它能够很好地满足您的需要:)</p><p>GitHub: <a href="https://github.com/casbin/node-casbin" target="_blank" rel="noopener noreferrer">https://github.com/casbin/node-casbin</a></p>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Casbin 服务器已启动！]]></title>
            <link>https://casbin.org/zh/blog/2018/08/07/launching-casbin-server</link>
            <guid>https://casbin.org/zh/blog/2018/08/07/launching-casbin-server</guid>
            <pubDate>Tue, 07 Aug 2018 00:00:00 GMT</pubDate>
            <description><![CDATA[我们的一些客户询问Casbin是否可以用作服务而不是图书馆。 答案是 当然可以。 今天，我们启动了 Casbin Server 项目，作为 访问控制作为服务 的具体解决方案。]]></description>
            <content:encoded><![CDATA[<p>我们的一些客户询问Casbin是否可以用作服务而不是图书馆。 答案是 <strong>当然可以</strong>。 今天，我们启动了 <a href="https://github.com/casbin/casbin-server" target="_blank" rel="noopener noreferrer">Casbin Server</a> 项目，作为 <strong>访问控制作为服务</strong> 的具体解决方案。</p><p><strong>Casbin Server</strong> 正在由我们的核心团队积极开发。 它有以下几个特点：</p><ul><li>纯粹是由Golang开发的。</li><li>可以管理数以千计的 Casbin 实例，这样您就可以将策略执行逻辑从多个服务移动到一个Casbin 服务器。</li><li><strong>gRPC</strong> 被用于与 Casbin 服务器通信。 我们还考虑在不久的将来添加 <strong>RESTTful</strong> 支持。</li><li>为非开发者管理员提供了一个友好的网站管理员门户，用于管理所有细节，如Casbin实例、模型、政策存储和负载平衡。</li></ul><p>源代码托管在 GitHub 上： <a href="https://github.com/casbin/casbin-server" target="_blank" rel="noopener noreferrer">https://github.com/casbin/casbin-server</a></p><p>欢迎任何问题或合并请求 :)</p>]]></content:encoded>
        </item>
    </channel>
</rss>