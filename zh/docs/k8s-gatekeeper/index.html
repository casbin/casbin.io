<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-k8s-gatekeeper" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Admission Webhook for K8s | Casbin</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://casbin.org/zh/docs/k8s-gatekeeper"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="Casbin" content="An authorization library that supports access control models like ACL, RBAC, ABAC for Golang, Java, C/C++, Node.js, Javascript, PHP, Laravel, Python, .NET (C#), Delphi, Rust, Ruby, Swift (Objective-C), Lua (OpenResty), Dart (Flutter) and Elixir"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Admission Webhook for K8s | Casbin"><meta data-rh="true" name="description" content="基於 Casbin 的 Kubernetes (K8s) RBAC 與 ABAC 授權中介軟體"><meta data-rh="true" property="og:description" content="基於 Casbin 的 Kubernetes (K8s) RBAC 與 ABAC 授權中介軟體"><meta data-rh="true" name="keywords" content="k8s-gatekeeper,Kubernetes,K8s"><link data-rh="true" rel="icon" href="/zh/img/favicon.png"><link data-rh="true" rel="canonical" href="https://casbin.org/zh/docs/k8s-gatekeeper"><link data-rh="true" rel="alternate" href="https://casbin.org/docs/k8s-gatekeeper" hreflang="en"><link data-rh="true" rel="alternate" href="https://casbin.org/zh/docs/k8s-gatekeeper" hreflang="zh"><link data-rh="true" rel="alternate" href="https://casbin.org/zh-Hant/docs/k8s-gatekeeper" hreflang="zh-Hant"><link data-rh="true" rel="alternate" href="https://casbin.org/ko/docs/k8s-gatekeeper" hreflang="ko"><link data-rh="true" rel="alternate" href="https://casbin.org/ru/docs/k8s-gatekeeper" hreflang="ru"><link data-rh="true" rel="alternate" href="https://casbin.org/fr/docs/k8s-gatekeeper" hreflang="fr"><link data-rh="true" rel="alternate" href="https://casbin.org/de/docs/k8s-gatekeeper" hreflang="de"><link data-rh="true" rel="alternate" href="https://casbin.org/ja/docs/k8s-gatekeeper" hreflang="ja"><link data-rh="true" rel="alternate" href="https://casbin.org/es/docs/k8s-gatekeeper" hreflang="es"><link data-rh="true" rel="alternate" href="https://casbin.org/pt/docs/k8s-gatekeeper" hreflang="pt"><link data-rh="true" rel="alternate" href="https://casbin.org/uk/docs/k8s-gatekeeper" hreflang="uk"><link data-rh="true" rel="alternate" href="https://casbin.org/th/docs/k8s-gatekeeper" hreflang="th"><link data-rh="true" rel="alternate" href="https://casbin.org/ar/docs/k8s-gatekeeper" hreflang="ar"><link data-rh="true" rel="alternate" href="https://casbin.org/id/docs/k8s-gatekeeper" hreflang="id"><link data-rh="true" rel="alternate" href="https://casbin.org/vi/docs/k8s-gatekeeper" hreflang="vi"><link data-rh="true" rel="alternate" href="https://casbin.org/it/docs/k8s-gatekeeper" hreflang="it"><link data-rh="true" rel="alternate" href="https://casbin.org/ms/docs/k8s-gatekeeper" hreflang="ms"><link data-rh="true" rel="alternate" href="https://casbin.org/tr/docs/k8s-gatekeeper" hreflang="tr"><link data-rh="true" rel="alternate" href="https://casbin.org/docs/k8s-gatekeeper" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6NBEV8TOFK-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="Casbin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="Casbin Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8S2TKCJ27X"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8S2TKCJ27X",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Casbin" href="/zh/opensearch.xml">
<script src="/js/isMainland.js" async></script>
<script src="/js/hotjar.js" async></script>
<script src="/js/probe.js" async></script>
<script src="/js/clarity.js" async></script><link rel="stylesheet" href="/zh/assets/css/styles.a7b1fe8a.css">
<link rel="preload" href="/zh/assets/js/runtime~main.0c8705a3.js" as="script">
<link rel="preload" href="/zh/assets/js/main.28398fcc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="跳至主要內容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳至主要內容</a></div><nav aria-label="主導航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切換導航欄" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/casbin.svg" alt="我的站點logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh/img/casbin.svg" alt="我的站點logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Casbin</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/zh/docs/overview">文檔</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/get-started">開始</a></li><li><a class="dropdown__link" href="/zh/docs/category/model">機型</a></li><li><a class="dropdown__link" href="/zh/docs/category/storage">儲存</a></li><li><a class="dropdown__link" href="/zh/docs/adapters">適配器</a></li><li><a class="dropdown__link" href="/zh/docs/category/api">API</a></li><li><a class="dropdown__link" href="/zh/docs/ide-plugins">IDE 插件</a></li><li><a class="dropdown__link" href="/zh/docs/contributing">開始貢獻</a></li></ul></div><a class="navbar__item navbar__link" href="/zh/ecosystem">生態系統</a><a class="navbar__item navbar__link" href="/zh/blog">博客</a><a class="navbar__item navbar__link" href="/zh/help">幫助</a><a class="navbar__item navbar__link" href="/zh/editor">編輯器</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文</a><ul class="dropdown__menu"><li><a href="/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">中文</a></li><li><a href="/zh-Hant/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hant">繁體中文</a></li><li><a href="/ko/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">한국어</a></li><li><a href="/ru/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ru">Русский</a></li><li><a href="/fr/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">Français</a></li><li><a href="/de/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="/ja/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/es/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/pt/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li><li><a href="/uk/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Українська</a></li><li><a href="/th/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="th">ไทย</a></li><li><a href="/ar/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">العربية</a></li><li><a href="/id/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="id">Indonesia</a></li><li><a href="/vi/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="vi">Tiếng Việt</a></li><li><a href="/it/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="it">Italiano</a></li><li><a href="/ms/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ms">Melayu</a></li><li><a href="/tr/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="tr">Türkçe</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://crowdin.com/project/casbin-website" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/casbin/casbin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://discord.gg/S5UjpzGZjN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-community-discord"></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="在深色和淺色模式之間切換（當前為淺色模式模式）" aria-label="在深色和淺色模式之間切換（當前為淺色模式模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="滾動回頂部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/zh/"><img src="/zh/img/casbin.svg" alt="我的站點logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh/img/casbin.svg" alt="我的站點logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>Casbin</b></a><nav aria-label="文檔側邊欄" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/the-basics">基礎知識</a><button aria-label="切換可摺疊側邊欄類別&#x27;基礎知識&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/get-started">Get Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/how-it-works">How It Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/tutorials">Tutorials</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/understanding-casbin-detail">Understanding How Casbin Matching Works in Detail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/pdf">PDF下载</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/model">機型</a><button aria-label="切換可摺疊側邊欄類別&#x27;機型&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/supported-models">Supported Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/syntax-for-models">Syntax for Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/effector">Effector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/function">Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rbac">RBAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rbac-with-pattern">RBAC with Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rbac-with-domains">RBAC with Domains</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rbac-with-conditions">RBAC with Conditions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rbac-96">Casbin RBAC vs. RBAC96</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/abac">ABAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/priority-model">Priority Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/superadmin">Super Admin</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/storage">儲存</a><button aria-label="切換可摺疊側邊欄類別&#x27;儲存&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/model-storage">Model Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/policy-storage">Policy Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/policy-subset-loading">Policy Subset Loading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/scenarios">場景</a><button aria-label="切換可摺疊側邊欄類別&#x27;場景&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/data-permissions">Data Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/menu-permissions">Menu Permissions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/extensions">擴充功能</a><button aria-label="切換可摺疊側邊欄類別&#x27;擴充功能&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/enforcers">Enforcers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/adapters">Adapters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/watchers">Watchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/dispatchers">Dispatchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/role-managers">Role Managers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/middlewares">Middlewares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/graphql-middlewares">GraphQL Middlewares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/cloud-native">Cloud Native Middlewares</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/api">API</a><button aria-label="切換可摺疊側邊欄類別&#x27;API&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/api-overview">API Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/management-api">Management API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rbac-api">RBAC API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rbac-with-domains-api">RBAC with Domains API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rbac-with-conditions-api">RBAC with Conditions API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/rolemanager-api">RoleManager API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh/docs/category/advanced-usage">高級用法</a><button aria-label="切換可摺疊側邊欄類別&#x27;高級用法&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/multi-threading">Multi-threading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/benchmark">Benchmarks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/performance">Performance Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/k8s">Authorization of Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/docs/k8s-gatekeeper">Admission Webhook for K8s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/envoy">Authorization of Service Mesh through Envoy</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/management">管理</a><button aria-label="切換可摺疊側邊欄類別&#x27;管理&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/admin-portal">Admin Portal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/service">Casbin Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/log-error">Log &amp; Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/frontend">Frontend Usage</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/editor">編輯器</a><button aria-label="切換可摺疊側邊欄類別&#x27;編輯器&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/online-editor">Online Editor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/ide-plugins">IDE Plugins</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/zh/docs/category/more">更多</a><button aria-label="切換可摺疊側邊欄類別&#x27;更多&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/adopters">Our Adopters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/contributing">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/privacy-policy">Privacy Policy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/terms-of-service">Terms of Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/refund-policy">Refund Policy</a></li></ul></li></ul></nav><button type="button" title="摺疊側邊欄" aria-label="摺疊側邊欄" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="導航路徑"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="首頁" class="breadcrumbs__link" href="/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/docs/category/advanced-usage"><span itemprop="name">高級用法</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Admission Webhook for K8s</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本頁內容</button></div><div class="theme-doc-markdown markdown"><header><h1>Admission Webhook for K8s</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-casbin-k8s-gatekeeper-概述與文件">1. Casbin K8s-Gatekeeper 概述與文件<a href="#1-casbin-k8s-gatekeeper-概述與文件" class="hash-link" aria-label="直接鏈接到1. Casbin K8s-Gatekeeper 概述與文件" title="直接鏈接到1. Casbin K8s-Gatekeeper 概述與文件">​</a></h2><p>Casbin K8s-GateKeeper 是一個 Kubernetes 准入 Webhook，整合了 Casbin 作為存取控制工具。 通過使用 Casbin K8s-GateKeeper，您可以建立靈活的規則來授權或攔截對 K8s 資源的任何操作，無需編寫任何程式碼，僅需幾行 Casbin 模型和策略的宣告式配置，這些是 Casbin ACL（存取控制列表）語言的一部分。</p><p>Casbin K8s-GateKeeper 由 Casbin 社群開發和維護。 該專案的倉庫可在這裡找到：<a href="https://github.com/casbin/k8s-gatekeeper" target="_blank" rel="noopener noreferrer">https://github.com/casbin/k8s-gatekeeper</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="01-一個簡單的例子">0.1 一個簡單的例子<a href="#01-一個簡單的例子" class="hash-link" aria-label="直接鏈接到0.1 一個簡單的例子" title="直接鏈接到0.1 一個簡單的例子">​</a></h3><p>例如，您不需要編寫任何代碼，但可以使用以下配置行來實現此功能：&quot;禁止使用某些指定標籤的圖像在任何部署中&quot;：</p><p>Model:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj,eft</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">!some(where (p.eft == deny))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contain(split(accessWithWildcard(${OBJECT}.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And Policy:</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>這些是普通的Casbin ACL語言。 假設您已經閱讀了有關它們的章節，理解起來將非常容易。</p><p>Casbin K8s-Gatekeeper具有以下優點：</p><ul><li>易於使用。 編寫幾行ACL遠比編寫大量代碼要好。</li><li>它允許配置的熱更新。 您不需要關閉整個插件來修改配置。</li><li>它具有彈性。 可以在任何 K8s 資源上制定任意規則，這些規則可以通過 <code>kubectl gatekeeper</code> 進行探索。</li><li>它簡化了 K8s 准入 Webhook 的實現，這是非常複雜的。 您不需要知道 K8s 准入 Webhook 是什麼，也不需要知道如何為其編寫代碼。 您只需要知道您想要施加限制的資源，然後編寫 Casbin ACL。 大家都知道 K8s 很複雜，但通過使用 Casbin K8s-Gatekeeper，可以節省您的時間。</li><li>它由 Casbin 社群維護。 如果有任何關於此插件的疑問，或者在嘗試使用時遇到任何問題，歡迎隨時聯繫我們。</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-casbin-k8s-gatekeeper-是如何工作的">1.1 Casbin K8s-Gatekeeper 是如何工作的？<a href="#11-casbin-k8s-gatekeeper-是如何工作的" class="hash-link" aria-label="直接鏈接到1.1 Casbin K8s-Gatekeeper 是如何工作的？" title="直接鏈接到1.1 Casbin K8s-Gatekeeper 是如何工作的？">​</a></h3><p>K8s-Gatekeeper 是一個 K8s 的准入 Webhook，使用 <a href="/zh/docs/overview">Casbin</a> 來應用任意用戶定義的訪問控制規則，以防止管理員不希望的任何 K8s 操作。</p><p>Casbin 是一個強大且高效能的開源存取控制庫。 它提供對基於各種存取控制模型的授權強制執行的支援。 有關 Casbin 的更多詳情，請參閱<a href="/zh/docs/overview">概述</a>。</p><p>K8s 中的准入 Webhook 是接收「准入請求」並對其進行處理的 HTTP 回調。 特別是，K8s-Gatekeeper 是一種特殊的准入 Webhook：「ValidatingAdmissionWebhook」，它可以決定是否接受或拒絕此准入請求。 至於准入請求，它們是描述對 K8s 指定資源（例如，創建/刪除部署）進行操作的 HTTP 請求。 有關准入 Webhook 的更多資訊，請參閱 <a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#what-are-admission-webhooks" target="_blank" rel="noopener noreferrer">K8s 官方文件</a>。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12-一個示例說明其工作原理">1.2 一個示例說明其工作原理<a href="#12-一個示例說明其工作原理" class="hash-link" aria-label="直接鏈接到1.2 一個示例說明其工作原理" title="直接鏈接到1.2 一個示例說明其工作原理">​</a></h3><p>例如，當有人想要創建一個包含運行 nginx 的 Pod 的部署（使用 kubectl 或 K8s 客戶端），K8s 將生成一個准入請求，該請求（如果轉換為 YAML 格式）可能如下所示：</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.14.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此請求將經過圖片中顯示的所有中間件處理流程，包括我們的 K8s-Gatekeeper。 K8s-Gatekeeper 能夠偵測到所有存儲在 K8s 的 etcd 中的 Casbin 執行器，這些執行器是由使用者（透過 <code>kubectl</code> 或我們提供的 Go 客戶端）建立和維護的。 每個執行器包含一個 Casbin 模型和一個 Casbin 策略。 准入請求將逐一被每個執行器處理，只有通過所有執行器的檢查，請求才能被這個 K8s-Gatekeeper 接受。</p><p>（如果你不理解什麼是 Casbin 執行器、模型或策略，請參閱此文件：<a href="/zh/docs/get-started">開始使用</a>）。</p><p>例如，由於某些原因，管理員希望禁止使用 &#x27;nginx:1.14.1&#x27; 映像檔，而允許使用 &#x27;nginx:1.3.1&#x27;。 可以建立一個包含以下規則和策略的執行器（我們將在後續章節解釋如何建立執行器，這些模型和策略是什麼，以及如何編寫它們）。</p><p>Model:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj,eft</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">!some(where (p.eft == deny))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">= p.obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Policy:</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;nginx:1.13.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">allow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;nginx:1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>透過建立包含上述模型和策略的執行器，之前的准入請求將被該執行器拒絕，這意味著 K8s 不會建立此部署。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-安裝-k8s-gatekeeper">2 安裝 K8s-gatekeeper<a href="#2-安裝-k8s-gatekeeper" class="hash-link" aria-label="直接鏈接到2 安裝 K8s-gatekeeper" title="直接鏈接到2 安裝 K8s-gatekeeper">​</a></h2><p>安裝 K8s-gatekeeper 有三種方法可供選擇：外部 webhook、內部 webhook 和 Helm。</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>注意</div><div class="admonitionContent_S0QG"><p>注意：這些方法僅供用戶試用 K8s-gatekeeper，並不安全。 如果您希望在生產環境中使用它，請確保您閱讀了 <a href="#5-advanced-settings">第5章。 進階設定</a> 並在安裝前進行必要的修改。</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21-內部-webhook">2.1 內部 webhook<a href="#21-內部-webhook" class="hash-link" aria-label="直接鏈接到2.1 內部 webhook" title="直接鏈接到2.1 內部 webhook">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="211-步驟1建立映像檔">2.1.1 步驟1：建立映像檔<a href="#211-步驟1建立映像檔" class="hash-link" aria-label="直接鏈接到2.1.1 步驟1：建立映像檔" title="直接鏈接到2.1.1 步驟1：建立映像檔">​</a></h4><p>對於內部 webhook 方法，webhook 本身將作為 Kubernetes 內部的服務來實現。 要創建必要的服務和部署，您需要建立 K8s-gatekeeper 的映像檔。 您可以通過運行以下命令來建立自己的映像檔：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build --target webhook -t k8s-gatekeeper </span><span class="token builtin class-name">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此命令將創建一個名為 &#x27;k8s-gatekeeper:latest&#x27; 的本地映像檔。</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>注意</div><div class="admonitionContent_S0QG"><p>注意：如果您正在使用 minikube，請在執行 &#x27;docker build&#x27; 之前先執行 <code>eval $(minikube -p minikube docker-env)</code>。</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="212-步驟-2為-k8s-gatekeeper-設置服務和部署">2.1.2 步驟 2：為 K8s-gatekeeper 設置服務和部署<a href="#212-步驟-2為-k8s-gatekeeper-設置服務和部署" class="hash-link" aria-label="直接鏈接到2.1.2 步驟 2：為 K8s-gatekeeper 設置服務和部署" title="直接鏈接到2.1.2 步驟 2：為 K8s-gatekeeper 設置服務和部署">​</a></h4><p>執行以下命令：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/rbac.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_deployment.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_internal.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>這將開始運行 K8s-gatekeeper，您可以通過執行 <code>kubectl get pods</code> 來確認這一點。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="213-步驟-3為-k8s-gatekeeper-安裝-crd-資源">2.1.3 步驟 3：為 K8s-gatekeeper 安裝 CRD 資源<a href="#213-步驟-3為-k8s-gatekeeper-安裝-crd-資源" class="hash-link" aria-label="直接鏈接到2.1.3 步驟 3：為 K8s-gatekeeper 安裝 CRD 資源" title="直接鏈接到2.1.3 步驟 3：為 K8s-gatekeeper 安裝 CRD 資源">​</a></h4><p>執行以下命令：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinmodels.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinpolicies.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22-外部-webhook">2.2 外部 webhook<a href="#22-外部-webhook" class="hash-link" aria-label="直接鏈接到2.2 外部 webhook" title="直接鏈接到2.2 外部 webhook">​</a></h3><p>對於外部 webhook 方法，K8s-gatekeeper 將在 Kubernetes 外部運行，而 Kubernetes 將像訪問普通網站一樣訪問 K8s-gatekeeper。 Kubernetes 有一個強制要求，即准入 webhook 必須是 HTTPS。 為了試用 K8s-gatekeeper，我們提供了一組證書和一個私鑰（儘管這不安全）。 若您偏好使用自己的憑證，請參閱<a href="#5-advanced-settings">第五章 進階設定</a>以獲取調整憑證和私鑰的指示。</p><p>我們提供的憑證是為 &#x27;webhook.domain.local&#x27; 發行的。 因此，請修改主機（例如，/etc/hosts）並將 &#x27;webhook.domain.local&#x27; 指向 K8s-gatekeeper 運行的 IP 地址。</p><p>然後執行以下命令：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">go mod tidy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go mod vendor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go run cmd/webhook/main.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinmodels.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinpolicies.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_external.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="23-透過-helm-安裝-k8s-gatekeeper">2.3 透過 Helm 安裝 K8s-gatekeeper<a href="#23-透過-helm-安裝-k8s-gatekeeper" class="hash-link" aria-label="直接鏈接到2.3 透過 Helm 安裝 K8s-gatekeeper" title="直接鏈接到2.3 透過 Helm 安裝 K8s-gatekeeper">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="231-第一步建立映像檔">2.3.1 第一步：建立映像檔<a href="#231-第一步建立映像檔" class="hash-link" aria-label="直接鏈接到2.3.1 第一步：建立映像檔" title="直接鏈接到2.3.1 第一步：建立映像檔">​</a></h4><p>請參閱<a href="#211-step-1-build-the-image">第二章 2.1.1</a>。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="232-helm-安裝">2.3.2 Helm 安裝<a href="#232-helm-安裝" class="hash-link" aria-label="直接鏈接到2.3.2 Helm 安裝" title="直接鏈接到2.3.2 Helm 安裝">​</a></h4><p>運行命令 <code>helm install k8sgatekeeper ./k8sgatekeeper</code>。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-嘗試-k8s-gatekeeper">3. 嘗試 K8s-gatekeeper<a href="#3-嘗試-k8s-gatekeeper" class="hash-link" aria-label="直接鏈接到3. 嘗試 K8s-gatekeeper" title="直接鏈接到3. 嘗試 K8s-gatekeeper">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31-創建-casbin-模型和策略">3.1 創建 Casbin 模型和策略<a href="#31-創建-casbin-模型和策略" class="hash-link" aria-label="直接鏈接到3.1 創建 Casbin 模型和策略" title="直接鏈接到3.1 創建 Casbin 模型和策略">​</a></h3><p>您有兩種方法來創建模型和策略：通過 kubectl 或通過我們提供的 go-client。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="311-通過-kubectl-創建更新-casbin-模型和策略">3.1.1 通過 kubectl 創建/更新 Casbin 模型和策略<a href="#311-通過-kubectl-創建更新-casbin-模型和策略" class="hash-link" aria-label="直接鏈接到3.1.1 通過 kubectl 創建/更新 Casbin 模型和策略" title="直接鏈接到3.1.1 通過 kubectl 創建/更新 Casbin 模型和策略">​</a></h4><p>在 K8s-gatekeeper 中，Casbin 模型存儲在一個名為 &#x27;CasbinModel&#x27; 的 CRD 資源中。 其定義位於 <code>config/auth.casbin.org_casbinmodels.yaml</code>。</p><p>示例在 <code>example/allowed_repo/model.yaml</code> 中。 請注意以下字段：</p><ul><li>metadata.name：模型的名稱。 此名稱必須與與此模型相關的 CasbinPolicy 物件的名稱相同，以便 K8s-gatekeeper 可以將它們配對並創建一個執行器。</li><li>spec.enable：如果此欄位設置為 &quot;false&quot;，此模型（以及與此模型相關的 CasbinPolicy 物件）將被忽略。</li><li>spec.modelText：包含 Casbin 模型文本的字符串。</li></ul><p>Casbin 策略存儲在另一個名為 &#x27;CasbinPolicy&#x27; 的 CRD 資源中，其定義可以在 <code>config/auth.casbin.org_casbinpolicies.yaml</code> 中找到。</p><p><code>example/allowed_repo/policy.yaml</code> 中有示例。 請注意以下欄位：</p><ul><li>metadata.name：策略的名稱。 此名稱必須與與此策略相關的 CasbinModel 物件的名稱相同，以便 K8s-gatekeeper 可以將它們配對並創建一個執行器。</li><li>spec.policyItem：包含 Casbin 模型策略文本的字符串。</li></ul><p>在創建自己的 CasbinModel 和 CasbinPolicy 文件後，使用以下命令應用它們：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">filename</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>一旦建立了一對 CasbinModel 和 CasbinPolicy，K8s-gatekeeper 將能在 5 秒內偵測到它。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-透過我們提供的-go-client-建立更新-casbin-模型和策略">3.1.2 透過我們提供的 go-client 建立/更新 Casbin 模型和策略<a href="#312-透過我們提供的-go-client-建立更新-casbin-模型和策略" class="hash-link" aria-label="直接鏈接到3.1.2 透過我們提供的 go-client 建立/更新 Casbin 模型和策略" title="直接鏈接到3.1.2 透過我們提供的 go-client 建立/更新 Casbin 模型和策略">​</a></h4><p>我們理解在某些情況下，直接在 K8s 集群的節點上使用 shell 執行命令可能不太方便，例如當您正在為您的公司構建自動化雲平台時。 因此，我們開發了一個 go-client 來創建和維護 CasbinModel 和 CasbinPolicy。</p><p>go-client 庫位於 <code>pkg/client</code> 中。</p><p>在 <code>client.go</code> 中，我們提供了一個創建客戶端的函數。</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewK8sGateKeeperClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">externalClient </span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">K8sGateKeeperClient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>externalClient</code> 參數決定了 K8s-gatekeeper 是否在 K8s 集群內部運行。</p><p>在 <code>model.go</code> 中，我們提供了各種函數來創建、刪除和修改 CasbinModel。 您可以在 <code>model_test.go</code> 中了解如何使用這些接口。</p><p>在 <code>policy.go</code> 中，我們提供了各種函數來創建、刪除和修改 CasbiPolicy。 您可以在 <code>policy_test.go</code> 中了解如何使用這些介面。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-嘗試-k8s-gatekeeper-是否運作">3.1.2 嘗試 K8s-gatekeeper 是否運作<a href="#312-嘗試-k8s-gatekeeper-是否運作" class="hash-link" aria-label="直接鏈接到3.1.2 嘗試 K8s-gatekeeper 是否運作" title="直接鏈接到3.1.2 嘗試 K8s-gatekeeper 是否運作">​</a></h3><p>假設您已經在 <code>example/allowed_repo</code> 中創建了確切的模型和策略。 現在，嘗試以下命令：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/allowed_repo/testcase/reject_1.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>您應該會發現 K8s 會拒絕此請求，並提到網鈎是拒絕此請求的原因。 然而，當您嘗試應用 <code>example/allowed_repo/testcase/approve_2.yaml</code> 時，它將被接受。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-如何使用-k8s-gatekeeper-編寫模型和策略">4. 如何使用 K8s-gatekeeper 編寫模型和策略<a href="#4-如何使用-k8s-gatekeeper-編寫模型和策略" class="hash-link" aria-label="直接鏈接到4. 如何使用 K8s-gatekeeper 編寫模型和策略" title="直接鏈接到4. 如何使用 K8s-gatekeeper 編寫模型和策略">​</a></h2><p>首先，確保您熟悉 Casbin 模型和策略的基本語法。 如果您不熟悉，請先閱讀 <a href="/zh/docs/get-started">入門</a> 部分。 在本章中，我們假設您已經理解什麼是 Casbin 模型和策略。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41-模型請求定義">4.1 模型請求定義<a href="#41-模型請求定義" class="hash-link" aria-label="直接鏈接到4.1 模型請求定義" title="直接鏈接到4.1 模型請求定義">​</a></h3><p>當 K8s-gatekeeper 進行授權請求時，輸入總是一個對象：Admission Request 的 Go 對象。 這意味著執行器將總是這樣使用：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ok</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> enforcer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Enforce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">admission</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中 <code>admission</code> 是一個由 K8s 官方 go api <code>&quot;k8s.io/api/admission/v1&quot;</code> 定義的 <code>AdmissionReview</code> 對象。 您可以在這個倉庫中找到這個結構體的定義：<a href="https://github.com/kubernetes/api/blob/master/admission/v1/types.go" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/api/blob/master/admission/v1/types.go</a>。 更多信息，您也可以參考 <a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response</a>。</p><p>因此，對於 K8s-gatekeeper 使用的任何模型，<code>request_definition</code> 的定義應該總是這樣：</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>名稱 &#x27;obj&#x27; 不是強制性的，只要名稱與 <code>[matchers]</code> 部分中使用的名稱一致即可。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42-模型匹配器">4.2 模型匹配器<a href="#42-模型匹配器" class="hash-link" aria-label="直接鏈接到4.2 模型匹配器" title="直接鏈接到4.2 模型匹配器">​</a></h3><p>您應該使用 Casbin 的 ABAC 功能來編寫您的規則。 然而，Casbin 內建的表達式評估器不支援在映射或陣列（切片）中進行索引，也不支援陣列的擴展。 因此，K8s-gatekeeper 提供了各種「Casbin 函數」作為擴展來實現這些功能。 如果您發現這些擴展仍無法滿足您的需求，請隨時開始一個問題，或創建一個拉取請求。</p><p>如果您不熟悉 Casbin 函數，可以參考 <a href="/zh/docs/function">Function</a> 以獲取更多信息。</p><p>以下是擴展函數：</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="421-擴展函數">4.2.1 擴展函數<a href="#421-擴展函數" class="hash-link" aria-label="直接鏈接到4.2.1 擴展函數" title="直接鏈接到4.2.1 擴展函數">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4211-access">4.2.1.1 access<a href="#4211-access" class="hash-link" aria-label="直接鏈接到4.2.1.1 access" title="直接鏈接到4.2.1.1 access">​</a></h4><p>Access 用於解決 Casbin 不支援在映射或陣列中進行索引的問題。 <code>example/allowed_repo/model.yaml</code> 示例展示了此函數的使用方法：</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">= p.obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在這個匹配器中，<code>access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</code> 等同於 <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Image</code>，其中 <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers</code> 是一個切片。</p><p>訪問也可以調用沒有參數且返回單一值的簡單函數。 示例 <code>example/container_resource_limit/model.yaml</code> 展示了這一點：</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;cpu&quot;,&quot;Value&quot;)) &gt;</span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">parseFloat(p.cpu) &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;memory&quot;,&quot;Value&quot;)) &gt;</span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">parseFloat(p.memory)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在這個匹配器中，<code>access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;cpu&quot;,&quot;Value&quot;)</code> 等同於 <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits[&quot;cpu&quot;].Value()</code>，其中 <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits</code> 是一個映射，而 <code>Value()</code> 是一個沒有參數且返回單一值的簡單函數。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4212-accesswithwildcard">4.2.1.2 accessWithWildcard<a href="#4212-accesswithwildcard" class="hash-link" aria-label="直接鏈接到4.2.1.2 accessWithWildcard" title="直接鏈接到4.2.1.2 accessWithWildcard">​</a></h4><p>有時候，您可能會有這樣的需求：陣列中的所有元素都必須有一個前綴 &quot;aaa&quot;。 然而，Casbin 不支持 <code>for</code> 循環。 通過 <code>accessWithWildcard</code> 和 &quot;映射/切片擴展&quot; 功能，您可以輕鬆實現這樣的需求。</p><p>例如，假設 <code>a.b.c</code> 是一個陣列 <code>[aaa,bbb,ccc,ddd,eee]</code>，那麼 <code>accessWithWildcard(a,&quot;b&quot;,&quot;c&quot;,&quot;*&quot;)</code> 的結果將是一個切片 <code>[aaa,bbb,ccc,ddd,eee]</code>。 通過使用通配符 <code>*</code>，切片被擴展了。</p><p>同樣地，萬用字元可以使用多次。 例如，<code>accessWithWildcard(a,&quot;b&quot;,&quot;c&quot;,&quot;*&quot;,&quot;*&quot;)</code> 的結果將是 <code>[a.b.c[0][0], a.b.c[0][1], ..., a.b.c[1][0], a.b.c[1][1], ...]</code>。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4213-支援可變長度參數的函數">4.2.1.3 支援可變長度參數的函數<a href="#4213-支援可變長度參數的函數" class="hash-link" aria-label="直接鏈接到4.2.1.3 支援可變長度參數的函數" title="直接鏈接到4.2.1.3 支援可變長度參數的函數">​</a></h3><p>在 Casbin 的表達式評估器中，當一個參數是陣列時，它將自動展開為可變長度參數。 利用這一特性來支援陣列/切片/映射的展開，我們還整合了幾個接受陣列/切片作為參數的函數：</p><ul><li>contain()：接受多個參數並返回是否任何參數（除了最後一個參數）等於最後一個參數。</li><li>split(a,b,c...,sep,index)：返回一個切片，包含 <code>[splits(a,sep)[index], splits(b,sep)[index], splits(a,sep)[index], ...]</code>。</li><li>len()：返回可變長度參數的長度。</li><li>matchRegex(a,b,c...,regex)：返回所有給定參數（<code>a</code>, <code>b</code>, <code>c</code>, ...）是否匹配給定的正則表達式。 匹配給定的正則表達式。</li></ul><p>這裡是一個範例，位於 <code>example/disallowed_tag/model.yaml</code>：</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>假設 <code>accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;)</code> 返回 <code>[&quot;a:b&quot;, &quot;c:d&quot;, &quot;e:f&quot;, &quot;g:h&quot;]</code>，因為 splits 支援可變長度參數並對每個元素執行分割操作，索引 1 的元素將被選擇並返回。 因此，<code>split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1)</code> 返回 <code>[&quot;b&quot;,&quot;d&quot;,&quot;f&quot;,&quot;h&quot;]</code>。 而 <code>contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</code> 返回 <code>p.obj</code> 是否包含在 <code>[&quot;b&quot;,&quot;d&quot;,&quot;f&quot;,&quot;h&quot;]</code> 中。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4212-類型轉換函數">4.2.1.2 類型轉換函數<a href="#4212-類型轉換函數" class="hash-link" aria-label="直接鏈接到4.2.1.2 類型轉換函數" title="直接鏈接到4.2.1.2 類型轉換函數">​</a></h4><ul><li>ParseFloat()：將整數解析為浮點數（這是必要的，因為在比較中使用的任何數字都必須轉換為浮點數）。</li><li>ToString()：將對象轉換為字符串。 此對象必須具有基本的字符串類型（例如，當有語句 <code>type XXX string</code> 時，類型為 <code>XXX</code> 的對象）。</li><li>IsNil()：返回參數是否為 nil。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-進階設定">5. 進階設定<a href="#5-進階設定" class="hash-link" aria-label="直接鏈接到5. 進階設定" title="直接鏈接到5. 進階設定">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-關於證書">5.1 關於證書<a href="#51-關於證書" class="hash-link" aria-label="直接鏈接到5.1 關於證書" title="直接鏈接到5.1 關於證書">​</a></h3><p>在 Kubernetes (k8s) 中，網鈎必須使用 HTTPS 是強制性的。 實現這一點有兩種方法：</p><ul><li>使用自簽署證書（本倉庫中的示例使用此方法）</li><li>使用普通證書</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="511-自簽署證書">5.1.1 自簽署證書<a href="#511-自簽署證書" class="hash-link" aria-label="直接鏈接到5.1.1 自簽署證書" title="直接鏈接到5.1.1 自簽署證書">​</a></h4><p>使用自簽署證書意味著簽發證書的證書頒發機構（CA）不是眾所周知的 CA 之一。 因此，您必須讓 k8s 知道這個 CA。</p><p>目前，本倉庫中的示例使用了一個自製的 CA，其私鑰和證書分別存儲在 <code>config/certificate/ca.crt</code> 和 <code>config/certificate/ca.key</code> 中。 網鈎的證書位於 <code>config/certificate/server.crt</code>，由自製的 CA 發行。 此證書的域名為 &quot;webhook.domain.local&quot;（用於外部網鈎）和 &quot;casbin-webhook-svc.default.svc&quot;（用於內部網鈎）。</p><p>CA 的相關信息透過網鈎配置文件傳遞給 k8s。 <code>config/webhook_external.yaml</code> 和 <code>config/webhook_internal.yaml</code> 文件中均有一個名為 &quot;CABundle&quot; 的字段，該字段包含 CA 證書的 base64 編碼字符串。</p><p>若需要更改證書/域名（例如，當您想將此網鈎放入 k8s 的另一個命名空間中使用內部網鈎，或在使用外部網鈎時更改域名），應遵循以下步驟：</p><ol><li><p>生成新的 CA：</p><ul><li><p>生成偽造 CA 的私鑰：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out ca.key </span><span class="token number" style="color:#36acaa">2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>移除私鑰的密碼保護：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in ca.key -out ca.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>生成網鈎服務器的私鑰：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out server.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in server.key -out server.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>使用自生成的 CA 簽署網鈎的證書：</p><ul><li><p>複製您系統的 openssl 配置文件以供臨時使用。 您可以通過運行 <code>openssl version -a</code> 來找出配置文件的位置，通常稱為 <code>openssl.cnf</code>。</p></li><li><p>在配置文件中：</p><ul><li><p>找到 <code>[req]</code> 段落並添加以下行：<code>req_extensions = v3_req</code></p></li><li><p>找到 <code>[v3_req]</code> 段落並添加以下行：<code>subjectAltName = @alt_names</code></p></li><li><p>將以下行附加到文件中：</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">alt_names</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">DNS.2</span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">&lt;The domain you want&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意：如果決定修改服務名稱，請將 &#x27;casbin-webhook-svc.default.svc&#x27; 替換為您自己的服務的真實服務名稱。</p></li></ul></li><li><p>使用修改後的配置文件生成證書請求文件：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -nodes -keyout server.key -out server.csr -config openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>使用自製的 CA 回應請求並簽署證書：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">3650</span><span class="token plain"> -in server.csr -out server.crt -CA ca.crt -CAkey ca.key -CAcreateserial -extensions v3_req -extensions SAN -extfile openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼到剪貼板" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>替換 &#x27;CABundle&#x27; 字段： 請以新證書更新此欄位。</p></li><li><p>若您使用 Helm，需對 Helm 圖表進行類似更改。</p></li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="512-法律證書">5.1.2 法律證書<a href="#512-法律證書" class="hash-link" aria-label="直接鏈接到5.1.2 法律證書" title="直接鏈接到5.1.2 法律證書">​</a></h4><p>若您使用法律證書，則無需經過所有這些程序。 在 <code>config/webhook_external.yaml</code> 和 <code>config/webhook_internal.yaml</code> 中移除 &quot;CABundle&quot; 欄位，並將這些文件中的域名更改為您所擁有的域名。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sGateKeeper.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>編輯此頁面</a> <a href="https://crowdin.com/project/casdoor-website/zh-CN" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page" transurl="https://crowdin.com/project/casdoor-website/zh-CN" style="margin-left:2rem"><svg fill="currentColor" height="20" width="20" viewBox="0 0 25 25" aria-hidden="true" style="margin-right:0.3em;vertical-align:sub"><path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>翻譯此頁面</a></div><div class="col lastUpdated_VsjB"><span>Created by</span><a href="https://github.com/ComradeProgrammer" target="_blank" rel="noreferrer"><img alt="ComradeProgrammer" src="https://avatars.githubusercontent.com/ComradeProgrammer" width="24px" style="border-radius:12px;vertical-align:sub;margin-left:4px">  <!-- -->ComradeProgrammer</a></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文檔頁面"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/docs/k8s"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">Authorization of Kubernetes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/docs/envoy"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">Authorization of Service Mesh through Envoy</div></a></nav><br></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-casbin-k8s-gatekeeper-概述與文件" class="table-of-contents__link toc-highlight">1. Casbin K8s-Gatekeeper 概述與文件</a><ul><li><a href="#01-一個簡單的例子" class="table-of-contents__link toc-highlight">0.1 一個簡單的例子</a></li><li><a href="#11-casbin-k8s-gatekeeper-是如何工作的" class="table-of-contents__link toc-highlight">1.1 Casbin K8s-Gatekeeper 是如何工作的？</a></li><li><a href="#12-一個示例說明其工作原理" class="table-of-contents__link toc-highlight">1.2 一個示例說明其工作原理</a></li></ul></li><li><a href="#2-安裝-k8s-gatekeeper" class="table-of-contents__link toc-highlight">2 安裝 K8s-gatekeeper</a><ul><li><a href="#21-內部-webhook" class="table-of-contents__link toc-highlight">2.1 內部 webhook</a></li><li><a href="#22-外部-webhook" class="table-of-contents__link toc-highlight">2.2 外部 webhook</a></li><li><a href="#23-透過-helm-安裝-k8s-gatekeeper" class="table-of-contents__link toc-highlight">2.3 透過 Helm 安裝 K8s-gatekeeper</a></li></ul></li><li><a href="#3-嘗試-k8s-gatekeeper" class="table-of-contents__link toc-highlight">3. 嘗試 K8s-gatekeeper</a><ul><li><a href="#31-創建-casbin-模型和策略" class="table-of-contents__link toc-highlight">3.1 創建 Casbin 模型和策略</a></li><li><a href="#312-嘗試-k8s-gatekeeper-是否運作" class="table-of-contents__link toc-highlight">3.1.2 嘗試 K8s-gatekeeper 是否運作</a></li></ul></li><li><a href="#4-如何使用-k8s-gatekeeper-編寫模型和策略" class="table-of-contents__link toc-highlight">4. 如何使用 K8s-gatekeeper 編寫模型和策略</a><ul><li><a href="#41-模型請求定義" class="table-of-contents__link toc-highlight">4.1 模型請求定義</a></li><li><a href="#42-模型匹配器" class="table-of-contents__link toc-highlight">4.2 模型匹配器</a></li><li><a href="#421-擴展函數" class="table-of-contents__link toc-highlight">4.2.1 擴展函數</a></li><li><a href="#4213-支援可變長度參數的函數" class="table-of-contents__link toc-highlight">4.2.1.3 支援可變長度參數的函數</a></li></ul></li><li><a href="#5-進階設定" class="table-of-contents__link toc-highlight">5. 進階設定</a><ul><li><a href="#51-關於證書" class="table-of-contents__link toc-highlight">5.1 關於證書</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文檔</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh/docs/get-started">開始使用</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/management-api">管理API</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/rbac-api">RBAC API</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/middlewares">中間件</a></li></ul></div><div class="col footer__col"><div class="footer__title">社區</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://forum.casbin.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">論壇<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/search?q=casbin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/S5UjpzGZjN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://cdn.casdoor.com/casdoor/resource/built-in/admin/qq_casbin.png" target="_blank" rel="noopener noreferrer" class="footer__link-item">QQ 群組<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item">
                <a href="https://github.com/casbin/casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin?label=Casbin&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/jcasbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/jcasbin?label=jCasbin&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/node-casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/node-casbin?label=Node-Casbin&style=social">
                </a>
                &nbsp;&nbsp;
                <a href="https://github.com/php-casbin/php-casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/php-casbin/php-casbin?label=PHP-Casbin&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/pycasbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/pycasbin?label=PyCasbin&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/Casbin.NET" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/Casbin.NET?label=Casbin.NET&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/casbin-cpp" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin-cpp?label=Casbin-CPP&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/casbin-rs" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin-rs?label=Casbin-RS&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://twitter.com/casbinHQ" target="_blank">
                  <img alt="Twitter Follow" src="https://img.shields.io/twitter/follow/casbinHQ?style=social">
                </a>
              </li><li class="footer__item">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?2c0ffc6f8d49e98d964d59d7aa4cbf34";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
</li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/zh/"><img src="/zh/img/casbin_min.svg" alt="卡斯宾徽标" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/zh/img/casbin_min.svg" alt="卡斯宾徽标" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">版权 ©️ 2024 Casbin 组织</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.0c8705a3.js"></script>
<script src="/zh/assets/js/main.28398fcc.js"></script>
</body>
</html>