"use strict";(globalThis.webpackChunkcasbin_website_v2=globalThis.webpackChunkcasbin_website_v2||[]).push([[1490],{1050(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"rbac","title":"RBAC","description":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19 RBAC \u0e02\u0e2d\u0e07 Casbin","source":"@site/i18n/th/docusaurus-plugin-content-docs/current/RBAC.mdx","sourceDirName":".","slug":"/rbac","permalink":"/th/docs/rbac","draft":false,"unlisted":false,"editUrl":"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBAC.mdx","tags":[],"version":"current","frontMatter":{"id":"rbac","title":"RBAC","description":"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19 RBAC \u0e02\u0e2d\u0e07 Casbin","keywords":["RBAC","role definition","role hierarchy"],"authors":["hsluoyz"]},"sidebar":"docs","previous":{"title":"RBAC Overview","permalink":"/th/docs/rbac-overview"},"next":{"title":"RBAC with Pattern","permalink":"/th/docs/rbac-with-pattern"}}');var s=r(4848),o=r(8453);const a={id:"rbac",title:"RBAC",description:"\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19 RBAC \u0e02\u0e2d\u0e07 Casbin",keywords:["RBAC","role definition","role hierarchy"],authors:["hsluoyz"]},t=void 0,l={},c=[{value:"Role definition",id:"role-definition",level:2},{value:"Role hierarchy",id:"role-hierarchy",level:2},{value:"Distinguishing users from roles",id:"distinguishing-users-from-roles",level:2},{value:"Implicit roles and permissions",id:"implicit-roles-and-permissions",level:2},{value:"Pattern matching in RBAC",id:"pattern-matching-in-rbac",level:2},{value:"Role manager",id:"role-manager",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"role-definition",children:"Role definition"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"[role_definition]"})," section defines RBAC role (inheritance) relationships. Casbin can run several RBAC systems at once: one for users (with role inheritance) and optionally one for resources. Each is independent."]}),"\n",(0,s.jsx)(n.p,{children:"This section is optional; omit it if you are not using RBAC."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"[role_definition]\ng = _, _\ng2 = _, _\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Here ",(0,s.jsx)(n.code,{children:"g"})," and ",(0,s.jsx)(n.code,{children:"g2"})," are two role systems; ",(0,s.jsx)(n.code,{children:"_, _"})," means each has two sides (e.g. user and role). Use only ",(0,s.jsx)(n.code,{children:"g"})," for user roles; add ",(0,s.jsx)(n.code,{children:"g2"})," when resources have roles too. Examples: ",(0,s.jsx)(n.a,{href:"https://github.com/casbin/casbin/blob/master/examples/rbac_model.conf",children:"rbac_model.conf"}),", ",(0,s.jsx)(n.a,{href:"https://github.com/casbin/casbin/blob/master/examples/rbac_with_resource_roles_model.conf",children:"rbac_with_resource_roles_model.conf"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"User\u2013role (and resource\u2013role) mappings are stored in the policy, for example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csv",children:"p, data2_admin, data2, read\ng, alice, data2_admin\n"})}),"\n",(0,s.jsxs)(n.p,{children:["So ",(0,s.jsx)(n.code,{children:"alice"})," has role ",(0,s.jsx)(n.code,{children:"data2_admin"}),". Casbin treats all names as strings (user, resource, or role)."]}),"\n",(0,s.jsx)(n.p,{children:"Use the role in a matcher:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act\n"})}),"\n",(0,s.jsx)(n.p,{children:"So the request is allowed only if the request subject has the role given in the policy."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Casbin only stores and evaluates user\u2013role (and resource\u2013role) mappings; it does not validate that users or roles exist. That is the job of authentication."}),"\n",(0,s.jsxs)(n.li,{children:["Do not reuse the same name for a user and a role (e.g. user ",(0,s.jsx)(n.code,{children:"alice"})," and role ",(0,s.jsx)(n.code,{children:"alice"}),"), since Casbin cannot tell them apart. Use a prefix (e.g. ",(0,s.jsx)(n.code,{children:"role_alice"}),") if needed."]}),"\n",(0,s.jsx)(n.li,{children:"Role inheritance is transitive and unbounded: if A has role B and B has role C, then A effectively has role C."}),"\n"]})}),"\n",(0,s.jsxs)(n.admonition,{title:"Token name convention",type:"info",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# `subject` here is for sub\n[policy_definition]\np =  obj, act, subject\n"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'e.SetFieldIndex("p", constant.SubjectIndex, 2) // index starts from 0\nok, err := e.DeleteUser("alice") // without SetFieldIndex, it will raise an error\n'})})]}),"\n",(0,s.jsx)(n.h2,{id:"role-hierarchy",children:"Role hierarchy"}),"\n",(0,s.jsxs)(n.p,{children:["Casbin implements RBAC1-style role hierarchy: if ",(0,s.jsx)(n.code,{children:"alice"})," has ",(0,s.jsx)(n.code,{children:"role1"})," and ",(0,s.jsx)(n.code,{children:"role1"})," has ",(0,s.jsx)(n.code,{children:"role2"}),", then ",(0,s.jsx)(n.code,{children:"alice"})," effectively has ",(0,s.jsx)(n.code,{children:"role2"})," and its permissions."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"hierarchy depth"})," is how many levels of inheritance you allow. The default role manager uses a maximum depth of 10 (configurable), so a user can inherit up to 10 levels of roles."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"// NewRoleManager is the constructor for creating an instance of the\n// default RoleManager implementation.\nfunc NewRoleManager(maxHierarchyLevel int) rbac.RoleManager {\n    rm := RoleManager{}\n    rm.allRoles = &sync.Map{}\n    rm.maxHierarchyLevel = maxHierarchyLevel\n    rm.hasPattern = false\n\n    return &rm\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"distinguishing-users-from-roles",children:"Distinguishing users from roles"}),"\n",(0,s.jsxs)(n.p,{children:["In Casbin, users and roles are both strings. In flat RBAC (no role hierarchy), ",(0,s.jsx)(n.code,{children:"GetAllSubjects()"})," and ",(0,s.jsx)(n.code,{children:"GetAllRoles()"})," return the left and right sides of ",(0,s.jsx)(n.code,{children:"g"})," rules (often users and roles). With a hierarchy, the same name can appear as both user and role; if your app does not track which is which, use a naming convention (e.g. prefix ",(0,s.jsx)(n.code,{children:"role::"}),") and check it when interpreting results."]}),"\n",(0,s.jsx)(n.h2,{id:"implicit-roles-and-permissions",children:"Implicit roles and permissions"}),"\n",(0,s.jsxs)(n.p,{children:["Roles and permissions inherited through the hierarchy (not only direct assignments) are called ",(0,s.jsx)(n.strong,{children:"implicit"}),". Use ",(0,s.jsx)(n.code,{children:"GetImplicitRolesForUser()"})," and ",(0,s.jsx)(n.code,{children:"GetImplicitPermissionsForUser()"})," to include them; ",(0,s.jsx)(n.code,{children:"GetRolesForUser()"})," and ",(0,s.jsx)(n.code,{children:"GetPermissionsForUser()"})," return only direct assignments. See ",(0,s.jsx)(n.a,{href:"https://github.com/casbin/casbin/issues/137",children:"GitHub #137"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"pattern-matching-in-rbac",children:"Pattern matching in RBAC"}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"/docs/rbac-with-pattern",children:"RBAC with pattern"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"role-manager",children:"Role manager"}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"/docs/role-managers",children:"Role managers"})," for custom role management."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>a,x:()=>t});var i=r(6540);const s={},o=i.createContext(s);function a(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);