"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[5993],{3905:(e,a,n)=>{n.d(a,{Zo:()=>c,kt:()=>m});var t=n(7294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function o(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?o(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=t.createContext({}),d=function(e){var a=t.useContext(l),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},c=function(e){var a=d(e.components);return t.createElement(l.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},u=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=d(n),m=r,b=u["".concat(l,".").concat(m)]||u[m]||p[m]||o;return n?t.createElement(b,i(i({ref:a},c),{},{components:n})):t.createElement(b,i({ref:a},c))}));function m(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2976:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var t=n(7462),r=(n(7294),n(3905));const o={id:"frontend",title:"Frontend Usage",description:"Casbin.js es un complemento de Casbin que facilita la gesti\xf3n de control de acceso en la aplicaci\xf3n frontend",keywords:["Casbin.js","react-authz","rbac-react","vue-authz","angular-authz"],authors:["hsluoyz"]},i=void 0,s={unversionedId:"frontend",id:"frontend",title:"Frontend Usage",description:"Casbin.js es un complemento de Casbin que facilita la gesti\xf3n de control de acceso en la aplicaci\xf3n frontend",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/FrontendUsage.mdx",sourceDirName:".",slug:"/frontend",permalink:"/es/docs/frontend",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/FrontendUsage.mdx",tags:[],version:"current",frontMatter:{id:"frontend",title:"Frontend Usage",description:"Casbin.js es un complemento de Casbin que facilita la gesti\xf3n de control de acceso en la aplicaci\xf3n frontend",keywords:["Casbin.js","react-authz","rbac-react","vue-authz","angular-authz"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Log & Error Handling",permalink:"/es/docs/log-error"},next:{title:"Editor",permalink:"/es/docs/category/editor"}},l={},d=[{value:"Instalaci\xf3n",id:"instalaci\xf3n",level:2},{value:"Middlewares de Frontend",id:"middlewares-de-frontend",level:2},{value:"Inicio R\xe1pido",id:"inicio-r\xe1pido",level:2},{value:"Objeto de Permiso",id:"objeto-de-permiso",level:3},{value:"Uso Avanzado",id:"uso-avanzado",level:2},{value:"Lista de API",id:"lista-de-api",level:2},{value:"<code>setPermission(permission: string)</code>",id:"setpermissionpermission-string",level:3},{value:"<code>setUser(user: string)</code>",id:"setuseruser-string",level:3},{value:"<code>can(action: string, object: string)</code>",id:"canaction-string-object-string",level:3},{value:"<code>cannot(action: string, object: string)</code>",id:"cannotaction-string-object-string",level:3},{value:"<code>canAll(action: string, objects: Array&lt;object&gt;)</code>",id:"canallaction-string-objects-arrayobject",level:3},{value:"<code>canAny(action: string, objects: Array&lt;object&gt;)</code>",id:"cananyaction-string-objects-arrayobject",level:3},{value:"Por qu\xe9 Casbin.js",id:"por-qu\xe9-casbinjs",level:2}],c={toc:d};function p(e){let{components:a,...n}=e;return(0,r.kt)("wrapper",(0,t.Z)({},c,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin.js"},"Casbin.js")," es un complemento de Casbin que facilita la gesti\xf3n de control de acceso en la aplicaci\xf3n frontend."),(0,r.kt)("h2",{id:"instalaci\xf3n"},"Instalaci\xf3n"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install casbin.js\nnpm install casbin\n")),(0,r.kt)("p",null,"o"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add casbin.js\n")),(0,r.kt)("h2",{id:"middlewares-de-frontend"},"Middlewares de Frontend"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Middleware"),(0,r.kt)("th",{parentName:"tr",align:null},"Tipo"),(0,r.kt)("th",{parentName:"tr",align:null},"Autor"),(0,r.kt)("th",{parentName:"tr",align:null},"Descripci\xf3n"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casbin-js/react-authz"},"react-authz")),(0,r.kt)("td",{parentName:"tr",align:null},"React"),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Envoltura de React para Casbin.js")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/daobeng/rbac-react"},"rbac-react")),(0,r.kt)("td",{parentName:"tr",align:null},"React"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/daobeng"},"@daobeng")),(0,r.kt)("td",{parentName:"tr",align:null},"Control de Acceso Basado en Roles en React usando HOCs, CASL y Casbin.js")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casbin-js/vue-authz"},"vue-authz")),(0,r.kt)("td",{parentName:"tr",align:null},"Vue"),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Envoltura de Vue para Casbin.js")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casbin-js/angular-authz"},"angular-authz")),(0,r.kt)("td",{parentName:"tr",align:null},"Angular"),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Envoltura de Angular para Casbin.js")))),(0,r.kt)("h2",{id:"inicio-r\xe1pido"},"Inicio R\xe1pido"),(0,r.kt)("p",null,"Puedes usar el modo ",(0,r.kt)("inlineCode",{parentName:"p"},"manual")," en tu aplicaci\xf3n frontend y establecer los permisos cuando lo desees."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'const casbinjs = require("casbin.js");\n// Set the user\'s permission:\n// He/She can read `data1` and `data2` objects and can write `data1` object\nconst permission = {\n    "read": ["data1", "data2"],\n    "write": ["data1"]\n}\n\n// Run casbin.js in manual mode, which requires you to set the permission manually.\nconst authorizer = new casbinjs.Authorizer("manual");\n')),(0,r.kt)("p",null,"Ahora tenemos un autorizador, ",(0,r.kt)("inlineCode",{parentName:"p"},"authorizer"),". Podemos obtener reglas de permiso de \xe9l usando las APIs ",(0,r.kt)("inlineCode",{parentName:"p"},"authorizer.can()")," y ",(0,r.kt)("inlineCode",{parentName:"p"},"authorizer.cannot()"),". Los valores de retorno de estas 2 APIs son Promesas de JavaScript (",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises"},"detalles aqu\xed"),"), por lo que debemos usar el m\xe9todo ",(0,r.kt)("inlineCode",{parentName:"p"},"then()")," del valor de retorno de esta manera:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'result = authorizer.can("write", "data1");\nresult.then((success, failed) => {\n    if (success) {\n        console.log("you can write data1");\n    } else {\n        console.log("you cannot write data1");\n    }\n});\n// output: you can write data1\n')),(0,r.kt)("p",null,"La API ",(0,r.kt)("inlineCode",{parentName:"p"},"cannot()")," se usa de la misma manera:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'result = authorizer.cannot("read", "data2");\nresult.then((success, failed) => {\n    if (success) {\n        console.log("you cannot read data2");\n    } else {\n        console.log("you can read data2");\n    }\n});\n// output: you can read data2\n')),(0,r.kt)("p",null,"En el c\xf3digo anterior, la variable ",(0,r.kt)("inlineCode",{parentName:"p"},"success")," en los par\xe1metros significa que la solicitud obtiene el resultado sin lanzar un error y no significa que la regla de permiso sea ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),". La variable ",(0,r.kt)("inlineCode",{parentName:"p"},"failed")," tambi\xe9n es ajena a las reglas de permiso. Solo tiene sentido cuando algo sale mal en el proceso de la solicitud."),(0,r.kt)("p",null,"Puedes referirte a nuestro ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin-js/examples"},"ejemplo de React")," para ver un uso pr\xe1ctico de Casbin.js."),(0,r.kt)("h3",{id:"objeto-de-permiso"},"Objeto de Permiso"),(0,r.kt)("p",null,"Casbin.js aceptar\xe1 un objeto JSON para manipular el permiso correspondiente de un visitante. Por ejemplo:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "read": ["data1", "data2"],\n    "write": ["data1"]\n}\n')),(0,r.kt)("p",null,"El objeto de permiso anterior muestra que el visitante puede ",(0,r.kt)("inlineCode",{parentName:"p"},"read")," los objetos ",(0,r.kt)("inlineCode",{parentName:"p"},"data1")," y ",(0,r.kt)("inlineCode",{parentName:"p"},"data2"),", mientras que solo pueden ",(0,r.kt)("inlineCode",{parentName:"p"},"write")," los objetos ",(0,r.kt)("inlineCode",{parentName:"p"},"data1"),"."),(0,r.kt)("h2",{id:"uso-avanzado"},"Uso Avanzado"),(0,r.kt)("p",null,"Casbin.js proporciona una soluci\xf3n perfecta para integrar la gesti\xf3n de control de acceso de tu frontend con tu servicio Casbin de backend."),(0,r.kt)("p",null,"Usa el modo ",(0,r.kt)("inlineCode",{parentName:"p"},"auto")," y especifica tu punto final al inicializar el ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorizer")," de Casbin.js, sincronizar\xe1 autom\xe1ticamente el permiso y manipular\xe1 el estado del frontend."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"const casbinjs = require('casbin.js');\n\n// Set your backend Casbin service URL\nconst authorizer = new casbinjs.Authorizer(\n    'auto', // mode\n    {endpoint: 'http://your_endpoint/api/casbin'}\n);\n\n// Set your visitor.\n// Casbin.js will automatically sync the permission with your backend Casbin service.\nauthorizer.setUser(\"Tom\");\n\n// Evaluate the permission\nresult = authorizer.can(\"read\", \"data1\");\nresult.then((success, failed) => {\n    if (success) {\n        // Some frontend procedure ...\n    }\n});\n")),(0,r.kt)("p",null,"Correspondientemente, necesitas exponer una interfaz (por ejemplo, una RestAPI) para generar el objeto de permiso y pasarlo al frontend. En tu controlador de API, llama a ",(0,r.kt)("inlineCode",{parentName:"p"},"CasbinJsGetUserPermission")," para construir el objeto de permiso. Aqu\xed hay un ejemplo en Beego:"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Tu servidor de punto final deber\xeda devolver algo como"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "other":"other",\n    "data": "What you get from `CasbinJsGetPermissionForUser`"\n}\n'))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'// Router\nbeego.Router("api/casbin", &controllers.APIController{}, "GET:GetFrontendPermission")\n\n// Controller\nfunc (c *APIController) GetFrontendPermission() {\n    // Get the visitor from the GET parameters. (The key is "casbin_subject")\n    visitor := c.Input().Get("casbin_subject")\n    // `e` is an initialized instance of Casbin Enforcer\n    c.Data["perm"] = casbin.CasbinJsGetPermissionForUser(e, visitor)\n    // Pass the data to the frontend.\n    c.ServeJSON()\n}\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Actualmente, la API ",(0,r.kt)("inlineCode",{parentName:"p"},"CasbinJsGetPermissionForUser")," solo es compatible con Go Casbin y Node-Casbin. Si quieres que esta API sea compatible en otros idiomas, por favor ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin.js/issues"},"plantea un problema")," o deja un comentario abajo.")),(0,r.kt)("h2",{id:"lista-de-api"},"Lista de API"),(0,r.kt)("h3",{id:"setpermissionpermission-string"},(0,r.kt)("inlineCode",{parentName:"h3"},"setPermission(permission: string)")),(0,r.kt)("p",null,"Establecer el objeto de permiso. Siempre se utiliza en modo ",(0,r.kt)("inlineCode",{parentName:"p"},"manual"),"."),(0,r.kt)("h3",{id:"setuseruser-string"},(0,r.kt)("inlineCode",{parentName:"h3"},"setUser(user: string)")),(0,r.kt)("p",null,"Establecer la identidad del visitante y actualizar el permiso. Siempre se utiliza en modo ",(0,r.kt)("inlineCode",{parentName:"p"},"auto"),"."),(0,r.kt)("h3",{id:"canaction-string-object-string"},(0,r.kt)("inlineCode",{parentName:"h3"},"can(action: string, object: string)")),(0,r.kt)("p",null,"Comprobar si el usuario puede realizar la ",(0,r.kt)("inlineCode",{parentName:"p"},"action")," en ",(0,r.kt)("inlineCode",{parentName:"p"},"object"),"."),(0,r.kt)("h3",{id:"cannotaction-string-object-string"},(0,r.kt)("inlineCode",{parentName:"h3"},"cannot(action: string, object: string)")),(0,r.kt)("p",null,"Comprobar si el usuario ",(0,r.kt)("strong",{parentName:"p"},"no puede")," realizar la ",(0,r.kt)("inlineCode",{parentName:"p"},"action")," en ",(0,r.kt)("inlineCode",{parentName:"p"},"object"),"."),(0,r.kt)("h3",{id:"canallaction-string-objects-arrayobject"},(0,r.kt)("inlineCode",{parentName:"h3"},"canAll(action: string, objects: Array<object>)")),(0,r.kt)("p",null,"Comprobar si el usuario puede realizar la ",(0,r.kt)("inlineCode",{parentName:"p"},"action")," en ",(0,r.kt)("strong",{parentName:"p"},"todos")," los objetos en ",(0,r.kt)("inlineCode",{parentName:"p"},"objects"),"."),(0,r.kt)("h3",{id:"cananyaction-string-objects-arrayobject"},(0,r.kt)("inlineCode",{parentName:"h3"},"canAny(action: string, objects: Array<object>)")),(0,r.kt)("p",null,"Comprobar si el usuario puede realizar la ",(0,r.kt)("inlineCode",{parentName:"p"},"action")," en ",(0,r.kt)("strong",{parentName:"p"},"cualquiera")," de los ",(0,r.kt)("inlineCode",{parentName:"p"},"objects"),"."),(0,r.kt)("h2",{id:"por-qu\xe9-casbinjs"},"Por qu\xe9 Casbin.js"),(0,r.kt)("p",null,"La gente puede preguntarse sobre la diferencia entre Node-Casbin y Casbin.js. En una palabra, Node-Casbin es el n\xfacleo de Casbin implementado en el entorno de NodeJS, y normalmente se utiliza como un kit de herramientas de gesti\xf3n de control de acceso en los extremos del servidor. Casbin.js es una biblioteca de frontend que te ayuda a utilizar Casbin para autorizar a los usuarios de tu p\xe1gina web en el lado del cliente."),(0,r.kt)("p",null,"Normalmente, no es adecuado construir directamente un servicio Casbin y realizar las tareas de autorizaci\xf3n/ejecuci\xf3n en una aplicaci\xf3n de frontend web debido a los siguientes problemas:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Cuando alguien activa el cliente, el enforcer se inicializar\xe1 y tirar\xe1 de todas las pol\xedticas de las capas persistentes del backend. Una alta concurrencia podr\xeda traer una fuerte presi\xf3n sobre las bases de datos y costar mucho ancho de banda de red."),(0,r.kt)("li",{parentName:"ol"},"Cargar todas las pol\xedticas al lado del cliente podr\xeda traer riesgos de seguridad."),(0,r.kt)("li",{parentName:"ol"},"Es dif\xedcil separar el cliente y el servidor, as\xed como facilitar el desarrollo \xe1gil.")),(0,r.kt)("p",null,"Necesitamos una herramienta que facilite el proceso de usar Casbin en el frontend. De hecho, el n\xfacleo de Casbin.js es la manipulaci\xf3n del permiso del usuario actual en el lado del cliente. Como mencionaste, Casbin.js hace una b\xfasqueda desde un punto final especificado. Este procedimiento sincronizar\xe1 el permiso del usuario con el servicio Casbin del backend. Despu\xe9s de tener los datos de permiso, los desarrolladores pueden usar las interfaces de Casbin.js para gestionar el comportamiento del usuario en el lado del frontend."),(0,r.kt)("p",null,"Casbin.js evita los dos problemas mencionados anteriormente: el servicio Casbin ya no se activar\xe1 repetidamente, y se reduce el tama\xf1o de los mensajes que pasan entre el cliente y el servidor. Tambi\xe9n evitamos almacenar todas las pol\xedticas en el frontend. El usuario solo puede acceder a su propio permiso, pero no tiene conocimiento sobre el modelo de control de acceso y los permisos de otros usuarios. Adem\xe1s, Casbin.js tambi\xe9n puede desacoplar eficientemente el cliente y el servidor en la gesti\xf3n de autorizaci\xf3n."))}p.isMDXComponent=!0}}]);