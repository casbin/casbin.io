"use strict";(globalThis.webpackChunkcasbin_website_v2=globalThis.webpackChunkcasbin_website_v2||[]).push([[5841],{987:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"envoy","title":"Authorization of Service Mesh through Envoy","description":"Autorizaci\xf3n de Service Mesh a trav\xe9s de Envoy","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/EnvoyAuthz.mdx","sourceDirName":".","slug":"/envoy","permalink":"/es/docs/envoy","draft":false,"unlisted":false,"editUrl":"https://github.com/casbin/casbin-website-v2/edit/master/docs/EnvoyAuthz.mdx","tags":[],"version":"current","frontMatter":{"id":"envoy","title":"Authorization of Service Mesh through Envoy","description":"Autorizaci\xf3n de Service Mesh a trav\xe9s de Envoy","keywords":["Envoy","Envoy-authz","Istio"],"authors":["ashish493"]},"sidebar":"docs","previous":{"title":"Admission Webhook for K8s","permalink":"/es/docs/k8s-gatekeeper"},"next":{"title":"Management","permalink":"/es/docs/category/management"}}');var s=i(4848),r=i(8453);const a={id:"envoy",title:"Authorization of Service Mesh through Envoy",description:"Autorizaci\xf3n de Service Mesh a trav\xe9s de Envoy",keywords:["Envoy","Envoy-authz","Istio"],authors:["ashish493"]},t=void 0,c={},d=[{value:"Requisitos",id:"requisitos",level:2},{value:"Funcionamiento del Middleware",id:"funcionamiento-del-middleware",level:2},{value:"Uso",id:"uso",level:2},{value:"Integraci\xf3n con Istio",id:"integraci\xf3n-con-istio",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/casbin/envoy-authz",children:"Envoy-authz"})," es un middleware para Envoy que realiza autorizaci\xf3n externa RBAC & ABAC a trav\xe9s de casbin. Este middleware utiliza la ",(0,s.jsx)(n.a,{href:"https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/security/ext_authz_filter.html",children:"API de autorizaci\xf3n externa de Envoy"})," a trav\xe9s de un servidor gRPC. Este proxy puede ser desplegado en cualquier tipo de malla de servicios basada en Envoy, como Istio."]}),"\n",(0,s.jsx)(n.h2,{id:"requisitos",children:"Requisitos"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Envoy 1.17+"}),"\n",(0,s.jsx)(n.li,{children:"Istio o cualquier otro tipo de malla de servicios"}),"\n",(0,s.jsx)(n.li,{children:"dependencias grpc"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Las dependencias se gestionan utilizando ",(0,s.jsx)(n.code,{children:"go.mod"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"funcionamiento-del-middleware",children:"Funcionamiento del Middleware"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Un cliente realiza una solicitud HTTP."}),"\n",(0,s.jsx)(n.li,{children:"El proxy Envoy env\xeda la solicitud al servidor gRPC."}),"\n",(0,s.jsx)(n.li,{children:"El servidor gRPC autoriza la solicitud bas\xe1ndose en las pol\xedticas de casbin."}),"\n",(0,s.jsx)(n.li,{children:"Si se autoriza, la solicitud se reenv\xeda; de lo contrario, se deniega."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["El servidor gRPC se basa en el protocol buffer de ",(0,s.jsx)(n.a,{href:"https://github.com/envoyproxy/envoy/blob/master/api/envoy/service/auth/v2alpha/external_auth.proto",children:"external_auth.proto"})," en Envoy."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-protobuf",children:"// A generic interface for performing authorization checks on incoming\n// requests to a networked service.\nservice Authorization {\n  // Performs an authorization check based on the attributes associated with the\n  // incoming request and returns a status of `OK` or not `OK`.\n  rpc Check(v2.CheckRequest) returns (v2.CheckResponse);\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Del archivo proto anterior, necesitamos utilizar el servicio ",(0,s.jsx)(n.code,{children:"Check()"})," en el servidor de autorizaci\xf3n."]}),"\n",(0,s.jsx)(n.h2,{id:"uso",children:"Uso"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Defina las pol\xedticas de Casbin en los archivos de configuraci\xf3n siguiendo esta ",(0,s.jsx)(n.a,{href:"/docs/how-it-works",children:"gu\xeda"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Puede verificar/probar sus pol\xedticas utilizando el ",(0,s.jsx)(n.a,{href:"/editor",children:"casbin-editor"})," en l\xednea."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Inicie el servidor de autenticaci\xf3n ejecutando:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"go build .\n./authz\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cargue la configuraci\xf3n de Envoy:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"envoy -c authz.yaml -l info\n"})}),"\n",(0,s.jsx)(n.p,{children:"Una vez que Envoy se inicia, interceptar\xe1 las solicitudes para el proceso de autorizaci\xf3n."}),"\n",(0,s.jsx)(n.h2,{id:"integraci\xf3n-con-istio",children:"Integraci\xf3n con Istio"}),"\n",(0,s.jsxs)(n.p,{children:["Para que este middleware funcione, necesita enviar encabezados personalizados que contengan nombres de usuario en el token JWT o encabezados. Puede consultar la ",(0,s.jsx)(n.a,{href:"https://istio.io/v1.4/docs/tasks/policy-enforcement/control-headers/",children:"documentaci\xf3n oficial de Istio"})," para obtener m\xe1s informaci\xf3n sobre la modificaci\xf3n de ",(0,s.jsx)(n.code,{children:"Request Headers"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>t});var o=i(6540);const s={},r=o.createContext(s);function a(e){const n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);