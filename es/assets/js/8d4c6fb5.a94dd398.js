"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[5689],{3905:(e,n,a)=>{a.d(n,{Zo:()=>l,kt:()=>u});var t=a(7294);function o(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function r(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(n){o(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function c(e,n){if(null==e)return{};var a,t,o=function(e,n){if(null==e)return{};var a,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var p=t.createContext({}),d=function(e){var n=t.useContext(p),a=n;return e&&(a="function"==typeof e?e(n):r(r({},n),e)),a},l=function(e){var n=d(e.components);return t.createElement(p.Provider,{value:n},e.children)},s={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var a=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),m=d(a),u=o,b=m["".concat(p,".").concat(u)]||m[u]||s[u]||i;return a?t.createElement(b,r(r({ref:n},l),{},{components:a})):t.createElement(b,r({ref:n},l))}));function u(e,n){var a=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=a.length,r=new Array(i);r[0]=m;var c={};for(var p in n)hasOwnProperty.call(n,p)&&(c[p]=n[p]);c.originalType=e,c.mdxType="string"==typeof e?e:o,r[1]=c;for(var d=2;d<i;d++)r[d]=a[d];return t.createElement.apply(null,r)}return t.createElement.apply(null,a)}m.displayName="MDXCreateElement"},3002:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>p,contentTitle:()=>r,default:()=>b,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var t=a(7462),o=(a(7294),a(3905));const i={id:"rbac-with-pattern",title:"RBAC with Pattern",description:"RBAC con Patr\xf3n",keywords:["RBAC with pattern","pattern matching"],authors:["hsluoyz"]},r=void 0,c={unversionedId:"rbac-with-pattern",id:"rbac-with-pattern",title:"RBAC with Pattern",description:"RBAC con Patr\xf3n",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/RBACWithPattern.mdx",sourceDirName:".",slug:"/rbac-with-pattern",permalink:"/es/docs/rbac-with-pattern",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBACWithPattern.mdx",tags:[],version:"current",frontMatter:{id:"rbac-with-pattern",title:"RBAC with Pattern",description:"RBAC con Patr\xf3n",keywords:["RBAC with pattern","pattern matching"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"RBAC",permalink:"/es/docs/rbac"},next:{title:"RBAC with Domains",permalink:"/es/docs/rbac-with-domains"}},p={},d=[{value:"Inicio R\xe1pido",id:"inicio-r\xe1pido",level:2},{value:"Usa coincidencia de patrones en RBAC",id:"usa-coincidencia-de-patrones-en-rbac",level:2}],l=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",n)},s=l("Tabs"),m=l("TabItem"),u={toc:d};function b(e){let{components:n,...i}=e;return(0,o.kt)("wrapper",(0,t.Z)({},u,i,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"inicio-r\xe1pido"},"Inicio R\xe1pido"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Usa patr\xf3n en ",(0,o.kt)("inlineCode",{parentName:"p"},"g(_, _)"),"."),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e, _ := NewEnforcer("./example.conf", "./example.csv")\ne.AddNamedMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Usa patr\xf3n con dominio."),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedDomainMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Usa todos los patrones."),(0,o.kt)("p",{parentName:"li"},"Solo combina el uso de ambas APIs."))),(0,o.kt)("p",null,"Como se muestra arriba, despu\xe9s de crear la instancia de ",(0,o.kt)("inlineCode",{parentName:"p"},"enforcer"),", necesitas activar la coincidencia de patrones a trav\xe9s de las APIs ",(0,o.kt)("inlineCode",{parentName:"p"},"AddNamedMatchingFunc")," y ",(0,o.kt)("inlineCode",{parentName:"p"},"AddNamedDomainMatchingFunc"),", que determinan c\xf3mo se realiza la coincidencia de patrones."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},'If you use the online editor, You can add a pattern matching function by clicking the "Add Role Matching" button in the lower left corner.\n',(0,o.kt)("img",{alt:"editor-tips",src:a(9523).Z,width:"690",height:"480"}))),(0,o.kt)("h2",{id:"usa-coincidencia-de-patrones-en-rbac"},"Usa coincidencia de patrones en RBAC"),(0,o.kt)("p",null,"A veces, quieres que ciertos sujetos, objetos o dominios/tenants con un patr\xf3n espec\xedfico sean autom\xe1ticamente asignados a un rol. Las funciones de coincidencia de patrones en RBAC pueden ayudarte a hacer eso. Una funci\xf3n de coincidencia de patrones comparte los mismos par\xe1metros y valor de retorno que la ",(0,o.kt)("a",{parentName:"p",href:"/docs/syntax-for-models#functions-in-matchers"},"funci\xf3n de coincidencia")," anterior."),(0,o.kt)("p",null,"La funci\xf3n de coincidencia de patrones soporta cada par\xe1metro de ",(0,o.kt)("inlineCode",{parentName:"p"},"g"),"."),(0,o.kt)("p",null,"Sabemos que normalmente RBAC se expresa como ",(0,o.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub)")," en un coincidente. Entonces podemos usar una pol\xedtica como:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csv"},"p, alice, book_group, read\ng, /book/1, book_group\ng, /book/2, book_group\n")),(0,o.kt)("p",null,"As\xed ",(0,o.kt)("inlineCode",{parentName:"p"},"alice")," puede leer todos los libros incluyendo ",(0,o.kt)("inlineCode",{parentName:"p"},"book 1")," y ",(0,o.kt)("inlineCode",{parentName:"p"},"book 2"),". Pero puede haber miles de libros, y es muy tedioso agregar cada libro al rol de libro (o grupo) con una regla de pol\xedtica ",(0,o.kt)("inlineCode",{parentName:"p"},"g"),"."),(0,o.kt)("p",null,"Pero con funciones de coincidencia de patrones, puedes escribir la pol\xedtica con solo una l\xednea:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csv"},"g, /book/:id, book_group\n")),(0,o.kt)("p",null,"Casbin coincidir\xe1 autom\xe1ticamente ",(0,o.kt)("inlineCode",{parentName:"p"},"/book/1")," y ",(0,o.kt)("inlineCode",{parentName:"p"},"/book/2")," en el patr\xf3n ",(0,o.kt)("inlineCode",{parentName:"p"},"/book/:id")," por ti. Solo necesitas registrar la funci\xf3n con el enforcer como:"),(0,o.kt)(s,{groupId:"langs",mdxType:"Tabs"},(0,o.kt)(m,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'))),(0,o.kt)(m,{value:"Node.js",label:"Node.js",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"await e.addNamedMatchingFunc('g', Util.keyMatch2Func);\n")))),(0,o.kt)("p",null,"Cuando usas una funci\xf3n de coincidencia de patrones en dominios/tenants, necesitas registrar la funci\xf3n con el enforcer y el modelo."),(0,o.kt)(s,{groupId:"langs",mdxType:"Tabs"},(0,o.kt)(m,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedDomainMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'))),(0,o.kt)(m,{value:"Node.js",label:"Node.js",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"await e.addNamedDomainMatchingFunc('g', Util.keyMatch2Func);\n")))),(0,o.kt)("p",null,"Si no entiendes qu\xe9 significa ",(0,o.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub, r.dom)"),", por favor lee ",(0,o.kt)("a",{parentName:"p",href:"/docs/rbac-with-domains"},"rbac-with-domains"),". En resumen, ",(0,o.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub, r.dom)")," verificar\xe1 si el usuario ",(0,o.kt)("inlineCode",{parentName:"p"},"r.sub")," tiene un rol ",(0,o.kt)("inlineCode",{parentName:"p"},"p.sub")," en el dominio ",(0,o.kt)("inlineCode",{parentName:"p"},"r.dom"),". As\xed es como funciona el coincidente. Puedes ver el ejemplo completo ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/dbdb6cbe2e7a80863e4951f9ff36da07fef01b75/model_test.go#L278-L307"},"aqu\xed"),"."),(0,o.kt)("p",null,"Aparte de la sintaxis de coincidencia de patrones anterior, tambi\xe9n podemos usar un patr\xf3n de dominio puro."),(0,o.kt)("p",null,"Por ejemplo, si queremos que ",(0,o.kt)("inlineCode",{parentName:"p"},"sub")," tenga acceso en diferentes dominios, ",(0,o.kt)("inlineCode",{parentName:"p"},"domain1")," y ",(0,o.kt)("inlineCode",{parentName:"p"},"domain2"),", podemos usar el patr\xf3n de dominio puro:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csv"},"p, admin, domain1, data1, read\np, admin, domain1, data1, write\np, admin, domain2, data2, read\np, admin, domain2, data2, write\n\ng, alice, admin, *\ng, bob, admin, domain2\n")),(0,o.kt)("p",null,"En este ejemplo, queremos que ",(0,o.kt)("inlineCode",{parentName:"p"},"alice")," lea y escriba ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," en domain1 y domain2. La coincidencia de patrones ",(0,o.kt)("inlineCode",{parentName:"p"},"*")," en ",(0,o.kt)("inlineCode",{parentName:"p"},"g")," hace que ",(0,o.kt)("inlineCode",{parentName:"p"},"alice")," tenga acceso a dos dominios."),(0,o.kt)("p",null,"Al usar coincidencia de patrones, especialmente en escenarios que son m\xe1s complicados y tienen muchos dominios u objetos a considerar, podemos implementar la ",(0,o.kt)("inlineCode",{parentName:"p"},"policy_definition")," de una manera m\xe1s elegante y efectiva."))}b.isMDXComponent=!0},9523:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/editor-tips-2c4bf3155a73f079c976e5ad118d5518.png"}}]);