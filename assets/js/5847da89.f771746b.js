"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[2094],{5933:function(t,e,a){a.r(e),a.d(e,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return d},toc:function(){return m},default:function(){return c}});var n=a(3117),l=a(102),r=(a(7294),a(3905)),i=["components"],o={id:"policy-storage",title:"Policy Storage"},p=void 0,d={unversionedId:"policy-storage",id:"policy-storage",isDocsHomePage:!1,title:"Policy Storage",description:"In Casbin, the policy storage is implemented as an adapter.",source:"@site/docs/PolicyStorage.mdx",sourceDirName:".",slug:"/policy-storage",permalink:"/docs/policy-storage",editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/PolicyStorage.mdx",tags:[],version:"current",frontMatter:{id:"policy-storage",title:"Policy Storage"},sidebar:"docs",previous:{title:"Model Storage",permalink:"/docs/model-storage"},next:{title:"Policy Subset Loading",permalink:"/docs/policy-subset-loading"}},m=[{value:"Load policy from .CSV file",id:"load-policy-from-csv-file",children:[],level:2},{value:"Adapter API",id:"adapter-api",children:[],level:2},{value:"Database Storage Format",id:"database-storage-format",children:[],level:2},{value:"Adapter Details",id:"adapter-details",children:[],level:2}],s={toc:m};function c(t){var e=t.components,a=(0,l.Z)(t,i);return(0,r.kt)("wrapper",(0,n.Z)({},s,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"In Casbin, the policy storage is implemented as an ",(0,r.kt)("a",{parentName:"p",href:"/docs/adapters"},"adapter"),". "),(0,r.kt)("h2",{id:"load-policy-from-csv-file"},"Load policy from .CSV file"),(0,r.kt)("p",null,"This is the most common way to use Casbin. It's easy to understand for beginners and convenient for sharing when you ask Casbin team for help."),(0,r.kt)("p",null,"The content of the ",(0,r.kt)("inlineCode",{parentName:"p"},".CSV")," file ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_policy.csv"},"examples/rbac_policy.csv"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"p, alice, data1, read\np, bob, data2, write\np, data2_admin, data2, read\np, data2_admin, data2, write\ng, alice, data2_admin\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If your file contains commas",(0,r.kt)("inlineCode",{parentName:"p"},",")," , you should wrap it in double quotes, for example:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre"},'p, alice, "data1,data2", read   --correct\np, alice, data1,data2, read     --incorrect ("data1,data2" should be a whole)\n')),(0,r.kt)("p",{parentName:"div"},"If your file contains commas",(0,r.kt)("inlineCode",{parentName:"p"},",")," and double quotes",(0,r.kt)("inlineCode",{parentName:"p"},'"'),", you should enclose the field in double quotes and double any embedded double quotes."),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre"},'p, alice, data, "r.act in (""get"", ""post"")"      --correct\np, alice, data, "r.act in ("get", "post")"          --incorrect (should use "" to escape "")\n')),(0,r.kt)("p",{parentName:"div"},"Related issue: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/issues/886"},"casbin#886")))),(0,r.kt)("h2",{id:"adapter-api"},"Adapter API"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Method"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LoadPolicy()"),(0,r.kt)("td",{parentName:"tr",align:null},"basic"),(0,r.kt)("td",{parentName:"tr",align:null},"Load all policy rules from the storage")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SavePolicy()"),(0,r.kt)("td",{parentName:"tr",align:null},"basic"),(0,r.kt)("td",{parentName:"tr",align:null},"Save all policy rules to the storage")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AddPolicy()"),(0,r.kt)("td",{parentName:"tr",align:null},"optional"),(0,r.kt)("td",{parentName:"tr",align:null},"Add a policy rule to the storage")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RemovePolicy()"),(0,r.kt)("td",{parentName:"tr",align:null},"optional"),(0,r.kt)("td",{parentName:"tr",align:null},"Remove a policy rule from the storage")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RemoveFilteredPolicy()"),(0,r.kt)("td",{parentName:"tr",align:null},"optional"),(0,r.kt)("td",{parentName:"tr",align:null},"Remove policy rules that match the filter from the storage")))),(0,r.kt)("h2",{id:"database-storage-format"},"Database Storage Format"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"your policy file")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"p, data2_admin, data2, read\np, data2_admin, data2, write\ng, alice, admin\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"corresponding database structure (Such as MySQL)")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"id"),(0,r.kt)("th",{parentName:"tr",align:null},"ptype"),(0,r.kt)("th",{parentName:"tr",align:null},"v0"),(0,r.kt)("th",{parentName:"tr",align:null},"v1"),(0,r.kt)("th",{parentName:"tr",align:null},"v2"),(0,r.kt)("th",{parentName:"tr",align:null},"v3"),(0,r.kt)("th",{parentName:"tr",align:null},"v4"),(0,r.kt)("th",{parentName:"tr",align:null},"v5"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"p"),(0,r.kt)("td",{parentName:"tr",align:null},"data2_admin"),(0,r.kt)("td",{parentName:"tr",align:null},"data2"),(0,r.kt)("td",{parentName:"tr",align:null},"read"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"p"),(0,r.kt)("td",{parentName:"tr",align:null},"data2_admin"),(0,r.kt)("td",{parentName:"tr",align:null},"data2"),(0,r.kt)("td",{parentName:"tr",align:null},"write"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"g"),(0,r.kt)("td",{parentName:"tr",align:null},"alice"),(0,r.kt)("td",{parentName:"tr",align:null},"admin"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The meaning of each column")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"id"),": Only exists in the database as the primary key. Not as part of the ",(0,r.kt)("inlineCode",{parentName:"p"},"casbin policy"),". The way it is generated depends on the specific adapter")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ptype"),": It corresponds to ",(0,r.kt)("inlineCode",{parentName:"p"},"p"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"g"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"g2"),", etc.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"v0-v5"),": The column names have no specific meaning, and correspond to the values in the ",(0,r.kt)("inlineCode",{parentName:"p"},"policy csv")," from left to right. The number of columns depends on how many you define yourself. In theory, there can be an infinite number of columns. But generally only ",(0,r.kt)("strong",{parentName:"p"},"6")," columns are implemented in adapter. If it is not enough for you, please submit an issue to the corresponding adapter repository. "))),(0,r.kt)("h2",{id:"adapter-details"},"Adapter Details"),(0,r.kt)("p",null,"More details about the use of adapter api and database table structure design,  Please go to:  ",(0,r.kt)("a",{parentName:"p",href:"/docs/adapters"},"/docs/adapters")))}c.isMDXComponent=!0}}]);