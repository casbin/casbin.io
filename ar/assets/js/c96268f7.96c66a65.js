"use strict";(globalThis.webpackChunkcasbin_website_v2=globalThis.webpackChunkcasbin_website_v2||[]).push([[8232],{4495(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>o});const c=JSON.parse('{"id":"k8s-gatekeeper","title":"Admission Webhook for K8s","description":"\u0648\u0633\u064a\u0637 \u062a\u0641\u0648\u064a\u0636 Kubernetes (K8s) RBAC & ABAC \u0627\u0644\u0645\u0628\u0646\u064a \u0639\u0644\u0649 Casbin","source":"@site/i18n/ar/docusaurus-plugin-content-docs/current/K8sGateKeeper.mdx","sourceDirName":".","slug":"/k8s-gatekeeper","permalink":"/ar/docs/k8s-gatekeeper","draft":false,"unlisted":false,"editUrl":"https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sGateKeeper.mdx","tags":[],"version":"current","frontMatter":{"id":"k8s-gatekeeper","title":"Admission Webhook for K8s","description":"\u0648\u0633\u064a\u0637 \u062a\u0641\u0648\u064a\u0636 Kubernetes (K8s) RBAC & ABAC \u0627\u0644\u0645\u0628\u0646\u064a \u0639\u0644\u0649 Casbin","keywords":["k8s-gatekeeper","Kubernetes","K8s"],"authors":["ComradeProgrammer"]},"sidebar":"docs","previous":{"title":"Authorization of Kubernetes","permalink":"/ar/docs/k8s"},"next":{"title":"Authorization of Service Mesh through Envoy","permalink":"/ar/docs/envoy"}}');var i=s(4848),l=s(8453);const r={id:"k8s-gatekeeper",title:"Admission Webhook for K8s",description:"\u0648\u0633\u064a\u0637 \u062a\u0641\u0648\u064a\u0636 Kubernetes (K8s) RBAC & ABAC \u0627\u0644\u0645\u0628\u0646\u064a \u0639\u0644\u0649 Casbin",keywords:["k8s-gatekeeper","Kubernetes","K8s"],authors:["ComradeProgrammer"]},a=void 0,d={},o=[{value:"1. \u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629 \u0648\u0648\u062b\u0627\u0626\u0642 \u0644\u0640 Casbin K8s-Gatekeeper",id:"1-\u0646\u0638\u0631\u0629-\u0639\u0627\u0645\u0629-\u0648\u0648\u062b\u0627\u0626\u0642-\u0644\u0640-casbin-k8s-gatekeeper",level:2},{value:"0.1 \u0645\u062b\u0627\u0644 \u0628\u0633\u064a\u0637",id:"01-\u0645\u062b\u0627\u0644-\u0628\u0633\u064a\u0637",level:3},{value:"1.1 \u0643\u064a\u0641 \u064a\u0639\u0645\u0644 Casbin K8s-Gatekeeper\u061f",id:"11-\u0643\u064a\u0641-\u064a\u0639\u0645\u0644-casbin-k8s-gatekeeper",level:3},{value:"1.2 \u0645\u062b\u0627\u0644 \u064a\u0648\u0636\u062d \u0643\u064a\u0641 \u064a\u0639\u0645\u0644",id:"12-\u0645\u062b\u0627\u0644-\u064a\u0648\u0636\u062d-\u0643\u064a\u0641-\u064a\u0639\u0645\u0644",level:3},{value:"2 \u062a\u062b\u0628\u064a\u062a K8s-gatekeeper",id:"2-\u062a\u062b\u0628\u064a\u062a-k8s-gatekeeper",level:2},{value:"2.1 \u0648\u064a\u0628 \u0647\u0648\u0643 \u062f\u0627\u062e\u0644\u064a",id:"21-\u0648\u064a\u0628-\u0647\u0648\u0643-\u062f\u0627\u062e\u0644\u064a",level:3},{value:"2.1.1 \u0627\u0644\u062e\u0637\u0648\u0629 1: \u0628\u0646\u0627\u0621 \u0627\u0644\u0635\u0648\u0631\u0629",id:"211-\u0627\u0644\u062e\u0637\u0648\u0629-1-\u0628\u0646\u0627\u0621-\u0627\u0644\u0635\u0648\u0631\u0629",level:4},{value:"2.1.2 \u0627\u0644\u062e\u0637\u0648\u0629 2: \u0625\u0639\u062f\u0627\u062f \u0627\u0644\u062e\u062f\u0645\u0627\u062a \u0648\u0627\u0644\u062a\u0648\u0632\u064a\u0639\u0627\u062a \u0644\u0640 K8s-gatekeeper",id:"212-\u0627\u0644\u062e\u0637\u0648\u0629-2-\u0625\u0639\u062f\u0627\u062f-\u0627\u0644\u062e\u062f\u0645\u0627\u062a-\u0648\u0627\u0644\u062a\u0648\u0632\u064a\u0639\u0627\u062a-\u0644\u0640-k8s-gatekeeper",level:4},{value:"2.1.3 \u0627\u0644\u062e\u0637\u0648\u0629 3: \u062a\u062b\u0628\u064a\u062a \u0645\u0648\u0627\u0631\u062f CRD \u0644\u0640 K8s-gatekeeper",id:"213-\u0627\u0644\u062e\u0637\u0648\u0629-3-\u062a\u062b\u0628\u064a\u062a-\u0645\u0648\u0627\u0631\u062f-crd-\u0644\u0640-k8s-gatekeeper",level:4},{value:"2.2 \u0627\u0644\u0648\u064a\u0628 \u0647\u0648\u0643 \u0627\u0644\u062e\u0627\u0631\u062c\u064a",id:"22-\u0627\u0644\u0648\u064a\u0628-\u0647\u0648\u0643-\u0627\u0644\u062e\u0627\u0631\u062c\u064a",level:3},{value:"2.3.1 \u0627\u0644\u062e\u0637\u0648\u0629 1: \u0628\u0646\u0627\u0621 \u0627\u0644\u0635\u0648\u0631\u0629",id:"231-\u0627\u0644\u062e\u0637\u0648\u0629-1-\u0628\u0646\u0627\u0621-\u0627\u0644\u0635\u0648\u0631\u0629",level:3},{value:"\u064a\u0631\u062c\u0649 \u0627\u0644\u0631\u062c\u0648\u0639 \u0625\u0644\u0649 \u0627\u0644\u0641\u0635\u0644 2.1.1.",id:"\u064a\u0631\u062c\u0649-\u0627\u0644\u0631\u062c\u0648\u0639-\u0625\u0644\u0649-\u0627\u0644\u0641\u0635\u0644-211",level:4},{value:"\u0642\u0645 \u0628\u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0623\u0645\u0631 <code>helm install k8sgatekeeper ./k8sgatekeeper</code>.",id:"\u0642\u0645-\u0628\u062a\u0634\u063a\u064a\u0644-\u0627\u0644\u0623\u0645\u0631-helm-install-k8sgatekeeper-k8sgatekeeper",level:4},{value:"\u062c\u0631\u0628 K8s-gatekeeper 3.1 \u0625\u0646\u0634\u0627\u0621 \u0646\u0645\u0648\u0630\u062c Casbin \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629",id:"\u062c\u0631\u0628-k8s-gatekeeper-31-\u0625\u0646\u0634\u0627\u0621-\u0646\u0645\u0648\u0630\u062c-casbin-\u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629",level:2},{value:"\u0644\u062f\u064a\u0643 \u0637\u0631\u064a\u0642\u062a\u0627\u0646 \u0644\u0625\u0646\u0634\u0627\u0621 \u0646\u0645\u0648\u0630\u062c \u0648\u0633\u064a\u0627\u0633\u0629: \u0639\u0628\u0631 kubectl \u0623\u0648 \u0639\u0628\u0631 go-client \u0627\u0644\u0630\u064a \u0646\u0642\u062f\u0645\u0647.",id:"\u0644\u062f\u064a\u0643-\u0637\u0631\u064a\u0642\u062a\u0627\u0646-\u0644\u0625\u0646\u0634\u0627\u0621-\u0646\u0645\u0648\u0630\u062c-\u0648\u0633\u064a\u0627\u0633\u0629-\u0639\u0628\u0631-kubectl-\u0623\u0648-\u0639\u0628\u0631-go-client-\u0627\u0644\u0630\u064a-\u0646\u0642\u062f\u0645\u0647",level:3},{value:"\u0641\u064a K8s-gatekeeper\u060c \u064a\u062a\u0645 \u062a\u062e\u0632\u064a\u0646 \u0646\u0645\u0648\u0630\u062c Casbin \u0641\u064a \u0645\u0648\u0631\u062f CRD \u064a\u0633\u0645\u0649 &#39;CasbinModel&#39;.",id:"\u0641\u064a-k8s-gatekeeper-\u064a\u062a\u0645-\u062a\u062e\u0632\u064a\u0646-\u0646\u0645\u0648\u0630\u062c-casbin-\u0641\u064a-\u0645\u0648\u0631\u062f-crd-\u064a\u0633\u0645\u0649-casbinmodel",level:4},{value:"\u0646\u062d\u0646 \u0646\u0641\u0647\u0645 \u0623\u0646 \u0647\u0646\u0627\u0643 \u062d\u0627\u0644\u0627\u062a \u0642\u062f \u0644\u0627 \u064a\u0643\u0648\u0646 \u0645\u0646 \u0627\u0644\u0645\u0644\u0627\u0626\u0645 \u0641\u064a\u0647\u0627 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0627\u0644\u0634\u0644 \u0644\u062a\u0646\u0641\u064a\u0630 \u0627\u0644\u0623\u0648\u0627\u0645\u0631 \u0645\u0628\u0627\u0634\u0631\u0629 \u0639\u0644\u0649 \u0639\u0642\u062f\u0629 \u0645\u0646 \u0639\u0642\u062f K8s\u060c \u0645\u062b\u0644 \u0639\u0646\u062f\u0645\u0627 \u062a\u0642\u0648\u0645 \u0628\u0628\u0646\u0627\u0621 \u0645\u0646\u0635\u0629 \u0633\u062d\u0627\u0628\u064a\u0629 \u062a\u0644\u0642\u0627\u0626\u064a\u0629 \u0644\u0634\u0631\u0643\u062a\u0643.",id:"\u0646\u062d\u0646-\u0646\u0641\u0647\u0645-\u0623\u0646-\u0647\u0646\u0627\u0643-\u062d\u0627\u0644\u0627\u062a-\u0642\u062f-\u0644\u0627-\u064a\u0643\u0648\u0646-\u0645\u0646-\u0627\u0644\u0645\u0644\u0627\u0626\u0645-\u0641\u064a\u0647\u0627-\u0627\u0633\u062a\u062e\u062f\u0627\u0645-\u0627\u0644\u0634\u0644-\u0644\u062a\u0646\u0641\u064a\u0630-\u0627\u0644\u0623\u0648\u0627\u0645\u0631-\u0645\u0628\u0627\u0634\u0631\u0629-\u0639\u0644\u0649-\u0639\u0642\u062f\u0629-\u0645\u0646-\u0639\u0642\u062f-k8s-\u0645\u062b\u0644-\u0639\u0646\u062f\u0645\u0627-\u062a\u0642\u0648\u0645-\u0628\u0628\u0646\u0627\u0621-\u0645\u0646\u0635\u0629-\u0633\u062d\u0627\u0628\u064a\u0629-\u062a\u0644\u0642\u0627\u0626\u064a\u0629-\u0644\u0634\u0631\u0643\u062a\u0643",level:4},{value:"3.1.2 \u062c\u0631\u0628 \u0645\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646 K8s-gatekeeper \u064a\u0639\u0645\u0644",id:"312-\u062c\u0631\u0628-\u0645\u0627-\u0625\u0630\u0627-\u0643\u0627\u0646-k8s-gatekeeper-\u064a\u0639\u0645\u0644",level:3},{value:"4. \u0643\u064a\u0641\u064a\u0629 \u0643\u062a\u0627\u0628\u0629 \u0627\u0644\u0646\u0645\u0648\u0630\u062c \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629 \u0645\u0639 K8s-gatekeeper",id:"4-\u0643\u064a\u0641\u064a\u0629-\u0643\u062a\u0627\u0628\u0629-\u0627\u0644\u0646\u0645\u0648\u0630\u062c-\u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629-\u0645\u0639-k8s-gatekeeper",level:2},{value:"4.1 \u062a\u0639\u0631\u064a\u0641 \u0627\u0644\u0637\u0644\u0628 \u0641\u064a \u0627\u0644\u0646\u0645\u0648\u0630\u062c",id:"41-\u062a\u0639\u0631\u064a\u0641-\u0627\u0644\u0637\u0644\u0628-\u0641\u064a-\u0627\u0644\u0646\u0645\u0648\u0630\u062c",level:3},{value:"4.2 \u0645\u0637\u0627\u0628\u0642\u0627\u062a \u0627\u0644\u0646\u0645\u0648\u0630\u062c",id:"42-\u0645\u0637\u0627\u0628\u0642\u0627\u062a-\u0627\u0644\u0646\u0645\u0648\u0630\u062c",level:3},{value:"4.2.1 \u0648\u0638\u0627\u0626\u0641 \u0627\u0644\u0625\u0636\u0627\u0641\u0629",id:"421-\u0648\u0638\u0627\u0626\u0641-\u0627\u0644\u0625\u0636\u0627\u0641\u0629",level:3},{value:"4.2.1.1 \u0627\u0644\u0648\u0635\u0648\u0644",id:"4211-\u0627\u0644\u0648\u0635\u0648\u0644",level:4},{value:"4.2.1.2 accessWithWildcard",id:"4212-accesswithwildcard",level:4},{value:"4.2.1.3 \u0648\u0638\u0627\u0626\u0641 \u062a\u062f\u0639\u0645 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062a \u0627\u0644\u0645\u062a\u063a\u064a\u0631\u0629 \u0627\u0644\u0637\u0648\u0644",id:"4213-\u0648\u0638\u0627\u0626\u0641-\u062a\u062f\u0639\u0645-\u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062a-\u0627\u0644\u0645\u062a\u063a\u064a\u0631\u0629-\u0627\u0644\u0637\u0648\u0644",level:3},{value:"4.2.1.2 \u0648\u0638\u0627\u0626\u0641 \u062a\u062d\u0648\u064a\u0644 \u0627\u0644\u0646\u0648\u0639",id:"4212-\u0648\u0638\u0627\u0626\u0641-\u062a\u062d\u0648\u064a\u0644-\u0627\u0644\u0646\u0648\u0639",level:4},{value:"5. \u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a \u0627\u0644\u0645\u062a\u0642\u062f\u0645\u0629",id:"5-\u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a-\u0627\u0644\u0645\u062a\u0642\u062f\u0645\u0629",level:2},{value:"5.1 \u062d\u0648\u0644 \u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a",id:"51-\u062d\u0648\u0644-\u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a",level:3},{value:"5.1.1 \u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a \u0630\u0627\u062a\u064a\u0629 \u0627\u0644\u062a\u0648\u0642\u064a\u0639",id:"511-\u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a-\u0630\u0627\u062a\u064a\u0629-\u0627\u0644\u062a\u0648\u0642\u064a\u0639",level:4},{value:"5.1.2 \u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a \u0627\u0644\u0642\u0627\u0646\u0648\u0646\u064a\u0629",id:"512-\u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a-\u0627\u0644\u0642\u0627\u0646\u0648\u0646\u064a\u0629",level:4}];function t(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"1-\u0646\u0638\u0631\u0629-\u0639\u0627\u0645\u0629-\u0648\u0648\u062b\u0627\u0626\u0642-\u0644\u0640-casbin-k8s-gatekeeper",children:"1. \u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629 \u0648\u0648\u062b\u0627\u0626\u0642 \u0644\u0640 Casbin K8s-Gatekeeper"}),"\n",(0,i.jsx)(n.p,{children:"Casbin K8s-GateKeeper \u0647\u0648 \u0648\u064a\u0628 \u0647\u0648\u0643 \u0644\u0644\u0642\u0628\u0648\u0644 \u0641\u064a Kubernetes \u064a\u062f\u0645\u062c Casbin \u0643\u0623\u062f\u0627\u0629 \u0644\u0644\u062a\u062d\u0643\u0645 \u0641\u064a \u0627\u0644\u0648\u0635\u0648\u0644. \u0628\u0627\u0633\u062a\u062e\u062f\u0627\u0645 Casbin K8s-GateKeeper\u060c \u064a\u0645\u0643\u0646\u0643 \u0625\u0646\u0634\u0627\u0621 \u0642\u0648\u0627\u0639\u062f \u0645\u0631\u0646\u0629 \u0644\u062a\u0641\u0648\u064a\u0636 \u0623\u0648 \u0627\u0639\u062a\u0631\u0627\u0636 \u0623\u064a \u0639\u0645\u0644\u064a\u0629 \u0639\u0644\u0649 \u0645\u0648\u0627\u0631\u062f K8s\u060c \u062f\u0648\u0646 \u0643\u062a\u0627\u0628\u0629 \u0623\u064a \u062c\u0632\u0621 \u0645\u0646 \u0627\u0644\u0643\u0648\u062f\u060c \u0648\u0644\u0643\u0646 \u0641\u0642\u0637 \u0628\u0639\u0636 \u0627\u0644\u0623\u0633\u0637\u0631 \u0645\u0646 \u0627\u0644\u062a\u0643\u0648\u064a\u0646\u0627\u062a \u0627\u0644\u0625\u0639\u0644\u0627\u0646\u064a\u0629 \u0644\u0646\u0645\u0627\u0630\u062c \u0648\u0633\u064a\u0627\u0633\u0627\u062a Casbin\u060c \u0648\u0627\u0644\u062a\u064a \u0647\u064a \u062c\u0632\u0621 \u0645\u0646 \u0644\u063a\u0629 \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u062a\u062d\u0643\u0645 \u0641\u064a \u0627\u0644\u0648\u0635\u0648\u0644 (ACL) \u0627\u0644\u062e\u0627\u0635\u0629 \u0628\u0640 Casbin."}),"\n",(0,i.jsxs)(n.p,{children:["Casbin K8s-GateKeeper \u062a\u0645 \u062a\u0637\u0648\u064a\u0631\u0647 \u0648\u0635\u064a\u0627\u0646\u062a\u0647 \u0645\u0646 \u0642\u0628\u0644 \u0645\u062c\u062a\u0645\u0639 Casbin. \u0645\u0633\u062a\u0648\u062f\u0639 \u0647\u0630\u0627 \u0627\u0644\u0645\u0634\u0631\u0648\u0639 \u0645\u062a\u0627\u062d \u0647\u0646\u0627: ",(0,i.jsx)(n.a,{href:"https://github.com/casbin/k8s-gatekeeper",children:"https://github.com/casbin/k8s-gatekeeper"})]}),"\n",(0,i.jsx)(n.h3,{id:"01-\u0645\u062b\u0627\u0644-\u0628\u0633\u064a\u0637",children:"0.1 \u0645\u062b\u0627\u0644 \u0628\u0633\u064a\u0637"}),"\n",(0,i.jsx)(n.p,{children:'\u0639\u0644\u0649 \u0633\u0628\u064a\u0644 \u0627\u0644\u0645\u062b\u0627\u0644\u060c \u0644\u0627 \u062a\u062d\u062a\u0627\u062c \u0625\u0644\u0649 \u0643\u062a\u0627\u0628\u0629 \u0623\u064a \u0643\u0648\u062f\u060c \u0648\u0644\u0643\u0646 \u0627\u0633\u062a\u062e\u062f\u0645 \u0627\u0644\u0623\u0633\u0637\u0631 \u0627\u0644\u062a\u0627\u0644\u064a\u0629 \u0645\u0646 \u0627\u0644\u062a\u0643\u0648\u064a\u0646 \u0644\u062a\u062d\u0642\u064a\u0642 \u0647\u0630\u0647 \u0627\u0644\u0648\u0638\u064a\u0641\u0629: "\u0645\u0646\u0639 \u0627\u0644\u0635\u0648\u0631 \u0630\u0627\u062a \u0627\u0644\u0639\u0644\u0627\u0645\u0627\u062a \u0627\u0644\u0645\u062d\u062f\u062f\u0629 \u0645\u0646 \u0627\u0644\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0641\u064a \u0623\u064a \u0639\u0645\u0644\u064a\u0627\u062a \u0646\u0634\u0631":'}),"\n",(0,i.jsx)(n.p,{children:"Model:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:'[request_definition]\nr =  obj\n\n[policy_definition]\np =  obj,eft\n\n[policy_effect]\ne = !some(where (p.eft == deny))\n\n[matchers]\nm = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\ncontain(split(accessWithWildcard(${OBJECT}.Spec.Template.Spec.Containers , "*", "Image"),":",1) , p.obj)\n'})}),"\n",(0,i.jsx)(n.p,{children:"And Policy:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csv",children:'p, "1.14.1",deny\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u0647\u0630\u0647 \u0628\u0644\u063a\u0629 Casbin ACL \u0627\u0644\u0639\u0627\u062f\u064a\u0629. \u0644\u0646\u0641\u062a\u0631\u0636 \u0623\u0646\u0643 \u0642\u062f \u0642\u0631\u0623\u062a \u0628\u0627\u0644\u0641\u0639\u0644 \u0627\u0644\u0641\u0635\u0648\u0644 \u0639\u0646\u0647\u0627\u060c \u0633\u064a\u0643\u0648\u0646 \u0645\u0646 \u0627\u0644\u0633\u0647\u0644 \u062c\u062f\u064b\u0627 \u0641\u0647\u0645\u0647\u0627."}),"\n",(0,i.jsx)(n.p,{children:"Casbin K8s-Gatekeeper \u0644\u0647 \u0627\u0644\u0645\u0632\u0627\u064a\u0627 \u0627\u0644\u062a\u0627\u0644\u064a\u0629:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u0633\u0647\u0644 \u0627\u0644\u0627\u0633\u062a\u062e\u062f\u0627\u0645. \u0643\u062a\u0627\u0628\u0629 \u0628\u0639\u0636 \u0627\u0644\u0623\u0633\u0637\u0631 \u0645\u0646 ACL \u0623\u0641\u0636\u0644 \u0628\u0643\u062b\u064a\u0631 \u0645\u0646 \u0643\u062a\u0627\u0628\u0629 \u0627\u0644\u0643\u062b\u064a\u0631 \u0645\u0646 \u0627\u0644\u0643\u0648\u062f."}),"\n",(0,i.jsx)(n.li,{children:"\u064a\u0633\u0645\u062d \u0628\u062a\u062d\u062f\u064a\u062b\u0627\u062a \u0633\u0627\u062e\u0646\u0629 \u0644\u0644\u062a\u0643\u0648\u064a\u0646\u0627\u062a. \u0644\u0627 \u062a\u062d\u062a\u0627\u062c \u0625\u0644\u0649 \u0625\u064a\u0642\u0627\u0641 \u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0625\u0636\u0627\u0641\u0629 \u0628\u0623\u0643\u0645\u0644\u0647\u0627 \u0644\u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u062a\u0643\u0648\u064a\u0646\u0627\u062a."}),"\n",(0,i.jsxs)(n.li,{children:["\u0647\u0648 \u0645\u0631\u0646. \u064a\u0645\u0643\u0646 \u0635\u0646\u0639 \u0642\u0648\u0627\u0639\u062f \u062a\u0639\u0633\u0641\u064a\u0629 \u0639\u0644\u0649 \u0623\u064a \u0645\u0648\u0631\u062f K8s\u060c \u0648\u0627\u0644\u062a\u064a \u064a\u0645\u0643\u0646 \u0627\u0633\u062a\u0643\u0634\u0627\u0641\u0647\u0627 \u0645\u0639 ",(0,i.jsx)(n.code,{children:"kubectl gatekeeper"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"\u064a\u0628\u0633\u0637 \u062a\u0646\u0641\u064a\u0630 \u0648\u064a\u0628 \u0647\u0648\u0643 \u0627\u0644\u0642\u0628\u0648\u0644 \u0641\u064a K8s\u060c \u0648\u0627\u0644\u0630\u064a \u064a\u0639\u062a\u0628\u0631 \u0645\u0639\u0642\u062f\u064b\u0627 \u0644\u0644\u063a\u0627\u064a\u0629. \u0644\u0627 \u062a\u062d\u062a\u0627\u062c \u0625\u0644\u0649 \u0645\u0639\u0631\u0641\u0629 \u0645\u0627 \u0647\u0648 \u0648\u064a\u0628 \u0647\u0648\u0643 \u0627\u0644\u0642\u0628\u0648\u0644 \u0641\u064a K8s \u0623\u0648 \u0643\u064a\u0641\u064a\u0629 \u0643\u062a\u0627\u0628\u0629 \u0627\u0644\u0643\u0648\u062f \u0644\u0647. \u0643\u0644 \u0645\u0627 \u062a\u062d\u062a\u0627\u062c \u0625\u0644\u0649 \u0645\u0639\u0631\u0641\u062a\u0647 \u0647\u0648 \u0627\u0644\u0645\u0648\u0631\u062f \u0627\u0644\u0630\u064a \u062a\u0631\u064a\u062f \u0648\u0636\u0639 \u0642\u064a\u0648\u062f \u0639\u0644\u064a\u0647 \u062b\u0645 \u0643\u062a\u0627\u0628\u0629 Casbin ACL. \u0627\u0644\u062c\u0645\u064a\u0639 \u064a\u0639\u0644\u0645 \u0623\u0646 K8s \u0645\u0639\u0642\u062f\u060c \u0648\u0644\u0643\u0646 \u0628\u0627\u0633\u062a\u062e\u062f\u0627\u0645 Casbin K8s-Gatekeeper\u060c \u064a\u0645\u0643\u0646 \u062a\u0648\u0641\u064a\u0631 \u0648\u0642\u062a\u0643."}),"\n",(0,i.jsx)(n.li,{children:"\u064a\u062a\u0645 \u0635\u064a\u0627\u0646\u062a\u0647 \u0645\u0646 \u0642\u0628\u0644 \u0645\u062c\u062a\u0645\u0639 Casbin. \u0644\u0627 \u062a\u062a\u0631\u062f\u062f \u0641\u064a \u0627\u0644\u0627\u062a\u0635\u0627\u0644 \u0628\u0646\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646 \u0647\u0646\u0627\u0643 \u0623\u064a \u0634\u064a\u0621 \u064a\u062d\u064a\u0631\u0643 \u062d\u0648\u0644 \u0647\u0630\u0647 \u0627\u0644\u0625\u0636\u0627\u0641\u0629 \u0623\u0648 \u0625\u0630\u0627 \u0648\u0627\u062c\u0647\u062a \u0623\u064a \u0645\u0634\u0627\u0643\u0644 \u0639\u0646\u062f \u062a\u062c\u0631\u0628\u062a\u0647\u0627."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"11-\u0643\u064a\u0641-\u064a\u0639\u0645\u0644-casbin-k8s-gatekeeper",children:"1.1 \u0643\u064a\u0641 \u064a\u0639\u0645\u0644 Casbin K8s-Gatekeeper\u061f"}),"\n",(0,i.jsxs)(n.p,{children:["K8s-Gatekeeper \u0647\u0648 \u0648\u064a\u0628 \u0647\u0648\u0643 \u0644\u0644\u0642\u0628\u0648\u0644 \u0641\u064a K8s \u064a\u0633\u062a\u062e\u062f\u0645 ",(0,i.jsx)(n.a,{href:"/docs/overview",children:"Casbin"})," \u0644\u062a\u0637\u0628\u064a\u0642 \u0642\u0648\u0627\u0639\u062f \u062a\u062d\u0643\u0645 \u0641\u064a \u0627\u0644\u0648\u0635\u0648\u0644 \u0645\u062d\u062f\u062f\u0629 \u0645\u0646 \u0642\u0628\u0644 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 \u0628\u0634\u0643\u0644 \u062a\u0639\u0633\u0641\u064a \u0644\u0644\u0645\u0633\u0627\u0639\u062f\u0629 \u0641\u064a \u0645\u0646\u0639 \u0623\u064a \u0639\u0645\u0644\u064a\u0629 \u0639\u0644\u0649 K8s \u0644\u0627 \u064a\u0631\u064a\u062f\u0647\u0627 \u0627\u0644\u0645\u0633\u0624\u0648\u0644."]}),"\n",(0,i.jsxs)(n.p,{children:["Casbin \u0647\u0648 \u0645\u0643\u062a\u0628\u0629 \u062a\u062d\u0643\u0645 \u0641\u064a \u0627\u0644\u0648\u0635\u0648\u0644 \u0645\u0641\u062a\u0648\u062d\u0629 \u0627\u0644\u0645\u0635\u062f\u0631 \u0642\u0648\u064a\u0629 \u0648\u0641\u0639\u0627\u0644\u0629. \u064a\u0648\u0641\u0631 \u062f\u0639\u0645\u064b\u0627 \u0644\u062a\u0637\u0628\u064a\u0642 \u0627\u0644\u062a\u0641\u0648\u064a\u0636 \u0628\u0646\u0627\u0621\u064b \u0639\u0644\u0649 \u0646\u0645\u0627\u0630\u062c \u062a\u062d\u0643\u0645 \u0641\u064a \u0627\u0644\u0648\u0635\u0648\u0644 \u0627\u0644\u0645\u062e\u062a\u0644\u0641\u0629. \u0644\u0645\u0632\u064a\u062f \u0645\u0646 \u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644 \u062d\u0648\u0644 Casbin\u060c \u0627\u0646\u0638\u0631 ",(0,i.jsx)(n.a,{href:"/docs/overview",children:"\u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["\u0648\u064a\u0628 \u0647\u0648\u0643 \u0627\u0644\u0642\u0628\u0648\u0644 \u0641\u064a K8s \u0647\u064a \u0627\u0633\u062a\u062f\u0639\u0627\u0621\u0627\u062a HTTP \u062a\u062a\u0644\u0642\u0649 '\u0637\u0644\u0628\u0627\u062a \u0627\u0644\u0642\u0628\u0648\u0644' \u0648\u062a\u0642\u0648\u0645 \u0628\u0634\u064a\u0621 \u0645\u0627 \u0645\u0639\u0647\u0627. \u0639\u0644\u0649 \u0648\u062c\u0647 \u0627\u0644\u062e\u0635\u0648\u0635\u060c K8s-Gatekeeper \u0647\u0648 \u0646\u0648\u0639 \u062e\u0627\u0635 \u0645\u0646 \u0648\u064a\u0628 \u0647\u0648\u0643 \u0627\u0644\u0642\u0628\u0648\u0644: 'ValidatingAdmissionWebhook'\u060c \u0648\u0627\u0644\u0630\u064a \u064a\u0645\u0643\u0646\u0647 \u0623\u0646 \u064a\u0642\u0631\u0631 \u0645\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646 \u0633\u064a\u0642\u0628\u0644 \u0637\u0644\u0628 \u0627\u0644\u0642\u0628\u0648\u0644 \u0647\u0630\u0627 \u0623\u0645 \u0644\u0627. \u0623\u0645\u0627 \u0628\u0627\u0644\u0646\u0633\u0628\u0629 \u0644\u0637\u0644\u0628\u0627\u062a \u0627\u0644\u0642\u0628\u0648\u0644\u060c \u0641\u0647\u064a \u0637\u0644\u0628\u0627\u062a HTTP \u062a\u0635\u0641 \u0639\u0645\u0644\u064a\u0629 \u0639\u0644\u0649 \u0645\u0648\u0627\u0631\u062f \u0645\u062d\u062f\u062f\u0629 \u0641\u064a K8s (\u0639\u0644\u0649 \u0633\u0628\u064a\u0644 \u0627\u0644\u0645\u062b\u0627\u0644\u060c \u0625\u0646\u0634\u0627\u0621/\u062d\u0630\u0641 \u0639\u0645\u0644\u064a\u0629 \u0646\u0634\u0631). \u0644\u0645\u0632\u064a\u062f \u0645\u0646 \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a \u062d\u0648\u0644 \u0648\u064a\u0628 \u0647\u0648\u0643 \u0627\u0644\u0642\u0628\u0648\u0644\u060c \u0627\u0646\u0638\u0631 ",(0,i.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#what-are-admission-webhooks",children:"\u0627\u0644\u0648\u062b\u0627\u0626\u0642 \u0627\u0644\u0631\u0633\u0645\u064a\u0629 \u0644\u0640 K8s"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"12-\u0645\u062b\u0627\u0644-\u064a\u0648\u0636\u062d-\u0643\u064a\u0641-\u064a\u0639\u0645\u0644",children:"1.2 \u0645\u062b\u0627\u0644 \u064a\u0648\u0636\u062d \u0643\u064a\u0641 \u064a\u0639\u0645\u0644"}),"\n",(0,i.jsx)(n.p,{children:"\u0639\u0644\u0649 \u0633\u0628\u064a\u0644 \u0627\u0644\u0645\u062b\u0627\u0644\u060c \u0639\u0646\u062f\u0645\u0627 \u064a\u0631\u063a\u0628 \u0634\u062e\u0635 \u0645\u0627 \u0641\u064a \u0625\u0646\u0634\u0627\u0621 \u0639\u0645\u0644\u064a\u0629 \u0646\u0634\u0631 \u062a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0628\u0648\u062f \u064a\u0634\u063a\u0644 nginx (\u0628\u0627\u0633\u062a\u062e\u062f\u0627\u0645 kubectl \u0623\u0648 \u0639\u0645\u0644\u0627\u0621 K8s)\u060c \u0633\u064a\u0648\u0644\u062f K8s \u0637\u0644\u0628 \u0642\u0628\u0648\u0644\u060c \u0648\u0627\u0644\u0630\u064a (\u0625\u0630\u0627 \u062a\u0645 \u062a\u0631\u062c\u0645\u062a\u0647 \u0625\u0644\u0649 \u062a\u0646\u0633\u064a\u0642 YAML) \u064a\u0645\u0643\u0646 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0634\u064a\u0626\u064b\u0627 \u0645\u062b\u0644 \u0647\u0630\u0627:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.1\n        ports:\n        - containerPort: 80\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u0633\u064a\u0645\u0631 \u0647\u0630\u0627 \u0627\u0644\u0637\u0644\u0628 \u0628\u0639\u0645\u0644\u064a\u0629 \u062c\u0645\u064a\u0639 \u0627\u0644\u0648\u0633\u0637\u0627\u0621 \u0627\u0644\u0645\u0648\u0636\u062d\u064a\u0646 \u0641\u064a \u0627\u0644\u0635\u0648\u0631\u0629\u060c \u0628\u0645\u0627 \u0641\u064a \u0630\u0644\u0643 K8s-Gatekeeper \u0627\u0644\u062e\u0627\u0635 \u0628\u0646\u0627. \u064a\u0645\u0643\u0646 \u0644\u0640 K8s-Gatekeeper \u0627\u0643\u062a\u0634\u0627\u0641 \u062c\u0645\u064a\u0639 \u0645\u0637\u0628\u0642\u0627\u062a Casbin \u0627\u0644\u0645\u062e\u0632\u0646\u0629 \u0641\u064a etcd \u0627\u0644\u062e\u0627\u0635 \u0628\u0640 K8s\u060c \u0648\u0627\u0644\u062a\u064a \u064a\u062a\u0645 \u0625\u0646\u0634\u0627\u0624\u0647\u0627 \u0648\u0635\u064a\u0627\u0646\u062a\u0647\u0627 \u0645\u0646 \u0642\u0628\u0644 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 (\u0639\u0628\u0631 ",(0,i.jsx)(n.code,{children:"kubectl"})," \u0623\u0648 \u0627\u0644\u0639\u0645\u064a\u0644 Go \u0627\u0644\u0630\u064a \u0646\u0648\u0641\u0631\u0647). \u0643\u0644 \u0645\u0637\u0628\u0642 \u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0646\u0645\u0648\u0630\u062c Casbin \u0648\u0633\u064a\u0627\u0633\u0629 Casbin. \u0633\u064a\u062a\u0645 \u0645\u0639\u0627\u0644\u062c\u0629 \u0637\u0644\u0628 \u0627\u0644\u0642\u0628\u0648\u0644 \u0628\u0648\u0627\u0633\u0637\u0629 \u0643\u0644 \u0645\u0637\u0628\u0642\u060c \u0648\u0627\u062d\u062f\u064b\u0627 \u062a\u0644\u0648 \u0627\u0644\u0622\u062e\u0631\u060c \u0648\u0641\u0642\u0637 \u0628\u0627\u0644\u0645\u0631\u0648\u0631 \u0639\u0628\u0631 \u062c\u0645\u064a\u0639 \u0627\u0644\u0645\u0637\u0628\u0642\u0627\u062a \u064a\u0645\u0643\u0646 \u0642\u0628\u0648\u0644 \u0637\u0644\u0628 \u0628\u0648\u0627\u0633\u0637\u0629 \u0647\u0630\u0627 K8s-Gatekeeper."]}),"\n",(0,i.jsxs)(n.p,{children:["(\u0625\u0630\u0627 \u0643\u0646\u062a \u0644\u0627 \u062a\u0641\u0647\u0645 \u0645\u0627 \u0647\u0648 \u0645\u0637\u0628\u0642 Casbin\u060c \u0623\u0648 \u0646\u0645\u0648\u0630\u062c\u060c \u0623\u0648 \u0633\u064a\u0627\u0633\u0629\u060c \u0627\u0646\u0638\u0631 \u0647\u0630\u0627 \u0627\u0644\u0648\u062b\u064a\u0642\u0629: ",(0,i.jsx)(n.a,{href:"/docs/get-started",children:"\u0627\u0644\u0628\u062f\u0621"}),")."]}),"\n",(0,i.jsx)(n.p,{children:"\u0639\u0644\u0649 \u0633\u0628\u064a\u0644 \u0627\u0644\u0645\u062b\u0627\u0644\u060c \u0644\u0633\u0628\u0628 \u0645\u0627\u060c \u064a\u0631\u064a\u062f \u0627\u0644\u0645\u0633\u0624\u0648\u0644 \u0645\u0646\u0639 \u0638\u0647\u0648\u0631 \u0627\u0644\u0635\u0648\u0631\u0629 'nginx:1.14.1' \u0645\u0639 \u0627\u0644\u0633\u0645\u0627\u062d \u0628\u0640 'nginx:1.3.1'. \u064a\u0645\u0643\u0646 \u0625\u0646\u0634\u0627\u0621 \u0645\u0637\u0628\u0642 \u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0627\u0644\u0642\u0627\u0639\u062f\u0629 \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629 \u0627\u0644\u062a\u0627\u0644\u064a\u0629 (\u0633\u0646\u0634\u0631\u062d \u0643\u064a\u0641\u064a\u0629 \u0625\u0646\u0634\u0627\u0621 \u0645\u0637\u0628\u0642\u060c \u0645\u0627 \u0647\u064a \u0647\u0630\u0647 \u0627\u0644\u0646\u0645\u0627\u0630\u062c \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0627\u062a\u060c \u0648\u0643\u064a\u0641\u064a\u0629 \u0643\u062a\u0627\u0628\u062a\u0647\u0627 \u0641\u064a \u0627\u0644\u0641\u0635\u0648\u0644 \u0627\u0644\u062a\u0627\u0644\u064a\u0629)."}),"\n",(0,i.jsx)(n.p,{children:"Model:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:'[request_definition]\nr =  obj\n\n[policy_definition]\np =  obj,eft\n\n[policy_effect]\ne = !some(where (p.eft == deny))\n\n[matchers]\nm = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\naccess(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Image") == p.obj\n\n'})}),"\n",(0,i.jsx)(n.p,{children:"Policy:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csv",children:'p, "nginx:1.13.1",allow\np, "nginx:1.14.1",deny\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u0628\u0625\u0646\u0634\u0627\u0621 \u0645\u0637\u0628\u0642 \u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0627\u0644\u0646\u0645\u0648\u0630\u062c \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629 \u0623\u0639\u0644\u0627\u0647\u060c \u0633\u064a\u062a\u0645 \u0631\u0641\u0636 \u0637\u0644\u0628 \u0627\u0644\u0642\u0628\u0648\u0644 \u0627\u0644\u0633\u0627\u0628\u0642 \u0645\u0646 \u0642\u0628\u0644 \u0647\u0630\u0627 \u0627\u0644\u0645\u0637\u0628\u0642\u060c \u0645\u0645\u0627 \u064a\u0639\u0646\u064a \u0623\u0646 K8s \u0644\u0646 \u064a\u0646\u0634\u0626 \u0647\u0630\u0647 \u0627\u0644\u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u0646\u0634\u0631."}),"\n",(0,i.jsx)(n.h2,{id:"2-\u062a\u062b\u0628\u064a\u062a-k8s-gatekeeper",children:"2 \u062a\u062b\u0628\u064a\u062a K8s-gatekeeper"}),"\n",(0,i.jsx)(n.p,{children:"\u0647\u0646\u0627\u0643 \u062b\u0644\u0627\u062b \u0637\u0631\u0642 \u0645\u062a\u0627\u062d\u0629 \u0644\u062a\u062b\u0628\u064a\u062a K8s-gatekeeper: \u0648\u064a\u0628 \u0647\u0648\u0643 \u062e\u0627\u0631\u062c\u064a\u060c \u0648\u064a\u0628 \u0647\u0648\u0643 \u062f\u0627\u062e\u0644\u064a\u060c \u0648Helm."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["\u0645\u0644\u0627\u062d\u0638\u0629: \u0647\u0630\u0647 \u0627\u0644\u0637\u0631\u0642 \u0645\u062e\u0635\u0635\u0629 \u0641\u0642\u0637 \u0644\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646 \u0644\u062a\u062c\u0631\u0628\u0629 K8s-gatekeeper \u0648\u0644\u064a\u0633\u062a \u0622\u0645\u0646\u0629. \u0625\u0630\u0627 \u0643\u0646\u062a \u062a\u0631\u063a\u0628 \u0641\u064a \u0627\u0633\u062a\u062e\u062f\u0627\u0645\u0647 \u0641\u064a \u0628\u064a\u0626\u0629 \u0625\u0646\u062a\u0627\u062c\u064a\u0629\u060c \u064a\u0631\u062c\u0649 \u0627\u0644\u062a\u0623\u0643\u062f \u0645\u0646 \u0642\u0631\u0627\u0621\u0629 ",(0,i.jsx)(n.a,{href:"#5-advanced-settings",children:"\u0627\u0644\u0641\u0635\u0644 5. \u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a \u0627\u0644\u0645\u062a\u0642\u062f\u0645\u0629"})," \u0648\u0625\u062c\u0631\u0627\u0621 \u0623\u064a \u062a\u0639\u062f\u064a\u0644\u0627\u062a \u0636\u0631\u0648\u0631\u064a\u0629 \u0642\u0628\u0644 \u0627\u0644\u062a\u062b\u0628\u064a\u062a."]})}),"\n",(0,i.jsx)(n.h3,{id:"21-\u0648\u064a\u0628-\u0647\u0648\u0643-\u062f\u0627\u062e\u0644\u064a",children:"2.1 \u0648\u064a\u0628 \u0647\u0648\u0643 \u062f\u0627\u062e\u0644\u064a"}),"\n",(0,i.jsx)(n.h4,{id:"211-\u0627\u0644\u062e\u0637\u0648\u0629-1-\u0628\u0646\u0627\u0621-\u0627\u0644\u0635\u0648\u0631\u0629",children:"2.1.1 \u0627\u0644\u062e\u0637\u0648\u0629 1: \u0628\u0646\u0627\u0621 \u0627\u0644\u0635\u0648\u0631\u0629"}),"\n",(0,i.jsx)(n.p,{children:"\u0644\u0644\u0637\u0631\u064a\u0642\u0629 \u0627\u0644\u062f\u0627\u062e\u0644\u064a\u0629 \u0644\u0644\u0648\u064a\u0628 \u0647\u0648\u0643\u060c \u0633\u064a\u062a\u0645 \u062a\u0646\u0641\u064a\u0630 \u0627\u0644\u0648\u064a\u0628 \u0647\u0648\u0643 \u0646\u0641\u0633\u0647 \u0643\u062e\u062f\u0645\u0629 \u062f\u0627\u062e\u0644 Kubernetes. \u0644\u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062e\u062f\u0645\u0629 \u0648\u0627\u0644\u062a\u0648\u0632\u064a\u0639 \u0627\u0644\u0644\u0627\u0632\u0645\u064a\u0646\u060c \u062a\u062d\u062a\u0627\u062c \u0625\u0644\u0649 \u0628\u0646\u0627\u0621 \u0635\u0648\u0631\u0629 \u0644\u0640 K8s-gatekeeper. \u064a\u0645\u0643\u0646\u0643 \u0628\u0646\u0627\u0621 \u0635\u0648\u0631\u062a\u0643 \u0627\u0644\u062e\u0627\u0635\u0629 \u0628\u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0623\u0645\u0631 \u0627\u0644\u062a\u0627\u0644\u064a:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"docker build --target webhook -t k8s-gatekeeper .\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u0647\u0630\u0627 \u0627\u0644\u0623\u0645\u0631 \u0633\u064a\u0642\u0648\u0645 \u0628\u0625\u0646\u0634\u0627\u0621 \u0635\u0648\u0631\u0629 \u0645\u062d\u0644\u064a\u0629 \u062a\u0633\u0645\u0649 'k8s-gatekeeper",":latest","'."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["\u0645\u0644\u0627\u062d\u0638\u0629: \u0625\u0630\u0627 \u0643\u0646\u062a \u062a\u0633\u062a\u062e\u062f\u0645 minikube\u060c \u064a\u0631\u062c\u0649 \u062a\u0646\u0641\u064a\u0630 ",(0,i.jsx)(n.code,{children:"eval $(minikube -p minikube docker-env)"})," \u0642\u0628\u0644 \u062a\u0634\u063a\u064a\u0644 'docker build'."]})}),"\n",(0,i.jsx)(n.h4,{id:"212-\u0627\u0644\u062e\u0637\u0648\u0629-2-\u0625\u0639\u062f\u0627\u062f-\u0627\u0644\u062e\u062f\u0645\u0627\u062a-\u0648\u0627\u0644\u062a\u0648\u0632\u064a\u0639\u0627\u062a-\u0644\u0640-k8s-gatekeeper",children:"2.1.2 \u0627\u0644\u062e\u0637\u0648\u0629 2: \u0625\u0639\u062f\u0627\u062f \u0627\u0644\u062e\u062f\u0645\u0627\u062a \u0648\u0627\u0644\u062a\u0648\u0632\u064a\u0639\u0627\u062a \u0644\u0640 K8s-gatekeeper"}),"\n",(0,i.jsx)(n.p,{children:"\u0642\u0645 \u0628\u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0623\u0648\u0627\u0645\u0631 \u0627\u0644\u062a\u0627\u0644\u064a\u0629:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f config/rbac.yaml\nkubectl apply -f config/webhook_deployment.yaml \nkubectl apply -f config/webhook_internal.yaml \n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u0647\u0630\u0627 \u0633\u064a\u0628\u062f\u0623 \u062a\u0634\u063a\u064a\u0644 K8s-gatekeeper\u060c \u0648\u064a\u0645\u0643\u0646\u0643 \u0627\u0644\u062a\u0623\u0643\u062f \u0645\u0646 \u0630\u0644\u0643 \u0628\u062a\u0634\u063a\u064a\u0644 ",(0,i.jsx)(n.code,{children:"kubectl get pods"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"213-\u0627\u0644\u062e\u0637\u0648\u0629-3-\u062a\u062b\u0628\u064a\u062a-\u0645\u0648\u0627\u0631\u062f-crd-\u0644\u0640-k8s-gatekeeper",children:"2.1.3 \u0627\u0644\u062e\u0637\u0648\u0629 3: \u062a\u062b\u0628\u064a\u062a \u0645\u0648\u0627\u0631\u062f CRD \u0644\u0640 K8s-gatekeeper"}),"\n",(0,i.jsx)(n.p,{children:"\u0642\u0645 \u0628\u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0623\u0648\u0627\u0645\u0631 \u0627\u0644\u062a\u0627\u0644\u064a\u0629:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f config/auth.casbin.org_casbinmodels.yaml \nkubectl apply -f config/auth.casbin.org_casbinpolicies.yaml\n"})}),"\n",(0,i.jsx)(n.h3,{id:"22-\u0627\u0644\u0648\u064a\u0628-\u0647\u0648\u0643-\u0627\u0644\u062e\u0627\u0631\u062c\u064a",children:"2.2 \u0627\u0644\u0648\u064a\u0628 \u0647\u0648\u0643 \u0627\u0644\u062e\u0627\u0631\u062c\u064a"}),"\n",(0,i.jsxs)(n.p,{children:["\u0644\u0637\u0631\u064a\u0642\u0629 \u0627\u0644\u0648\u064a\u0628 \u0647\u0648\u0643 \u0627\u0644\u062e\u0627\u0631\u062c\u064a\u0629\u060c \u0633\u064a\u062a\u0645 \u062a\u0634\u063a\u064a\u0644 K8s-gatekeeper \u062e\u0627\u0631\u062c Kubernetes\u060c \u0648\u0633\u064a\u0642\u0648\u0645 Kubernetes \u0628\u0627\u0644\u0648\u0635\u0648\u0644 \u0625\u0644\u0649 K8s-gatekeeper \u0643\u0645\u0627 \u0644\u0648 \u0643\u0627\u0646 \u064a\u0635\u0644 \u0625\u0644\u0649 \u0645\u0648\u0642\u0639 \u0648\u064a\u0628 \u0639\u0627\u062f\u064a. Kubernetes \u0644\u062f\u064a\u0647 \u0645\u062a\u0637\u0644\u0628 \u0625\u0644\u0632\u0627\u0645\u064a \u0628\u0623\u0646 \u064a\u0643\u0648\u0646 \u0627\u0644\u0648\u064a\u0628 \u0647\u0648\u0643 \u0644\u0644\u0642\u0628\u0648\u0644 HTTPS. \u0644\u063a\u0631\u0636 \u062a\u062c\u0631\u0628\u0629 K8s-gatekeeper\u060c \u0642\u062f\u0645\u0646\u0627 \u0645\u062c\u0645\u0648\u0639\u0629 \u0645\u0646 \u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a \u0648\u0645\u0641\u062a\u0627\u062d \u062e\u0627\u0635 (\u0639\u0644\u0649 \u0627\u0644\u0631\u063a\u0645 \u0645\u0646 \u0623\u0646 \u0647\u0630\u0627 \u0644\u064a\u0633 \u0622\u0645\u0646\u064b\u0627). \u0625\u0630\u0627 \u0643\u0646\u062a \u062a\u0641\u0636\u0644 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0634\u0647\u0627\u062f\u062a\u0643 \u0627\u0644\u062e\u0627\u0635\u0629\u060c \u064a\u0631\u062c\u0649 \u0627\u0644\u0631\u062c\u0648\u0639 \u0625\u0644\u0649 ",(0,i.jsx)(n.a,{href:"#5-advanced-settings",children:"\u0627\u0644\u0641\u0635\u0644 5. \u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a \u0627\u0644\u0645\u062a\u0642\u062f\u0645\u0629"})," \u0644\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u062a\u0639\u0644\u064a\u0645\u0627\u062a \u062d\u0648\u0644 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0648\u0627\u0644\u0645\u0641\u062a\u0627\u062d \u0627\u0644\u062e\u0627\u0635. \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0627\u0644\u062a\u064a \u0646\u0642\u062f\u0645\u0647\u0627 \u0635\u0627\u062f\u0631\u0629 \u0644\u0640 'webhook.domain.local'."]}),"\n",(0,i.jsx)(n.p,{children:"\u0644\u0630\u0627\u060c \u0642\u0645 \u0628\u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0645\u0636\u064a\u0641 (\u0645\u062b\u0644\u060c /etc/hosts) \u0648\u0623\u0634\u0631 'webhook.domain.local' \u0625\u0644\u0649 \u0639\u0646\u0648\u0627\u0646 IP \u0627\u0644\u0630\u064a \u064a\u0639\u0645\u0644 \u0639\u0644\u064a\u0647 K8s-gatekeeper. \u062b\u0645 \u0646\u0641\u0630 \u0627\u0644\u0623\u0645\u0631 \u0627\u0644\u062a\u0627\u0644\u064a:"}),"\n",(0,i.jsx)(n.p,{children:"2.3 \u062a\u062b\u0628\u064a\u062a K8s-gatekeeper \u0639\u0628\u0631 Helm"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"go mod tidy\ngo mod vendor\ngo run cmd/webhook/main.go\nkubectl apply -f config/auth.casbin.org_casbinmodels.yaml \nkubectl apply -f config/auth.casbin.org_casbinpolicies.yaml\nkubectl apply -f config/webhook_external.yaml \n"})}),"\n",(0,i.jsx)(n.h3,{id:"231-\u0627\u0644\u062e\u0637\u0648\u0629-1-\u0628\u0646\u0627\u0621-\u0627\u0644\u0635\u0648\u0631\u0629",children:"2.3.1 \u0627\u0644\u062e\u0637\u0648\u0629 1: \u0628\u0646\u0627\u0621 \u0627\u0644\u0635\u0648\u0631\u0629"}),"\n",(0,i.jsxs)(n.h4,{id:"\u064a\u0631\u062c\u0649-\u0627\u0644\u0631\u062c\u0648\u0639-\u0625\u0644\u0649-\u0627\u0644\u0641\u0635\u0644-211",children:["\u064a\u0631\u062c\u0649 \u0627\u0644\u0631\u062c\u0648\u0639 \u0625\u0644\u0649 ",(0,i.jsx)(n.a,{href:"#211-step-1-build-the-image",children:"\u0627\u0644\u0641\u0635\u0644 2.1.1"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"2.3.2 \u062a\u062b\u0628\u064a\u062a Helm"}),"\n",(0,i.jsxs)(n.h4,{id:"\u0642\u0645-\u0628\u062a\u0634\u063a\u064a\u0644-\u0627\u0644\u0623\u0645\u0631-helm-install-k8sgatekeeper-k8sgatekeeper",children:["\u0642\u0645 \u0628\u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0623\u0645\u0631 ",(0,i.jsx)(n.code,{children:"helm install k8sgatekeeper ./k8sgatekeeper"}),"."]}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u062c\u0631\u0628-k8s-gatekeeper-31-\u0625\u0646\u0634\u0627\u0621-\u0646\u0645\u0648\u0630\u062c-casbin-\u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629",children:"\u062c\u0631\u0628 K8s-gatekeeper 3.1 \u0625\u0646\u0634\u0627\u0621 \u0646\u0645\u0648\u0630\u062c Casbin \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629"}),"\n",(0,i.jsx)(n.h3,{id:"\u0644\u062f\u064a\u0643-\u0637\u0631\u064a\u0642\u062a\u0627\u0646-\u0644\u0625\u0646\u0634\u0627\u0621-\u0646\u0645\u0648\u0630\u062c-\u0648\u0633\u064a\u0627\u0633\u0629-\u0639\u0628\u0631-kubectl-\u0623\u0648-\u0639\u0628\u0631-go-client-\u0627\u0644\u0630\u064a-\u0646\u0642\u062f\u0645\u0647",children:"\u0644\u062f\u064a\u0643 \u0637\u0631\u064a\u0642\u062a\u0627\u0646 \u0644\u0625\u0646\u0634\u0627\u0621 \u0646\u0645\u0648\u0630\u062c \u0648\u0633\u064a\u0627\u0633\u0629: \u0639\u0628\u0631 kubectl \u0623\u0648 \u0639\u0628\u0631 go-client \u0627\u0644\u0630\u064a \u0646\u0642\u062f\u0645\u0647."}),"\n",(0,i.jsx)(n.p,{children:"3.1.1 \u0625\u0646\u0634\u0627\u0621/\u062a\u062d\u062f\u064a\u062b \u0646\u0645\u0648\u0630\u062c Casbin \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629 \u0639\u0628\u0631 kubectl"}),"\n",(0,i.jsx)(n.h4,{id:"\u0641\u064a-k8s-gatekeeper-\u064a\u062a\u0645-\u062a\u062e\u0632\u064a\u0646-\u0646\u0645\u0648\u0630\u062c-casbin-\u0641\u064a-\u0645\u0648\u0631\u062f-crd-\u064a\u0633\u0645\u0649-casbinmodel",children:"\u0641\u064a K8s-gatekeeper\u060c \u064a\u062a\u0645 \u062a\u062e\u0632\u064a\u0646 \u0646\u0645\u0648\u0630\u062c Casbin \u0641\u064a \u0645\u0648\u0631\u062f CRD \u064a\u0633\u0645\u0649 'CasbinModel'."}),"\n",(0,i.jsxs)(n.p,{children:["\u062a\u0642\u0639 \u062a\u0639\u0631\u064a\u0641\u0647 \u0641\u064a ",(0,i.jsx)(n.code,{children:"config/auth.casbin.org_casbinmodels.yaml"}),". \u0647\u0646\u0627\u0643 \u0623\u0645\u062b\u0644\u0629 \u0641\u064a ",(0,i.jsx)(n.code,{children:"example/allowed_repo/model.yaml"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"\u0627\u0646\u062a\u0628\u0647 \u0644\u0644\u062d\u0642\u0648\u0644 \u0627\u0644\u062a\u0627\u0644\u064a\u0629: metadata.name: \u0627\u0633\u0645 \u0627\u0644\u0646\u0645\u0648\u0630\u062c."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0647\u0630\u0627 \u0627\u0644\u0627\u0633\u0645 \u0647\u0648 \u0646\u0641\u0633\u0647 \u0627\u0633\u0645 \u0643\u0627\u0626\u0646 CasbinPolicy \u0627\u0644\u0645\u062a\u0639\u0644\u0642 \u0628\u0647\u0630\u0627 \u0627\u0644\u0646\u0645\u0648\u0630\u062c\u060c \u062d\u062a\u0649 \u064a\u062a\u0645\u0643\u0646 K8s-gatekeeper \u0645\u0646 \u0625\u0642\u0631\u0627\u0646\u0647\u0645\u0627 \u0648\u0625\u0646\u0634\u0627\u0621 \u0645\u064f\u0646\u0641\u0630. spec.enable: \u0625\u0630\u0627 \u062a\u0645 \u0636\u0628\u0637 \u0647\u0630\u0627 \u0627\u0644\u062d\u0642\u0644 \u0639\u0644\u0649 'false'\u060c \u0633\u064a\u062a\u0645 \u062a\u062c\u0627\u0647\u0644 \u0647\u0630\u0627 \u0627\u0644\u0646\u0645\u0648\u0630\u062c (\u0648\u0643\u0630\u0644\u0643 \u0643\u0627\u0626\u0646 CasbinPolicy \u0627\u0644\u0645\u062a\u0639\u0644\u0642 \u0628\u0647\u0630\u0627 \u0627\u0644\u0646\u0645\u0648\u0630\u062c)."}),"\n",(0,i.jsx)(n.li,{children:"spec.modelText: \u0633\u0644\u0633\u0644\u0629 \u062a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0646\u0635 \u0646\u0645\u0648\u0630\u062c Casbin."}),"\n",(0,i.jsxs)(n.li,{children:["\u064a\u062a\u0645 \u062a\u062e\u0632\u064a\u0646 \u0627\u0644\u0633\u064a\u0627\u0633\u0629 Casbin \u0641\u064a \u0645\u0648\u0631\u062f CRD \u0622\u062e\u0631 \u064a\u0633\u0645\u0649 'CasbinPolicy'\u060c \u0648\u064a\u0645\u0643\u0646 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u062a\u0639\u0631\u064a\u0641\u0647 \u0641\u064a ",(0,i.jsx)(n.code,{children:"config/auth.casbin.org_casbinpolicies.yaml"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u0647\u0646\u0627\u0643 \u0623\u0645\u062b\u0644\u0629 \u0641\u064a ",(0,i.jsx)(n.code,{children:"example/allowed_repo/policy.yaml"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"\u0627\u0646\u062a\u0628\u0647 \u0644\u0644\u062d\u0642\u0648\u0644 \u0627\u0644\u062a\u0627\u0644\u064a\u0629: metadata.name: \u0627\u0633\u0645 \u0627\u0644\u0633\u064a\u0627\u0633\u0629."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0647\u0630\u0627 \u0627\u0644\u0627\u0633\u0645 \u0647\u0648 \u0646\u0641\u0633\u0647 \u0627\u0633\u0645 \u0643\u0627\u0626\u0646 CasbinModel \u0627\u0644\u0645\u062a\u0639\u0644\u0642 \u0628\u0647\u0630\u0647 \u0627\u0644\u0633\u064a\u0627\u0633\u0629\u060c \u062d\u062a\u0649 \u064a\u062a\u0645\u0643\u0646 K8s-gatekeeper \u0645\u0646 \u0625\u0642\u0631\u0627\u0646\u0647\u0645\u0627 \u0648\u0625\u0646\u0634\u0627\u0621 \u0645\u064f\u0646\u0641\u0630. spec.policyItem: \u0633\u0644\u0633\u0644\u0629 \u062a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0646\u0635 \u0633\u064a\u0627\u0633\u0629 \u0646\u0645\u0648\u0630\u062c Casbin."}),"\n",(0,i.jsx)(n.li,{children:"\u0628\u0639\u062f \u0625\u0646\u0634\u0627\u0621 \u0645\u0644\u0641\u0627\u062a CasbinModel \u0648CasbinPolicy \u0627\u0644\u062e\u0627\u0635\u0629 \u0628\u0643\u060c \u0627\u0633\u062a\u062e\u062f\u0645 \u0627\u0644\u0623\u0645\u0631 \u0627\u0644\u062a\u0627\u0644\u064a \u0644\u062a\u0637\u0628\u064a\u0642\u0647\u0627:"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u0628\u0645\u062c\u0631\u062f \u0625\u0646\u0634\u0627\u0621 \u0632\u0648\u062c \u0645\u0646 CasbinModel \u0648CasbinPolicy\u060c \u0633\u064a\u0643\u0648\u0646 K8s-gatekeeper \u0642\u0627\u062f\u0631\u064b\u0627 \u0639\u0644\u0649 \u0627\u0643\u062a\u0634\u0627\u0641\u0647 \u062e\u0644\u0627\u0644 5 \u062b\u0648\u0627\u0646\u064d."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f <filename>\n"})}),"\n",(0,i.jsx)(n.p,{children:"3.1.2 \u0625\u0646\u0634\u0627\u0621/\u062a\u062d\u062f\u064a\u062b \u0646\u0645\u0648\u0630\u062c Casbin \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629 \u0639\u0628\u0631 go-client \u0627\u0644\u0630\u064a \u0646\u0642\u062f\u0645\u0647"}),"\n",(0,i.jsx)(n.h4,{id:"\u0646\u062d\u0646-\u0646\u0641\u0647\u0645-\u0623\u0646-\u0647\u0646\u0627\u0643-\u062d\u0627\u0644\u0627\u062a-\u0642\u062f-\u0644\u0627-\u064a\u0643\u0648\u0646-\u0645\u0646-\u0627\u0644\u0645\u0644\u0627\u0626\u0645-\u0641\u064a\u0647\u0627-\u0627\u0633\u062a\u062e\u062f\u0627\u0645-\u0627\u0644\u0634\u0644-\u0644\u062a\u0646\u0641\u064a\u0630-\u0627\u0644\u0623\u0648\u0627\u0645\u0631-\u0645\u0628\u0627\u0634\u0631\u0629-\u0639\u0644\u0649-\u0639\u0642\u062f\u0629-\u0645\u0646-\u0639\u0642\u062f-k8s-\u0645\u062b\u0644-\u0639\u0646\u062f\u0645\u0627-\u062a\u0642\u0648\u0645-\u0628\u0628\u0646\u0627\u0621-\u0645\u0646\u0635\u0629-\u0633\u062d\u0627\u0628\u064a\u0629-\u062a\u0644\u0642\u0627\u0626\u064a\u0629-\u0644\u0634\u0631\u0643\u062a\u0643",children:"\u0646\u062d\u0646 \u0646\u0641\u0647\u0645 \u0623\u0646 \u0647\u0646\u0627\u0643 \u062d\u0627\u0644\u0627\u062a \u0642\u062f \u0644\u0627 \u064a\u0643\u0648\u0646 \u0645\u0646 \u0627\u0644\u0645\u0644\u0627\u0626\u0645 \u0641\u064a\u0647\u0627 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0627\u0644\u0634\u0644 \u0644\u062a\u0646\u0641\u064a\u0630 \u0627\u0644\u0623\u0648\u0627\u0645\u0631 \u0645\u0628\u0627\u0634\u0631\u0629 \u0639\u0644\u0649 \u0639\u0642\u062f\u0629 \u0645\u0646 \u0639\u0642\u062f K8s\u060c \u0645\u062b\u0644 \u0639\u0646\u062f\u0645\u0627 \u062a\u0642\u0648\u0645 \u0628\u0628\u0646\u0627\u0621 \u0645\u0646\u0635\u0629 \u0633\u062d\u0627\u0628\u064a\u0629 \u062a\u0644\u0642\u0627\u0626\u064a\u0629 \u0644\u0634\u0631\u0643\u062a\u0643."}),"\n",(0,i.jsxs)(n.p,{children:["\u0644\u0630\u0644\u0643\u060c \u0642\u0645\u0646\u0627 \u0628\u062a\u0637\u0648\u064a\u0631 go-client \u0644\u0625\u0646\u0634\u0627\u0621 \u0648\u0635\u064a\u0627\u0646\u0629 CasbinModel \u0648CasbinPolicy. \u0645\u0643\u062a\u0628\u0629 go-client \u062a\u0642\u0639 \u0641\u064a ",(0,i.jsx)(n.code,{children:"pkg/client"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["\u0641\u064a ",(0,i.jsx)(n.code,{children:"client.go"}),"\u060c \u0646\u0642\u062f\u0645 \u0648\u0638\u064a\u0641\u0629 \u0644\u0625\u0646\u0634\u0627\u0621 \u0639\u0645\u064a\u0644."]}),"\n",(0,i.jsxs)(n.p,{children:["\u0641\u064a ",(0,i.jsx)(n.code,{children:"client.go"}),"\u060c \u0646\u0648\u0641\u0631 \u0648\u0638\u064a\u0641\u0629 \u0644\u0625\u0646\u0634\u0627\u0621 \u0639\u0645\u064a\u0644."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"func NewK8sGateKeeperClient(externalClient bool) (*K8sGateKeeperClient, error) \n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u064a\u062d\u062f\u062f \u0627\u0644\u0645\u0639\u0627\u0645\u0644 ",(0,i.jsx)(n.code,{children:"externalClient"})," \u0645\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646 K8s-gatekeeper \u064a\u0639\u0645\u0644 \u062f\u0627\u062e\u0644 \u0639\u0646\u0642\u0648\u062f K8s \u0623\u0645 \u0644\u0627."]}),"\n",(0,i.jsxs)(n.p,{children:["\u0641\u064a ",(0,i.jsx)(n.code,{children:"model.go"}),"\u060c \u0646\u0648\u0641\u0631 \u0648\u0638\u0627\u0626\u0641 \u0645\u062a\u0639\u062f\u062f\u0629 \u0644\u0625\u0646\u0634\u0627\u0621\u060c \u062d\u0630\u0641\u060c \u0648\u062a\u0639\u062f\u064a\u0644 CasbinModel. \u064a\u0645\u0643\u0646\u0643 \u0645\u0639\u0631\u0641\u0629 \u0643\u064a\u0641\u064a\u0629 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0647\u0630\u0647 \u0627\u0644\u0648\u0627\u062c\u0647\u0627\u062a \u0641\u064a ",(0,i.jsx)(n.code,{children:"model_test.go"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["\u0641\u064a ",(0,i.jsx)(n.code,{children:"policy.go"}),"\u060c \u0646\u0648\u0641\u0631 \u0648\u0638\u0627\u0626\u0641 \u0645\u062a\u0639\u062f\u062f\u0629 \u0644\u0625\u0646\u0634\u0627\u0621\u060c \u062d\u0630\u0641\u060c \u0648\u062a\u0639\u062f\u064a\u0644 CasbiPolicy. \u064a\u0645\u0643\u0646\u0643 \u0645\u0639\u0631\u0641\u0629 \u0643\u064a\u0641\u064a\u0629 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0647\u0630\u0647 \u0627\u0644\u0648\u0627\u062c\u0647\u0627\u062a \u0641\u064a ",(0,i.jsx)(n.code,{children:"policy_test.go"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"312-\u062c\u0631\u0628-\u0645\u0627-\u0625\u0630\u0627-\u0643\u0627\u0646-k8s-gatekeeper-\u064a\u0639\u0645\u0644",children:"3.1.2 \u062c\u0631\u0628 \u0645\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646 K8s-gatekeeper \u064a\u0639\u0645\u0644"}),"\n",(0,i.jsxs)(n.p,{children:["\u0627\u0641\u062a\u0631\u0636 \u0623\u0646\u0643 \u0642\u062f \u0623\u0646\u0634\u0623\u062a \u0628\u0627\u0644\u0641\u0639\u0644 \u0627\u0644\u0646\u0645\u0648\u0630\u062c \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629 \u0627\u0644\u062f\u0642\u064a\u0642\u064a\u0646 \u0641\u064a ",(0,i.jsx)(n.code,{children:"example/allowed_repo"}),". \u0627\u0644\u0622\u0646\u060c \u062c\u0631\u0628 \u0627\u0644\u0623\u0645\u0631 \u0627\u0644\u062a\u0627\u0644\u064a:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"kubectl apply -f example/allowed_repo/testcase/reject_1.yaml\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u064a\u062c\u0628 \u0623\u0646 \u062a\u062c\u062f \u0623\u0646 K8s \u0633\u064a\u0631\u0641\u0636 \u0647\u0630\u0627 \u0627\u0644\u0637\u0644\u0628 \u0648\u064a\u0630\u0643\u0631 \u0623\u0646 \u0627\u0644\u0648\u064a\u0628 \u0647\u0648\u0643 \u0643\u0627\u0646 \u0627\u0644\u0633\u0628\u0628 \u0641\u064a \u0631\u0641\u0636 \u0647\u0630\u0627 \u0627\u0644\u0637\u0644\u0628. \u0648\u0645\u0639 \u0630\u0644\u0643\u060c \u0639\u0646\u062f\u0645\u0627 \u062a\u062d\u0627\u0648\u0644 \u062a\u0637\u0628\u064a\u0642 ",(0,i.jsx)(n.code,{children:"example/allowed_repo/testcase/approve_2.yaml"}),"\u060c \u0633\u064a\u062a\u0645 \u0642\u0628\u0648\u0644\u0647."]}),"\n",(0,i.jsx)(n.h2,{id:"4-\u0643\u064a\u0641\u064a\u0629-\u0643\u062a\u0627\u0628\u0629-\u0627\u0644\u0646\u0645\u0648\u0630\u062c-\u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629-\u0645\u0639-k8s-gatekeeper",children:"4. \u0643\u064a\u0641\u064a\u0629 \u0643\u062a\u0627\u0628\u0629 \u0627\u0644\u0646\u0645\u0648\u0630\u062c \u0648\u0627\u0644\u0633\u064a\u0627\u0633\u0629 \u0645\u0639 K8s-gatekeeper"}),"\n",(0,i.jsxs)(n.p,{children:["\u0623\u0648\u0644\u0627\u064b\u060c \u062a\u0623\u0643\u062f \u0645\u0646 \u0623\u0646\u0643 \u0645\u0644\u0645 \u0628\u0627\u0644\u0642\u0648\u0627\u0639\u062f \u0627\u0644\u0623\u0633\u0627\u0633\u064a\u0629 \u0644\u0646\u0645\u0627\u0630\u062c \u0648\u0633\u064a\u0627\u0633\u0627\u062a Casbin. \u0625\u0630\u0627 \u0644\u0645 \u062a\u0643\u0646 \u0643\u0630\u0644\u0643\u060c \u064a\u0631\u062c\u0649 \u0642\u0631\u0627\u0621\u0629 \u0642\u0633\u0645 ",(0,i.jsx)(n.a,{href:"/docs/get-started",children:"\u0627\u0644\u0628\u062f\u0621"})," \u0623\u0648\u0644\u0627\u064b. \u0641\u064a \u0647\u0630\u0627 \u0627\u0644\u0641\u0635\u0644\u060c \u0646\u0641\u062a\u0631\u0636 \u0623\u0646\u0643 \u062a\u0641\u0647\u0645 \u0628\u0627\u0644\u0641\u0639\u0644 \u0645\u0627 \u0647\u064a \u0646\u0645\u0627\u0630\u062c \u0648\u0633\u064a\u0627\u0633\u0627\u062a Casbin."]}),"\n",(0,i.jsx)(n.h3,{id:"41-\u062a\u0639\u0631\u064a\u0641-\u0627\u0644\u0637\u0644\u0628-\u0641\u064a-\u0627\u0644\u0646\u0645\u0648\u0630\u062c",children:"4.1 \u062a\u0639\u0631\u064a\u0641 \u0627\u0644\u0637\u0644\u0628 \u0641\u064a \u0627\u0644\u0646\u0645\u0648\u0630\u062c"}),"\n",(0,i.jsx)(n.p,{children:"\u0639\u0646\u062f\u0645\u0627 \u064a\u0642\u0648\u0645 K8s-gatekeeper \u0628\u062a\u0641\u0648\u064a\u0636 \u0637\u0644\u0628\u060c \u0641\u0625\u0646 \u0627\u0644\u0625\u062f\u062e\u0627\u0644 \u062f\u0627\u0626\u0645\u064b\u0627 \u0639\u0628\u0627\u0631\u0629 \u0639\u0646 \u0643\u0627\u0626\u0646: \u0643\u0627\u0626\u0646 Go \u0644\u0637\u0644\u0628 \u0627\u0644\u0642\u0628\u0648\u0644. \u0647\u0630\u0627 \u064a\u0639\u0646\u064a \u0623\u0646 \u0627\u0644\u0645\u0646\u0641\u0630 \u0633\u064a\u0633\u062a\u062e\u062f\u0645 \u062f\u0627\u0626\u0645\u064b\u0627 \u0628\u0647\u0630\u0647 \u0627\u0644\u0637\u0631\u064a\u0642\u0629:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"ok, err := enforcer.Enforce(admission)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u062d\u064a\u062b ",(0,i.jsx)(n.code,{children:"admission"})," \u0647\u0648 \u0643\u0627\u0626\u0646 ",(0,i.jsx)(n.code,{children:"AdmissionReview"})," \u0645\u062d\u062f\u062f \u0628\u0648\u0627\u0633\u0637\u0629 \u0648\u0627\u062c\u0647\u0629 \u0628\u0631\u0645\u062c\u0629 \u062a\u0637\u0628\u064a\u0642\u0627\u062a K8s \u0627\u0644\u0631\u0633\u0645\u064a\u0629 ",(0,i.jsx)(n.code,{children:'"k8s.io/api/admission/v1"'}),". \u064a\u0645\u0643\u0646\u0643 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u062a\u0639\u0631\u064a\u0641 \u0647\u0630\u0627 \u0627\u0644\u0647\u064a\u0643\u0644 \u0641\u064a \u0647\u0630\u0627 \u0627\u0644\u0645\u0633\u062a\u0648\u062f\u0639: ",(0,i.jsx)(n.a,{href:"https://github.com/kubernetes/api/blob/master/admission/v1/types.go",children:"https://github.com/kubernetes/api/blob/master/admission/v1/types.go"}),". \u0644\u0645\u0632\u064a\u062f \u0645\u0646 \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a\u060c \u064a\u0645\u0643\u0646\u0643 \u0623\u064a\u0636\u064b\u0627 \u0627\u0644\u0631\u062c\u0648\u0639 \u0625\u0644\u0649 ",(0,i.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response",children:"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["\u0644\u0630\u0644\u0643\u060c \u0628\u0627\u0644\u0646\u0633\u0628\u0629 \u0644\u0623\u064a \u0646\u0645\u0648\u0630\u062c \u064a\u0633\u062a\u062e\u062f\u0645\u0647 K8s-gatekeeper\u060c \u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u062a\u0639\u0631\u064a\u0641 ",(0,i.jsx)(n.code,{children:"request_definition"})," \u062f\u0627\u0626\u0645\u064b\u0627 \u0643\u0645\u0627 \u064a\u0644\u064a:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:"    [request_definition]\n    r =  obj\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u0627\u0633\u0645 'obj' \u0644\u064a\u0633 \u0625\u0644\u0632\u0627\u0645\u064a\u064b\u0627\u060c \u0637\u0627\u0644\u0645\u0627 \u0623\u0646 \u0627\u0644\u0627\u0633\u0645 \u0645\u062a\u0633\u0642 \u0645\u0639 \u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 \u0641\u064a \u062c\u0632\u0621 ",(0,i.jsx)(n.code,{children:"[matchers]"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"42-\u0645\u0637\u0627\u0628\u0642\u0627\u062a-\u0627\u0644\u0646\u0645\u0648\u0630\u062c",children:"4.2 \u0645\u0637\u0627\u0628\u0642\u0627\u062a \u0627\u0644\u0646\u0645\u0648\u0630\u062c"}),"\n",(0,i.jsx)(n.p,{children:"\u0645\u0646 \u0627\u0644\u0645\u0641\u062a\u0631\u0636 \u0623\u0646 \u062a\u0633\u062a\u062e\u062f\u0645 \u0645\u064a\u0632\u0629 ABAC \u0644\u0643\u062a\u0627\u0628\u0629 \u0642\u0648\u0627\u0639\u062f\u0643. \u0648\u0645\u0639 \u0630\u0644\u0643\u060c \u0641\u0625\u0646 \u0645\u0642\u064a\u0645 \u0627\u0644\u062a\u0639\u0628\u064a\u0631 \u0627\u0644\u0645\u062f\u0645\u062c \u0641\u064a Casbin \u0644\u0627 \u064a\u062f\u0639\u0645 \u0627\u0644\u0641\u0647\u0631\u0633\u0629 \u0641\u064a \u0627\u0644\u062e\u0631\u0627\u0626\u0637 \u0623\u0648 \u0627\u0644\u0645\u0635\u0641\u0648\u0641\u0627\u062a (\u0627\u0644\u0634\u0631\u0627\u0626\u062d)\u060c \u0648\u0644\u0627 \u062a\u0648\u0633\u064a\u0639 \u0627\u0644\u0645\u0635\u0641\u0648\u0641\u0627\u062a. \u0644\u0630\u0644\u0643\u060c \u064a\u0648\u0641\u0631 K8s-gatekeeper \u0648\u0638\u0627\u0626\u0641 'Casbin' \u0645\u062a\u0646\u0648\u0639\u0629 \u0643\u0627\u0645\u062a\u062f\u0627\u062f\u0627\u062a \u0644\u062a\u0646\u0641\u064a\u0630 \u0647\u0630\u0647 \u0627\u0644\u0645\u064a\u0632\u0627\u062a. \u0625\u0630\u0627 \u0648\u062c\u062f\u062a \u0623\u0646 \u0637\u0644\u0628\u0643 \u0644\u0627 \u064a\u0645\u0643\u0646 \u062a\u0644\u0628\u064a\u062a\u0647 \u0628\u0648\u0627\u0633\u0637\u0629 \u0647\u0630\u0647 \u0627\u0644\u0627\u0645\u062a\u062f\u0627\u062f\u0627\u062a\u060c \u0641\u0644\u0627 \u062a\u062a\u0631\u062f\u062f \u0641\u064a \u0628\u062f\u0621 \u0645\u0634\u0643\u0644\u0629\u060c \u0623\u0648 \u0625\u0646\u0634\u0627\u0621 \u0637\u0644\u0628 \u0633\u062d\u0628."}),"\n",(0,i.jsxs)(n.p,{children:["\u0625\u0630\u0627 \u0644\u0645 \u062a\u0643\u0646 \u0645\u0639\u062a\u0627\u062f\u064b\u0627 \u0639\u0644\u0649 \u0648\u0638\u0627\u0626\u0641 Casbin\u060c \u064a\u0645\u0643\u0646\u0643 \u0627\u0644\u0631\u062c\u0648\u0639 \u0625\u0644\u0649 ",(0,i.jsx)(n.a,{href:"/docs/function",children:"\u0627\u0644\u0648\u0638\u064a\u0641\u0629"})," \u0644\u0645\u0632\u064a\u062f \u0645\u0646 \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a."]}),"\n",(0,i.jsx)(n.p,{children:"\u0625\u0644\u064a\u0643 \u0627\u0644\u0648\u0638\u0627\u0626\u0641 \u0627\u0644\u0625\u0636\u0627\u0641\u064a\u0629:"}),"\n",(0,i.jsx)(n.h3,{id:"421-\u0648\u0638\u0627\u0626\u0641-\u0627\u0644\u0625\u0636\u0627\u0641\u0629",children:"4.2.1 \u0648\u0638\u0627\u0626\u0641 \u0627\u0644\u0625\u0636\u0627\u0641\u0629"}),"\n",(0,i.jsx)(n.h4,{id:"4211-\u0627\u0644\u0648\u0635\u0648\u0644",children:"4.2.1.1 \u0627\u0644\u0648\u0635\u0648\u0644"}),"\n",(0,i.jsxs)(n.p,{children:["\u064a\u064f\u0633\u062a\u062e\u062f\u0645 \u0627\u0644\u0648\u0635\u0648\u0644 \u0644\u062d\u0644 \u0627\u0644\u0645\u0634\u0643\u0644\u0629 \u0627\u0644\u062a\u064a \u0644\u0627 \u064a\u062f\u0639\u0645\u0647\u0627 Casbin \u0641\u064a \u0627\u0644\u0641\u0647\u0631\u0633\u0629 \u0641\u064a \u0627\u0644\u062e\u0631\u0627\u0626\u0637 \u0623\u0648 \u0627\u0644\u0645\u0635\u0641\u0648\u0641\u0627\u062a. \u064a\u0648\u0636\u062d \u0627\u0644\u0645\u062b\u0627\u0644 ",(0,i.jsx)(n.code,{children:"example/allowed_repo/model.yaml"})," \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0647\u0630\u0647 \u0627\u0644\u0648\u0638\u064a\u0641\u0629:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:'[matchers]\nm = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\naccess(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Image") == p.obj\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u0641\u064a \u0647\u0630\u0627 \u0627\u0644\u0645\u0637\u0627\u0628\u0642\u060c ",(0,i.jsx)(n.code,{children:'access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Image")'})," \u0645\u0643\u0627\u0641\u0626 \u0644\u0640 ",(0,i.jsx)(n.code,{children:"r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Image"}),"\u060c \u062d\u064a\u062b ",(0,i.jsx)(n.code,{children:"r.obj.Request.Object.Object.Spec.Template.Spec.Containers"})," \u0647\u0648 \u0634\u0631\u064a\u062d\u0629."]}),"\n",(0,i.jsxs)(n.p,{children:["\u064a\u0645\u0643\u0646 \u0644\u0644\u0648\u0635\u0648\u0644 \u0623\u064a\u0636\u064b\u0627 \u0627\u0633\u062a\u062f\u0639\u0627\u0621 \u0648\u0638\u0627\u0626\u0641 \u0628\u0633\u064a\u0637\u0629 \u0644\u064a\u0633 \u0644\u0647\u0627 \u0645\u0639\u0627\u0645\u0644\u0627\u062a \u0648\u062a\u0639\u064a\u062f \u0642\u064a\u0645\u0629 \u0648\u0627\u062d\u062f\u0629. \u064a\u0648\u0636\u062d \u0627\u0644\u0645\u062b\u0627\u0644 ",(0,i.jsx)(n.code,{children:"example/container_resource_limit/model.yaml"})," \u0647\u0630\u0627:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:'[matchers]\n  m = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\n  parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Resources","Limits","cpu","Value")) >= parseFloat(p.cpu) && \\\n  parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Resources","Limits","memory","Value")) >= parseFloat(p.memory)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u0641\u064a \u0647\u0630\u0627 \u0627\u0644\u0645\u0637\u0627\u0628\u0642\u060c ",(0,i.jsx)(n.code,{children:'access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, "Resources","Limits","cpu","Value")'})," \u0645\u0643\u0627\u0641\u0626 \u0644\u0640 ",(0,i.jsx)(n.code,{children:'r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits["cpu"].Value()'}),"\u060c \u062d\u064a\u062b ",(0,i.jsx)(n.code,{children:"r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits"})," \u0647\u0648 \u062e\u0631\u064a\u0637\u0629\u060c \u0648",(0,i.jsx)(n.code,{children:"Value()"})," \u0647\u064a \u0648\u0638\u064a\u0641\u0629 \u0628\u0633\u064a\u0637\u0629 \u0644\u064a\u0633 \u0644\u0647\u0627 \u0645\u0639\u0627\u0645\u0644\u0627\u062a \u0648\u062a\u0639\u064a\u062f \u0642\u064a\u0645\u0629 \u0648\u0627\u062d\u062f\u0629."]}),"\n",(0,i.jsx)(n.h4,{id:"4212-accesswithwildcard",children:"4.2.1.2 accessWithWildcard"}),"\n",(0,i.jsxs)(n.p,{children:['\u0623\u062d\u064a\u0627\u0646\u064b\u0627\u060c \u0642\u062f \u064a\u0643\u0648\u0646 \u0644\u062f\u064a\u0643 \u0637\u0644\u0628 \u0645\u062b\u0644 \u0647\u0630\u0627: \u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0644\u062c\u0645\u064a\u0639 \u0627\u0644\u0639\u0646\u0627\u0635\u0631 \u0641\u064a \u0645\u0635\u0641\u0648\u0641\u0629 \u0628\u0627\u062f\u0626\u0629 "aaa". \u0648\u0645\u0639 \u0630\u0644\u0643\u060c \u0644\u0627 \u064a\u062f\u0639\u0645 Casbin \u062d\u0644\u0642\u0627\u062a ',(0,i.jsx)(n.code,{children:"for"}),". \u0645\u0639 ",(0,i.jsx)(n.code,{children:"accessWithWildcard"}),' \u0648\u0645\u064a\u0632\u0629 "\u062a\u0648\u0633\u064a\u0639 \u0627\u0644\u062e\u0631\u064a\u0637\u0629/\u0627\u0644\u0634\u0631\u064a\u062d\u0629"\u060c \u064a\u0645\u0643\u0646\u0643 \u062a\u0646\u0641\u064a\u0630 \u0645\u062b\u0644 \u0647\u0630\u0627 \u0627\u0644\u0637\u0644\u0628 \u0628\u0633\u0647\u0648\u0644\u0629.']}),"\n",(0,i.jsxs)(n.p,{children:["\u0639\u0644\u0649 \u0633\u0628\u064a\u0644 \u0627\u0644\u0645\u062b\u0627\u0644\u060c \u0644\u0646\u0641\u062a\u0631\u0636 \u0623\u0646 ",(0,i.jsx)(n.code,{children:"a.b.c"})," \u0647\u064a \u0645\u0635\u0641\u0648\u0641\u0629 ",(0,i.jsx)(n.code,{children:"[aaa,bbb,ccc,ddd,eee]"}),"\u060c \u0641\u0625\u0646 \u0646\u062a\u064a\u062c\u0629 ",(0,i.jsx)(n.code,{children:'accessWithWildcard(a,"b","c","*")'})," \u0633\u062a\u0643\u0648\u0646 \u0634\u0631\u064a\u062d\u0629 ",(0,i.jsx)(n.code,{children:"[aaa,bbb,ccc,ddd,eee]"}),". \u0628\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0627\u0644\u0628\u062f\u0644 ",(0,i.jsx)(n.code,{children:"*"}),"\u060c \u064a\u062a\u0645 \u062a\u0648\u0633\u064a\u0639 \u0627\u0644\u0634\u0631\u064a\u062d\u0629."]}),"\n",(0,i.jsxs)(n.p,{children:["\u0628\u0627\u0644\u0645\u062b\u0644\u060c \u064a\u0645\u0643\u0646 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0627\u0644\u0628\u062f\u0644 \u0623\u0643\u062b\u0631 \u0645\u0646 \u0645\u0631\u0629. \u0639\u0644\u0649 \u0633\u0628\u064a\u0644 \u0627\u0644\u0645\u062b\u0627\u0644\u060c \u0646\u062a\u064a\u062c\u0629 ",(0,i.jsx)(n.code,{children:'accessWithWildcard(a,"b","c","*","*")'})," \u0633\u062a\u0643\u0648\u0646 ",(0,i.jsx)(n.code,{children:"[a.b.c[0][0], a.b.c[0][1], ..., a.b.c[1][0], a.b.c[1][1], ...]"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"4213-\u0648\u0638\u0627\u0626\u0641-\u062a\u062f\u0639\u0645-\u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062a-\u0627\u0644\u0645\u062a\u063a\u064a\u0631\u0629-\u0627\u0644\u0637\u0648\u0644",children:"4.2.1.3 \u0648\u0638\u0627\u0626\u0641 \u062a\u062f\u0639\u0645 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062a \u0627\u0644\u0645\u062a\u063a\u064a\u0631\u0629 \u0627\u0644\u0637\u0648\u0644"}),"\n",(0,i.jsx)(n.p,{children:"\u0641\u064a \u0645\u0642\u064a\u0645 \u0627\u0644\u062a\u0639\u0628\u064a\u0631 \u0644\u0640 Casbin\u060c \u0639\u0646\u062f\u0645\u0627 \u064a\u0643\u0648\u0646 \u0627\u0644\u0645\u0639\u0627\u0645\u0644 \u0645\u0635\u0641\u0648\u0641\u0629\u060c \u0633\u064a\u062a\u0645 \u062a\u0648\u0633\u064a\u0639\u0647 \u062a\u0644\u0642\u0627\u0626\u064a\u064b\u0627 \u0643\u0645\u0639\u0627\u0645\u0644 \u0645\u062a\u063a\u064a\u0631 \u0627\u0644\u0637\u0648\u0644. \u0628\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0647\u0630\u0647 \u0627\u0644\u0645\u064a\u0632\u0629 \u0644\u062f\u0639\u0645 \u062a\u0648\u0633\u064a\u0639 \u0627\u0644\u0645\u0635\u0641\u0648\u0641\u0629/\u0627\u0644\u0634\u0631\u064a\u062d\u0629/\u0627\u0644\u062e\u0631\u064a\u0637\u0629\u060c \u0644\u0642\u062f \u062f\u0645\u062c\u0646\u0627 \u0623\u064a\u0636\u064b\u0627 \u0639\u062f\u0629 \u0648\u0638\u0627\u0626\u0641 \u062a\u0642\u0628\u0644 \u0645\u0635\u0641\u0648\u0641\u0629/\u0634\u0631\u064a\u062d\u0629 \u0643\u0645\u0639\u0627\u0645\u0644:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"contain(): \u062a\u0642\u0628\u0644 \u0645\u0639\u0627\u0645\u0644\u0627\u062a \u0645\u062a\u0639\u062f\u062f\u0629 \u0648\u062a\u0639\u064a\u062f \u0645\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646 \u0623\u064a \u0645\u0639\u0627\u0645\u0644 (\u0628\u0627\u0633\u062a\u062b\u0646\u0627\u0621 \u0627\u0644\u0645\u0639\u0627\u0645\u0644 \u0627\u0644\u0623\u062e\u064a\u0631) \u064a\u0633\u0627\u0648\u064a \u0627\u0644\u0645\u0639\u0627\u0645\u0644 \u0627\u0644\u0623\u062e\u064a\u0631."}),"\n",(0,i.jsxs)(n.li,{children:["split(a,b,c...,sep,index): \u062a\u064f\u0639\u064a\u062f \u0645\u0635\u0641\u0648\u0641\u0629 \u062a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 ",(0,i.jsx)(n.code,{children:"[splits(a,sep)[index], splits(b,sep)[index], splits(a,sep)[index], ...]"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"len(): \u062a\u064f\u0639\u064a\u062f \u0637\u0648\u0644 \u0627\u0644\u0648\u0633\u064a\u0637\u0629 \u0630\u0627\u062a \u0627\u0644\u0637\u0648\u0644 \u0627\u0644\u0645\u062a\u063a\u064a\u0631."}),"\n",(0,i.jsxs)(n.li,{children:["matchRegex(a,b,c...,regex): \u062a\u064f\u0639\u064a\u062f \u0645\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646\u062a \u062c\u0645\u064a\u0639 \u0627\u0644\u0648\u0633\u0627\u0626\u0637 \u0627\u0644\u0645\u0639\u0637\u0627\u0629 (",(0,i.jsx)(n.code,{children:"a"}),", ",(0,i.jsx)(n.code,{children:"b"}),", ",(0,i.jsx)(n.code,{children:"c"}),", ...) \u062a\u0637\u0627\u0628\u0642 \u0627\u0644\u0639\u0628\u0627\u0631\u0629 \u0627\u0644\u0646\u0645\u0637\u064a\u0629 \u0627\u0644\u0645\u0639\u0637\u0627\u0629."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u0647\u0646\u0627 \u0645\u062b\u0627\u0644 \u0641\u064a ",(0,i.jsx)(n.code,{children:"example/disallowed_tag/model.yaml"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:'    [matchers]\n    m = r.obj.Request.Namespace == "default" && r.obj.Request.Resource.Resource =="deployments" && \\\n    contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , "*", "Image"),":",1) , p.obj)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u0628\u0627\u0641\u062a\u0631\u0627\u0636 \u0623\u0646 ",(0,i.jsx)(n.code,{children:'accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , "*", "Image")'})," \u062a\u064f\u0639\u064a\u062f ",(0,i.jsx)(n.code,{children:"['a:b', 'c:d', 'e:f', 'g:h']"}),"\u060c \u0644\u0623\u0646 \u0627\u0644\u062f\u0627\u0644\u0629 splits \u062a\u062f\u0639\u0645 \u0627\u0644\u0648\u0633\u0627\u0626\u0637 \u0630\u0627\u062a \u0627\u0644\u0637\u0648\u0644 \u0627\u0644\u0645\u062a\u063a\u064a\u0631 \u0648\u062a\u0624\u062f\u064a \u0639\u0645\u0644\u064a\u0629 \u0627\u0644\u062a\u0642\u0633\u064a\u0645 \u0639\u0644\u0649 \u0643\u0644 \u0639\u0646\u0635\u0631\u060c \u0633\u064a\u062a\u0645 \u0627\u062e\u062a\u064a\u0627\u0631 \u0627\u0644\u0639\u0646\u0635\u0631 \u0641\u064a \u0627\u0644\u0645\u0624\u0634\u0631 1 \u0648\u0625\u0639\u0627\u062f\u062a\u0647. \u0644\u0630\u0644\u0643\u060c ",(0,i.jsx)(n.code,{children:'split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , "*", "Image"),":",1)'})," \u062a\u064f\u0639\u064a\u062f ",(0,i.jsx)(n.code,{children:"['b','d','f','h']"}),". \u0648 ",(0,i.jsx)(n.code,{children:'contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , "*", "Image"),":",1) , p.obj)'})," \u062a\u064f\u0639\u064a\u062f \u0645\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646 ",(0,i.jsx)(n.code,{children:"p.obj"})," \u0645\u0648\u062c\u0648\u062f\u064b\u0627 \u0641\u064a ",(0,i.jsx)(n.code,{children:"['b','d','f','h']"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"4212-\u0648\u0638\u0627\u0626\u0641-\u062a\u062d\u0648\u064a\u0644-\u0627\u0644\u0646\u0648\u0639",children:"4.2.1.2 \u0648\u0638\u0627\u0626\u0641 \u062a\u062d\u0648\u064a\u0644 \u0627\u0644\u0646\u0648\u0639"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ParseFloat(): \u062a\u062d\u0644\u0644 \u0639\u062f\u062f \u0635\u062d\u064a\u062d \u0625\u0644\u0649 \u0639\u062f\u062f \u0639\u0634\u0631\u064a (\u0647\u0630\u0627 \u0636\u0631\u0648\u0631\u064a \u0644\u0623\u0646 \u0623\u064a \u0631\u0642\u0645 \u064a\u064f\u0633\u062a\u062e\u062f\u0645 \u0641\u064a \u0627\u0644\u0645\u0642\u0627\u0631\u0646\u0629 \u064a\u062c\u0628 \u062a\u062d\u0648\u064a\u0644\u0647 \u0625\u0644\u0649 \u0639\u062f\u062f \u0639\u0634\u0631\u064a)."}),"\n",(0,i.jsxs)(n.li,{children:["ToString(): \u062a\u062d\u0648\u0644 \u0643\u0627\u0626\u0646 \u0625\u0644\u0649 \u0646\u0635. \u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0644\u0647\u0630\u0627 \u0627\u0644\u0643\u0627\u0626\u0646 \u0646\u0648\u0639 \u0623\u0633\u0627\u0633\u064a \u0645\u0646 \u0627\u0644\u0646\u0648\u0639 string (\u0639\u0644\u0649 \u0633\u0628\u064a\u0644 \u0627\u0644\u0645\u062b\u0627\u0644\u060c \u0643\u0627\u0626\u0646 \u0645\u0646 \u0646\u0648\u0639 ",(0,i.jsx)(n.code,{children:"XXX"})," \u0639\u0646\u062f\u0645\u0627 \u064a\u0643\u0648\u0646 \u0647\u0646\u0627\u0643 \u0628\u064a\u0627\u0646 ",(0,i.jsx)(n.code,{children:"type XXX string"}),")."]}),"\n",(0,i.jsx)(n.li,{children:"IsNil(): \u062a\u064f\u0639\u064a\u062f \u0645\u0627 \u0625\u0630\u0627 \u0643\u0627\u0646 \u0627\u0644\u0648\u0633\u064a\u0637 \u0647\u0648 nil."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"5-\u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a-\u0627\u0644\u0645\u062a\u0642\u062f\u0645\u0629",children:"5. \u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a \u0627\u0644\u0645\u062a\u0642\u062f\u0645\u0629"}),"\n",(0,i.jsx)(n.h3,{id:"51-\u062d\u0648\u0644-\u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a",children:"5.1 \u062d\u0648\u0644 \u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a"}),"\n",(0,i.jsx)(n.p,{children:"\u0641\u064a Kubernetes (k8s)\u060c \u0645\u0646 \u0627\u0644\u0636\u0631\u0648\u0631\u064a \u0623\u0646 \u064a\u0633\u062a\u062e\u062f\u0645 webhook \u0628\u0631\u0648\u062a\u0648\u0643\u0648\u0644 HTTPS. \u0647\u0646\u0627\u0643 \u0646\u0647\u062c\u0627\u0646 \u0644\u062a\u062d\u0642\u064a\u0642 \u0630\u0644\u0643:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0634\u0647\u0627\u062f\u0627\u062a \u0630\u0627\u062a\u064a\u0629 \u0627\u0644\u062a\u0648\u0642\u064a\u0639 (\u0627\u0644\u0623\u0645\u062b\u0644\u0629 \u0641\u064a \u0647\u0630\u0627 \u0627\u0644\u0645\u0633\u062a\u0648\u062f\u0639 \u062a\u0633\u062a\u062e\u062f\u0645 \u0647\u0630\u0647 \u0627\u0644\u0637\u0631\u064a\u0642\u0629)"}),"\n",(0,i.jsx)(n.li,{children:"\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0634\u0647\u0627\u062f\u0629 \u0639\u0627\u062f\u064a\u0629"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"511-\u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a-\u0630\u0627\u062a\u064a\u0629-\u0627\u0644\u062a\u0648\u0642\u064a\u0639",children:"5.1.1 \u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a \u0630\u0627\u062a\u064a\u0629 \u0627\u0644\u062a\u0648\u0642\u064a\u0639"}),"\n",(0,i.jsx)(n.p,{children:"\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0634\u0647\u0627\u062f\u0629 \u0630\u0627\u062a\u064a\u0629 \u0627\u0644\u062a\u0648\u0642\u064a\u0639 \u064a\u0639\u0646\u064a \u0623\u0646 \u0627\u0644\u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 (CA) \u0627\u0644\u062a\u064a \u062a\u0635\u062f\u0631 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0644\u064a\u0633\u062a \u0648\u0627\u062d\u062f\u0629 \u0645\u0646 \u0627\u0644\u0633\u0644\u0637\u0627\u062a \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0627\u0644\u0645\u0639\u0631\u0648\u0641\u0629. \u0644\u0630\u0644\u0643\u060c \u064a\u062c\u0628 \u0625\u0639\u0644\u0627\u0645 k8s \u0628\u0647\u0630\u0647 \u0627\u0644\u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629."}),"\n",(0,i.jsxs)(n.p,{children:["\u062d\u0627\u0644\u064a\u064b\u0627\u060c \u0627\u0644\u0645\u062b\u0627\u0644 \u0641\u064a \u0647\u0630\u0627 \u0627\u0644\u0645\u0633\u062a\u0648\u062f\u0639 \u064a\u0633\u062a\u062e\u062f\u0645 \u0633\u0644\u0637\u0629 \u0634\u0647\u0627\u062f\u0629 \u0645\u0635\u0646\u0648\u0639\u0629 \u0630\u0627\u062a\u064a\u064b\u0627\u060c \u062d\u064a\u062b \u064a\u062a\u0645 \u062a\u062e\u0632\u064a\u0646 \u0627\u0644\u0645\u0641\u062a\u0627\u062d \u0627\u0644\u062e\u0627\u0635 \u0648\u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0641\u064a ",(0,i.jsx)(n.code,{children:"config/certificate/ca.crt"})," \u0648 ",(0,i.jsx)(n.code,{children:"config/certificate/ca.key"})," \u0639\u0644\u0649 \u0627\u0644\u062a\u0648\u0627\u0644\u064a. \u0634\u0647\u0627\u062f\u0629 webhook \u0647\u064a ",(0,i.jsx)(n.code,{children:"config/certificate/server.crt"}),'\u060c \u0648\u0627\u0644\u062a\u064a \u062a\u0635\u062f\u0631\u0647\u0627 \u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0627\u0644\u0645\u0635\u0646\u0648\u0639\u0629 \u0630\u0627\u062a\u064a\u064b\u0627. \u0646\u0637\u0627\u0642\u0627\u062a \u0647\u0630\u0647 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0647\u064a "webhook.domain.local" (\u0644\u0640 webhook \u062e\u0627\u0631\u062c\u064a) \u0648 "casbin-webhook-svc.default.svc" (\u0644\u0640 webhook \u062f\u0627\u062e\u0644\u064a).']}),"\n",(0,i.jsxs)(n.p,{children:["\u064a\u062a\u0645 \u0646\u0642\u0644 \u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0639\u0646 \u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0625\u0644\u0649 k8s \u0639\u0628\u0631 \u0645\u0644\u0641\u0627\u062a \u062a\u0643\u0648\u064a\u0646 webhook. \u0643\u0644\u0627 \u0645\u0646 ",(0,i.jsx)(n.code,{children:"config/webhook_external.yaml"})," \u0648 ",(0,i.jsx)(n.code,{children:"config/webhook_internal.yaml"}),' \u064a\u062d\u062a\u0648\u064a\u0627\u0646 \u0639\u0644\u0649 \u062d\u0642\u0644 \u064a\u0633\u0645\u0649 "CABundle"\u060c \u0648\u0627\u0644\u0630\u064a \u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0633\u0644\u0633\u0644\u0629 \u0645\u0634\u0641\u0631\u0629 \u0628\u062a\u0631\u0645\u064a\u0632 base64 \u0644\u0634\u0647\u0627\u062f\u0629 \u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629.']}),"\n",(0,i.jsx)(n.p,{children:"\u0641\u064a \u062d\u0627\u0644\u0629 \u0627\u0644\u062d\u0627\u062c\u0629 \u0625\u0644\u0649 \u062a\u063a\u064a\u064a\u0631 \u0627\u0644\u0634\u0647\u0627\u062f\u0629/\u0627\u0644\u0646\u0637\u0627\u0642 (\u0639\u0644\u0649 \u0633\u0628\u064a\u0644 \u0627\u0644\u0645\u062b\u0627\u0644\u060c \u0625\u0630\u0627 \u0643\u0646\u062a \u062a\u0631\u063a\u0628 \u0641\u064a \u0648\u0636\u0639 \u0647\u0630\u0627 webhook \u0641\u064a \u0645\u0633\u0627\u062d\u0629 \u0623\u062e\u0631\u0649 \u0645\u0646 k8s \u0623\u062b\u0646\u0627\u0621 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 webhook \u062f\u0627\u062e\u0644\u064a\u060c \u0623\u0648 \u0625\u0630\u0627 \u0643\u0646\u062a \u062a\u0631\u063a\u0628 \u0641\u064a \u062a\u063a\u064a\u064a\u0631 \u0627\u0644\u0646\u0637\u0627\u0642 \u0623\u062b\u0646\u0627\u0621 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 webhook \u062e\u0627\u0631\u062c\u064a)\u060c \u064a\u062c\u0628 \u0627\u062a\u0628\u0627\u0639 \u0627\u0644\u0625\u062c\u0631\u0627\u0621\u0627\u062a \u0627\u0644\u062a\u0627\u0644\u064a\u0629:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0625\u0646\u0634\u0627\u0621 \u0633\u0644\u0637\u0629 \u0634\u0647\u0627\u062f\u0629 \u062c\u062f\u064a\u062f\u0629:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u0641\u062a\u0627\u062d \u0627\u0644\u062e\u0627\u0635 \u0644\u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0627\u0644\u0645\u0632\u064a\u0641\u0629:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"openssl genrsa -des3 -out ca.key 2048\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0625\u0632\u0627\u0644\u0629 \u062d\u0645\u0627\u064a\u0629 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0644\u0644\u0645\u0641\u062a\u0627\u062d \u0627\u0644\u062e\u0627\u0635:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"openssl rsa -in ca.key -out ca.key\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0625\u0646\u0634\u0627\u0621 \u0645\u0641\u062a\u0627\u062d \u062e\u0627\u0635 \u0644\u062e\u0627\u062f\u0645 webhook:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"openssl genrsa -des3 -out server.key 2048\nopenssl rsa -in server.key -out server.key\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0627\u0633\u062a\u062e\u062f\u0645 \u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0627\u0644\u0645\u0648\u0644\u062f\u0629 \u0630\u0627\u062a\u064a\u064b\u0627 \u0644\u062a\u0648\u0642\u064a\u0639 \u0634\u0647\u0627\u062f\u0629 \u0644\u0640 webhook:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u0627\u0646\u0633\u062e \u0645\u0644\u0641 \u062a\u0643\u0648\u064a\u0646 openssl \u0627\u0644\u062e\u0627\u0635 \u0628\u0646\u0638\u0627\u0645\u0643 \u0644\u0644\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0627\u0644\u0645\u0624\u0642\u062a. \u064a\u0645\u0643\u0646\u0643 \u0645\u0639\u0631\u0641\u0629 \u0645\u0648\u0642\u0639 \u0645\u0644\u0641 \u0627\u0644\u062a\u0643\u0648\u064a\u0646 \u0628\u062a\u0634\u063a\u064a\u0644 ",(0,i.jsx)(n.code,{children:"openssl version -a"}),"\u060c \u0648\u0639\u0627\u062f\u0629 \u0645\u0627 \u064a\u0633\u0645\u0649 ",(0,i.jsx)(n.code,{children:"openssl.cnf"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0641\u064a \u0645\u0644\u0641 \u0627\u0644\u062a\u0643\u0648\u064a\u0646:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u0627\u0628\u062d\u062b \u0639\u0646 \u0627\u0644\u0641\u0642\u0631\u0629 ",(0,i.jsx)(n.code,{children:"[req]"})," \u0648\u0623\u0636\u0641 \u0627\u0644\u0633\u0637\u0631 \u0627\u0644\u062a\u0627\u0644\u064a: ",(0,i.jsx)(n.code,{children:"req_extensions = v3_req"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u0627\u0628\u062d\u062b \u0639\u0646 \u0627\u0644\u0641\u0642\u0631\u0629 ",(0,i.jsx)(n.code,{children:"[v3_req]"})," \u0648\u0623\u0636\u0641 \u0627\u0644\u0633\u0637\u0631 \u0627\u0644\u062a\u0627\u0644\u064a: ",(0,i.jsx)(n.code,{children:"subjectAltName = @alt_names"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0623\u0636\u0641 \u0627\u0644\u0623\u0633\u0637\u0631 \u0627\u0644\u062a\u0627\u0644\u064a\u0629 \u0625\u0644\u0649 \u0627\u0644\u0645\u0644\u0641:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:"[alt_names]\nDNS.2=<The domain you want>\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u0645\u0644\u0627\u062d\u0638\u0629: \u0627\u0633\u062a\u0628\u062f\u0644 'casbin-webhook-svc.default.svc' \u0628\u0627\u0644\u0627\u0633\u0645 \u0627\u0644\u062d\u0642\u064a\u0642\u064a \u0644\u062e\u062f\u0645\u062a\u0643 \u0627\u0644\u062e\u0627\u0635\u0629 \u0625\u0630\u0627 \u0642\u0631\u0631\u062a \u062a\u0639\u062f\u064a\u0644 \u0627\u0633\u0645 \u0627\u0644\u062e\u062f\u0645\u0629."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0627\u0633\u062a\u062e\u062f\u0645 \u0645\u0644\u0641 \u0627\u0644\u062a\u0643\u0648\u064a\u0646 \u0627\u0644\u0645\u0639\u062f\u0644 \u0644\u0625\u0646\u0634\u0627\u0621 \u0645\u0644\u0641 \u0637\u0644\u0628 \u0634\u0647\u0627\u062f\u0629:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"openssl req -new -nodes -keyout server.key -out server.csr -config openssl.cnf\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0627\u0633\u062a\u062e\u062f\u0645 \u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0627\u0644\u0645\u0635\u0646\u0648\u0639\u0629 \u0630\u0627\u062a\u064a\u064b\u0627 \u0644\u0644\u0631\u062f \u0639\u0644\u0649 \u0627\u0644\u0637\u0644\u0628 \u0648\u062a\u0648\u0642\u064a\u0639 \u0627\u0644\u0634\u0647\u0627\u062f\u0629:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"openssl x509 -req -days 3650 -in server.csr -out server.crt -CA ca.crt -CAkey ca.key -CAcreateserial -extensions v3_req -extensions SAN -extfile openssl.cnf\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u0627\u0633\u062a\u0628\u062f\u0644 \u062d\u0642\u0644 'CABundle': \u0643\u0644\u0627 \u0645\u0646 ",(0,i.jsx)(n.code,{children:"config/webhook_external.yaml"})," \u0648 ",(0,i.jsx)(n.code,{children:"config/webhook_internal.yaml"}),' \u064a\u062d\u062a\u0648\u064a\u0627\u0646 \u0639\u0644\u0649 \u062d\u0642\u0644 \u064a\u0633\u0645\u0649 "CABundle"\u060c \u0648\u0627\u0644\u0630\u064a \u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0633\u0644\u0633\u0644\u0629 \u0645\u0634\u0641\u0631\u0629 \u0628\u062a\u0631\u0645\u064a\u0632 base64 \u0644\u0634\u0647\u0627\u062f\u0629 \u0633\u0644\u0637\u0629 \u0627\u0644\u0634\u0647\u0627\u062f\u0629. \u0642\u0645 \u0628\u062a\u062d\u062f\u064a\u062b \u0647\u0630\u0627 \u0627\u0644\u062d\u0642\u0644 \u0628\u0627\u0644\u0634\u0647\u0627\u062f\u0629 \u0627\u0644\u062c\u062f\u064a\u062f\u0629.']}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u0625\u0630\u0627 \u0643\u0646\u062a \u062a\u0633\u062a\u062e\u062f\u0645 helm\u060c \u064a\u062c\u0628 \u062a\u0637\u0628\u064a\u0642 \u062a\u063a\u064a\u064a\u0631\u0627\u062a \u0645\u0645\u0627\u062b\u0644\u0629 \u0639\u0644\u0649 \u0627\u0644\u0631\u0633\u0648\u0645 \u0627\u0644\u0628\u064a\u0627\u0646\u064a\u0629 helm."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"512-\u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a-\u0627\u0644\u0642\u0627\u0646\u0648\u0646\u064a\u0629",children:"5.1.2 \u0627\u0644\u0634\u0647\u0627\u062f\u0627\u062a \u0627\u0644\u0642\u0627\u0646\u0648\u0646\u064a\u0629"}),"\n",(0,i.jsxs)(n.p,{children:['\u0625\u0630\u0627 \u0643\u0646\u062a \u062a\u0633\u062a\u062e\u062f\u0645 \u0634\u0647\u0627\u062f\u0627\u062a \u0642\u0627\u0646\u0648\u0646\u064a\u0629\u060c \u0641\u0644\u0646 \u062a\u062d\u062a\u0627\u062c \u0625\u0644\u0649 \u0627\u0644\u0645\u0631\u0648\u0631 \u0628\u0643\u0644 \u0647\u0630\u0647 \u0627\u0644\u0625\u062c\u0631\u0627\u0621\u0627\u062a. \u0623\u0632\u0644 \u062d\u0642\u0644 "CABundle" \u0641\u064a ',(0,i.jsx)(n.code,{children:"config/webhook_external.yaml"})," \u0648 ",(0,i.jsx)(n.code,{children:"config/webhook_internal.yaml"}),"\u060c \u0648\u063a\u064a\u0631 \u0627\u0644\u0646\u0637\u0627\u0642 \u0641\u064a \u0647\u0630\u0647 \u0627\u0644\u0645\u0644\u0641\u0627\u062a \u0625\u0644\u0649 \u0627\u0644\u0646\u0637\u0627\u0642 \u0627\u0644\u0630\u064a \u062a\u0645\u0644\u0643\u0647."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},8453(e,n,s){s.d(n,{R:()=>r,x:()=>a});var c=s(6540);const i={},l=c.createContext(i);function r(e){const n=c.useContext(l);return c.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),c.createElement(l.Provider,{value:n},e.children)}}}]);