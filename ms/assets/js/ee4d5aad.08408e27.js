"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[1252],{3905:(a,n,e)=>{e.d(n,{Zo:()=>u,kt:()=>k});var t=e(7294);function r(a,n,e){return n in a?Object.defineProperty(a,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[n]=e,a}function l(a,n){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(a);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable}))),e.push.apply(e,t)}return e}function i(a){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?l(Object(e),!0).forEach((function(n){r(a,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(e,n))}))}return a}function o(a,n){if(null==a)return{};var e,t,r=function(a,n){if(null==a)return{};var e,t,r={},l=Object.keys(a);for(t=0;t<l.length;t++)e=l[t],n.indexOf(e)>=0||(r[e]=a[e]);return r}(a,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(a);for(t=0;t<l.length;t++)e=l[t],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(a,e)&&(r[e]=a[e])}return r}var g=t.createContext({}),p=function(a){var n=t.useContext(g),e=n;return a&&(e="function"==typeof a?a(n):i(i({},n),a)),e},u=function(a){var n=p(a.components);return t.createElement(g.Provider,{value:n},a.children)},d={inlineCode:"code",wrapper:function(a){var n=a.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(a,n){var e=a.components,r=a.mdxType,l=a.originalType,g=a.parentName,u=o(a,["components","mdxType","originalType","parentName"]),m=p(e),k=r,s=m["".concat(g,".").concat(k)]||m[k]||d[k]||l;return e?t.createElement(s,i(i({ref:n},u),{},{components:e})):t.createElement(s,i({ref:n},u))}));function k(a,n){var e=arguments,r=n&&n.mdxType;if("string"==typeof a||r){var l=e.length,i=new Array(l);i[0]=m;var o={};for(var g in n)hasOwnProperty.call(n,g)&&(o[g]=n[g]);o.originalType=a,o.mdxType="string"==typeof a?a:r,i[1]=o;for(var p=2;p<l;p++)i[p]=e[p];return t.createElement.apply(null,i)}return t.createElement.apply(null,e)}m.displayName="MDXCreateElement"},6918:(a,n,e)=>{e.r(n),e.d(n,{assets:()=>g,contentTitle:()=>i,default:()=>s,frontMatter:()=>l,metadata:()=>o,toc:()=>p});var t=e(7462),r=(e(7294),e(3905));const l={id:"log-error",title:"Log & Error Handling",description:"Pencatatan dan penanganan kesalahan dalam Casbin",keywords:["log","error","error handling"],authors:["hsluoyz"]},i=void 0,o={unversionedId:"log-error",id:"log-error",title:"Log & Error Handling",description:"Pencatatan dan penanganan kesalahan dalam Casbin",source:"@site/i18n/ms/docusaurus-plugin-content-docs/current/LogError.mdx",sourceDirName:".",slug:"/log-error",permalink:"/ms/docs/log-error",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/LogError.mdx",tags:[],version:"current",frontMatter:{id:"log-error",title:"Log & Error Handling",description:"Pencatatan dan penanganan kesalahan dalam Casbin",keywords:["log","error","error handling"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Casbin Service",permalink:"/ms/docs/service"},next:{title:"Frontend Usage",permalink:"/ms/docs/frontend"}},g={},p=[{value:"Pencatatan",id:"pencatatan",level:2},{value:"Gunakan logger yang berbeza untuk penguatkuasaan yang berbeza",id:"gunakan-logger-yang-berbeza-untuk-penguatkuasaan-yang-berbeza",level:3},{value:"Logger yang disokong",id:"logger-yang-disokong",level:4},{value:"Cara menulis pencatat",id:"cara-menulis-pencatat",level:4},{value:"Pengendalian ralat",id:"pengendalian-ralat",level:2},{value:"Aktifkan dan nyahaktifkan",id:"aktifkan-dan-nyahaktifkan",level:2}],u=a=>function(n){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",n)},d=u("Tabs"),m=u("TabItem"),k={toc:p};function s(a){let{components:n,...e}=a;return(0,r.kt)("wrapper",(0,t.Z)({},k,e,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"pencatatan"},"Pencatatan"),(0,r.kt)("p",null,"Casbin menggunakan ",(0,r.kt)("inlineCode",{parentName:"p"},"log")," terbina dalam untuk mencetak log ke konsol secara lalai, seperti:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-log"},"2017/07/15 19:43:56 [Request: alice, data1, read ---\x3e true]\n")),(0,r.kt)("p",null,"Pencatatan tidak diaktifkan secara lalai. Anda boleh menukarnya melalui ",(0,r.kt)("inlineCode",{parentName:"p"},"Enforcer.EnableLog()")," atau parameter terakhir ",(0,r.kt)("inlineCode",{parentName:"p"},"NewEnforcer()"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Kami sudah menyokong pencatatan model, permintaan penguatkuasaan, peranan, dan polisi dalam Golang. Anda boleh menentukan log anda sendiri untuk mencatat Casbin.\nJika anda menggunakan Python, pycasbin menggunakan mekanisme pencatatan (logging) bawaan Python. Pakej pycasbin membuat panggilan ke ",(0,r.kt)("inlineCode",{parentName:"p"},"logging.getLogger()")," untuk menetapkan logger. Tidak diperlukan konfigurasi pencatatan khas selain menginisialisasi logger dalam aplikasi induk. Jika tidak ada pencatatan yang diinisialisasi dalam aplikasi induk, anda tidak akan melihat apa-apa mesej log dari pycasbin. Pada masa yang sama, apabila anda mengaktifkan log dalam pycasbin, ia akan menggunakan ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/pycasbin/blob/c33cabfa0ac65cd09cf812a65e71794d64cb5132/casbin/util/log.py#L6C1-L6C1"},"konfigurasi log lalai"),". Untuk sambungan pycasbin lain, anda boleh merujuk kepada ",(0,r.kt)("a",{parentName:"p",href:"https://docs.djangoproject.com/en/4.2/topics/logging/"},"dokumen pencatatan Django")," jika anda pengguna Django. Bagi pengguna Python lain, anda harus merujuk kepada ",(0,r.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/logging.config.html"},"dokumen pencatatan Python")," untuk mengkonfigurasi logger.")),(0,r.kt)("h3",{id:"gunakan-logger-yang-berbeza-untuk-penguatkuasaan-yang-berbeza"},"Gunakan logger yang berbeza untuk penguatkuasaan yang berbeza"),(0,r.kt)("p",null,"Setiap penguatkuasa boleh mempunyai logger sendiri untuk mencatat maklumat, dan ia boleh diubah pada waktu runtime."),(0,r.kt)("p",null,"Dan anda boleh menggunakan logger yang sesuai melalui parameter terakhir ",(0,r.kt)("inlineCode",{parentName:"p"},"NewEnforcer()"),". Jika anda menggunakan cara ini untuk memulakan enforcer anda, anda tidak perlu menggunakan parameter enabled kerana keutamaan medan enabled dalam logger adalah lebih tinggi."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},"// Set a default logger as enforcer e1's logger.\n// This operation can also be seen as changing the logger of e1 at runtime.\ne1.SetLogger(&Log.DefaultLogger{})\n\n// Set another logger as enforcer e2's logger.\ne2.SetLogger(&YouOwnLogger)\n\n// Set your logger when initializing enforcer e3.\ne3, _ := casbin.NewEnforcer(\"examples/rbac_model.conf\", a, logger)\n")),(0,r.kt)("h4",{id:"logger-yang-disokong"},"Logger yang disokong"),(0,r.kt)("p",null,"Kami menyediakan beberapa logger untuk membantu anda mencatat maklumat."),(0,r.kt)(d,{groupId:"langs",mdxType:"Tabs"},(0,r.kt)(m,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Logger"),(0,r.kt)("th",{parentName:"tr",align:null},"Pengarang"),(0,r.kt)("th",{parentName:"tr",align:null},"Penerangan"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casbin/casbin/blob/master/log/default_logger.go"},"Logger lalai (terbina dalam)")),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Logger lalai menggunakan log golang.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/casbin/zap-logger"},"Pencatat Zap")),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Menggunakan ",(0,r.kt)("a",{parentName:"td",href:"https://github.com/uber-go/zap"},"zap"),", berikan log yang dikodkan JSON dan anda boleh menyesuaikan lebih dengan pencatat zap anda sendiri."))))),(0,r.kt)(m,{value:"PHP",label:"PHP",mdxType:"TabItem"},(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Pencatat"),(0,r.kt)("th",{parentName:"tr",align:null},"Pengarang"),(0,r.kt)("th",{parentName:"tr",align:null},"Penerangan"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/php-casbin/psr3-bridge"},"pencatat jambatan psr3")),(0,r.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,r.kt)("td",{parentName:"tr",align:null},"Menyediakan jambatan yang mematuhi ",(0,r.kt)("a",{parentName:"td",href:"https://www.php-fig.org/psr/psr-3/"},"PSR-3"),".")))))),(0,r.kt)("h4",{id:"cara-menulis-pencatat"},"Cara menulis pencatat"),(0,r.kt)("p",null,"Pencatat anda harus melaksanakan antara muka ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/log/logger.go#L20"},"Logger"),"."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Kaedah"),(0,r.kt)("th",{parentName:"tr",align:null},"Jenis"),(0,r.kt)("th",{parentName:"tr",align:null},"Penerangan"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"EnableLog()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Kawal sama ada untuk mencetak mesej.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"IsEnabled()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Tunjukkan status yang didayakan bagi pencatat semasa.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LogModel()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Log maklumat berkaitan model.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LogEnforce()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Log maklumat berkaitan penguatkuasaan.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LogRole()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Log maklumat berkaitan peranan.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LogPolicy()"),(0,r.kt)("td",{parentName:"tr",align:null},"wajib"),(0,r.kt)("td",{parentName:"tr",align:null},"Log maklumat berkaitan polisi.")))),(0,r.kt)("p",null,"Anda boleh lulus ",(0,r.kt)("inlineCode",{parentName:"p"},"logger")," tersuai anda ke ",(0,r.kt)("inlineCode",{parentName:"p"},"Enforcer.SetLogger()"),"."),(0,r.kt)("p",null,"Berikut adalah contoh cara menyesuaikan logger untuk Golang:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'import (\n    "fmt"\n    "log"\n    "strings"\n)\n\n// DefaultLogger is the implementation for a Logger using golang log.\ntype DefaultLogger struct {\n    enabled bool\n}\n\nfunc (l *DefaultLogger) EnableLog(enable bool) {\n    l.enabled = enable\n}\n\nfunc (l *DefaultLogger) IsEnabled() bool {\n    return l.enabled\n}\n\nfunc (l *DefaultLogger) LogModel(model [][]string) {\n    if !l.enabled {\n        return\n    }\n    var str strings.Builder\n    str.WriteString("Model: ")\n    for _, v := range model {\n        str.WriteString(fmt.Sprintf("%v\\n", v))\n    }\n\n    log.Println(str.String())\n}\n\nfunc (l *DefaultLogger) LogEnforce(matcher string, request []interface{}, result bool, explains [][]string) {\n    if !l.enabled {\n        return\n    }\n\n    var reqStr strings.Builder\n    reqStr.WriteString("Request: ")\n    for i, rval := range request {\n        if i != len(request)-1 {\n            reqStr.WriteString(fmt.Sprintf("%v, ", rval))\n        } else {\n            reqStr.WriteString(fmt.Sprintf("%v", rval))\n        }\n    }\n    reqStr.WriteString(fmt.Sprintf(" ---\x3e %t\\n", result))\n\n    reqStr.WriteString("Hit Policy: ")\n    for i, pval := range explains {\n        if i != len(explains)-1 {\n            reqStr.WriteString(fmt.Sprintf("%v, ", pval))\n        } else {\n            reqStr.WriteString(fmt.Sprintf("%v \\n", pval))\n        }\n    }\n\n    log.Println(reqStr.String())\n}\n\nfunc (l *DefaultLogger) LogPolicy(policy map[string][][]string) {\n    if !l.enabled {\n        return\n    }\n\n    var str strings.Builder\n    str.WriteString("Policy: ")\n    for k, v := range policy {\n        str.WriteString(fmt.Sprintf("%s : %v\\n", k, v))\n    }\n\n    log.Println(str.String())\n}\n\nfunc (l *DefaultLogger) LogRole(roles []string) {\n    if !l.enabled {\n        return\n    }\n\n    log.Println("Roles: ", roles)\n}\n')),(0,r.kt)("h2",{id:"pengendalian-ralat"},"Pengendalian ralat"),(0,r.kt)("p",null,"Ralat atau panik mungkin berlaku apabila anda menggunakan Casbin atas sebab-sebab seperti:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Sintaks tidak sah dalam fail model (.conf)."),(0,r.kt)("li",{parentName:"ol"},"Sintaks tidak sah dalam fail polisi (.csv)."),(0,r.kt)("li",{parentName:"ol"},"Ralat tersuai dari adaptor storan, contohnya, MySQL gagal menyambung."),(0,r.kt)("li",{parentName:"ol"},"Bug Casbin.")),(0,r.kt)("p",null,"Terdapat lima fungsi utama yang mungkin anda perlu ketahui untuk kesalahan atau panik:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Fungsi"),(0,r.kt)("th",{parentName:"tr",align:null},"Tingkah laku pada kesalahan"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#NewEnforcer"},"NewEnforcer()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan ralat")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.LoadModel"},"LoadModel()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan ralat")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.LoadPolicy"},"LoadPolicy()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan ralat")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.SavePolicy"},"SavePolicy()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan ralat")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.Enforce"},"Enforce()")),(0,r.kt)("td",{parentName:"tr",align:null},"Mengembalikan ralat")))),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"NewEnforcer()")," memanggil ",(0,r.kt)("inlineCode",{parentName:"p"},"LoadModel()")," dan ",(0,r.kt)("inlineCode",{parentName:"p"},"LoadPolicy()")," secara dalaman. Oleh itu, anda tidak perlu memanggil dua yang terakhir ketika menggunakan ",(0,r.kt)("inlineCode",{parentName:"p"},"NewEnforcer()"),".")),(0,r.kt)("h2",{id:"aktifkan-dan-nyahaktifkan"},"Aktifkan dan nyahaktifkan"),(0,r.kt)("p",null,"Penegak boleh dinonaktifkan melalui fungsi ",(0,r.kt)("inlineCode",{parentName:"p"},"Enforcer.EnableEnforce()"),". Apabila ia dinonaktifkan, ",(0,r.kt)("inlineCode",{parentName:"p"},"Enforcer.Enforce()")," akan sentiasa mengembalikan ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),". Operasi lain seperti menambah atau mengalih keluar polisi tidak terjejas. Berikut adalah contoh:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'e := casbin.NewEnforcer("examples/basic_model.conf", "examples/basic_policy.csv")\n\n// Will return false.\n// By default, the enforcer is enabled.\ne.Enforce("non-authorized-user", "data1", "read")\n\n// Disable the enforcer at runtime.\ne.EnableEnforce(false)\n\n// Will return true for any request.\ne.Enforce("non-authorized-user", "data1", "read")\n\n// Enable the enforcer again.\ne.EnableEnforce(true)\n\n// Will return false.\ne.Enforce("non-authorized-user", "data1", "read")\n')))}s.isMDXComponent=!0}}]);