"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[2851],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return c}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var g=r.createContext({}),d=function(e){var n=r.useContext(g),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},u=function(e){var n=d(e.components);return r.createElement(g.Provider,{value:n},e.children)},s={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,g=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=d(t),c=a,m=p["".concat(g,".").concat(c)]||p[c]||s[c]||i;return t?r.createElement(m,l(l({ref:n},u),{},{components:t})):r.createElement(m,l({ref:n},u))}));function c(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,l=new Array(i);l[0]=p;var o={};for(var g in n)hasOwnProperty.call(n,g)&&(o[g]=n[g]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var d=2;d<i;d++)l[d]=t[d];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}p.displayName="MDXCreateElement"},925:function(e,n,t){t.r(n),t.d(n,{assets:function(){return u},contentTitle:function(){return g},default:function(){return f},frontMatter:function(){return o},metadata:function(){return d},toc:function(){return s}});var r=t(3117),a=t(102),i=(t(7294),t(3905)),l=["components"],o={id:"log-error",title:"Log- & Fehlerbehandlung",description:"Casbin log & error handling",keywords:["log","error","error handling"]},g=void 0,d={unversionedId:"log-error",id:"log-error",title:"Log- & Fehlerbehandlung",description:"Casbin log & error handling",source:"@site/i18n/de/docusaurus-plugin-content-docs/current/LogError.mdx",sourceDirName:".",slug:"/log-error",permalink:"/de/docs/log-error",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/LogError.mdx",tags:[],version:"current",frontMatter:{id:"log-error",title:"Log- & Fehlerbehandlung",description:"Casbin log & error handling",keywords:["log","error","error handling"]},sidebar:"docs",previous:{title:"Kasbin-Dienst",permalink:"/de/docs/service"},next:{title:"Frontend-Nutzung",permalink:"/de/docs/frontend"}},u={},s=[{value:"Protokollierung",id:"protokollierung",level:2},{value:"Verwende verschiedene Protokolle f\xfcr unterschiedliche Durchsetzer",id:"verwende-verschiedene-protokolle-f\xfcr-unterschiedliche-durchsetzer",level:3},{value:"Unterst\xfctzte Logger",id:"unterst\xfctzte-logger",level:4},{value:"Wie man einen Logger schreibt",id:"wie-man-einen-logger-schreibt",level:4},{value:"Fehlerbehandlung",id:"fehlerbehandlung",level:2},{value:"&amp; deaktivieren",id:"-deaktivieren",level:2}],p=function(e){return function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",n)}},c=p("Tabs"),m=p("TabItem"),k={toc:s};function f(e){var n=e.components,t=(0,a.Z)(e,l);return(0,i.kt)("wrapper",(0,r.Z)({},k,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"protokollierung"},"Protokollierung"),(0,i.kt)("p",null,"Kasbin verwendet das eingebaute ",(0,i.kt)("inlineCode",{parentName:"p"},"Log")," um Logs standardm\xe4\xdfig auf die Konsole zu drucken, wie:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-log"},"2017/07/15 19:43:56 [Anfrage: alice, data1, lesen Sie ---\x3e true]\n")),(0,i.kt)("p",null,"Die Protokollierung ist standardm\xe4\xdfig nicht aktiviert. Sie k\xf6nnen es \xfcber ",(0,i.kt)("inlineCode",{parentName:"p"},"Enforcer.EnableLog()")," oder den letzten Parameter von ",(0,i.kt)("inlineCode",{parentName:"p"},"NewEnforcer()")," umschalten."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Wir unterst\xfctzen bereits die Protokollierung des Modells, Forderung, Rolle, Politik in Golang. Sie k\xf6nnen Ihr eigenes Log f\xfcr die Protokollierung von Casbin festlegen. Wenn du Python verwendest, nutzt Pycasbin den standardm\xe4\xdfigen Python-Logging-Mechanismus. Das pycasbin-Paket ruft auf logging.getLogger() auf, um den Logger zu setzen. Eine spezielle Protokollkonfiguration wird au\xdfer der Initialisierung des Loggers in der \xfcbergeordneten Anwendung ben\xf6tigt. Wenn keine Protokollierung innerhalb der \xfcbergeordneten Anwendung intiliziert ist, werden keine Logmeldungen von pycasbin angezeigt.")),(0,i.kt)("h3",{id:"verwende-verschiedene-protokolle-f\xfcr-unterschiedliche-durchsetzer"},"Verwende verschiedene Protokolle f\xfcr unterschiedliche Durchsetzer"),(0,i.kt)("p",null,"Jeder Vollstrecker kann seinen eigenen Logger haben, der Informationen protokolliert und zur Laufzeit ge\xe4ndert werden kann."),(0,i.kt)("p",null,"Und Sie k\xf6nnen einen richtigen Logger \xfcber den letzten Parameter von ",(0,i.kt)("inlineCode",{parentName:"p"},"NewEnforcer()"),"verwenden, wenn Sie auf diese Weise Ihre Durchsetzung initialisieren, Sie m\xfcssen den aktivierten Parameter nicht verwenden, da die Priorit\xe4t des aktivierten Feldes im Logger h\xf6her ist."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'// Standardlogger als Enforcer e1 Logger festlegen.\n// Dieser Vorgang kann auch als \xc4nderung des Loggers von e1 zur Laufzeit angesehen werden.\ne1.SetLogger(&Log.DefaultLogger{})\n\n// Einen anderen Logger als Enforcer e2\'s Logger setzen.\ne2.SetLogger(&YouOwnLogger)\n\n// Legen Sie Ihren Logger fest, wenn Sie den Durchsetzer e3 initialisieren.\ne3, _ := casbin.NewEnforcer("examples/rbac_model.conf", a, logger)\n')),(0,i.kt)("h4",{id:"unterst\xfctzte-logger"},"Unterst\xfctzte Logger"),(0,i.kt)("p",null,"Wir stellen Ihnen einige Logger zur Verf\xfcgung, die Ihnen beim Loggen helfen."),(0,i.kt)(c,{groupId:"langs",mdxType:"Tabs"},(0,i.kt)(m,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Logger"),(0,i.kt)("th",{parentName:"tr",align:null},"Autor"),(0,i.kt)("th",{parentName:"tr",align:null},"Beschreibung"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/casbin/casbin/blob/master/log/default_logger.go"},"Standard Logger (eingebaut)")),(0,i.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,i.kt)("td",{parentName:"tr",align:null},"Der Standard-Logger mit golang-Log.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/casbin/zap-logger"},"Zap logger")),(0,i.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,i.kt)("td",{parentName:"tr",align:null},"Verwende ",(0,i.kt)("a",{parentName:"td",href:"https://github.com/uber-go/zap"},"zap"),", gib json kodiertes Log an und du kannst mehr mit deinem eigenen zap-logger anpassen."))))),(0,i.kt)(m,{value:"PHP",label:"PHP",mdxType:"TabItem"},(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Logger"),(0,i.kt)("th",{parentName:"tr",align:null},"Autor"),(0,i.kt)("th",{parentName:"tr",align:null},"Beschreibung"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/php-casbin/psr3-bridge"},"psr3-bridge Logger")),(0,i.kt)("td",{parentName:"tr",align:null},"Casbin"),(0,i.kt)("td",{parentName:"tr",align:null},"Bietet eine ",(0,i.kt)("a",{parentName:"td",href:"https://www.php-fig.org/psr/psr-3/"},"PSR-3")," konforme Br\xfccke.")))))),(0,i.kt)("h4",{id:"wie-man-einen-logger-schreibt"},"Wie man einen Logger schreibt"),(0,i.kt)("p",null,"Ihr Logger sollte die ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/log/logger.go#L20"},"Logger")," Schnittstelle implementieren."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Methode"),(0,i.kt)("th",{parentName:"tr",align:null},"Typ"),(0,i.kt)("th",{parentName:"tr",align:null},"Beschreibung"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"EnableLog()"),(0,i.kt)("td",{parentName:"tr",align:null},"mandatory"),(0,i.kt)("td",{parentName:"tr",align:null},"Legen Sie fest, ob die Nachricht gedruckt wird.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Isaktiviert()"),(0,i.kt)("td",{parentName:"tr",align:null},"mandatory"),(0,i.kt)("td",{parentName:"tr",align:null},"Zeigt den aktuellen Status des Loggers an.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"LogModel()"),(0,i.kt)("td",{parentName:"tr",align:null},"mandatory"),(0,i.kt)("td",{parentName:"tr",align:null},"Login-Informationen zum Modell.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"LogEnforce()"),(0,i.kt)("td",{parentName:"tr",align:null},"mandatory"),(0,i.kt)("td",{parentName:"tr",align:null},"Login-Informationen im Zusammenhang mit der Durchsetzung.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"LogRole()"),(0,i.kt)("td",{parentName:"tr",align:null},"mandatory"),(0,i.kt)("td",{parentName:"tr",align:null},"Log-Info in Bezug auf die Rolle.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"LogPolicy()"),(0,i.kt)("td",{parentName:"tr",align:null},"mandatory"),(0,i.kt)("td",{parentName:"tr",align:null},"Log-Informationen in Bezug auf Richtlinien.")))),(0,i.kt)("p",null,"Sie k\xf6nnen Ihren benutzerdefinierten ",(0,i.kt)("inlineCode",{parentName:"p"},"-Logger")," an ",(0,i.kt)("inlineCode",{parentName:"p"},"Enforcer.SetLogger()")," \xfcbergeben."),(0,i.kt)("p",null,"Hier ist ein Beispiel daf\xfcr, wie man einen Logger f\xfcr Golang anpassen kann:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'import (\n    "fmt"\n    "log"\n    "strings"\n)\n\n// DefaultLogger ist die Implementierung f\xfcr einen Logger mit golang-Protokoll.\ntype DefaultLogger struct {\n    enabled bool\n}\n\nfunc (l *DefaultLogger) EnableLog(enable bool) {\n    l. nabled = enable\n}\n\nfunc (l *StandardLogger) IsEnabled() bool {\n    return l.enabled\n}\n\nfunc (l *Standardlogger) LogModel(model [][]string) {\n    if !l. nabled {\n        return\n    }\n    var str strings.Builder\n    str. riteString("Model: ")\n    f\xfcr _, v := range model {\n        str. riteString(fmt.Sprintf("%v\\n", v))\n    }\n\n    log.Println(str. tring())\n}\n\nfunc (l *StandardLogger) LogEnforce(Matcher string, request []interface{}, result bool, erkl\xe4rt [][][]string) {\n    if !l. nabled {\n        return\n    }\n\n    var reqStr strings.Builder\n    reqStr. riteString("Anfrage: ")\n    f\xfcr i, rval := range request {\n        if i ! len(request)-1 {\n            reqStr. riteString(fmt. printf("%v, ", rval))\n        } else {\n            reqStr. riteString(fmt. printf("%v", rval))\n        }\n    }\n    reqStr. riteString(fmt.Sprintf(" ---\x3e %t\\n", result))\n\n    reqStr. riteString("Trefferrichtlinie: ")\n    f\xfcr i, pval := range erkl\xe4rt {\n        if i ! len(explains)-1 {\n            reqStr. riteString(fmt. printf("%v, ", pval))\n        } else {\n            reqStr. riteString(fmt. printf("%v \\n", pval))\n        }\n    }\n\n    Log. rintln(reqStr. tring())\n}\n\nfunc (l *DefaultLogger) LogPolicy(policy map[string][][]string) {\n    if !l. nabled {\n        return\n    }\n\n    var str strings. uilder\n    str. riteString("Policy: ")\n    f\xfcr k, v := range policy {\n        str.WriteString(fmt. printf("%s : %v\\n", k, v))\n    }\n\n    log.Println(str. tring())\n}\n\nfunc (l *DefaultLogger) LogRole(roles []string) {\n    if !l. nabled {\n        return\n    }\n\n    log.Println("Rolen: ", Rollen)\n}\n\n')),(0,i.kt)("h2",{id:"fehlerbehandlung"},"Fehlerbehandlung"),(0,i.kt)("p",null,"Fehler oder Panik k\xf6nnen auftreten, wenn Sie Casbin aus Gr\xfcnden wie z. B.:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Ung\xfcltige Syntax in der Modelldatei (.conf)."),(0,i.kt)("li",{parentName:"ol"},"Ung\xfcltige Syntax in Richtlinien-Datei (.csv)."),(0,i.kt)("li",{parentName:"ol"},"Benutzerdefinierter Fehler von Speicheradaptern, z. B. MySQL kann sich nicht verbinden."),(0,i.kt)("li",{parentName:"ol"},"Casbin's bug.")),(0,i.kt)("p",null,"Es gibt f\xfcnf Hauptfunktionen, die Sie f\xfcr Fehler oder Panik sorgen k\xf6nnen:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Funktion"),(0,i.kt)("th",{parentName:"tr",align:null},"Verhalten bei Fehler"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#NewEnforcer"},"NewEnforcer()")),(0,i.kt)("td",{parentName:"tr",align:null},"Retourenfehler")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.LoadModel"},"LoadModel()")),(0,i.kt)("td",{parentName:"tr",align:null},"Retourenfehler")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.LoadPolicy"},"LoadPolicy()")),(0,i.kt)("td",{parentName:"tr",align:null},"Retourenfehler")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.SavePolicy"},"SavePolicy()")),(0,i.kt)("td",{parentName:"tr",align:null},"Retourenfehler")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://godoc.org/github.com/casbin/casbin#Enforcer.Enforce"},"Enforce()")),(0,i.kt)("td",{parentName:"tr",align:null},"Retourenfehler")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"NewEnforcer()")," ruft ",(0,i.kt)("inlineCode",{parentName:"p"},"LoadModel()")," und ",(0,i.kt)("inlineCode",{parentName:"p"},"LoadPolicy()")," in auf. Sie m\xfcssen also die beiden letzten Aufrufe nicht aufrufen, wenn Sie ",(0,i.kt)("inlineCode",{parentName:"p"},"NewEnforcer()")," verwenden.")),(0,i.kt)("h2",{id:"-deaktivieren"},"& deaktivieren"),(0,i.kt)("p",null,"Der Vollstrecker kann \xfcber die Funktion ",(0,i.kt)("inlineCode",{parentName:"p"},"Enforcer.EnableEnforce()")," deaktiviert werden. ",(0,i.kt)("inlineCode",{parentName:"p"},"Enforcer.Enforce()")," wird immer ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," zur\xfcckgeben. Andere Operationen wie das Hinzuf\xfcgen oder Entfernen von Richtlinien sind nicht betroffen. Hier ist ein Beispiel:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'e := casbin.NewEnforcer("examples/basic_model.conf", "examples/basic_policy.csv")\n\n// Gibt Falsch zur\xfcck.\n// Standardm\xe4\xdfig ist der Vollstrecker aktiviert.\ne.Enforce("non-authorized-user", "data1", "read")\n\n// // Enforcer zur Laufzeit deaktivieren.\ne.EnableEnforce(false)\n\n// Gibt true f\xfcr jede Anfrage zur\xfcck.\ne.Enforce("non-authorized-user", "data1", "read")\n\n// Aktivieren Sie den Vollstrecker erneut.\ne.EnableEnforce(true)\n\n// Gibt Falsch zur\xfcck.\ne.Enforce("non-authorized-user", "data1", "read")\n')))}f.isMDXComponent=!0}}]);