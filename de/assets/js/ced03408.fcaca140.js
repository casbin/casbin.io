"use strict";(globalThis.webpackChunkcasbin_website_v2=globalThis.webpackChunkcasbin_website_v2||[]).push([[5090],{4666(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"k8s","title":"Authorization of Kubernetes","description":"Kubernetes (k8s) RBAC & ABAC Autorisierungsmiddleware basierend auf Casbin","source":"@site/i18n/de/docusaurus-plugin-content-docs/current/K8sAuthz.mdx","sourceDirName":".","slug":"/k8s","permalink":"/de/docs/k8s","draft":false,"unlisted":false,"editUrl":"https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sAuthz.mdx","tags":[],"version":"current","frontMatter":{"id":"k8s","title":"Authorization of Kubernetes","description":"Kubernetes (k8s) RBAC & ABAC Autorisierungsmiddleware basierend auf Casbin","keywords":["Kubernetes authorization","Kubernetes RBAC","Kubernetes ABAC","K8s-authz"],"authors":["hsluoyz"]},"sidebar":"docs","previous":{"title":"Performance Optimization","permalink":"/de/docs/performance"},"next":{"title":"Admission Webhook for K8s","permalink":"/de/docs/k8s-gatekeeper"}}');var r=s(4848),t=s(8453);const d={id:"k8s",title:"Authorization of Kubernetes",description:"Kubernetes (k8s) RBAC & ABAC Autorisierungsmiddleware basierend auf Casbin",keywords:["Kubernetes authorization","Kubernetes RBAC","Kubernetes ABAC","K8s-authz"],authors:["hsluoyz"]},a=void 0,l={},o=[{value:"Anforderungen",id:"anforderungen",level:2},{value:"Verwendung",id:"verwendung",level:2}];function u(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/casbin/k8s-authz",children:"K8s-authz"})," ist eine auf Casbin basierende Kubernetes (k8s) Autorisierungsmiddleware, die RBAC (Role-Based Access Control) und ABAC (Attribute-Based Access Control) zur Durchsetzung von Richtlinien nutzt. Diese Middleware integriert sich mit dem K8s Validierungs-Admission-Webhook, um die von Casbin definierten Richtlinien f\xfcr jede Anfrage an K8s-Ressourcen zu validieren. Benutzerdefinierte Zulassungscontroller werden mit Kubernetes unter Verwendung des ",(0,r.jsx)(n.code,{children:"ValidatingAdmissionWebhook"})," registriert, um Validierungen an Anfrageobjekten durchzuf\xfchren, die vom API-Server weitergeleitet wurden, und eine Antwort zu liefern, ob die Anfrage zugelassen oder abgelehnt werden soll."]}),"\n",(0,r.jsxs)(n.p,{children:["Um zu bestimmen, wann eingehende Anfragen an den Zulassungscontroller gesendet werden sollen, wurde ein Validierungs-Webhook implementiert. Dieser Webhook leitet Anfragen f\xfcr jede Art von K8s-Ressource oder Unterressource weiter und f\xfchrt eine Richtlinien\xfcberpr\xfcfung durch. Benutzer d\xfcrfen nur dann Operationen an diesen Ressourcen durchf\xfchren, wenn sie vom Casbin-Durchsetzer autorisiert sind. Der ",(0,r.jsx)(n.a,{href:"/docs/get-started#new-a-casbin-enforcer",children:"Durchsetzer"})," \xfcberpr\xfcft die Rollen des Benutzers, wie sie in den Richtlinien definiert sind. Das K8s-Cluster ist das Einsatzziel f\xfcr diese Middleware."]}),"\n",(0,r.jsx)(n.h2,{id:"anforderungen",children:"Anforderungen"}),"\n",(0,r.jsx)(n.p,{children:"Stellen Sie vor dem Fortfahren sicher, dass Sie folgendes haben:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Ein laufendes Kubernetes-Cluster. Sie k\xf6nnen ein lokales Cluster mit Docker einrichten oder ein komplettes Kubernetes-\xd6kosystem auf Ihrem Server einrichten. F\xfcr detaillierte Anweisungen, beziehen Sie sich auf diesen ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tutorials/kubernetes-basics/create-cluster/cluster-intro/",children:"Leitfaden"})," zur Einrichtung eines lokalen Kubernetes-Clusters auf Windows oder diesen ",(0,r.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-create-a-kubernetes-cluster-using-kubeadm-on-ubuntu-18-04",children:"Leitfaden"})," zur Einrichtung eines Clusters auf Linux."]}),"\n",(0,r.jsxs)(n.li,{children:["Kubectl CLI. Anweisungen zur Installation von Kubectl auf Windows finden Sie ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/tools/install-kubectl-windows/",children:"hier"}),", und f\xfcr Linux ",(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/",children:"hier"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"OpenSSL"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"verwendung",children:"Verwendung"}),"\n",(0,r.jsx)(n.p,{children:"Befolgen Sie diese Schritte, um K8s-authz zu verwenden:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Generieren Sie Zertifikate und Schl\xfcssel f\xfcr jeden Benutzer mit OpenSSL. F\xfchren Sie das untenstehende Skript aus:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./gen_cert.sh\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Erstellen Sie das Docker-Image aus der ",(0,r.jsx)(n.a,{href:"https://github.com/casbin/k8s-authz/blob/master/Dockerfile",children:"Dockerfile"})," manuell, indem Sie den folgenden Befehl ausf\xfchren. Vergessen Sie nicht, die Build-Version im Befehl und in der Bereitstellungs-",(0,r.jsx)(n.a,{href:"https://github.com/casbin/k8s-authz/blob/718f58c46e3dbf79063b5b1c18348c2fee5de9e9/manifests/deployment.yaml#L18",children:"Datei"})," entsprechend zu \xe4ndern."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker build -t casbin/k8s_authz:0.1 .\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Definieren Sie die Casbin-Richtlinien in den ",(0,r.jsx)(n.a,{href:"https://github.com/casbin/k8s-authz/blob/master/config/model.conf",children:"model.conf"})," und ",(0,r.jsx)(n.a,{href:"https://github.com/casbin/k8s-authz/blob/master/config/policy.csv",children:"policy.csv"})," Dateien. F\xfcr weitere Informationen dar\xfcber, wie diese Richtlinien funktionieren, verweisen Sie auf die ",(0,r.jsx)(n.a,{href:"/docs/how-it-works",children:"Dokumentation"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Vor der Bereitstellung k\xf6nnen Sie die Ports in der ",(0,r.jsx)(n.a,{href:"https://github.com/casbin/k8s-authz/blob/master/main.go",children:"main.go"})," Datei sowie in der Validierungs-Webhook-Konfigurations-",(0,r.jsx)(n.a,{href:"https://github.com/casbin/k8s-authz/blob/master/manifests/deployment.yaml",children:"Datei"})," basierend auf Ihren spezifischen Anforderungen \xe4ndern."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Bereitstellen des Validierungscontrollers und des Webhooks auf dem Kubernetes-Cluster durch Ausf\xfchren des folgenden Befehls:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f deployment.yaml\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["F\xfcr einen Produktionsserver wird empfohlen, ein Kubernetes ",(0,r.jsx)(n.code,{children:"secret"})," zu erstellen, um die Zertifikate zu sichern:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl create secret generic casbin -n default \\\n  --from-file=key.pem=certs/casbin-key.pem \\\n  --from-file=cert.pem=certs/casbin-crt.pem\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Nach Abschluss der oben genannten Schritte m\xfcssen Sie das Zertifikatsverzeichnis in ",(0,r.jsx)(n.a,{href:"https://github.com/ashish493/k8s-authz/blob/3560551427c0431a9d4594ad1206f084ede37c49/main.go#L26",children:"main.go"})," und den ",(0,r.jsx)(n.a,{href:"https://github.com/ashish493/k8s-authz/blob/3560551427c0431a9d4594ad1206f084ede37c49/manifests/deployment.yaml#L22",children:"Manifesten"})," mit dem Verzeichnis des erstellten ",(0,r.jsx)(n.code,{children:"secret"})," aktualisieren."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Jetzt sollte der Server hochgefahren und betriebsbereit sein, bereit, Anfragen an K8s-Ressourcen zu validieren und Richtlinien entsprechend durchzusetzen."})]})}function c(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453(e,n,s){s.d(n,{R:()=>d,x:()=>a});var i=s(6540);const r={},t=i.createContext(r);function d(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);