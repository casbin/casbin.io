"use strict";(globalThis.webpackChunkcasbin_website_v2=globalThis.webpackChunkcasbin_website_v2||[]).push([[8770],{1789(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"menu-permissions","title":"Menu Permissions","description":"Example for Menu Permissions","source":"@site/docs/MenuPermissions.mdx","sourceDirName":".","slug":"/menu-permissions","permalink":"/de/docs/menu-permissions","draft":false,"unlisted":false,"editUrl":"https://github.com/casbin/casbin-website-v2/edit/master/docs/MenuPermissions.mdx","tags":[],"version":"current","frontMatter":{"id":"menu-permissions","title":"Menu Permissions","description":"Example for Menu Permissions","keywords":["Menu Permissions","example"],"authors":["amikecoXu"]},"sidebar":"docs","previous":{"title":"Data Permissions","permalink":"/de/docs/data-permissions"},"next":{"title":"Plugins Overview","permalink":"/de/docs/plugins-overview"}}');var t=s(4848),r=s(8453);const l={id:"menu-permissions",title:"Menu Permissions",description:"Example for Menu Permissions",keywords:["Menu Permissions","example"],authors:["amikecoXu"]},c=void 0,d={},o=[{value:"1. Configuration Files",id:"1-configuration-files",level:3},{value:"1.1 Overview",id:"11-overview",level:4},{value:"1.2 Permission Definitions (Policies)",id:"12-permission-definitions-policies",level:4},{value:"1.3 Roles and User Associations",id:"13-roles-and-user-associations",level:4},{value:"1.4 Menu Item Hierarchy",id:"14-menu-item-hierarchy",level:4},{value:"1.5 Menu Permission Inheritance and Default Rules",id:"15-menu-permission-inheritance-and-default-rules",level:4},{value:"1.6 Special Permission Inheritance Rules",id:"16-special-permission-inheritance-rules",level:4},{value:"1.7 Example Description",id:"17-example-description",level:4},{value:"2. Menu Permission Control",id:"2-menu-permission-control",level:3}];function a(e){const n={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"We begin by introducing a Spring Boot example featuring a menu system. This example leverages jCasbin to manage menu permissions. Ultimately, it aims to abstract a middleware, specifically for menu permissions, which could be extended to other languages supported by Casbin, such as Go and Python."}),"\n",(0,t.jsx)(n.h3,{id:"1-configuration-files",children:"1. Configuration Files"}),"\n",(0,t.jsxs)(n.p,{children:["You need to set up role and permission management in the ",(0,t.jsx)(n.code,{children:"policy.csv"})," file, along with the parent-child relationships between menu items. For more details, please refer to ",(0,t.jsx)(n.a,{href:"https://github.com/jcasbin/jcasbin-menu-permission",children:"this GitHub repo"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"11-overview",children:"1.1 Overview"}),"\n",(0,t.jsxs)(n.p,{children:["Using ",(0,t.jsx)(n.code,{children:"policy.csv"}),", you can flexibly configure role permissions and menu structures for fine-grained access control. This configuration file defines access permissions for different roles on various menu items, associations between users and roles, and the hierarchical relationships between menu items."]}),"\n",(0,t.jsx)(n.h4,{id:"12-permission-definitions-policies",children:"1.2 Permission Definitions (Policies)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Policy Rules"}),": Policies are defined with a ",(0,t.jsx)(n.code,{children:"p"})," prefix, specifying roles (",(0,t.jsx)(n.code,{children:"sub"}),") and their permissions (",(0,t.jsx)(n.code,{children:"act"}),") on menu items (",(0,t.jsx)(n.code,{children:"obj"}),"), along with the rule's effect (",(0,t.jsx)(n.code,{children:"eft"}),"), where ",(0,t.jsx)(n.code,{children:"allow"})," indicates permission is granted, and ",(0,t.jsx)(n.code,{children:"deny"})," indicates it is denied."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Examples:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"p, ROLE_ROOT, SystemMenu, read, allow"})," means the ",(0,t.jsx)(n.code,{children:"ROLE_ROOT"})," role has read access to the ",(0,t.jsx)(n.code,{children:"SystemMenu"})," menu item."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"p, ROLE_ROOT, UserMenu, read, deny"})," means the ",(0,t.jsx)(n.code,{children:"ROLE_ROOT"})," role is denied read access to the ",(0,t.jsx)(n.code,{children:"UserMenu"})," menu item."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"13-roles-and-user-associations",children:"1.3 Roles and User Associations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Role Inheritance"}),": User-role relationships and role hierarchies are defined with a ",(0,t.jsx)(n.code,{children:"g"})," prefix. This allows users to inherit permissions from one or multiple roles."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Examples:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"g, user, ROLE_USER"})," means the user ",(0,t.jsx)(n.code,{children:"user"})," is assigned the ",(0,t.jsx)(n.code,{children:"ROLE_USER"})," role."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"g, ROLE_ADMIN, ROLE_USER"})," means ",(0,t.jsx)(n.code,{children:"ROLE_ADMIN"})," inherits permissions from ",(0,t.jsx)(n.code,{children:"ROLE_USER"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"14-menu-item-hierarchy",children:"1.4 Menu Item Hierarchy"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Menu Relationships"}),": Parent-child relationships between menu items are defined with a ",(0,t.jsx)(n.code,{children:"g2"})," prefix, aiding in the construction of a menu's structure."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Examples:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"g2, UserSubMenu_allow, UserMenu"})," indicates ",(0,t.jsx)(n.code,{children:"UserSubMenu_allow"})," is a submenu of ",(0,t.jsx)(n.code,{children:"UserMenu"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"g2, (NULL), SystemMenu"})," indicates ",(0,t.jsx)(n.code,{children:"SystemMenu"})," has no submenu item, meaning it is a top-level menu item."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"15-menu-permission-inheritance-and-default-rules",children:"1.5 Menu Permission Inheritance and Default Rules"}),"\n",(0,t.jsx)(n.p,{children:"When managing menu permissions with jCasbin, the permission relationship between parent and child menus follows specific inheritance rules, with two important default rules:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Inheritance of Parent Menu Permissions"}),":"]}),"\n",(0,t.jsxs)(n.p,{children:["If a parent menu is explicitly granted ",(0,t.jsx)(n.code,{children:"allow"})," permission, all its submenus also default to ",(0,t.jsx)(n.code,{children:"allow"})," permission unless specifically marked as ",(0,t.jsx)(n.code,{children:"deny"}),". This means once a parent menu is accessible, its submenus are also accessible by default."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Handling Parent Menus Without Direct Permission Settings"}),":"]}),"\n",(0,t.jsxs)(n.p,{children:["If a parent menu has no direct permission settings (neither explicitly allowed nor denied) but has at least one submenu explicitly granted ",(0,t.jsx)(n.code,{children:"allow"})," permission, then the parent menu is implicitly considered to have ",(0,t.jsx)(n.code,{children:"allow"})," permission. This ensures users can navigate to these submenus."]}),"\n",(0,t.jsx)(n.h4,{id:"16-special-permission-inheritance-rules",children:"1.6 Special Permission Inheritance Rules"}),"\n",(0,t.jsxs)(n.p,{children:["Regarding the inheritance of permissions between roles, especially in scenarios involving ",(0,t.jsx)(n.code,{children:"deny"})," permissions, the following rules must be followed to ensure system security and precise control of permissions:"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Distinction Between Explicit and Default Denials"}),":"]}),"\n",(0,t.jsxs)(n.p,{children:["If a role, such as ",(0,t.jsx)(n.code,{children:"ROLE_ADMIN"}),", is explicitly denied access to a menu item, such as ",(0,t.jsx)(n.code,{children:"AdminSubMenu_deny"})," (marked as ",(0,t.jsx)(n.code,{children:"deny"}),"), then even if this role is inherited by another role (e.g., ",(0,t.jsx)(n.code,{children:"ROLE_ROOT"}),"), the inheriting role is not permitted access to the denied menu item. This ensures explicit security policies are not bypassed due to role inheritance."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Inheritance of Default Denial Permissions"}),":"]}),"\n",(0,t.jsxs)(n.p,{children:["Conversely, if a role's denial of access to a menu item (e.g., ",(0,t.jsx)(n.code,{children:"UserSubMenu_deny"}),") is default (not explicitly marked as ",(0,t.jsx)(n.code,{children:"deny"}),", but because it was not explicitly granted ",(0,t.jsx)(n.code,{children:"allow"}),"), then when this role is inherited by another role (e.g., ",(0,t.jsx)(n.code,{children:"ROLE_ADMIN"}),"), the inheriting role may override the default ",(0,t.jsx)(n.code,{children:"deny"})," status, allowing access to these menu items."]}),"\n",(0,t.jsx)(n.h4,{id:"17-example-description",children:"1.7 Example Description"}),"\n",(0,t.jsx)(n.p,{children:"policy:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csv",children:"p, ROLE_ROOT, SystemMenu, read, allow\np, ROLE_ROOT, AdminMenu, read, allow\np, ROLE_ROOT, UserMenu, read, deny\np, ROLE_ADMIN, UserMenu, read, allow\np, ROLE_ADMIN, AdminMenu, read, allow\np, ROLE_ADMIN, AdminSubMenu_deny, read, deny\np, ROLE_USER, UserSubMenu_allow, read, allow\n\ng, user, ROLE_USER\ng, admin, ROLE_ADMIN\ng, root, ROLE_ROOT\ng, ROLE_ADMIN, ROLE_USER\n\ng2, UserSubMenu_allow, UserMenu\ng2, UserSubMenu_deny, UserMenu\ng2, UserSubSubMenu, UserSubMenu_allow\ng2, AdminSubMenu_allow, AdminMenu\ng2, AdminSubMenu_deny, AdminMenu\ng2, (NULL), SystemMenu\n"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{style:{textAlign:"left"},children:"MenuName"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"ROLE_ROOT"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"ROLE_ADMIN"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"ROLE_USER"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"SystemMenu"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"UserMenu"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"UserSubMenu_allow"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"UserSubSubMenu"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"UserSubMenu_deny"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"AdminMenu"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"AdminSubMenu_allow"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:"AdminSubMenu_deny"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"2-menu-permission-control",children:"2. Menu Permission Control"}),"\n",(0,t.jsxs)(n.p,{children:["The list of all menu items accessible by a given username can be identified through the ",(0,t.jsx)(n.code,{children:"findAccessibleMenus()"})," function available in the ",(0,t.jsx)(n.a,{href:"https://github.com/jcasbin/jcasbin-menu-permission/blob/master/src/main/java/org/casbin/service/MenuService.java",children:"MenuService"}),". To check whether a specific user has the rights to access a designated menu item, the ",(0,t.jsx)(n.code,{children:"checkMenuAccess()"})," method can be utilized. This approach ensures that menu permissions are effectively controlled, leveraging jCasbin's capabilities to manage access rights efficiently."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>c});var i=s(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);