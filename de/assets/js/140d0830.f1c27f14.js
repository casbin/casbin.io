"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[3983],{3905:(e,n,i)=>{i.d(n,{Zo:()=>u,kt:()=>m});var t=i(7294);function r(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function a(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function l(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?a(Object(i),!0).forEach((function(n){r(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function o(e,n){if(null==e)return{};var i,t,r=function(e,n){if(null==e)return{};var i,t,r={},a=Object.keys(e);for(t=0;t<a.length;t++)i=a[t],n.indexOf(i)>=0||(r[i]=e[i]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)i=a[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var s=t.createContext({}),d=function(e){var n=t.useContext(s),i=n;return e&&(i="function"==typeof e?e(n):l(l({},n),e)),i},u=function(e){var n=d(e.components);return t.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var i=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=d(i),m=r,b=p["".concat(s,".").concat(m)]||p[m]||c[m]||a;return i?t.createElement(b,l(l({ref:n},u),{},{components:i})):t.createElement(b,l({ref:n},u))}));function m(e,n){var i=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=i.length,l=new Array(a);l[0]=p;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var d=2;d<a;d++)l[d]=i[d];return t.createElement.apply(null,l)}return t.createElement.apply(null,i)}p.displayName="MDXCreateElement"},3348:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var t=i(7462),r=(i(7294),i(3905));const a={id:"rbac",title:"RBAC",description:"Casbin RBAC-Nutzung",keywords:["RBAC","role definition","role hierarchy"],authors:["hsluoyz"]},l=void 0,o={unversionedId:"rbac",id:"rbac",title:"RBAC",description:"Casbin RBAC-Nutzung",source:"@site/i18n/de/docusaurus-plugin-content-docs/current/RBAC.mdx",sourceDirName:".",slug:"/rbac",permalink:"/de/docs/rbac",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBAC.mdx",tags:[],version:"current",frontMatter:{id:"rbac",title:"RBAC",description:"Casbin RBAC-Nutzung",keywords:["RBAC","role definition","role hierarchy"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Functions",permalink:"/de/docs/function"},next:{title:"RBAC with Pattern",permalink:"/de/docs/rbac-with-pattern"}},s={},d=[{value:"Rollen-Definition",id:"rollen-definition",level:2},{value:"Rollenhierarchie",id:"rollenhierarchie",level:2},{value:"Wie unterscheidet man Rolle von Benutzer?",id:"wie-unterscheidet-man-rolle-von-benutzer",level:2},{value:"Wie fragt man implizite Rollen oder Berechtigungen ab?",id:"wie-fragt-man-implizite-rollen-oder-berechtigungen-ab",level:2},{value:"Verwendung von Musterabgleich in RBAC",id:"verwendung-von-musterabgleich-in-rbac",level:2},{value:"Rollenmanager",id:"rollenmanager",level:2}],u={toc:d};function c(e){let{components:n,...i}=e;return(0,r.kt)("wrapper",(0,t.Z)({},u,i,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"rollen-definition"},"Rollen-Definition"),(0,r.kt)("p",null,"Die ",(0,r.kt)("inlineCode",{parentName:"p"},"[role_definition]")," wird verwendet, um die RBAC-Rollen-Erbschaftsbeziehungen zu definieren. Casbin unterst\xfctzt mehrere Instanzen von RBAC-Systemen, in denen Benutzer Rollen und deren Erbschaftsbeziehungen haben k\xf6nnen, und Ressourcen k\xf6nnen ebenfalls Rollen und deren Erbschaftsbeziehungen haben. Diese beiden RBAC-Systeme st\xf6ren sich nicht gegenseitig."),(0,r.kt)("p",null,"Dieser Abschnitt ist optional. Wenn Sie in dem Modell keine RBAC-Rollen verwenden, dann lassen Sie diesen Abschnitt aus."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"[role_definition]\ng = _, _\ng2 = _, _\n")),(0,r.kt)("p",null,"Die obige Rollendefinition zeigt, dass ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," ein RBAC-System ist und ",(0,r.kt)("inlineCode",{parentName:"p"},"g2")," ein anderes RBAC-System ist. ",(0,r.kt)("inlineCode",{parentName:"p"},"_,_")," bedeutet, dass zwei Parteien an einer Erbschaftsbeziehung beteiligt sind. Im h\xe4ufigsten Fall verwenden Sie normalerweise ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," allein, wenn Sie nur Rollen f\xfcr Benutzer ben\xf6tigen. Sie k\xf6nnen auch sowohl ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," als auch ",(0,r.kt)("inlineCode",{parentName:"p"},"g2")," verwenden, wenn Sie Rollen (oder Gruppen) f\xfcr Benutzer und Ressourcen ben\xf6tigen. Bitte sehen Sie sich die ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_model.conf"},"rbac","_","model.conf")," und ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_with_resource_roles_model.conf"},"rbac","_","model","_","with","_","resource","_","roles.conf")," f\xfcr Beispiele an."),(0,r.kt)("p",null,"Casbin speichert die tats\xe4chliche Benutzer-Rollen-Zuordnung (oder Ressourcen-Rollen-Zuordnung, wenn Sie Rollen auf Ressourcen verwenden) in der Richtlinie. Zum Beispiel:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csv"},"p, data2_admin, data2, read\ng, alice, data2_admin\n")),(0,r.kt)("p",null,"Das bedeutet, dass ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," die Rolle ",(0,r.kt)("inlineCode",{parentName:"p"},"data2_admin")," erbt/ist ein Mitglied der Rolle ",(0,r.kt)("inlineCode",{parentName:"p"},"data2_admin"),". Hier kann ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," ein Benutzer, eine Ressource oder eine Rolle sein. Casbin erkennt es nur als Zeichenkette."),(0,r.kt)("p",null,"Dann sollten Sie in einem Matcher die Rolle wie unten gezeigt \xfcberpr\xfcfen:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act\n")),(0,r.kt)("p",null,"Das bedeutet, dass das ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," in der Anfrage die Rolle ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," in der Richtlinie haben sollte."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"Casbin speichert nur die Benutzer-Rollen-Zuordnung."),(0,r.kt)("li",{parentName:"ol"},"Casbin \xfcberpr\xfcft nicht, ob ein Benutzer ein g\xfcltiger Benutzer oder eine Rolle eine g\xfcltige Rolle ist. Das sollte durch die Authentifizierung geregelt werden."),(0,r.kt)("li",{parentName:"ol"},"Verwenden Sie nicht den gleichen Namen f\xfcr einen Benutzer und eine Rolle innerhalb eines RBAC-Systems, denn Casbin erkennt Benutzer und Rollen als Zeichenketten, und es gibt keine M\xf6glichkeit f\xfcr Casbin zu wissen, ob Sie den Benutzer ",(0,r.kt)("inlineCode",{parentName:"li"},"alice")," oder die Rolle ",(0,r.kt)("inlineCode",{parentName:"li"},"alice")," angeben. Sie k\xf6nnen dies einfach l\xf6sen, indem Sie ",(0,r.kt)("inlineCode",{parentName:"li"},"role_alice")," verwenden."),(0,r.kt)("li",{parentName:"ol"},"Wenn ",(0,r.kt)("inlineCode",{parentName:"li"},"A")," die Rolle ",(0,r.kt)("inlineCode",{parentName:"li"},"B")," hat und ",(0,r.kt)("inlineCode",{parentName:"li"},"B")," die Rolle ",(0,r.kt)("inlineCode",{parentName:"li"},"C")," hat, dann hat ",(0,r.kt)("inlineCode",{parentName:"li"},"A")," die Rolle ",(0,r.kt)("inlineCode",{parentName:"li"},"C"),". Diese Transitivit\xe4t ist momentan unendlich."))),(0,r.kt)("admonition",{title:"Token-Namen-Konvention",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Konventionell ist der Subjekt-Token-Name in der Richtliniendefinition ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," und wird am Anfang platziert. Jetzt unterst\xfctzt Golang Casbin angepasste Token-Namen und -Pl\xe4tze. Wenn der Subjekt-Token-Name ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," ist, kann der Subjekt-Token an einer beliebigen Stelle platziert werden, ohne dass eine zus\xe4tzliche Aktion erforderlich ist. Wenn der Name des Subjekt-Tokens nicht ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," ist, sollte ",(0,r.kt)("inlineCode",{parentName:"p"},"e.SetFieldIndex()")," f\xfcr ",(0,r.kt)("inlineCode",{parentName:"p"},"constant.SubjectIndex")," aufgerufen werden, nachdem der Durchsetzer initialisiert wurde, unabh\xe4ngig von seiner Position."),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"# `subject` here is for sub\n[policy_definition]\np =  obj, act, subject\n")),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-go"},'e.SetFieldIndex("p", constant.SubjectIndex, 2) // index starts from 0\nok, err := e.DeleteUser("alice") // without SetFieldIndex, it will raise an error\n'))),(0,r.kt)("h2",{id:"rollenhierarchie"},"Rollenhierarchie"),(0,r.kt)("p",null,"Casbins RBAC unterst\xfctzt die Rollenhierarchie-Funktion von RBAC1, was bedeutet, dass wenn ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," ",(0,r.kt)("inlineCode",{parentName:"p"},"role1")," hat, und ",(0,r.kt)("inlineCode",{parentName:"p"},"role1")," ",(0,r.kt)("inlineCode",{parentName:"p"},"role2")," hat, dann wird ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," auch ",(0,r.kt)("inlineCode",{parentName:"p"},"role2")," haben und deren Berechtigungen erben."),(0,r.kt)("p",null,"Hier haben wir ein Konzept, das als Hierarchieebene bezeichnet wird. In diesem Beispiel betr\xe4gt die Hierarchieebene also 2. F\xfcr den eingebauten Rollenmanager in Casbin k\xf6nnen Sie die maximale Hierarchieebene festlegen. Der Standardwert ist 10. Das bedeutet, dass ein Endbenutzer wie ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," nur 10 Rollenebenen erben kann."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},"// NewRoleManager is the constructor for creating an instance of the\n// default RoleManager implementation.\nfunc NewRoleManager(maxHierarchyLevel int) rbac.RoleManager {\n    rm := RoleManager{}\n    rm.allRoles = &sync.Map{}\n    rm.maxHierarchyLevel = maxHierarchyLevel\n    rm.hasPattern = false\n\n    return &rm\n}\n")),(0,r.kt)("h2",{id:"wie-unterscheidet-man-rolle-von-benutzer"},"Wie unterscheidet man Rolle von Benutzer?"),(0,r.kt)("p",null,"Casbin unterscheidet in seinem RBAC nicht zwischen Rollen und Benutzern. Beide werden als Zeichenketten behandelt. Wenn Sie nur ein einstufiges RBAC verwenden (wo eine Rolle niemals Mitglied einer anderen Rolle sein wird), k\xf6nnen Sie ",(0,r.kt)("inlineCode",{parentName:"p"},"e.GetAllSubjects()")," verwenden, um alle Benutzer zu erhalten und ",(0,r.kt)("inlineCode",{parentName:"p"},"e.GetAllRoles()")," um alle Rollen zu erhalten. Sie werden alle ",(0,r.kt)("inlineCode",{parentName:"p"},"u")," und alle ",(0,r.kt)("inlineCode",{parentName:"p"},"r")," auflisten, jeweils in allen ",(0,r.kt)("inlineCode",{parentName:"p"},"g, u, r")," Regeln."),(0,r.kt)("p",null,"Aber wenn Sie ein mehrstufiges RBAC (mit Rollenhierarchie) verwenden und Ihre Anwendung nicht aufzeichnet, ob ein Name (Zeichenkette) ein Benutzer oder eine Rolle ist, oder Sie einen Benutzer und eine Rolle mit dem gleichen Namen haben, k\xf6nnen Sie der Rolle ein Pr\xe4fix wie ",(0,r.kt)("inlineCode",{parentName:"p"},"role::admin")," hinzuf\xfcgen, bevor Sie es an Casbin weitergeben. Auf diese Weise werden Sie wissen, ob es sich um eine Rolle handelt, indem Sie dieses Pr\xe4fix \xfcberpr\xfcfen."),(0,r.kt)("h2",{id:"wie-fragt-man-implizite-rollen-oder-berechtigungen-ab"},"Wie fragt man implizite Rollen oder Berechtigungen ab?"),(0,r.kt)("p",null,'Wenn ein Benutzer eine Rolle oder Berechtigung \xfcber die RBAC-Hierarchie erbt, anstatt sie direkt in einer Richtlinienregel zugeordnet zu bekommen, nennen wir diese Art der Zuweisung "implizit". Um solche impliziten Beziehungen abzufragen, m\xfcssen Sie diese beiden APIs verwenden: ',(0,r.kt)("inlineCode",{parentName:"p"},"GetImplicitRolesForUser()")," und ",(0,r.kt)("inlineCode",{parentName:"p"},"GetImplicitPermissionsForUser()")," anstelle von ",(0,r.kt)("inlineCode",{parentName:"p"},"GetRolesForUser()")," und ",(0,r.kt)("inlineCode",{parentName:"p"},"GetPermissionsForUser()"),". F\xfcr weitere Details siehe bitte ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/issues/137"},"dieses GitHub-Issue"),"."),(0,r.kt)("h2",{id:"verwendung-von-musterabgleich-in-rbac"},"Verwendung von Musterabgleich in RBAC"),(0,r.kt)("p",null,"Siehe ",(0,r.kt)("a",{parentName:"p",href:"/docs/rbac-with-pattern"},"RBAC mit Muster")),(0,r.kt)("h2",{id:"rollenmanager"},"Rollenmanager"),(0,r.kt)("p",null,"Siehe den Abschnitt ",(0,r.kt)("a",{parentName:"p",href:"/docs/role-managers"},"Rollenmanager")," f\xfcr Details."))}c.isMDXComponent=!0}}]);