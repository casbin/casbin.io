"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[3983],{3905:function(e,n,i){i.d(n,{Zo:function(){return u},kt:function(){return m}});var t=i(7294);function r(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function a(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function l(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?a(Object(i),!0).forEach((function(n){r(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function o(e,n){if(null==e)return{};var i,t,r=function(e,n){if(null==e)return{};var i,t,r={},a=Object.keys(e);for(t=0;t<a.length;t++)i=a[t],n.indexOf(i)>=0||(r[i]=e[i]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)i=a[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var s=t.createContext({}),d=function(e){var n=t.useContext(s),i=n;return e&&(i="function"==typeof e?e(n):l(l({},n),e)),i},u=function(e){var n=d(e.components);return t.createElement(s.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var i=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=d(i),m=r,b=p["".concat(s,".").concat(m)]||p[m]||c[m]||a;return i?t.createElement(b,l(l({ref:n},u),{},{components:i})):t.createElement(b,l({ref:n},u))}));function m(e,n){var i=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=i.length,l=new Array(a);l[0]=p;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var d=2;d<a;d++)l[d]=i[d];return t.createElement.apply(null,l)}return t.createElement.apply(null,i)}p.displayName="MDXCreateElement"},3348:function(e,n,i){i.r(n),i.d(n,{assets:function(){return u},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return o},metadata:function(){return d},toc:function(){return c}});var t=i(3117),r=i(102),a=(i(7294),i(3905)),l=["components"],o={id:"rbac",title:"RBAC",description:"Casbin RBAC usage",keywords:["RBAC","role definition","role hierarchy"]},s=void 0,d={unversionedId:"rbac",id:"rbac",title:"RBAC",description:"Casbin RBAC usage",source:"@site/i18n/de/docusaurus-plugin-content-docs/current/RBAC.mdx",sourceDirName:".",slug:"/rbac",permalink:"/de/docs/rbac",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBAC.mdx",tags:[],version:"current",frontMatter:{id:"rbac",title:"RBAC",description:"Casbin RBAC usage",keywords:["RBAC","role definition","role hierarchy"]},sidebar:"docs",previous:{title:"Funktion",permalink:"/de/docs/function"},next:{title:"RBAC mit Muster",permalink:"/de/docs/rbac-with-pattern"}},u={},c=[{value:"Rollendefinition",id:"rollendefinition",level:2},{value:"Rollen-Hierarchie",id:"rollen-hierarchie",level:2},{value:"Wie unterscheidet man die Rolle vom Benutzer?",id:"wie-unterscheidet-man-die-rolle-vom-benutzer",level:2},{value:"Wie kann ich implizite Rollen oder Berechtigungen abfragen?",id:"wie-kann-ich-implizite-rollen-oder-berechtigungen-abfragen",level:2},{value:"Verwende Musterpassung in RBAC",id:"verwende-musterpassung-in-rbac",level:2},{value:"Rollen-Manager",id:"rollen-manager",level:2}],p={toc:c};function m(e){var n=e.components,i=(0,r.Z)(e,l);return(0,a.kt)("wrapper",(0,t.Z)({},p,i,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"rollendefinition"},"Rollendefinition"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"[role_definition]")," ist die Definition f\xfcr die RBAC-Rollenvererbungsbeziehungen. Casbin unterst\xfctzt mehrere RBAC-Systeme, z. Benutzer k\xf6nnen Rollen und ihre Erbschaftsbeziehungen haben, und Ressourcen k\xf6nnen auch Rollen und ihre Erbschaft haben. Diese beiden RBAC-Systeme werden nicht beeintr\xe4chtigt."),(0,a.kt)("p",null,"Dieser Abschnitt ist optional. Wenn Sie keine RBAC-Rollen im Modell verwenden, lassen Sie diesen Abschnitt weg."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"[role_definition]\ng = _, _\ng2 = _, _\n")),(0,a.kt)("p",null,"Die obige Rollendefinition zeigt an, dass ",(0,a.kt)("inlineCode",{parentName:"p"},"g")," ein RBAC-System ist und ",(0,a.kt)("inlineCode",{parentName:"p"},"g2")," ein anderes RBAC-System. ",(0,a.kt)("inlineCode",{parentName:"p"},"_, _")," bedeutet, dass es zwei Parteien innerhalb einer Erbschaftsbeziehung gibt. Normalerweise verwenden Sie ",(0,a.kt)("inlineCode",{parentName:"p"},"g")," allein, wenn Sie nur Rollen von Benutzern ben\xf6tigen.  Sie k\xf6nnen auch ",(0,a.kt)("inlineCode",{parentName:"p"},"g")," und ",(0,a.kt)("inlineCode",{parentName:"p"},"g2")," verwenden, wenn Sie Rollen (oder Gruppen) f\xfcr Benutzer und Ressourcen ben\xf6tigen. Beispiele finden Sie in der ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_model.conf"},"rbac_model.conf")," und ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_with_resource_roles_model.conf"},"rbac_model_with_resource_roles.conf"),"."),(0,a.kt)("p",null,"Casbin speichert die aktuelle Benutzerrollen-Zuordnung (oder Ressourcen-Rollen-Zuordnung, wenn Sie Rollen auf Ressourcen verwenden) in der Richtlinie, zum Beispiel:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"p, data2_admin, data2, read\ng, alice, data2_admin\n")),(0,a.kt)("p",null,"Es bedeutet ",(0,a.kt)("inlineCode",{parentName:"p"},"Alice")," inherits/ist Mitglied der Rolle ",(0,a.kt)("inlineCode",{parentName:"p"},"data2_admin"),". ",(0,a.kt)("inlineCode",{parentName:"p"},"Alice")," hier kann ein Benutzer, eine Ressource oder eine Rolle sein. Casbin erkennt es nur als String."),(0,a.kt)("p",null,"Dann solltest du in einem Matcher die Rolle wie unten \xfcberpr\xfcfen:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act\n")),(0,a.kt)("p",null,"Es bedeutet, dass ",(0,a.kt)("inlineCode",{parentName:"p"},"sub")," in der Anfrage die Rolle ",(0,a.kt)("inlineCode",{parentName:"p"},"Unter")," in der Richtlinie haben sollte."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("ol",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ol"},"Casbin speichert nur die Benutzerrollenzuordnung."),(0,a.kt)("li",{parentName:"ol"},"Casbin pr\xfcft nicht, ob ein Benutzer ein g\xfcltiger Benutzer ist oder Rolle eine g\xfcltige Rolle ist. Das sollte durch die Authentifizierung geregelt werden."),(0,a.kt)("li",{parentName:"ol"},"Verwenden Sie nicht den gleichen Namen f\xfcr einen Benutzer und eine Rolle innerhalb eines RBAC-Systems, da Casbin Benutzer und Rollen als Zeichenketten anerkennt und es gibt keine M\xf6glichkeit f\xfcr Kasbin zu wissen, ob Sie Benutzer ",(0,a.kt)("inlineCode",{parentName:"li"},"Alice")," oder Rolle ",(0,a.kt)("inlineCode",{parentName:"li"},"Alice")," angeben. Sie k\xf6nnen es einfach mit ",(0,a.kt)("inlineCode",{parentName:"li"},"role_alice")," l\xf6sen."),(0,a.kt)("li",{parentName:"ol"},"Wenn ",(0,a.kt)("inlineCode",{parentName:"li"},"A")," Rolle hat ",(0,a.kt)("inlineCode",{parentName:"li"},"B"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"B")," hat Rolle ",(0,a.kt)("inlineCode",{parentName:"li"},"C"),", dann ",(0,a.kt)("inlineCode",{parentName:"li"},"A")," hat eine Rolle ",(0,a.kt)("inlineCode",{parentName:"li"},"C"),". Diese Transitivit\xe4t ist vorerst unendlich."))),(0,a.kt)("admonition",{title:"Token name convention",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Conventionally subject token name in policy definition is ",(0,a.kt)("inlineCode",{parentName:"p"},"sub")," and placed in the beginning. Now Golang Casbin supports customized token name & place. If the subject token name is ",(0,a.kt)("inlineCode",{parentName:"p"},"sub"),", the subject token can be placed at an arbitrary place and no extra action needs.  If the subject token name is not ",(0,a.kt)("inlineCode",{parentName:"p"},"sub")," , ",(0,a.kt)("inlineCode",{parentName:"p"},"e.SetFieldIndex()")," for ",(0,a.kt)("inlineCode",{parentName:"p"},"constant.SubjectIndex")," should be called after the enforcer is initialized regardless of its position."),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"# `subject` here for sub\n[policy_definition]\np =  obj, act, subject\n")),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-go"},'e.SetFieldIndex("p", constant.SubjectIndex, 2) // index start from 0\nok, err := e.DeleteUser("alice") // without SetFieldIndex, it will raise an error\n'))),(0,a.kt)("h2",{id:"rollen-hierarchie"},"Rollen-Hierarchie"),(0,a.kt)("p",null,"Casbin's RBAC unterst\xfctzt RBAC1's Rollen-Hierarchie-Funktion, was bedeutet, wenn ",(0,a.kt)("inlineCode",{parentName:"p"},"Alice")," ",(0,a.kt)("inlineCode",{parentName:"p"},"Rolle hat"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"Rolle1")," hat ",(0,a.kt)("inlineCode",{parentName:"p"},"Rollen2"),", dann wird ",(0,a.kt)("inlineCode",{parentName:"p"},"alice")," auch ",(0,a.kt)("inlineCode",{parentName:"p"},"role2")," haben und seine Berechtigungen erben."),(0,a.kt)("p",null,"Hier ist ein Konzept namens Hierarchieebene. Die Hierarchieebene f\xfcr dieses Beispiel ist also 2. F\xfcr den eingebauten Rollenmanager in Kasbin k\xf6nnen Sie die maximale Hierarchieebene angeben. Der Standardwert ist 10. Es bedeutet, dass ein Endbenutzer wie ",(0,a.kt)("inlineCode",{parentName:"p"},"Alice")," nur 10 Rollenlevel erben kann."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"// NewRoleManager ist der Konstruktor f\xfcr das Erstellen einer Instanz der\n// Standard RoleManager Implementierung.\nfunc NewRoleManager(maxHierarchyLevel int) rbac.RoleManager {\n    rm := RoleManager{}\n    rm.allRoles = &sync. ap{}\n    rm.maxHierarchyLevel = maxHierarchyLevel\n    rm. asPattern = false\n\n    R\xfcckgabe &rm\n}\n")),(0,a.kt)("h2",{id:"wie-unterscheidet-man-die-rolle-vom-benutzer"},"Wie unterscheidet man die Rolle vom Benutzer?"),(0,a.kt)("p",null,"Casbin unterscheidet in seinem RBAC nicht zwischen der Rolle und dem Benutzer. Sie werden alle als Strings behandelt. Wenn Sie nur eine Ebene RBAC verwenden (eine Rolle wird niemals Mitglied einer anderen Rolle sein). Sie k\xf6nnen ",(0,a.kt)("inlineCode",{parentName:"p"},"e.GetAllSubjects()")," verwenden, um alle Benutzer und ",(0,a.kt)("inlineCode",{parentName:"p"},"e.GetAllRoles()")," um alle Rollen zu erhalten. Sie listen nur alle ",(0,a.kt)("inlineCode",{parentName:"p"},"u")," und alle ",(0,a.kt)("inlineCode",{parentName:"p"},"r")," bzw. in allen ",(0,a.kt)("inlineCode",{parentName:"p"},"g, u, r")," Regeln auf."),(0,a.kt)("p",null,"Aber wenn Sie Mehrstufen-RBAC (mit Rollen-Hierarchie), und Ihre Anwendung speichert nicht, ob ein Name (string) ein Benutzer oder eine Rolle ist, oder Sie haben Benutzer und Rolle mit demselben Namen. Sie k\xf6nnen ein Pr\xe4fix zur Rolle wie ",(0,a.kt)("inlineCode",{parentName:"p"},"role::admin")," hinzuf\xfcgen, bevor Sie es an Kasbin \xfcbergeben. So werden Sie wissen, ob es eine Rolle ist, indem Sie dieses Pr\xe4fix \xfcberpr\xfcfen."),(0,a.kt)("h2",{id:"wie-kann-ich-implizite-rollen-oder-berechtigungen-abfragen"},"Wie kann ich implizite Rollen oder Berechtigungen abfragen?"),(0,a.kt)("p",null,"Wenn ein Benutzer eine Rolle oder Berechtigung \xfcber RBAC Hierarchie erbt anstatt sie direkt in einer Richtlinien-Regel zuzuweisen, wir nennen solche Art der Zuweisung als ",(0,a.kt)("inlineCode",{parentName:"p"},"implizit"),". Solche impliziten Beziehungen abfragen Sie m\xfcssen diese 2 APIs verwenden: ",(0,a.kt)("inlineCode",{parentName:"p"},"GetImplicitRolesForUser()")," und ",(0,a.kt)("inlineCode",{parentName:"p"},"GetImplicitPermissionsForUser()")," statt ",(0,a.kt)("inlineCode",{parentName:"p"},"GetRolesForUser()")," und ",(0,a.kt)("inlineCode",{parentName:"p"},"GetPermissionsForUser()"),". F\xfcr weitere Details siehe ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/issues/137"},"dieses GitHub Ticket"),"."),(0,a.kt)("h2",{id:"verwende-musterpassung-in-rbac"},"Verwende Musterpassung in RBAC"),(0,a.kt)("p",null,"Siehe ",(0,a.kt)("a",{parentName:"p",href:"/docs/rbac-with-pattern"},"RBAC mit Muster")),(0,a.kt)("h2",{id:"rollen-manager"},"Rollen-Manager"),(0,a.kt)("p",null,"Siehe ",(0,a.kt)("a",{parentName:"p",href:"/docs/role-managers"},"Rollenmanager")," Abschnitt f\xfcr Details."))}m.isMDXComponent=!0}}]);