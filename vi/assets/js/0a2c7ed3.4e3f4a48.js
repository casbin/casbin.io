"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[8566],{3905:(t,e,n)=>{n.d(e,{Zo:()=>u,kt:()=>m});var a=n(7294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},c=Object.keys(t);for(a=0;a<c.length;a++)n=c[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(a=0;a<c.length;a++)n=c[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var o=a.createContext({}),s=function(t){var e=a.useContext(o),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},u=function(t){var e=s(t.components);return a.createElement(o.Provider,{value:e},t.children)},l={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},p=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,c=t.originalType,o=t.parentName,u=h(t,["components","mdxType","originalType","parentName"]),p=s(n),m=r,b=p["".concat(o,".").concat(m)]||p[m]||l[m]||c;return n?a.createElement(b,i(i({ref:e},u),{},{components:n})):a.createElement(b,i({ref:e},u))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var c=n.length,i=new Array(c);i[0]=p;var h={};for(var o in e)hasOwnProperty.call(e,o)&&(h[o]=e[o]);h.originalType=t,h.mdxType="string"==typeof t?t:r,i[1]=h;for(var s=2;s<c;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},9336:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>o,contentTitle:()=>i,default:()=>l,frontMatter:()=>c,metadata:()=>h,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const c={id:"k8s",title:"Authorization of Kubernetes",description:"Kubernetes (k8s) RBAC & ABAC \u1ee7y quy\u1ec1n middleware d\u1ef1a tr\xean Casbin",keywords:["Kubernetes authorization","Kubernetes RBAC","Kubernetes ABAC","K8s-authz"],authors:["hsluoyz"]},i=void 0,h={unversionedId:"k8s",id:"k8s",title:"Authorization of Kubernetes",description:"Kubernetes (k8s) RBAC & ABAC \u1ee7y quy\u1ec1n middleware d\u1ef1a tr\xean Casbin",source:"@site/i18n/vi/docusaurus-plugin-content-docs/current/K8sAuthz.mdx",sourceDirName:".",slug:"/k8s",permalink:"/vi/docs/k8s",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sAuthz.mdx",tags:[],version:"current",frontMatter:{id:"k8s",title:"Authorization of Kubernetes",description:"Kubernetes (k8s) RBAC & ABAC \u1ee7y quy\u1ec1n middleware d\u1ef1a tr\xean Casbin",keywords:["Kubernetes authorization","Kubernetes RBAC","Kubernetes ABAC","K8s-authz"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Performance Optimization",permalink:"/vi/docs/performance"},next:{title:"Admission Webhook for K8s",permalink:"/vi/docs/k8s-gatekeeper"}},o={},s=[{value:"Y\xeau c\u1ea7u",id:"y\xeau-c\u1ea7u",level:2},{value:"S\u1eed d\u1ee5ng",id:"s\u1eed-d\u1ee5ng",level:2}],u={toc:s};function l(t){let{components:e,...n}=t;return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz"},"K8s-authz")," l\xe0 m\u1ed9t middleware \u1ee7y quy\u1ec1n cho Kubernetes (k8s) d\u1ef1a tr\xean Casbin, s\u1eed d\u1ee5ng RBAC (Role-Based Access Control) v\xe0 ABAC (Attribute-Based Access Control) cho vi\u1ec7c th\u1ef1c thi ch\xednh s\xe1ch. Middleware n\xe0y t\xedch h\u1ee3p v\u1edbi webhook ki\u1ec3m \u0111\u1ecbnh c\u1ee7a K8s \u0111\u1ec3 ki\u1ec3m tra c\xe1c ch\xednh s\xe1ch \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a b\u1edfi Casbin cho m\u1ed7i y\xeau c\u1ea7u \u0111\u1ebfn t\xe0i nguy\xean K8s. C\xe1c b\u1ed9 \u0111i\u1ec1u khi\u1ec3n nh\u1eadp li\u1ec7u t\xf9y ch\u1ec9nh \u0111\u01b0\u1ee3c \u0111\u0103ng k\xfd v\u1edbi Kubernetes s\u1eed d\u1ee5ng ",(0,r.kt)("inlineCode",{parentName:"p"},"ValidatingAdmissionWebhook")," \u0111\u1ec3 th\u1ef1c hi\u1ec7n ki\u1ec3m \u0111\u1ecbnh tr\xean c\xe1c \u0111\u1ed1i t\u01b0\u1ee3ng y\xeau c\u1ea7u \u0111\u01b0\u1ee3c chuy\u1ec3n ti\u1ebfp b\u1edfi m\xe1y ch\u1ee7 API v\xe0 cung c\u1ea5p ph\u1ea3n h\u1ed3i cho bi\u1ebft y\xeau c\u1ea7u c\xf3 n\xean \u0111\u01b0\u1ee3c cho ph\xe9p hay t\u1eeb ch\u1ed1i."),(0,r.kt)("p",null,"\u0110\u1ec3 x\xe1c \u0111\u1ecbnh th\u1eddi \u0111i\u1ec3m g\u1eedi c\xe1c y\xeau c\u1ea7u \u0111\u1ebfn b\u1ed9 \u0111i\u1ec1u khi\u1ec3n nh\u1eadp li\u1ec7u, m\u1ed9t webhook ki\u1ec3m \u0111\u1ecbnh \u0111\xe3 \u0111\u01b0\u1ee3c tri\u1ec3n khai. Webhook n\xe0y chuy\u1ec3n ti\u1ebfp c\xe1c y\xeau c\u1ea7u cho b\u1ea5t k\u1ef3 lo\u1ea1i t\xe0i nguy\xean K8s ho\u1eb7c t\xe0i nguy\xean ph\u1ee5 n\xe0o v\xe0 th\u1ef1c hi\u1ec7n x\xe1c minh ch\xednh s\xe1ch. Ng\u01b0\u1eddi d\xf9ng ch\u1ec9 \u0111\u01b0\u1ee3c ph\xe9p th\u1ef1c hi\u1ec7n c\xe1c ho\u1ea1t \u0111\u1ed9ng tr\xean c\xe1c t\xe0i nguy\xean n\xe0y n\u1ebfu h\u1ecd \u0111\u01b0\u1ee3c \u1ee7y quy\u1ec1n b\u1edfi b\u1ed9 th\u1ef1c thi Casbin. ",(0,r.kt)("a",{parentName:"p",href:"/docs/get-started#new-a-casbin-enforcer"},"B\u1ed9 th\u1ef1c thi")," ki\u1ec3m tra c\xe1c vai tr\xf2 c\u1ee7a ng\u01b0\u1eddi d\xf9ng nh\u01b0 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a trong c\xe1c ch\xednh s\xe1ch. C\u1ee5m K8s l\xe0 m\u1ee5c ti\xeau tri\u1ec3n khai cho ph\u1ea7n m\u1ec1m trung gian n\xe0y."),(0,r.kt)("h2",{id:"y\xeau-c\u1ea7u"},"Y\xeau c\u1ea7u"),(0,r.kt)("p",null,"Tr\u01b0\u1edbc khi ti\u1ebfn h\xe0nh, h\xe3y \u0111\u1ea3m b\u1ea3o r\u1eb1ng b\u1ea1n c\xf3 nh\u1eefng th\u1ee9 sau:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"M\u1ed9t c\u1ee5m Kubernetes \u0111ang ch\u1ea1y. B\u1ea1n c\xf3 th\u1ec3 thi\u1ebft l\u1eadp m\u1ed9t c\u1ee5m c\u1ee5c b\u1ed9 s\u1eed d\u1ee5ng Docker ho\u1eb7c thi\u1ebft l\u1eadp m\u1ed9t h\u1ec7 sinh th\xe1i Kubernetes ho\xe0n ch\u1ec9nh tr\xean m\xe1y ch\u1ee7 c\u1ee7a b\u1ea1n. \u0110\u1ec3 bi\u1ebft h\u01b0\u1edbng d\u1eabn chi ti\u1ebft, tham kh\u1ea3o ",(0,r.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/tutorials/kubernetes-basics/create-cluster/cluster-intro/"},"h\u01b0\u1edbng d\u1eabn")," n\xe0y \u0111\u1ec3 thi\u1ebft l\u1eadp m\u1ed9t c\u1ee5m Kubernetes c\u1ee5c b\u1ed9 tr\xean Windows ho\u1eb7c ",(0,r.kt)("a",{parentName:"li",href:"https://www.digitalocean.com/community/tutorials/how-to-create-a-kubernetes-cluster-using-kubeadm-on-ubuntu-18-04"},"h\u01b0\u1edbng d\u1eabn")," n\xe0y \u0111\u1ec3 thi\u1ebft l\u1eadp m\u1ed9t c\u1ee5m tr\xean Linux."),(0,r.kt)("li",{parentName:"ul"},"Kubectl CLI. H\u01b0\u1edbng d\u1eabn c\xe0i \u0111\u1eb7t Kubectl tr\xean Windows c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c t\xecm th\u1ea5y ",(0,r.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/tasks/tools/install-kubectl-windows/"},"t\u1ea1i \u0111\xe2y"),", v\xe0 cho Linux ",(0,r.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/"},"t\u1ea1i \u0111\xe2y"),"."),(0,r.kt)("li",{parentName:"ul"},"OpenSSL")),(0,r.kt)("h2",{id:"s\u1eed-d\u1ee5ng"},"S\u1eed d\u1ee5ng"),(0,r.kt)("p",null,"L\xe0m theo c\xe1c b\u01b0\u1edbc sau \u0111\u1ec3 s\u1eed d\u1ee5ng K8s-authz:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"T\u1ea1o ch\u1ee9ng ch\u1ec9 v\xe0 kh\xf3a cho m\u1ed7i ng\u01b0\u1eddi d\xf9ng b\u1eb1ng OpenSSL. Ch\u1ea1y t\u1eadp l\u1ec7nh d\u01b0\u1edbi \u0111\xe2y:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"./gen_cert.sh\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"X\xe2y d\u1ef1ng h\xecnh \u1ea3nh Docker t\u1eeb ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/Dockerfile"},"Dockerfile")," th\u1ee7 c\xf4ng b\u1eb1ng c\xe1ch ch\u1ea1y l\u1ec7nh sau. H\xe3y nh\u1edb thay \u0111\u1ed5i phi\xean b\u1ea3n x\xe2y d\u1ef1ng trong l\u1ec7nh v\xe0 trong t\u1ec7p ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/718f58c46e3dbf79063b5b1c18348c2fee5de9e9/manifests/deployment.yaml#L18"},"deployment")," t\u01b0\u01a1ng \u1ee9ng."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker build -t casbin/k8s_authz:0.1 .\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u0110\u1ecbnh ngh\u0129a c\xe1c ch\xednh s\xe1ch Casbin trong t\u1ec7p ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/config/model.conf"},"model.conf")," v\xe0 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/config/policy.csv"},"policy.csv"),". \u0110\u1ec3 bi\u1ebft th\xeam th\xf4ng tin v\u1ec1 c\xe1ch c\xe1c ch\xednh s\xe1ch n\xe0y ho\u1ea1t \u0111\u1ed9ng, h\xe3y tham kh\u1ea3o ",(0,r.kt)("a",{parentName:"p",href:"/docs/how-it-works"},"t\xe0i li\u1ec7u"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Tr\u01b0\u1edbc khi tri\u1ec3n khai, b\u1ea1n c\xf3 th\u1ec3 s\u1eeda \u0111\u1ed5i c\u1ed5ng trong t\u1ec7p ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/main.go"},"main.go"),", c\u0169ng nh\u01b0 trong t\u1ec7p c\u1ea5u h\xecnh webhook x\xe1c th\u1ef1c ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/k8s-authz/blob/master/manifests/deployment.yaml"},"file"),", d\u1ef1a tr\xean y\xeau c\u1ea7u c\u1ee5 th\u1ec3 c\u1ee7a b\u1ea1n.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Tri\u1ec3n khai b\u1ed9 \u0111i\u1ec1u khi\u1ec3n x\xe1c th\u1ef1c v\xe0 webhook tr\xean c\u1ee5m Kubernetes b\u1eb1ng c\xe1ch ch\u1ea1y l\u1ec7nh sau:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl apply -f deployment.yaml\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u0110\u1ed1i v\u1edbi m\xe1y ch\u1ee7 s\u1ea3n xu\u1ea5t, khuy\u1ebfn ngh\u1ecb t\u1ea1o m\u1ed9t Kubernetes ",(0,r.kt)("inlineCode",{parentName:"p"},"secret")," \u0111\u1ec3 b\u1ea3o m\u1eadt ch\u1ee9ng ch\u1ec9:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl create secret generic casbin -n default \\\n  --from-file=key.pem=certs/casbin-key.pem \\\n  --from-file=cert.pem=certs/casbin-crt.pem\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Sau khi ho\xe0n th\xe0nh c\xe1c b\u01b0\u1edbc tr\xean, b\u1ea1n c\u1ea7n c\u1eadp nh\u1eadt th\u01b0 m\u1ee5c ch\u1ee9ng ch\u1ec9 trong ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ashish493/k8s-authz/blob/3560551427c0431a9d4594ad1206f084ede37c49/main.go#L26"},"main.go")," v\xe0 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ashish493/k8s-authz/blob/3560551427c0431a9d4594ad1206f084ede37c49/manifests/deployment.yaml#L22"},"manifests")," v\u1edbi th\u01b0 m\u1ee5c c\u1ee7a ",(0,r.kt)("inlineCode",{parentName:"p"},"secret")," \u0111\xe3 t\u1ea1o."))),(0,r.kt)("p",null,"B\xe2y gi\u1edd, m\xe1y ch\u1ee7 n\xean \u0111\xe3 ho\u1ea1t \u0111\u1ed9ng v\xe0 s\u1eb5n s\xe0ng \u0111\u1ec3 x\xe1c th\u1ef1c c\xe1c y\xeau c\u1ea7u \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \u0111\u1ebfn t\xe0i nguy\xean K8s v\xe0 th\u1ef1c thi ch\xednh s\xe1ch t\u01b0\u01a1ng \u1ee9ng."))}l.isMDXComponent=!0}}]);