<!doctype html>
<html lang="vi" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-k8s-gatekeeper" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Admission Webhook for K8s | Casbin</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://casbin.org/vi/docs/k8s-gatekeeper"><meta data-rh="true" name="docusaurus_locale" content="vi"><meta data-rh="true" name="docsearch:language" content="vi"><meta data-rh="true" name="Casbin" content="An authorization library that supports access control models like ACL, RBAC, ABAC for Golang, Java, C/C++, Node.js, Javascript, PHP, Laravel, Python, .NET (C#), Delphi, Rust, Ruby, Swift (Objective-C), Lua (OpenResty), Dart (Flutter) and Elixir"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Admission Webhook for K8s | Casbin"><meta data-rh="true" name="description" content="Kubernetes (K8s) RBAC &amp; ABAC Authorization Middleware dá»±a trÃªn Casbin"><meta data-rh="true" property="og:description" content="Kubernetes (K8s) RBAC &amp; ABAC Authorization Middleware dá»±a trÃªn Casbin"><meta data-rh="true" name="keywords" content="k8s-gatekeeper,Kubernetes,K8s"><link data-rh="true" rel="icon" href="/vi/img/favicon.png"><link data-rh="true" rel="canonical" href="https://casbin.org/vi/docs/k8s-gatekeeper"><link data-rh="true" rel="alternate" href="https://casbin.org/docs/k8s-gatekeeper" hreflang="en"><link data-rh="true" rel="alternate" href="https://casbin.org/zh/docs/k8s-gatekeeper" hreflang="zh"><link data-rh="true" rel="alternate" href="https://casbin.org/ko/docs/k8s-gatekeeper" hreflang="ko"><link data-rh="true" rel="alternate" href="https://casbin.org/ru/docs/k8s-gatekeeper" hreflang="ru"><link data-rh="true" rel="alternate" href="https://casbin.org/fr/docs/k8s-gatekeeper" hreflang="fr"><link data-rh="true" rel="alternate" href="https://casbin.org/de/docs/k8s-gatekeeper" hreflang="de"><link data-rh="true" rel="alternate" href="https://casbin.org/ja/docs/k8s-gatekeeper" hreflang="ja"><link data-rh="true" rel="alternate" href="https://casbin.org/es/docs/k8s-gatekeeper" hreflang="es"><link data-rh="true" rel="alternate" href="https://casbin.org/pt/docs/k8s-gatekeeper" hreflang="pt"><link data-rh="true" rel="alternate" href="https://casbin.org/uk/docs/k8s-gatekeeper" hreflang="uk"><link data-rh="true" rel="alternate" href="https://casbin.org/th/docs/k8s-gatekeeper" hreflang="th"><link data-rh="true" rel="alternate" href="https://casbin.org/ar/docs/k8s-gatekeeper" hreflang="ar"><link data-rh="true" rel="alternate" href="https://casbin.org/id/docs/k8s-gatekeeper" hreflang="id"><link data-rh="true" rel="alternate" href="https://casbin.org/vi/docs/k8s-gatekeeper" hreflang="vi"><link data-rh="true" rel="alternate" href="https://casbin.org/it/docs/k8s-gatekeeper" hreflang="it"><link data-rh="true" rel="alternate" href="https://casbin.org/ms/docs/k8s-gatekeeper" hreflang="ms"><link data-rh="true" rel="alternate" href="https://casbin.org/tr/docs/k8s-gatekeeper" hreflang="tr"><link data-rh="true" rel="alternate" href="https://casbin.org/docs/k8s-gatekeeper" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6NBEV8TOFK-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/vi/blog/rss.xml" title="Casbin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/vi/blog/atom.xml" title="Casbin Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8S2TKCJ27X"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8S2TKCJ27X",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Casbin" href="/vi/opensearch.xml">
<script src="/js/isMainland.js" async></script>
<script src="/js/hotjar.js" async></script>
<script src="/js/probe.js" async></script>
<script src="/js/clarity.js" async></script>
<script src="/js/casibase.js" async></script><link rel="stylesheet" href="/vi/assets/css/styles.7fd4a8f6.css">
<link rel="preload" href="/vi/assets/js/runtime~main.ebfab582.js" as="script">
<link rel="preload" href="/vi/assets/js/main.235bfe67.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Bá» qua Ä‘áº¿n ná»™i dung chÃ­nh"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Bá» qua Ä‘áº¿n ná»™i dung chÃ­nh</a></div><div class="announcementBar_mb4j" role="banner"><div class="content_knG7 announcementBarContent_xLdY"><a target="_blank" href="https://github.com/casibase/casibase/">ğŸ’– Looking for an open-source LangChain-like AI knowledge database & chat bot with admin UI and multi-model support (ChatGPT, Claude, Llama 3, DeepSeek R1, HuggingFace, etc.) ? Learn more about: Casibase</a></div></div><nav aria-label="ChÃ­nh" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Chuyá»ƒn Ä‘á»•i thanh Ä‘iá»u hÆ°á»›ng" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/vi/"><div class="navbar__logo"><img src="/vi/img/casbin.svg" alt="Logo Trang Cá»§a TÃ´i" class="themedImage_ToTc themedImage--light_HNdA"><img src="/vi/img/casbin.svg" alt="Logo Trang Cá»§a TÃ´i" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Casbin</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/vi/docs/overview">TÃ i liá»‡u</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/vi/docs/get-started">Báº¯t Ä‘áº§u</a></li><li><a class="dropdown__link" href="/vi/docs/category/model">MÃ´ hÃ¬nh</a></li><li><a class="dropdown__link" href="/vi/docs/category/storage">LÆ°u trá»¯</a></li><li><a class="dropdown__link" href="/vi/docs/adapters">Bá»™ Ä‘iá»u há»£p</a></li><li><a class="dropdown__link" href="/vi/docs/category/api">API</a></li><li><a class="dropdown__link" href="/vi/docs/ide-plugins">Plugin IDE</a></li><li><a class="dropdown__link" href="/vi/docs/contributing">Báº¯t Ä‘áº§u ÄÃ³ng gÃ³p</a></li></ul></div><a class="navbar__item navbar__link" href="/vi/ecosystem">Há»‡ sinh thÃ¡i</a><a class="navbar__item navbar__link" href="/vi/blog">Blog</a><a class="navbar__item navbar__link" href="/vi/help">Trá»£ giÃºp</a><a class="navbar__item navbar__link" href="/vi/editor">TrÃ¬nh soáº¡n tháº£o</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Tiáº¿ng Viá»‡t</a><ul class="dropdown__menu"><li><a href="/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">ä¸­æ–‡</a></li><li><a href="/ko/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">í•œêµ­ì–´</a></li><li><a href="/ru/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a></li><li><a href="/fr/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="fr">FranÃ§ais</a></li><li><a href="/de/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="de">Deutsch</a></li><li><a href="/ja/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">æ—¥æœ¬èª</a></li><li><a href="/es/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">EspaÃ±ol</a></li><li><a href="/pt/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">PortuguÃªs</a></li><li><a href="/uk/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="uk">Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°</a></li><li><a href="/th/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="th">à¹„à¸—à¸¢</a></li><li><a href="/ar/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a></li><li><a href="/id/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="id">Indonesia</a></li><li><a href="/vi/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="vi">Tiáº¿ng Viá»‡t</a></li><li><a href="/it/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="it">Italiano</a></li><li><a href="/ms/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ms">Melayu</a></li><li><a href="/tr/docs/k8s-gatekeeper" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="tr">TÃ¼rkÃ§e</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://crowdin.com/project/casbin-website" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/casbin/casbin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://discord.gg/S5UjpzGZjN" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-community-discord"></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="TÃ¬m kiáº¿m"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">TÃ¬m kiáº¿m</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Chuyá»ƒn Ä‘á»•i giá»¯a cháº¿ Ä‘á»™ tá»‘i vÃ  sÃ¡ng (hiá»‡n táº¡i lÃ  cháº¿ Ä‘á»™ sÃ¡ng)" aria-label="Chuyá»ƒn Ä‘á»•i giá»¯a cháº¿ Ä‘á»™ tá»‘i vÃ  sÃ¡ng (hiá»‡n táº¡i lÃ  cháº¿ Ä‘á»™ sÃ¡ng)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Cuá»™n láº¡i Ä‘áº§u trang" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/vi/"><img src="/vi/img/casbin.svg" alt="Logo Trang Cá»§a TÃ´i" class="themedImage_ToTc themedImage--light_HNdA"><img src="/vi/img/casbin.svg" alt="Logo Trang Cá»§a TÃ´i" class="themedImage_ToTc themedImage--dark_i4oU"><b>Casbin</b></a><nav aria-label="Thanh bÃªn tÃ i liá»‡u" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/the-basics">Nhá»¯ng Ä‘iá»u cÆ¡ báº£n</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;Nhá»¯ng Ä‘iá»u cÆ¡ báº£n&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/get-started">Get Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/how-it-works">How It Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/tutorials">Tutorials</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/understanding-casbin-detail">Understanding How Casbin Matching Works in Detail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/pdf">Táº£i xuá»‘ng PDF</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/model">MÃ´ hÃ¬nh</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;MÃ´ hÃ¬nh&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/supported-models">Supported Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/syntax-for-models">Syntax for Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/effector">Effector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/function">Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rbac">RBAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rbac-with-pattern">RBAC with Pattern</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rbac-with-domains">RBAC with Domains</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rbac-with-conditions">RBAC with Conditions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rbac-96">Casbin RBAC vs. RBAC96</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rebac">ReBAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/abac">ABAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/blp">BLP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/biba">Biba</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/lbac">LBAC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/priority-model">Priority Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/superadmin">Super Admin</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/storage">LÆ°u trá»¯</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;LÆ°u trá»¯&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/model-storage">Model Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/policy-storage">Policy Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/policy-subset-loading">Policy Subset Loading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/scenarios">Ká»‹ch báº£n</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;Ká»‹ch báº£n&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/data-permissions">Data Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/menu-permissions">Menu Permissions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/extensions">Má»Ÿ rá»™ng</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;Má»Ÿ rá»™ng&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/enforcers">Enforcers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/adapters">Adapters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/watchers">Watchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/dispatchers">Dispatchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/role-managers">Role Managers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/middlewares">Middlewares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/graphql-middlewares">GraphQL Middlewares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/cloud-native">Cloud Native Middlewares</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/api">API</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;API&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/api-overview">API Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/management-api">Management API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rbac-api">RBAC API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rbac-with-domains-api">RBAC with Domains API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rbac-with-conditions-api">RBAC with Conditions API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/rolemanager-api">RoleManager API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/vi/docs/category/advanced-usage">Sá»­ dá»¥ng nÃ¢ng cao</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;Sá»­ dá»¥ng nÃ¢ng cao&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/multi-threading">Multi-threading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/benchmark">Benchmarks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/performance">Performance Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/k8s">Authorization of Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/vi/docs/k8s-gatekeeper">Admission Webhook for K8s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/envoy">Authorization of Service Mesh through Envoy</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/management">Quáº£n lÃ½</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;Quáº£n lÃ½&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/admin-portal">Admin Portal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/service">Casbin Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/command-line-tools">Command-line Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/log-error">Log &amp; Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/frontend">Frontend Usage</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/editor">TrÃ¬nh soáº¡n tháº£o</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;TrÃ¬nh soáº¡n tháº£o&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/online-editor">Online Editor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/ide-plugins">IDE Plugins</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/vi/docs/category/more">ThÃªm</a><button aria-label="Chuyá»ƒn Ä‘á»•i danh má»¥c thanh bÃªn cÃ³ thá»ƒ thu gá»n &#x27;ThÃªm&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/adopters">Our Adopters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/contributing">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/privacy-policy">Privacy Policy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/terms-of-service">Terms of Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/docs/refund-policy">Refund Policy</a></li></ul></li></ul></nav><button type="button" title="Thu gá»n thanh bÃªn" aria-label="Thu gá»n thanh bÃªn" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="ÄÆ°á»ng dáº«n"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Trang chá»§" class="breadcrumbs__link" href="/vi/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/vi/docs/category/advanced-usage"><span itemprop="name">Sá»­ dá»¥ng nÃ¢ng cao</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Admission Webhook for K8s</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">TrÃªn trang nÃ y</button></div><div class="theme-doc-markdown markdown"><header><h1>Admission Webhook for K8s</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-tá»•ng-quan--tÃ i-liá»‡u-cho-casbin-k8s-gatekeeper">1. Tá»•ng quan &amp; TÃ i liá»‡u cho Casbin K8s-Gatekeeper<a href="#1-tá»•ng-quan--tÃ i-liá»‡u-cho-casbin-k8s-gatekeeper" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 1. Tá»•ng quan &amp; TÃ i liá»‡u cho Casbin K8s-Gatekeeper" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 1. Tá»•ng quan &amp; TÃ i liá»‡u cho Casbin K8s-Gatekeeper">â€‹</a></h2><p>Casbin K8s-GateKeeper lÃ  má»™t webhook kiá»ƒm soÃ¡t truy cáº­p cá»§a Kubernetes tÃ­ch há»£p Casbin nhÆ° cÃ´ng cá»¥ Quáº£n lÃ½ Truy cáº­p. Báº±ng cÃ¡ch sá»­ dá»¥ng Casbin K8s-GateKeeper, báº¡n cÃ³ thá»ƒ thiáº¿t láº­p cÃ¡c quy táº¯c linh hoáº¡t Ä‘á»ƒ á»§y quyá»n hoáº·c cháº·n báº¥t ká»³ hoáº¡t Ä‘á»™ng nÃ o trÃªn tÃ i nguyÃªn K8s, KHÃ”NG Cáº¦N viáº¿t báº¥t ká»³ Ä‘oáº¡n mÃ£ nÃ o, chá»‰ vá»›i má»™t vÃ i dÃ²ng cáº¥u hÃ¬nh khai bÃ¡o cá»§a mÃ´ hÃ¬nh vÃ  chÃ­nh sÃ¡ch Casbin, Ä‘Ã³ lÃ  má»™t pháº§n cá»§a ngÃ´n ngá»¯ ACL (Access Control List) cá»§a Casbin.</p><p>Casbin K8s-GateKeeper Ä‘Æ°á»£c phÃ¡t triá»ƒn vÃ  báº£o trÃ¬ bá»Ÿi cá»™ng Ä‘á»“ng Casbin. Kho lÆ°u trá»¯ cá»§a dá»± Ã¡n nÃ y cÃ³ sáºµn táº¡i Ä‘Ã¢y: <a href="https://github.com/casbin/k8s-gatekeeper" target="_blank" rel="noopener noreferrer">https://github.com/casbin/k8s-gatekeeper</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="01-vÃ­-dá»¥-Ä‘Æ¡n-giáº£n">0.1 VÃ­ dá»¥ ÄÆ¡n Giáº£n<a href="#01-vÃ­-dá»¥-Ä‘Æ¡n-giáº£n" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 0.1 VÃ­ dá»¥ ÄÆ¡n Giáº£n" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 0.1 VÃ­ dá»¥ ÄÆ¡n Giáº£n">â€‹</a></h3><p>VÃ­ dá»¥, báº¡n khÃ´ng cáº§n pháº£i viáº¿t báº¥t ká»³ mÃ£ nÃ o, nhÆ°ng sá»­ dá»¥ng cÃ¡c dÃ²ng cáº¥u hÃ¬nh sau Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c chá»©c nÄƒng nÃ y: &quot;Cáº¥m sá»­ dá»¥ng cÃ¡c image cÃ³ nhá»¯ng tag Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trong báº¥t ká»³ deployment nÃ o&quot;:</p><p>Model:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj,eft</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">!some(where (p.eft == deny))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contain(split(accessWithWildcard(${OBJECT}.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And Policy:</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ÄÃ¢y lÃ  trong ngÃ´n ngá»¯ ACL thÃ´ng thÆ°á»ng cá»§a Casbin. Giáº£ sá»­ báº¡n Ä‘Ã£ Ä‘á»c cÃ¡c chÆ°Æ¡ng vá» chÃºng, nÃ³ sáº½ ráº¥t dá»… hiá»ƒu.</p><p>Casbin K8s-GateKeeper cÃ³ nhá»¯ng Æ°u Ä‘iá»ƒm sau:</p><ul><li>Dá»… sá»­ dá»¥ng. Viáº¿t má»™t vÃ i dÃ²ng mÃ£ ACL tá»‘t hÆ¡n nhiá»u so vá»›i viáº¿t má»™t lÆ°á»£ng lá»›n mÃ£ nguá»“n.</li><li>NÃ³ cho phÃ©p cáº­p nháº­t cáº¥u hÃ¬nh nÃ³ng. Báº¡n khÃ´ng cáº§n pháº£i táº¯t toÃ n bá»™ plugin Ä‘á»ƒ sá»­a Ä‘á»•i cáº¥u hÃ¬nh.</li><li>NÃ³ ráº¥t linh hoáº¡t. CÃ³ thá»ƒ táº¡o cÃ¡c quy táº¯c tÃ¹y Ã½ trÃªn báº¥t ká»³ tÃ i nguyÃªn K8s nÃ o, cÃ³ thá»ƒ khÃ¡m phÃ¡ vá»›i <code>kubectl gatekeeper</code>.</li><li>NÃ³ Ä‘Æ¡n giáº£n hÃ³a viá»‡c triá»ƒn khai webhook kiá»ƒm soÃ¡t truy cáº­p K8s, Ä‘iá»u nÃ y ráº¥t phá»©c táº¡p. Báº¡n khÃ´ng cáº§n biáº¿t webhook kiá»ƒm soÃ¡t truy cáº­p K8s lÃ  gÃ¬ hoáº·c lÃ m tháº¿ nÃ o Ä‘á»ƒ viáº¿t mÃ£ cho nÃ³. Táº¥t cáº£ nhá»¯ng gÃ¬ báº¡n cáº§n lÃ m lÃ  biáº¿t tÃ i nguyÃªn mÃ  báº¡n muá»‘n Ä‘áº·t rÃ ng buá»™c vÃ  sau Ä‘Ã³ viáº¿t mÃ£ ACL Casbin. Má»i ngÆ°á»i Ä‘á»u biáº¿t ráº±ng K8s ráº¥t phá»©c táº¡p, nhÆ°ng báº±ng cÃ¡ch sá»­ dá»¥ng Casbin K8s-Gatekeeper, thá»i gian cá»§a báº¡n cÃ³ thá»ƒ Ä‘Æ°á»£c tiáº¿t kiá»‡m.</li><li>NÃ³ Ä‘Æ°á»£c duy trÃ¬ bá»Ÿi cá»™ng Ä‘á»“ng Casbin. HÃ£y thoáº£i mÃ¡i liÃªn há»‡ vá»›i chÃºng tÃ´i náº¿u báº¡n cÃ³ báº¥t ká»³ tháº¯c máº¯c nÃ o vá» plugin nÃ y hoáº·c gáº·p pháº£i báº¥t ká»³ váº¥n Ä‘á» gÃ¬ khi thá»­ nghiá»‡m.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-cÃ¡ch-casbin-k8s-gatekeeper-hoáº¡t-Ä‘á»™ng">1.1 CÃ¡ch Casbin K8s-Gatekeeper hoáº¡t Ä‘á»™ng?<a href="#11-cÃ¡ch-casbin-k8s-gatekeeper-hoáº¡t-Ä‘á»™ng" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 1.1 CÃ¡ch Casbin K8s-Gatekeeper hoáº¡t Ä‘á»™ng?" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 1.1 CÃ¡ch Casbin K8s-Gatekeeper hoáº¡t Ä‘á»™ng?">â€‹</a></h3><p>K8s-Gatekeeper lÃ  má»™t admission webhook cho K8s sá»­ dá»¥ng <a href="/vi/docs/overview">Casbin</a> Ä‘á»ƒ Ã¡p dá»¥ng cÃ¡c quy táº¯c kiá»ƒm soÃ¡t truy cáº­p do ngÆ°á»i dÃ¹ng Ä‘á»‹nh nghÄ©a tÃ¹y Ã½, giÃºp ngÄƒn cháº·n báº¥t ká»³ hoáº¡t Ä‘á»™ng nÃ o trÃªn K8s mÃ  quáº£n trá»‹ viÃªn khÃ´ng muá»‘n.</p><p>Casbin lÃ  má»™t thÆ° viá»‡n kiá»ƒm soÃ¡t truy cáº­p mÃ£ nguá»“n má»Ÿ máº¡nh máº½ vÃ  hiá»‡u quáº£. NÃ³ cung cáº¥p há»— trá»£ cho viá»‡c thá»±c thi á»§y quyá»n dá»±a trÃªn nhiá»u mÃ´ hÃ¬nh kiá»ƒm soÃ¡t truy cáº­p khÃ¡c nhau. Äá»ƒ biáº¿t thÃªm chi tiáº¿t vá» Casbin, hÃ£y xem <a href="/vi/docs/overview">Tá»•ng quan</a>.</p><p>Admission webhooks trong K8s lÃ  cÃ¡c cuá»™c gá»i láº¡i HTTP nháº­n &#x27;yÃªu cáº§u admission&#x27; vÃ  thá»±c hiá»‡n má»™t viá»‡c gÃ¬ Ä‘Ã³ vá»›i chÃºng. Äáº·c biá»‡t, K8s-Gatekeeper lÃ  má»™t loáº¡i admission webhook Ä‘áº·c biá»‡t: &#x27;ValidatingAdmissionWebhook&#x27;, cÃ³ thá»ƒ quyáº¿t Ä‘á»‹nh cháº¥p nháº­n hay tá»« chá»‘i yÃªu cáº§u admission nÃ y. Äá»‘i vá»›i yÃªu cáº§u admission, chÃºng lÃ  cÃ¡c yÃªu cáº§u HTTP mÃ´ táº£ má»™t hoáº¡t Ä‘á»™ng trÃªn cÃ¡c tÃ i nguyÃªn Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh cá»§a K8s (vÃ­ dá»¥: táº¡o/xÃ³a má»™t deployment). Äá»ƒ biáº¿t thÃªm vá» admission webhooks, hÃ£y xem <a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#what-are-admission-webhooks" target="_blank" rel="noopener noreferrer">TÃ i liá»‡u chÃ­nh thá»©c cá»§a K8s</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12-má»™t-vÃ­-dá»¥-minh-há»a-cÃ¡ch-nÃ³-hoáº¡t-Ä‘á»™ng">1.2 Má»™t VÃ­ Dá»¥ Minh Há»a CÃ¡ch NÃ³ Hoáº¡t Äá»™ng<a href="#12-má»™t-vÃ­-dá»¥-minh-há»a-cÃ¡ch-nÃ³-hoáº¡t-Ä‘á»™ng" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 1.2 Má»™t VÃ­ Dá»¥ Minh Há»a CÃ¡ch NÃ³ Hoáº¡t Äá»™ng" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 1.2 Má»™t VÃ­ Dá»¥ Minh Há»a CÃ¡ch NÃ³ Hoáº¡t Äá»™ng">â€‹</a></h3><p>VÃ­ dá»¥, khi ai Ä‘Ã³ muá»‘n táº¡o má»™t báº£n triá»ƒn khai chá»©a má»™t pod cháº¡y nginx (sá»­ dá»¥ng kubectl hoáº·c cÃ¡c client K8s), K8s sáº½ táº¡o ra má»™t yÃªu cáº§u nháº­p cáº£nh, mÃ  (náº¿u Ä‘Æ°á»£c dá»‹ch sang Ä‘á»‹nh dáº¡ng YAML) cÃ³ thá»ƒ giá»‘ng nhÆ° tháº¿ nÃ y:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.14.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>YÃªu cáº§u nÃ y sáº½ Ä‘i qua quÃ¡ trÃ¬nh xá»­ lÃ½ cá»§a táº¥t cáº£ cÃ¡c middleware Ä‘Æ°á»£c hiá»ƒn thá»‹ trong hÃ¬nh, bao gá»“m cáº£ K8s-Gatekeeper cá»§a chÃºng tÃ´i. K8s-Gatekeeper cÃ³ thá»ƒ phÃ¡t hiá»‡n táº¥t cáº£ cÃ¡c enforcer Casbin Ä‘Æ°á»£c lÆ°u trá»¯ trong etcd cá»§a K8s, Ä‘Æ°á»£c táº¡o vÃ  duy trÃ¬ bá»Ÿi ngÆ°á»i dÃ¹ng (thÃ´ng qua <code>kubectl</code> hoáº·c client Go mÃ  chÃºng tÃ´i cung cáº¥p). Má»—i enforcer chá»©a má»™t mÃ´ hÃ¬nh Casbin vÃ  má»™t chÃ­nh sÃ¡ch Casbin. YÃªu cáº§u nháº­p cáº£nh sáº½ Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi tá»«ng enforcer, má»™t cÃ¡ch tuáº§n tá»±, vÃ  chá»‰ khi vÆ°á»£t qua táº¥t cáº£ cÃ¡c enforcer thÃ¬ yÃªu cáº§u má»›i Ä‘Æ°á»£c cháº¥p nháº­n bá»Ÿi K8s-Gatekeeper nÃ y.</p><p>(Náº¿u báº¡n khÃ´ng hiá»ƒu enforcer Casbin, mÃ´ hÃ¬nh, hoáº·c chÃ­nh sÃ¡ch lÃ  gÃ¬, hÃ£y xem tÃ i liá»‡u nÃ y: <a href="/vi/docs/get-started">Báº¯t Äáº§u</a>).</p><p>VÃ­ dá»¥, vÃ¬ má»™t lÃ½ do nÃ o Ä‘Ã³, ngÆ°á»i quáº£n trá»‹ muá»‘n cáº¥m sá»± xuáº¥t hiá»‡n cá»§a image &#x27;nginx:1.14.1&#x27; trong khi cho phÃ©p &#x27;nginx:1.3.1&#x27;. Má»™t enforcer chá»©a quy táº¯c vÃ  chÃ­nh sÃ¡ch sau cÃ³ thá»ƒ Ä‘Æ°á»£c táº¡o ra (ChÃºng tÃ´i sáº½ giáº£i thÃ­ch cÃ¡ch táº¡o má»™t enforcer, mÃ´ hÃ¬nh vÃ  chÃ­nh sÃ¡ch lÃ  gÃ¬, vÃ  cÃ¡ch viáº¿t chÃºng trong cÃ¡c chÆ°Æ¡ng tiáº¿p theo).</p><p>Model:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj,eft</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">policy_effect</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">e</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">!some(where (p.eft == deny))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">= p.obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Policy:</p><div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;nginx:1.13.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">allow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token value">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value"> </span><span class="token value">&quot;nginx:1.14.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token value">deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Báº±ng cÃ¡ch táº¡o má»™t enforcer chá»©a mÃ´ hÃ¬nh vÃ  chÃ­nh sÃ¡ch á»Ÿ trÃªn, yÃªu cáº§u nháº­p cáº£nh trÆ°á»›c Ä‘Ã³ sáº½ bá»‹ tá»« chá»‘i bá»Ÿi enforcer nÃ y, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  K8s sáº½ khÃ´ng táº¡o ra bá»™ triá»ƒn khai nÃ y.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-cÃ i-Ä‘áº·t-k8s-gatekeeper">2 CÃ i Ä‘áº·t K8s-gatekeeper<a href="#2-cÃ i-Ä‘áº·t-k8s-gatekeeper" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2 CÃ i Ä‘áº·t K8s-gatekeeper" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2 CÃ i Ä‘áº·t K8s-gatekeeper">â€‹</a></h2><p>CÃ³ ba phÆ°Æ¡ng phÃ¡p cÃ³ sáºµn Ä‘á»ƒ cÃ i Ä‘áº·t K8s-gatekeeper: Webhook bÃªn ngoÃ i, Webhook ná»™i bá»™ vÃ  Helm.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ghi chÃº</div><div class="admonitionContent_S0QG"><p>LÆ°u Ã½: Nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y chá»‰ dÃ nh cho ngÆ°á»i dÃ¹ng thá»­ nghiá»‡m K8s-gatekeeper vÃ  khÃ´ng an toÃ n. Náº¿u báº¡n muá»‘n sá»­ dá»¥ng nÃ³ trong mÃ´i trÆ°á»ng sáº£n xuáº¥t, vui lÃ²ng Ä‘áº£m báº£o ráº±ng báº¡n Ä‘Ã£ Ä‘á»c <a href="#5-advanced-settings">ChÆ°Æ¡ng 5. CÃ i Ä‘áº·t nÃ¢ng cao</a> vÃ  thá»±c hiá»‡n báº¥t ká»³ sá»­a Ä‘á»•i cáº§n thiáº¿t nÃ o trÆ°á»›c khi cÃ i Ä‘áº·t.</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21-webhook-ná»™i-bá»™">2.1 Webhook ná»™i bá»™<a href="#21-webhook-ná»™i-bá»™" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.1 Webhook ná»™i bá»™" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.1 Webhook ná»™i bá»™">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="211-bÆ°á»›c-1-xÃ¢y-dá»±ng-hÃ¬nh-áº£nh">2.1.1 BÆ°á»›c 1: XÃ¢y dá»±ng hÃ¬nh áº£nh<a href="#211-bÆ°á»›c-1-xÃ¢y-dá»±ng-hÃ¬nh-áº£nh" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.1.1 BÆ°á»›c 1: XÃ¢y dá»±ng hÃ¬nh áº£nh" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.1.1 BÆ°á»›c 1: XÃ¢y dá»±ng hÃ¬nh áº£nh">â€‹</a></h4><p>Äá»‘i vá»›i phÆ°Æ¡ng phÃ¡p webhook ná»™i bá»™, chÃ­nh webhook sáº½ Ä‘Æ°á»£c triá»ƒn khai nhÆ° má»™t dá»‹ch vá»¥ trong Kubernetes. Äá»ƒ táº¡o dá»‹ch vá»¥ vÃ  triá»ƒn khai cáº§n thiáº¿t, báº¡n cáº§n xÃ¢y dá»±ng má»™t hÃ¬nh áº£nh cá»§a K8s-gatekeeper. Báº¡n cÃ³ thá»ƒ xÃ¢y dá»±ng hÃ¬nh áº£nh cá»§a riÃªng mÃ¬nh báº±ng cÃ¡ch cháº¡y lá»‡nh sau:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build --target webhook -t k8s-gatekeeper </span><span class="token builtin class-name">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lá»‡nh nÃ y sáº½ táº¡o má»™t hÃ¬nh áº£nh cá»¥c bá»™ cÃ³ tÃªn &#x27;k8s-gatekeeper:latest&#x27;.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>ghi chÃº</div><div class="admonitionContent_S0QG"><p>LÆ°u Ã½: Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng minikube, vui lÃ²ng thá»±c hiá»‡n <code>eval $(minikube -p minikube docker-env)</code> trÆ°á»›c khi cháº¡y &#x27;docker build&#x27;.</p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="212-bÆ°á»›c-2-thiáº¿t-láº­p-dá»‹ch-vá»¥-vÃ -triá»ƒn-khai-cho-k8s-gatekeeper">2.1.2 BÆ°á»›c 2: Thiáº¿t láº­p dá»‹ch vá»¥ vÃ  triá»ƒn khai cho K8s-gatekeeper<a href="#212-bÆ°á»›c-2-thiáº¿t-láº­p-dá»‹ch-vá»¥-vÃ -triá»ƒn-khai-cho-k8s-gatekeeper" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.1.2 BÆ°á»›c 2: Thiáº¿t láº­p dá»‹ch vá»¥ vÃ  triá»ƒn khai cho K8s-gatekeeper" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.1.2 BÆ°á»›c 2: Thiáº¿t láº­p dá»‹ch vá»¥ vÃ  triá»ƒn khai cho K8s-gatekeeper">â€‹</a></h4><p>Cháº¡y cÃ¡c lá»‡nh sau:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/rbac.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_deployment.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_internal.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Äiá»u nÃ y sáº½ báº¯t Ä‘áº§u cháº¡y K8s-gatekeeper, vÃ  báº¡n cÃ³ thá»ƒ xÃ¡c nháº­n Ä‘iá»u nÃ y báº±ng cÃ¡ch cháº¡y <code>kubectl get pods</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="213-bÆ°á»›c-3-cÃ i-Ä‘áº·t-tÃ i-nguyÃªn-crd-cho-k8s-gatekeeper">2.1.3 BÆ°á»›c 3: CÃ i Ä‘áº·t TÃ i nguyÃªn CRD cho K8s-gatekeeper<a href="#213-bÆ°á»›c-3-cÃ i-Ä‘áº·t-tÃ i-nguyÃªn-crd-cho-k8s-gatekeeper" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.1.3 BÆ°á»›c 3: CÃ i Ä‘áº·t TÃ i nguyÃªn CRD cho K8s-gatekeeper" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.1.3 BÆ°á»›c 3: CÃ i Ä‘áº·t TÃ i nguyÃªn CRD cho K8s-gatekeeper">â€‹</a></h4><p>Cháº¡y cÃ¡c lá»‡nh sau:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinmodels.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinpolicies.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22-webhook-bÃªn-ngoÃ i">2.2 Webhook bÃªn ngoÃ i<a href="#22-webhook-bÃªn-ngoÃ i" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.2 Webhook bÃªn ngoÃ i" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.2 Webhook bÃªn ngoÃ i">â€‹</a></h3><p>Äá»‘i vá»›i phÆ°Æ¡ng thá»©c webhook bÃªn ngoÃ i, K8s-gatekeeper sáº½ cháº¡y bÃªn ngoÃ i Kubernetes, vÃ  Kubernetes sáº½ truy cáº­p K8s-gatekeeper nhÆ° thá»ƒ nÃ³ truy cáº­p má»™t trang web thÃ´ng thÆ°á»ng. Kubernetes cÃ³ má»™t yÃªu cáº§u báº¯t buá»™c lÃ  webhook kiá»ƒm soÃ¡t truy cáº­p pháº£i sá»­ dá»¥ng giao thá»©c HTTPS. VÃ¬ má»¥c Ä‘Ã­ch thá»­ nghiá»‡m K8s-gatekeeper, chÃºng tÃ´i Ä‘Ã£ cung cáº¥p má»™t bá»™ chá»©ng chá»‰ vÃ  má»™t khÃ³a riÃªng (máº·c dÃ¹ Ä‘iá»u nÃ y khÃ´ng an toÃ n). Náº¿u báº¡n muá»‘n sá»­ dá»¥ng chá»©ng chá»‰ cá»§a riÃªng mÃ¬nh, vui lÃ²ng tham kháº£o <a href="#5-advanced-settings">ChÆ°Æ¡ng 5. CÃ i Ä‘áº·t nÃ¢ng cao</a> Ä‘á»ƒ Ä‘Æ°á»£c hÆ°á»›ng dáº«n Ä‘iá»u chá»‰nh chá»©ng chá»‰ vÃ  khÃ³a riÃªng. Chá»©ng chá»‰ mÃ  chÃºng tÃ´i cung cáº¥p Ä‘Æ°á»£c cáº¥p cho &#x27;webhook.domain.local&#x27;.</p><p>VÃ¬ váº­y, hÃ£y sá»­a Ä‘á»•i mÃ¡y chá»§ (vÃ­ dá»¥: /etc/hosts) vÃ  trá» &#x27;webhook.domain.local&#x27; Ä‘áº¿n Ä‘á»‹a chá»‰ IP mÃ  K8s-gatekeeper Ä‘ang cháº¡y. Sau Ä‘Ã³ thá»±c hiá»‡n lá»‡nh sau:</p><p>2.3 CÃ i Ä‘áº·t K8s-gatekeeper thÃ´ng qua Helm</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">go mod tidy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go mod vendor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go run cmd/webhook/main.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinmodels.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/auth.casbin.org_casbinpolicies.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f config/webhook_external.yaml </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="231-bÆ°á»›c-1-xÃ¢y-dá»±ng-hÃ¬nh-áº£nh">2.3.1 BÆ°á»›c 1: XÃ¢y dá»±ng hÃ¬nh áº£nh<a href="#231-bÆ°á»›c-1-xÃ¢y-dá»±ng-hÃ¬nh-áº£nh" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.3.1 BÆ°á»›c 1: XÃ¢y dá»±ng hÃ¬nh áº£nh" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.3.1 BÆ°á»›c 1: XÃ¢y dá»±ng hÃ¬nh áº£nh">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="231-adÄ±m-1-gÃ¶rÃ¼ntÃ¼yÃ¼-oluÅŸturun">2.3.1 AdÄ±m 1: GÃ¶rÃ¼ntÃ¼yÃ¼ oluÅŸturun<a href="#231-adÄ±m-1-gÃ¶rÃ¼ntÃ¼yÃ¼-oluÅŸturun" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.3.1 AdÄ±m 1: GÃ¶rÃ¼ntÃ¼yÃ¼ oluÅŸturun" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.3.1 AdÄ±m 1: GÃ¶rÃ¼ntÃ¼yÃ¼ oluÅŸturun">â€‹</a></h4><p>Vui lÃ²ng tham kháº£o <a href="#211-step-1-build-the-image">ChÆ°Æ¡ng 2.1.1</a>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="232-cÃ i-Ä‘áº·t-helm">2.3.2 CÃ i Ä‘áº·t Helm<a href="#232-cÃ i-Ä‘áº·t-helm" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.3.2 CÃ i Ä‘áº·t Helm" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 2.3.2 CÃ i Ä‘áº·t Helm">â€‹</a></h4><p>Cháº¡y lá»‡nh <code>helm install k8sgatekeeper ./k8sgatekeeper</code>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-thá»­-k8s-gatekeeper">3. Thá»­ K8s-gatekeeper<a href="#3-thá»­-k8s-gatekeeper" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3. Thá»­ K8s-gatekeeper" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3. Thá»­ K8s-gatekeeper">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31-táº¡o-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-casbin">3.1 Táº¡o MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin<a href="#31-táº¡o-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-casbin" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3.1 Táº¡o MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3.1 Táº¡o MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin">â€‹</a></h3><p>Báº¡n cÃ³ hai phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ táº¡o má»™t mÃ´ hÃ¬nh vÃ  chÃ­nh sÃ¡ch: thÃ´ng qua kubectl hoáº·c thÃ´ng qua go-client mÃ  chÃºng tÃ´i cung cáº¥p.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="311-táº¡ocáº­p-nháº­t-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-casbin-qua-kubectl">3.1.1 Táº¡o/Cáº­p nháº­t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin qua kubectl<a href="#311-táº¡ocáº­p-nháº­t-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-casbin-qua-kubectl" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3.1.1 Táº¡o/Cáº­p nháº­t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin qua kubectl" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3.1.1 Táº¡o/Cáº­p nháº­t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin qua kubectl">â€‹</a></h4><p>Trong K8s-gatekeeper, mÃ´ hÃ¬nh Casbin Ä‘Æ°á»£c lÆ°u trá»¯ trong má»™t tÃ i nguyÃªn CRD cÃ³ tÃªn lÃ  &#x27;CasbinModel&#x27;. Äá»‹nh nghÄ©a cá»§a nÃ³ náº±m trong <code>config/auth.casbin.org_casbinmodels.yaml</code>.</p><p>CÃ³ vÃ­ dá»¥ trong <code>example/allowed_repo/model.yaml</code>. ChÃº Ã½ Ä‘áº¿n cÃ¡c trÆ°á»ng sau:</p><ul><li>metadata.name: tÃªn cá»§a mÃ´ hÃ¬nh. TÃªn nÃ y PHáº¢I giá»‘ng vá»›i tÃªn cá»§a Ä‘á»‘i tÆ°á»£ng CasbinPolicy liÃªn quan Ä‘áº¿n mÃ´ hÃ¬nh nÃ y, Ä‘á»ƒ K8s-gatekeeper cÃ³ thá»ƒ ghÃ©p cáº·p chÃºng vÃ  táº¡o má»™t enforcer.</li><li>spec.enable: náº¿u trÆ°á»ng nÃ y Ä‘Æ°á»£c Ä‘áº·t thÃ nh &quot;false&quot;, mÃ´ hÃ¬nh nÃ y (cÅ©ng nhÆ° Ä‘á»‘i tÆ°á»£ng CasbinPolicy liÃªn quan Ä‘áº¿n mÃ´ hÃ¬nh nÃ y) sáº½ bá»‹ bá» qua.</li><li>spec.modelText: má»™t chuá»—i chá»©a vÄƒn báº£n mÃ´ hÃ¬nh cá»§a má»™t mÃ´ hÃ¬nh Casbin.</li></ul><p>ChÃ­nh sÃ¡ch Casbin Ä‘Æ°á»£c lÆ°u trá»¯ trong má»™t tÃ i nguyÃªn CRD khÃ¡c Ä‘Æ°á»£c gá»i lÃ  &#x27;CasbinPolicy&#x27;, Ä‘á»‹nh nghÄ©a cá»§a nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong <code>config/auth.casbin.org_casbinpolicies.yaml</code>.</p><p>CÃ³ vÃ­ dá»¥ trong <code>example/allowed_repo/policy.yaml</code>. ChÃº Ã½ Ä‘áº¿n cÃ¡c trÆ°á»ng sau:</p><ul><li>metadata.name: tÃªn cá»§a chÃ­nh sÃ¡ch. TÃªn nÃ y PHáº¢I giá»‘ng vá»›i tÃªn cá»§a Ä‘á»‘i tÆ°á»£ng CasbinModel liÃªn quan Ä‘áº¿n chÃ­nh sÃ¡ch nÃ y, Ä‘á»ƒ K8s-gatekeeper cÃ³ thá»ƒ ghÃ©p cáº·p chÃºng vÃ  táº¡o ra má»™t enforcer.</li><li>spec.policyItem: má»™t chuá»—i chá»©a vÄƒn báº£n chÃ­nh sÃ¡ch cá»§a má»™t mÃ´ hÃ¬nh Casbin.</li></ul><p>Sau khi táº¡o cÃ¡c tá»‡p CasbinModel vÃ  CasbinPolicy cá»§a riÃªng báº¡n, sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ Ã¡p dá»¥ng chÃºng:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">filename</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Má»™t khi má»™t cáº·p CasbinModel vÃ  CasbinPolicy Ä‘Æ°á»£c táº¡o, K8s-gatekeeper sáº½ cÃ³ thá»ƒ phÃ¡t hiá»‡n nÃ³ trong vÃ²ng 5 giÃ¢y.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-táº¡ocáº­p-nháº­t-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-casbin-thÃ´ng-qua-go-client-mÃ -chÃºng-tÃ´i-cung-cáº¥p">3.1.2 Táº¡o/Cáº­p nháº­t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin thÃ´ng qua go-client mÃ  chÃºng tÃ´i cung cáº¥p<a href="#312-táº¡ocáº­p-nháº­t-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-casbin-thÃ´ng-qua-go-client-mÃ -chÃºng-tÃ´i-cung-cáº¥p" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3.1.2 Táº¡o/Cáº­p nháº­t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin thÃ´ng qua go-client mÃ  chÃºng tÃ´i cung cáº¥p" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3.1.2 Táº¡o/Cáº­p nháº­t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin thÃ´ng qua go-client mÃ  chÃºng tÃ´i cung cáº¥p">â€‹</a></h4><p>ChÃºng tÃ´i hiá»ƒu ráº±ng cÃ³ thá»ƒ cÃ³ tÃ¬nh huá»‘ng mÃ  viá»‡c sá»­ dá»¥ng shell Ä‘á»ƒ thá»±c thi cÃ¡c lá»‡nh trá»±c tiáº¿p trÃªn má»™t nÃºt cá»§a cá»¥m K8s khÃ´ng thuáº­n tiá»‡n, cháº³ng háº¡n nhÆ° khi báº¡n Ä‘ang xÃ¢y dá»±ng má»™t ná»n táº£ng Ä‘iá»‡n toÃ¡n Ä‘Ã¡m mÃ¢y tá»± Ä‘á»™ng cho cÃ´ng ty cá»§a mÃ¬nh. Do Ä‘Ã³, chÃºng tÃ´i Ä‘Ã£ phÃ¡t triá»ƒn má»™t go-client Ä‘á»ƒ táº¡o vÃ  duy trÃ¬ CasbinModel vÃ  CasbinPolicy.</p><p>ThÆ° viá»‡n go-client náº±m trong <code>pkg/client</code>.</p><p>Trong <code>client.go</code>, chÃºng tÃ´i cung cáº¥p má»™t hÃ m Ä‘á»ƒ táº¡o má»™t client.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewK8sGateKeeperClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">externalClient </span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">K8sGateKeeperClient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Tham sá»‘ <code>externalClient</code> xÃ¡c Ä‘á»‹nh liá»‡u K8s-gatekeeper cÃ³ Ä‘ang cháº¡y bÃªn trong cá»¥m K8s hay khÃ´ng.</p><p>Trong <code>model.go</code>, chÃºng tÃ´i cung cáº¥p nhiá»u hÃ m Ä‘á»ƒ táº¡o, xÃ³a vÃ  sá»­a Ä‘á»•i CasbinModel. Báº¡n cÃ³ thá»ƒ tÃ¬m hiá»ƒu cÃ¡ch sá»­ dá»¥ng cÃ¡c giao diá»‡n nÃ y trong <code>model_test.go</code>.</p><p>Trong <code>policy.go</code>, chÃºng tÃ´i cung cáº¥p nhiá»u hÃ m Ä‘á»ƒ táº¡o, xÃ³a vÃ  sá»­a Ä‘á»•i CasbiPolicy. Báº¡n cÃ³ thá»ƒ tÃ¬m hiá»ƒu cÃ¡ch sá»­ dá»¥ng cÃ¡c giao diá»‡n nÃ y trong <code>policy_test.go</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312-thá»­-xem-k8s-gatekeeper-cÃ³-hoáº¡t-Ä‘á»™ng-khÃ´ng">3.1.2 Thá»­ xem K8s-gatekeeper cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng<a href="#312-thá»­-xem-k8s-gatekeeper-cÃ³-hoáº¡t-Ä‘á»™ng-khÃ´ng" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3.1.2 Thá»­ xem K8s-gatekeeper cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 3.1.2 Thá»­ xem K8s-gatekeeper cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng">â€‹</a></h3><p>Giáº£ sá»­ báº¡n Ä‘Ã£ táº¡o chÃ­nh xÃ¡c mÃ´ hÃ¬nh vÃ  chÃ­nh sÃ¡ch trong <code>example/allowed_repo</code>. BÃ¢y giá», hÃ£y thá»­ lá»‡nh sau:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f example/allowed_repo/testcase/reject_1.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Báº¡n sáº½ tháº¥y ráº±ng K8s sáº½ tá»« chá»‘i yÃªu cáº§u nÃ y vÃ  Ä‘á» cáº­p ráº±ng webhook lÃ  lÃ½ do táº¡i sao yÃªu cáº§u nÃ y bá»‹ tá»« chá»‘i. Tuy nhiÃªn, khi báº¡n thá»­ Ã¡p dá»¥ng <code>example/allowed_repo/testcase/approve_2.yaml</code>, nÃ³ sáº½ Ä‘Æ°á»£c cháº¥p nháº­n.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-cÃ¡ch-viáº¿t-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-vá»›i-k8s-gatekeeper">4. CÃ¡ch Viáº¿t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch vá»›i K8s-gatekeeper<a href="#4-cÃ¡ch-viáº¿t-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-vá»›i-k8s-gatekeeper" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4. CÃ¡ch Viáº¿t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch vá»›i K8s-gatekeeper" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4. CÃ¡ch Viáº¿t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch vá»›i K8s-gatekeeper">â€‹</a></h2><p>TrÆ°á»›c háº¿t, hÃ£y Ä‘áº£m báº£o báº¡n quen thuá»™c vá»›i cÃº phÃ¡p cÆ¡ báº£n cá»§a MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin. Náº¿u khÃ´ng, vui lÃ²ng Ä‘á»c pháº§n <a href="/vi/docs/get-started">Báº¯t Ä‘áº§u</a> trÆ°á»›c. Trong chÆ°Æ¡ng nÃ y, chÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng báº¡n Ä‘Ã£ hiá»ƒu MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin lÃ  gÃ¬.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41-Ä‘á»‹nh-nghÄ©a-yÃªu-cáº§u-cá»§a-mÃ´-hÃ¬nh">4.1 Äá»‹nh nghÄ©a YÃªu cáº§u cá»§a MÃ´ hÃ¬nh<a href="#41-Ä‘á»‹nh-nghÄ©a-yÃªu-cáº§u-cá»§a-mÃ´-hÃ¬nh" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.1 Äá»‹nh nghÄ©a YÃªu cáº§u cá»§a MÃ´ hÃ¬nh" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.1 Äá»‹nh nghÄ©a YÃªu cáº§u cá»§a MÃ´ hÃ¬nh">â€‹</a></h3><p>Khi K8s-gatekeeper Ä‘ang cáº¥p quyá»n cho má»™t yÃªu cáº§u, Ä‘áº§u vÃ o luÃ´n lÃ  má»™t Ä‘á»‘i tÆ°á»£ng: Ä‘á»‘i tÆ°á»£ng Go cá»§a YÃªu cáº§u Nháº­p cáº£nh. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  enforcer sáº½ luÃ´n Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° tháº¿ nÃ y:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ok</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> enforcer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Enforce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">admission</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>trong Ä‘Ã³ <code>admission</code> lÃ  má»™t Ä‘á»‘i tÆ°á»£ng <code>AdmissionReview</code> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi api chÃ­nh thá»©c cá»§a K8s <code>&quot;k8s.io/api/admission/v1&quot;</code>. Báº¡n cÃ³ thá»ƒ tÃ¬m tháº¥y Ä‘á»‹nh nghÄ©a cá»§a cáº¥u trÃºc nÃ y trong kho lÆ°u trá»¯ nÃ y: <a href="https://github.com/kubernetes/api/blob/master/admission/v1/types.go" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/api/blob/master/admission/v1/types.go</a>. Äá»ƒ biáº¿t thÃªm thÃ´ng tin, báº¡n cÅ©ng cÃ³ thá»ƒ tham kháº£o <a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response</a>.</p><p>Do Ä‘Ã³, Ä‘á»‘i vá»›i báº¥t ká»³ mÃ´ hÃ¬nh nÃ o Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi K8s-gatekeeper, Ä‘á»‹nh nghÄ©a cá»§a <code>request_definition</code> luÃ´n pháº£i nhÆ° sau:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">request_definition</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key attr-name" style="color:#00a4db">r</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain">  </span><span class="token value attr-value" style="color:#e3116c">obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>TÃªn &#x27;obj&#x27; khÃ´ng báº¯t buá»™c, miá»…n lÃ  tÃªn Ä‘Ã³ nháº¥t quÃ¡n vá»›i tÃªn Ä‘Æ°á»£c sá»­ dá»¥ng trong pháº§n <code>[matchers]</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42-matchers-cá»§a-mÃ´-hÃ¬nh">4.2 Matchers cá»§a MÃ´ hÃ¬nh<a href="#42-matchers-cá»§a-mÃ´-hÃ¬nh" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2 Matchers cá»§a MÃ´ hÃ¬nh" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2 Matchers cá»§a MÃ´ hÃ¬nh">â€‹</a></h3><p>Báº¡n Ä‘Æ°á»£c ká»³ vá»ng sá»­ dá»¥ng tÃ­nh nÄƒng ABAC cá»§a Casbin Ä‘á»ƒ viáº¿t cÃ¡c quy táº¯c cá»§a báº¡n. Tuy nhiÃªn, bá»™ Ä‘Ã¡nh giÃ¡ biá»ƒu thá»©c tÃ­ch há»£p trong Casbin khÃ´ng há»— trá»£ láº­p chá»‰ má»¥c trong báº£n Ä‘á»“ hoáº·c máº£ng (slices), cÅ©ng nhÆ° khÃ´ng há»— trá»£ má»Ÿ rá»™ng máº£ng. Do Ä‘Ã³, K8s-gatekeeper cung cáº¥p cÃ¡c &#x27;hÃ m Casbin&#x27; khÃ¡c nhau nhÆ° cÃ¡c pháº§n má»Ÿ rá»™ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c tÃ­nh nÄƒng nÃ y. Náº¿u báº¡n váº«n tháº¥y ráº±ng nhu cáº§u cá»§a báº¡n khÃ´ng thá»ƒ Ä‘Æ°á»£c Ä‘Ã¡p á»©ng bá»Ÿi cÃ¡c pháº§n má»Ÿ rá»™ng nÃ y, hÃ£y thoáº£i mÃ¡i báº¯t Ä‘áº§u má»™t váº¥n Ä‘á», hoáº·c táº¡o má»™t pull request.</p><p>Náº¿u báº¡n khÃ´ng quen thuá»™c vá»›i cÃ¡c hÃ m Casbin, báº¡n cÃ³ thá»ƒ tham kháº£o <a href="/vi/docs/function">Function</a> Ä‘á»ƒ biáº¿t thÃªm thÃ´ng tin.</p><p>DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c hÃ m má»Ÿ rá»™ng:</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="421-cÃ¡c-hÃ m-má»Ÿ-rá»™ng">4.2.1 CÃ¡c hÃ m má»Ÿ rá»™ng<a href="#421-cÃ¡c-hÃ m-má»Ÿ-rá»™ng" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1 CÃ¡c hÃ m má»Ÿ rá»™ng" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1 CÃ¡c hÃ m má»Ÿ rá»™ng">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4211-truy-cáº­p">4.2.1.1 truy cáº­p<a href="#4211-truy-cáº­p" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1.1 truy cáº­p" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1.1 truy cáº­p">â€‹</a></h4><p>Truy cáº­p Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» mÃ  Casbin khÃ´ng há»— trá»£ Ä‘Ã¡nh chá»‰ má»¥c trong báº£n Ä‘á»“ hoáº·c máº£ng. VÃ­ dá»¥ <code>example/allowed_repo/model.yaml</code> minh há»a viá»‡c sá»­ dá»¥ng chá»©c nÄƒng nÃ y:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">= p.obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Trong bá»™ so khá»›p nÃ y, <code>access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Image&quot;)</code> tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Image</code>, trong Ä‘Ã³ <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers</code> lÃ  má»™t slice.</p><p>Truy cáº­p cÅ©ng cÃ³ thá»ƒ gá»i cÃ¡c hÃ m Ä‘Æ¡n giáº£n khÃ´ng cÃ³ tham sá»‘ vÃ  tráº£ vá» má»™t giÃ¡ trá»‹ duy nháº¥t. VÃ­ dá»¥ <code>example/container_resource_limit/model.yaml</code> minh há»a Ä‘iá»u nÃ y:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;cpu&quot;,&quot;Value&quot;)) &gt;</span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">parseFloat(p.cpu) &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key attr-name" style="color:#00a4db">parseFloat(access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;memory&quot;,&quot;Value&quot;)) &gt;</span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">parseFloat(p.memory)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Trong bá»™ so khá»›p nÃ y, <code>access(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , 0, &quot;Resources&quot;,&quot;Limits&quot;,&quot;cpu&quot;,&quot;Value&quot;)</code> tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits[&quot;cpu&quot;].Value()</code>, trong Ä‘Ã³ <code>r.obj.Request.Object.Object.Spec.Template.Spec.Containers[0].Resources.Limits</code> lÃ  má»™t báº£n Ä‘á»“, vÃ  <code>Value()</code> lÃ  má»™t hÃ m Ä‘Æ¡n giáº£n khÃ´ng cÃ³ tham sá»‘ vÃ  tráº£ vá» má»™t giÃ¡ trá»‹ duy nháº¥t.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4212-truycáº­pvá»›ikÃ½tá»±Ä‘áº¡idiá»‡n">4.2.1.2 truyCáº­pVá»›iKÃ½Tá»±Äáº¡iDiá»‡n<a href="#4212-truycáº­pvá»›ikÃ½tá»±Ä‘áº¡idiá»‡n" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1.2 truyCáº­pVá»›iKÃ½Tá»±Äáº¡iDiá»‡n" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1.2 truyCáº­pVá»›iKÃ½Tá»±Äáº¡iDiá»‡n">â€‹</a></h4><p>ÄÃ´i khi, báº¡n cÃ³ thá»ƒ cÃ³ nhu cáº§u nhÆ° tháº¿ nÃ y: táº¥t cáº£ cÃ¡c pháº§n tá»­ trong má»™t máº£ng pháº£i cÃ³ tiá»n tá»‘ &quot;aaa&quot;. Tuy nhiÃªn, Casbin khÃ´ng há»— trá»£ vÃ²ng láº·p <code>for</code>. Vá»›i <code>accessWithWildcard</code> vÃ  tÃ­nh nÄƒng &quot;má»Ÿ rá»™ng báº£n Ä‘á»“/slice&quot;, báº¡n cÃ³ thá»ƒ dá»… dÃ ng thá»±c hiá»‡n yÃªu cáº§u nhÆ° váº­y.</p><p>VÃ­ dá»¥, giáº£ sá»­ <code>a.b.c</code> lÃ  má»™t máº£ng <code>[aaa, bbb, ccc, ddd, eee]</code>, thÃ¬ káº¿t quáº£ cá»§a <code>accessWithWildcard(a, &quot;b&quot;, &quot;c&quot;, &quot;*&quot;)</code> sáº½ lÃ  má»™t slice <code>[aaa, bbb, ccc, ddd, eee]</code>. Báº±ng cÃ¡ch sá»­ dá»¥ng kÃ½ tá»± Ä‘áº¡i diá»‡n <code>*</code>, slice Ä‘Æ°á»£c má»Ÿ rá»™ng.</p><p>TÆ°Æ¡ng tá»±, kÃ½ tá»± Ä‘áº¡i diá»‡n cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u hÆ¡n má»™t láº§n. VÃ­ dá»¥, káº¿t quáº£ cá»§a <code>accessWithWildcard(a, &quot;b&quot;, &quot;c&quot;, &quot;*&quot;, &quot;*&quot;)</code> sáº½ lÃ  <code>[a.b.c[0][0], a.b.c[0][1], ..., a.b.c[1][0], a.b.c[1][1], ...]</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4213-cÃ¡c-hÃ m-há»—-trá»£-Ä‘á»‘i-sá»‘-cÃ³-Ä‘á»™-dÃ i-biáº¿n-Ä‘á»•i">4.2.1.3 CÃ¡c hÃ m há»— trá»£ Ä‘á»‘i sá»‘ cÃ³ Ä‘á»™ dÃ i biáº¿n Ä‘á»•i<a href="#4213-cÃ¡c-hÃ m-há»—-trá»£-Ä‘á»‘i-sá»‘-cÃ³-Ä‘á»™-dÃ i-biáº¿n-Ä‘á»•i" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1.3 CÃ¡c hÃ m há»— trá»£ Ä‘á»‘i sá»‘ cÃ³ Ä‘á»™ dÃ i biáº¿n Ä‘á»•i" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1.3 CÃ¡c hÃ m há»— trá»£ Ä‘á»‘i sá»‘ cÃ³ Ä‘á»™ dÃ i biáº¿n Ä‘á»•i">â€‹</a></h3><p>Trong trÃ¬nh Ä‘Ã¡nh giÃ¡ biá»ƒu thá»©c cá»§a Casbin, khi má»™t tham sá»‘ lÃ  má»™t máº£ng, nÃ³ sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng má»Ÿ rá»™ng thÃ nh má»™t Ä‘á»‘i sá»‘ cÃ³ Ä‘á»™ dÃ i biáº¿n Ä‘á»•i. Sá»­ dá»¥ng tÃ­nh nÄƒng nÃ y Ä‘á»ƒ há»— trá»£ má»Ÿ rá»™ng máº£ng/slice/báº£n Ä‘á»“, chÃºng tÃ´i cÅ©ng Ä‘Ã£ tÃ­ch há»£p má»™t sá»‘ hÃ m cháº¥p nháº­n máº£ng/slice lÃ m tham sá»‘:</p><ul><li>contain(): cháº¥p nháº­n nhiá»u tham sá»‘ vÃ  tráº£ vá» xem báº¥t ká»³ tham sá»‘ nÃ o (ngoáº¡i trá»« tham sá»‘ cuá»‘i cÃ¹ng) cÃ³ báº±ng tham sá»‘ cuá»‘i cÃ¹ng hay khÃ´ng.</li><li>split(a, b, c..., sep, index): tráº£ vá» má»™t slice chá»©a <code>[splits(a, sep)[index], splits(b, sep)[index], splits(a, sep)[index], ...]</code>.</li><li><code>len()</code>: tráº£ vá» Ä‘á»™ dÃ i cá»§a Ä‘á»‘i sá»‘ cÃ³ Ä‘á»™ dÃ i thay Ä‘á»•i.</li><li><code>matchRegex(a, b, c..., regex)</code>: tráº£ vá» xem táº¥t cáº£ cÃ¡c tham sá»‘ Ä‘Ã£ cho (<code>a</code>, <code>b</code>, <code>c</code>, ...) cÃ³ khá»›p vá»›i regex Ä‘Ã£ cho.</li></ul><p>ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ trong <code>example/disallowed_tag/model.yaml</code>:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">matchers</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key attr-name" style="color:#00a4db">m</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token value attr-value" style="color:#e3116c">r.obj.Request.Namespace == &quot;default&quot; &amp;&amp; r.obj.Request.Resource.Resource ==&quot;deployments&quot; &amp;&amp; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers , &quot;*&quot;, &quot;Image&quot;),&quot;:&quot;,1) , p.obj)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Giáº£ sá»­ ráº±ng <code>accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers, &quot;*&quot;, &quot;Image&quot;)</code> tráº£ vá» <code>[&quot;a:b&quot;, &quot;c:d&quot;, &quot;e:f&quot;, &quot;g:h&quot;]</code>, bá»Ÿi vÃ¬ <code>splits</code> há»— trá»£ Ä‘á»‘i sá»‘ cÃ³ Ä‘á»™ dÃ i thay Ä‘á»•i vÃ  thá»±c hiá»‡n phÃ©p chia trÃªn má»—i pháº§n tá»­, pháº§n tá»­ táº¡i chá»‰ sá»‘ 1 sáº½ Ä‘Æ°á»£c chá»n vÃ  tráº£ vá». Do Ä‘Ã³, <code>split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers, &quot;*&quot;, &quot;Image&quot;), &quot;:&quot;, 1)</code> tráº£ vá» <code>[&quot;b&quot;, &quot;d&quot;, &quot;f&quot;, &quot;h&quot;]</code>. VÃ  <code>contain(split(accessWithWildcard(r.obj.Request.Object.Object.Spec.Template.Spec.Containers, &quot;*&quot;, &quot;Image&quot;), &quot;:&quot;, 1), p.obj)</code> tráº£ vá» xem <code>p.obj</code> cÃ³ Ä‘Æ°á»£c chá»©a trong <code>[&quot;b&quot;, &quot;d&quot;, &quot;f&quot;, &quot;h&quot;]</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4212-cÃ¡c-hÃ m-chuyá»ƒn-Ä‘á»•i-kiá»ƒu">4.2.1.2 CÃ¡c HÃ m Chuyá»ƒn Äá»•i Kiá»ƒu<a href="#4212-cÃ¡c-hÃ m-chuyá»ƒn-Ä‘á»•i-kiá»ƒu" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1.2 CÃ¡c HÃ m Chuyá»ƒn Äá»•i Kiá»ƒu" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 4.2.1.2 CÃ¡c HÃ m Chuyá»ƒn Äá»•i Kiá»ƒu">â€‹</a></h4><ul><li><code>ParseFloat()</code>: Chuyá»ƒn Ä‘á»•i má»™t sá»‘ nguyÃªn thÃ nh má»™t sá»‘ thá»±c (Ä‘iá»u nÃ y lÃ  cáº§n thiáº¿t vÃ¬ báº¥t ká»³ sá»‘ nÃ o Ä‘Æ°á»£c sá»­ dá»¥ng trong so sÃ¡nh pháº£i Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh sá»‘ thá»±c).</li><li><code>ToString()</code>: Chuyá»ƒn Ä‘á»•i má»™t Ä‘á»‘i tÆ°á»£ng thÃ nh má»™t chuá»—i. Äá»‘i tÆ°á»£ng nÃ y pháº£i cÃ³ má»™t kiá»ƒu cÆ¡ báº£n lÃ  chuá»—i (vÃ­ dá»¥, má»™t Ä‘á»‘i tÆ°á»£ng kiá»ƒu <code>XXX</code> khi cÃ³ má»™t cÃ¢u lá»‡nh <code>type XXX string</code>).</li><li>IsNil(): Tráº£ vá» liá»‡u tham sá»‘ cÃ³ pháº£i lÃ  nil hay khÃ´ng.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-cÃ i-Ä‘áº·t-nÃ¢ng-cao">5. CÃ i Ä‘áº·t NÃ¢ng cao<a href="#5-cÃ i-Ä‘áº·t-nÃ¢ng-cao" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 5. CÃ i Ä‘áº·t NÃ¢ng cao" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 5. CÃ i Ä‘áº·t NÃ¢ng cao">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-vá»-chá»©ng-chá»‰">5.1 Vá» Chá»©ng chá»‰<a href="#51-vá»-chá»©ng-chá»‰" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 5.1 Vá» Chá»©ng chá»‰" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 5.1 Vá» Chá»©ng chá»‰">â€‹</a></h3><p>Trong Kubernetes (k8s), báº¯t buá»™c pháº£i sá»­ dá»¥ng HTTPS cho má»™t webhook. CÃ³ hai cÃ¡ch tiáº¿p cáº­n Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y:</p><ul><li>Sá»­ dá»¥ng chá»©ng chá»‰ tá»± kÃ½ (cÃ¡c vÃ­ dá»¥ trong kho lÆ°u trá»¯ nÃ y sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p nÃ y)</li><li>Sá»­ dá»¥ng chá»©ng chá»‰ bÃ¬nh thÆ°á»ng</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="511-chá»©ng-chá»‰-tá»±-kÃ½">5.1.1 Chá»©ng chá»‰ tá»± kÃ½<a href="#511-chá»©ng-chá»‰-tá»±-kÃ½" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 5.1.1 Chá»©ng chá»‰ tá»± kÃ½" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 5.1.1 Chá»©ng chá»‰ tá»± kÃ½">â€‹</a></h4><p>Sá»­ dá»¥ng chá»©ng chá»‰ tá»± kÃ½ cÃ³ nghÄ©a lÃ  Tá»• chá»©c Chá»©ng chá»‰ (CA) cáº¥p chá»©ng chá»‰ khÃ´ng pháº£i lÃ  má»™t trong nhá»¯ng CA ná»•i tiáº¿ng. Do Ä‘Ã³, báº¡n pháº£i cho k8s biáº¿t vá» CA nÃ y.</p><p>Hiá»‡n táº¡i, vÃ­ dá»¥ trong kho lÆ°u trá»¯ nÃ y sá»­ dá»¥ng má»™t CA tá»± lÃ m, khÃ³a riÃªng vÃ  chá»©ng chá»‰ cá»§a nÃ³ Ä‘Æ°á»£c lÆ°u trá»¯ trong <code>config/certificate/ca.crt</code> vÃ  <code>config/certificate/ca.key</code> tÆ°Æ¡ng á»©ng. Chá»©ng chá»‰ cho webhook lÃ  <code>config/certificate/server.crt</code>, Ä‘Æ°á»£c cáº¥p bá»Ÿi CA tá»± lÃ m. CÃ¡c tÃªn miá»n cá»§a chá»©ng chá»‰ nÃ y lÃ  &quot;webhook.domain.local&quot; (cho webhook bÃªn ngoÃ i) vÃ  &quot;casbin-webhook-svc.default.svc&quot; (cho webhook ná»™i bá»™).</p><p>ThÃ´ng tin vá» CA Ä‘Æ°á»£c truyá»n cho k8s thÃ´ng qua cÃ¡c tá»‡p cáº¥u hÃ¬nh webhook. Cáº£ <code>config/webhook_external.yaml</code> vÃ  <code>config/webhook_internal.yaml</code> Ä‘á»u cÃ³ má»™t trÆ°á»ng gá»i lÃ  &quot;CABundle&quot;, chá»©a má»™t chuá»—i Ä‘Æ°á»£c mÃ£ hÃ³a base64 cá»§a chá»©ng chá»‰ CA.</p><p>Trong trÆ°á»ng há»£p báº¡n cáº§n thay Ä‘á»•i chá»©ng chá»‰/tÃªn miá»n (vÃ­ dá»¥, náº¿u báº¡n muá»‘n Ä‘áº·t webhook nÃ y vÃ o má»™t namespace khÃ¡c cá»§a k8s trong khi sá»­ dá»¥ng webhook ná»™i bá»™, hoáº·c náº¿u báº¡n muá»‘n thay Ä‘á»•i tÃªn miá»n trong khi sá»­ dá»¥ng webhook bÃªn ngoÃ i), cÃ¡c thá»§ tá»¥c sau Ä‘Ã¢y nÃªn Ä‘Æ°á»£c tuÃ¢n theo:</p><ol><li><p>Táº¡o má»™t CA má»›i:</p><ul><li><p>Táº¡o khÃ³a riÃªng cho CA giáº£:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out ca.key </span><span class="token number" style="color:#36acaa">2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>XÃ³a báº£o vá»‡ máº­t kháº©u cá»§a khÃ³a riÃªng:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in ca.key -out ca.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>Táº¡o má»™t khÃ³a riÃªng cho mÃ¡y chá»§ webhook:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -des3 -out server.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -in server.key -out server.key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Sá»­ dá»¥ng CA tá»± táº¡o Ä‘á»ƒ kÃ½ chá»©ng chá»‰ cho webhook:</p><ul><li><p>Sao chÃ©p tá»‡p cáº¥u hÃ¬nh openssl cá»§a há»‡ thá»‘ng cá»§a báº¡n Ä‘á»ƒ sá»­ dá»¥ng táº¡m thá»i. Báº¡n cÃ³ thá»ƒ tÃ¬m ra vá»‹ trÃ­ cá»§a tá»‡p cáº¥u hÃ¬nh báº±ng cÃ¡ch cháº¡y <code>openssl version -a</code>, thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <code>openssl.cnf</code>.</p></li><li><p>Trong tá»‡p cáº¥u hÃ¬nh:</p><ul><li><p>TÃ¬m Ä‘oáº¡n <code>[req]</code> vÃ  thÃªm dÃ²ng sau: <code>req_extensions = v3_req</code></p></li><li><p>TÃ¬m Ä‘oáº¡n <code>[v3_req]</code> vÃ  thÃªm dÃ²ng sau: <code>subjectAltName = @alt_names</code></p></li><li><p>Ná»‘i cÃ¡c dÃ²ng sau vÃ o tá»‡p:</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token section punctuation" style="color:#393A34">[</span><span class="token section section-name selector" style="color:#00009f">alt_names</span><span class="token section punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key attr-name" style="color:#00a4db">DNS.2</span><span class="token punctuation" style="color:#393A34">=</span><span class="token value attr-value" style="color:#e3116c">&lt;The domain you want&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>LÆ°u Ã½: Thay tháº¿ &#x27;casbin-webhook-svc.default.svc&#x27; báº±ng tÃªn dá»‹ch vá»¥ thá»±c táº¿ cá»§a dá»‹ch vá»¥ cá»§a báº¡n náº¿u báº¡n quyáº¿t Ä‘á»‹nh sá»­a Ä‘á»•i tÃªn dá»‹ch vá»¥.</p></li></ul></li><li><p>Sá»­ dá»¥ng tá»‡p cáº¥u hÃ¬nh Ä‘Ã£ sá»­a Ä‘á»•i Ä‘á»ƒ táº¡o tá»‡p yÃªu cáº§u chá»©ng chá»‰:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -nodes -keyout server.key -out server.csr -config openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Sá»­ dá»¥ng CA tá»± táº¡o Ä‘á»ƒ Ä‘Ã¡p á»©ng yÃªu cáº§u vÃ  kÃ½ chá»©ng chá»‰:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">3650</span><span class="token plain"> -in server.csr -out server.crt -CA ca.crt -CAkey ca.key -CAcreateserial -extensions v3_req -extensions SAN -extfile openssl.cnf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Sao chÃ©p mÃ£ vÃ o khay nhá»› táº¡m" title="Sao chÃ©p" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>Thay tháº¿ trÆ°á»ng &#x27;CABundle&#x27;: Cáº­p nháº­t trÆ°á»ng nÃ y vá»›i chá»©ng chá»‰ má»›i.</p></li><li><p>Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng helm, cáº§n Ã¡p dá»¥ng cÃ¡c thay Ä‘á»•i tÆ°Æ¡ng tá»± cho biá»ƒu Ä‘á»“ helm.</p></li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="512-chá»©ng-chá»‰-phÃ¡p-lÃ½">5.1.2 Chá»©ng chá»‰ phÃ¡p lÃ½<a href="#512-chá»©ng-chá»‰-phÃ¡p-lÃ½" class="hash-link" aria-label="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 5.1.2 Chá»©ng chá»‰ phÃ¡p lÃ½" title="ÄÆ°á»ng dáº«n trá»±c tiáº¿p Ä‘áº¿n 5.1.2 Chá»©ng chá»‰ phÃ¡p lÃ½">â€‹</a></h4><p>Náº¿u báº¡n sá»­ dá»¥ng chá»©ng chá»‰ phÃ¡p lÃ½, báº¡n khÃ´ng cáº§n pháº£i tráº£i qua táº¥t cáº£ cÃ¡c thá»§ tá»¥c nÃ y. XÃ³a trÆ°á»ng &quot;CABundle&quot; trong <code>config/webhook_external.yaml</code> vÃ  <code>config/webhook_internal.yaml</code>, vÃ  thay Ä‘á»•i tÃªn miá»n trong cÃ¡c tá»‡p nÃ y thÃ nh tÃªn miá»n mÃ  báº¡n sá»Ÿ há»¯u.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/casbin/casbin-website-v2/edit/master/docs/K8sGateKeeper.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Chá»‰nh sá»­a trang nÃ y</a> <a href="https://crowdin.com/project/casdoor-website/vi" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page" transurl="https://crowdin.com/project/casdoor-website/vi" style="margin-left:2rem"><svg fill="currentColor" height="20" width="20" viewBox="0 0 25 25" aria-hidden="true" style="margin-right:0.3em;vertical-align:sub"><path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Dá»‹ch trang nÃ y</a></div><div class="col lastUpdated_VsjB"><span>Created by</span><a href="https://github.com/ComradeProgrammer" target="_blank" rel="noreferrer"><img alt="ComradeProgrammer" src="https://avatars.githubusercontent.com/ComradeProgrammer" width="24px" style="border-radius:12px;vertical-align:sub;margin-left:4px">  <!-- -->ComradeProgrammer</a></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Trang tÃ i liá»‡u"><a class="pagination-nav__link pagination-nav__link--prev" href="/vi/docs/k8s"><div class="pagination-nav__sublabel">TrÆ°á»›c</div><div class="pagination-nav__label">Authorization of Kubernetes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/vi/docs/envoy"><div class="pagination-nav__sublabel">Tiáº¿p theo</div><div class="pagination-nav__label">Authorization of Service Mesh through Envoy</div></a></nav><br></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-tá»•ng-quan--tÃ i-liá»‡u-cho-casbin-k8s-gatekeeper" class="table-of-contents__link toc-highlight">1. Tá»•ng quan &amp; TÃ i liá»‡u cho Casbin K8s-Gatekeeper</a><ul><li><a href="#01-vÃ­-dá»¥-Ä‘Æ¡n-giáº£n" class="table-of-contents__link toc-highlight">0.1 VÃ­ dá»¥ ÄÆ¡n Giáº£n</a></li><li><a href="#11-cÃ¡ch-casbin-k8s-gatekeeper-hoáº¡t-Ä‘á»™ng" class="table-of-contents__link toc-highlight">1.1 CÃ¡ch Casbin K8s-Gatekeeper hoáº¡t Ä‘á»™ng?</a></li><li><a href="#12-má»™t-vÃ­-dá»¥-minh-há»a-cÃ¡ch-nÃ³-hoáº¡t-Ä‘á»™ng" class="table-of-contents__link toc-highlight">1.2 Má»™t VÃ­ Dá»¥ Minh Há»a CÃ¡ch NÃ³ Hoáº¡t Äá»™ng</a></li></ul></li><li><a href="#2-cÃ i-Ä‘áº·t-k8s-gatekeeper" class="table-of-contents__link toc-highlight">2 CÃ i Ä‘áº·t K8s-gatekeeper</a><ul><li><a href="#21-webhook-ná»™i-bá»™" class="table-of-contents__link toc-highlight">2.1 Webhook ná»™i bá»™</a></li><li><a href="#22-webhook-bÃªn-ngoÃ i" class="table-of-contents__link toc-highlight">2.2 Webhook bÃªn ngoÃ i</a></li><li><a href="#231-bÆ°á»›c-1-xÃ¢y-dá»±ng-hÃ¬nh-áº£nh" class="table-of-contents__link toc-highlight">2.3.1 BÆ°á»›c 1: XÃ¢y dá»±ng hÃ¬nh áº£nh</a></li></ul></li><li><a href="#3-thá»­-k8s-gatekeeper" class="table-of-contents__link toc-highlight">3. Thá»­ K8s-gatekeeper</a><ul><li><a href="#31-táº¡o-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-casbin" class="table-of-contents__link toc-highlight">3.1 Táº¡o MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch Casbin</a></li><li><a href="#312-thá»­-xem-k8s-gatekeeper-cÃ³-hoáº¡t-Ä‘á»™ng-khÃ´ng" class="table-of-contents__link toc-highlight">3.1.2 Thá»­ xem K8s-gatekeeper cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng</a></li></ul></li><li><a href="#4-cÃ¡ch-viáº¿t-mÃ´-hÃ¬nh-vÃ -chÃ­nh-sÃ¡ch-vá»›i-k8s-gatekeeper" class="table-of-contents__link toc-highlight">4. CÃ¡ch Viáº¿t MÃ´ hÃ¬nh vÃ  ChÃ­nh sÃ¡ch vá»›i K8s-gatekeeper</a><ul><li><a href="#41-Ä‘á»‹nh-nghÄ©a-yÃªu-cáº§u-cá»§a-mÃ´-hÃ¬nh" class="table-of-contents__link toc-highlight">4.1 Äá»‹nh nghÄ©a YÃªu cáº§u cá»§a MÃ´ hÃ¬nh</a></li><li><a href="#42-matchers-cá»§a-mÃ´-hÃ¬nh" class="table-of-contents__link toc-highlight">4.2 Matchers cá»§a MÃ´ hÃ¬nh</a></li><li><a href="#421-cÃ¡c-hÃ m-má»Ÿ-rá»™ng" class="table-of-contents__link toc-highlight">4.2.1 CÃ¡c hÃ m má»Ÿ rá»™ng</a></li><li><a href="#4213-cÃ¡c-hÃ m-há»—-trá»£-Ä‘á»‘i-sá»‘-cÃ³-Ä‘á»™-dÃ i-biáº¿n-Ä‘á»•i" class="table-of-contents__link toc-highlight">4.2.1.3 CÃ¡c hÃ m há»— trá»£ Ä‘á»‘i sá»‘ cÃ³ Ä‘á»™ dÃ i biáº¿n Ä‘á»•i</a></li></ul></li><li><a href="#5-cÃ i-Ä‘áº·t-nÃ¢ng-cao" class="table-of-contents__link toc-highlight">5. CÃ i Ä‘áº·t NÃ¢ng cao</a><ul><li><a href="#51-vá»-chá»©ng-chá»‰" class="table-of-contents__link toc-highlight">5.1 Vá» Chá»©ng chá»‰</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">TÃ i liá»‡u</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/vi/docs/get-started">Báº¯t Ä‘áº§u</a></li><li class="footer__item"><a class="footer__link-item" href="/vi/docs/management-api">API Quáº£n lÃ½</a></li><li class="footer__item"><a class="footer__link-item" href="/vi/docs/rbac-api">API RBAC</a></li><li class="footer__item"><a class="footer__link-item" href="/vi/docs/middlewares">Middlewares</a></li></ul></div><div class="col footer__col"><div class="footer__title">Cá»™ng Ä‘á»“ng</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://forum.casbin.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Diá»…n Ä‘Ã n<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/search?q=casbin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/S5UjpzGZjN" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://cdn.casdoor.com/casdoor/resource/built-in/admin/qq_casbin.png" target="_blank" rel="noopener noreferrer" class="footer__link-item">NhÃ³m QQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">ThÃªm</div><ul class="footer__items clean-list"><li class="footer__item">
                <a href="https://github.com/casbin/casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin?label=Casbin&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/jcasbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/jcasbin?label=jCasbin&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/node-casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/node-casbin?label=Node-Casbin&style=social">
                </a>
                &nbsp;&nbsp;
                <a href="https://github.com/php-casbin/php-casbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/php-casbin/php-casbin?label=PHP-Casbin&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/pycasbin" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/pycasbin?label=PyCasbin&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/Casbin.NET" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/Casbin.NET?label=Casbin.NET&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://github.com/casbin/casbin-cpp" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin-cpp?label=Casbin-CPP&style=social">
                </a>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <a href="https://github.com/casbin/casbin-rs" target="_blank">
                  <img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/casbin/casbin-rs?label=Casbin-RS&style=social">
                </a>
              </li><li class="footer__item">
                <a href="https://twitter.com/casbinHQ" target="_blank">
                  <img alt="Twitter Follow" src="https://img.shields.io/twitter/follow/casbinHQ?style=social">
                </a>
              </li><li class="footer__item">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?2c0ffc6f8d49e98d964d59d7aa4cbf34";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
</li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/vi/"><img src="/vi/img/casbin_min.svg" alt="Logo Casbin" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/vi/img/casbin_min.svg" alt="Logo Casbin" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2025 Casbin Organization</div></div></div></footer></div>
<script src="/vi/assets/js/runtime~main.ebfab582.js"></script>
<script src="/vi/assets/js/main.235bfe67.js"></script>
</body>
</html>