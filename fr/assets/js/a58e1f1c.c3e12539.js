"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[178],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=i.createContext({}),u=function(e){var t=i.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return i.createElement(o.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),m=r,f=c["".concat(o,".").concat(m)]||c[m]||d[m]||a;return n?i.createElement(f,s(s({ref:t},p),{},{components:n})):i.createElement(f,s({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,s=new Array(a);s[0]=c;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:r,s[1]=l;for(var u=2;u<a;u++)s[u]=n[u];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},4391:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var i=n(7462),r=(n(7294),n(3905));const a={id:"rbac",title:"RBAC",description:"Utilisation de Casbin RBAC",keywords:["RBAC","role definition","role hierarchy"],authors:["hsluoyz"]},s=void 0,l={unversionedId:"rbac",id:"rbac",title:"RBAC",description:"Utilisation de Casbin RBAC",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/RBAC.mdx",sourceDirName:".",slug:"/rbac",permalink:"/fr/docs/rbac",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBAC.mdx",tags:[],version:"current",frontMatter:{id:"rbac",title:"RBAC",description:"Utilisation de Casbin RBAC",keywords:["RBAC","role definition","role hierarchy"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Functions",permalink:"/fr/docs/function"},next:{title:"RBAC with Pattern",permalink:"/fr/docs/rbac-with-pattern"}},o={},u=[{value:"D\xe9finition du r\xf4le",id:"d\xe9finition-du-r\xf4le",level:2},{value:"Hi\xe9rarchie des r\xf4les",id:"hi\xe9rarchie-des-r\xf4les",level:2},{value:"Comment distinguer le r\xf4le de l&#39;utilisateur ?",id:"comment-distinguer-le-r\xf4le-de-lutilisateur-",level:2},{value:"Comment interroger les r\xf4les ou les permissions implicites ?",id:"comment-interroger-les-r\xf4les-ou-les-permissions-implicites-",level:2},{value:"Utilisation de la correspondance de motifs dans RBAC",id:"utilisation-de-la-correspondance-de-motifs-dans-rbac",level:2},{value:"Gestionnaire de r\xf4les",id:"gestionnaire-de-r\xf4les",level:2}],p={toc:u};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"d\xe9finition-du-r\xf4le"},"D\xe9finition du r\xf4le"),(0,r.kt)("p",null,"Le ",(0,r.kt)("inlineCode",{parentName:"p"},"[role_definition]")," est utilis\xe9 pour d\xe9finir les relations d'h\xe9ritage de r\xf4le RBAC. Casbin prend en charge plusieurs instances de syst\xe8mes RBAC, o\xf9 les utilisateurs peuvent avoir des r\xf4les et leurs relations d'h\xe9ritage, et les ressources peuvent \xe9galement avoir des r\xf4les et leurs relations d'h\xe9ritage. Ces deux syst\xe8mes RBAC ne se g\xeaneront pas mutuellement."),(0,r.kt)("p",null,"Cette section est facultative. Si vous n'utilisez pas de r\xf4les RBAC dans le mod\xe8le, alors omettez cette section."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"[role_definition]\ng = _, _\ng2 = _, _\n")),(0,r.kt)("p",null,"La d\xe9finition de r\xf4le ci-dessus montre que ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," est un syst\xe8me RBAC, et ",(0,r.kt)("inlineCode",{parentName:"p"},"g2")," est un autre syst\xe8me RBAC. ",(0,r.kt)("inlineCode",{parentName:"p"},"_,_")," signifie qu'il y a deux parties impliqu\xe9es dans une relation d'h\xe9ritage. Dans le cas le plus courant, vous utilisez g\xe9n\xe9ralement ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," seul si vous n'avez besoin de r\xf4les que pour les utilisateurs. Vous pouvez \xe9galement utiliser \xe0 la fois ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"g2")," lorsque vous avez besoin de r\xf4les (ou de groupes) \xe0 la fois pour les utilisateurs et les ressources. Veuillez voir les ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_model.conf"},"rbac","_","model.conf")," et ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_with_resource_roles_model.conf"},"rbac","_","model","_","with","_","resource","_","roles.conf")," pour des exemples."),(0,r.kt)("p",null,"Casbin stocke la cartographie r\xe9elle utilisateur-r\xf4le (ou la cartographie ressource-r\xf4le si vous utilisez des r\xf4les sur les ressources) dans la politique. Par exemple :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csv"},"p, data2_admin, data2, read\ng, alice, data2_admin\n")),(0,r.kt)("p",null,"Cela signifie que ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," h\xe9rite/est membre du r\xf4le ",(0,r.kt)("inlineCode",{parentName:"p"},"data2_admin"),". Ici, ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," peut \xeatre un utilisateur, une ressource, ou un r\xf4le. Casbin ne le reconna\xeet que comme une cha\xeene."),(0,r.kt)("p",null,"Ensuite, dans un comparateur, vous devriez v\xe9rifier le r\xf4le comme indiqu\xe9 ci-dessous :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act\n")),(0,r.kt)("p",null,"Cela signifie que le ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," dans la requ\xeate devrait avoir le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," dans la politique."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"Casbin ne stocke que la cartographie utilisateur-r\xf4le."),(0,r.kt)("li",{parentName:"ol"},"Casbin ne v\xe9rifie pas si un utilisateur est un utilisateur valide ou si un r\xf4le est un r\xf4le valide. Cela devrait \xeatre pris en charge par l'authentification."),(0,r.kt)("li",{parentName:"ol"},"N'utilisez pas le m\xeame nom pour un utilisateur et un r\xf4le \xe0 l'int\xe9rieur d'un syst\xe8me RBAC, car Casbin reconna\xeet les utilisateurs et les r\xf4les comme des cha\xeenes, et il n'y a aucun moyen pour Casbin de savoir si vous sp\xe9cifiez l'utilisateur ",(0,r.kt)("inlineCode",{parentName:"li"},"alice")," ou le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"li"},"alice"),". Vous pouvez simplement le r\xe9soudre en utilisant ",(0,r.kt)("inlineCode",{parentName:"li"},"role_alice"),"."),(0,r.kt)("li",{parentName:"ol"},"Si ",(0,r.kt)("inlineCode",{parentName:"li"},"A")," a le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"li"},"B"),", et ",(0,r.kt)("inlineCode",{parentName:"li"},"B")," a le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"li"},"C"),", alors ",(0,r.kt)("inlineCode",{parentName:"li"},"A")," a le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"li"},"C"),". Cette transitivit\xe9 est infinie pour l'instant."))),(0,r.kt)("admonition",{title:"Convention de nom de jeton",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Conventionnellement, le nom du jeton sujet dans la d\xe9finition de la politique est ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," et plac\xe9 au d\xe9but. Maintenant, Golang Casbin prend en charge les noms de jetons personnalis\xe9s et les places. Si le nom du jeton sujet est ",(0,r.kt)("inlineCode",{parentName:"p"},"sub"),", le jeton sujet peut \xeatre plac\xe9 \xe0 un endroit arbitraire sans aucune action suppl\xe9mentaire n\xe9cessaire. Si le nom du jeton de sujet n'est pas ",(0,r.kt)("inlineCode",{parentName:"p"},"sub"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"e.SetFieldIndex()")," pour ",(0,r.kt)("inlineCode",{parentName:"p"},"constant.SubjectIndex")," doit \xeatre appel\xe9 apr\xe8s l'initialisation de l'ex\xe9cuteur, quelle que soit sa position."),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"# `subject` here is for sub\n[policy_definition]\np =  obj, act, subject\n")),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-go"},'e.SetFieldIndex("p", constant.SubjectIndex, 2) // index starts from 0\nok, err := e.DeleteUser("alice") // without SetFieldIndex, it will raise an error\n'))),(0,r.kt)("h2",{id:"hi\xe9rarchie-des-r\xf4les"},"Hi\xe9rarchie des r\xf4les"),(0,r.kt)("p",null,"Le RBAC de Casbin prend en charge la fonctionnalit\xe9 de hi\xe9rarchie des r\xf4les de RBAC1, ce qui signifie que si ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," a ",(0,r.kt)("inlineCode",{parentName:"p"},"role1"),", et ",(0,r.kt)("inlineCode",{parentName:"p"},"role1")," a ",(0,r.kt)("inlineCode",{parentName:"p"},"role2"),", alors ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," aura \xe9galement ",(0,r.kt)("inlineCode",{parentName:"p"},"role2")," et h\xe9ritera de ses permissions."),(0,r.kt)("p",null,"Ici, nous avons un concept appel\xe9 niveau de hi\xe9rarchie. Donc, dans cet exemple, le niveau de hi\xe9rarchie est 2. Pour le gestionnaire de r\xf4les int\xe9gr\xe9 dans Casbin, vous pouvez sp\xe9cifier le niveau de hi\xe9rarchie maximum. La valeur par d\xe9faut est 10. Cela signifie qu'un utilisateur final comme ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," ne peut h\xe9riter que de 10 niveaux de r\xf4les."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},"// NewRoleManager is the constructor for creating an instance of the\n// default RoleManager implementation.\nfunc NewRoleManager(maxHierarchyLevel int) rbac.RoleManager {\n    rm := RoleManager{}\n    rm.allRoles = &sync.Map{}\n    rm.maxHierarchyLevel = maxHierarchyLevel\n    rm.hasPattern = false\n\n    return &rm\n}\n")),(0,r.kt)("h2",{id:"comment-distinguer-le-r\xf4le-de-lutilisateur-"},"Comment distinguer le r\xf4le de l'utilisateur ?"),(0,r.kt)("p",null,"Casbin ne fait pas de distinction entre les r\xf4les et les utilisateurs dans son RBAC. Ils sont tous deux trait\xe9s comme des cha\xeenes de caract\xe8res. Si vous n'utilisez qu'un RBAC \xe0 un seul niveau (o\xf9 un r\xf4le ne sera jamais membre d'un autre r\xf4le), vous pouvez utiliser ",(0,r.kt)("inlineCode",{parentName:"p"},"e.GetAllSubjects()")," pour obtenir tous les utilisateurs et ",(0,r.kt)("inlineCode",{parentName:"p"},"e.GetAllRoles()")," pour obtenir tous les r\xf4les. Ils listeront tous les ",(0,r.kt)("inlineCode",{parentName:"p"},"u")," et tous les ",(0,r.kt)("inlineCode",{parentName:"p"},"r"),", respectivement, dans toutes les r\xe8gles ",(0,r.kt)("inlineCode",{parentName:"p"},"g, u, r"),"."),(0,r.kt)("p",null,"Mais si vous utilisez un RBAC \xe0 plusieurs niveaux (avec hi\xe9rarchie des r\xf4les) et que votre application n'enregistre pas si un nom (cha\xeene) est un utilisateur ou un r\xf4le, ou si vous avez un utilisateur et un r\xf4le avec le m\xeame nom, vous pouvez ajouter un pr\xe9fixe au r\xf4le comme ",(0,r.kt)("inlineCode",{parentName:"p"},"role::admin")," avant de le passer \xe0 Casbin. De cette fa\xe7on, vous saurez si c'est un r\xf4le en v\xe9rifiant ce pr\xe9fixe."),(0,r.kt)("h2",{id:"comment-interroger-les-r\xf4les-ou-les-permissions-implicites-"},"Comment interroger les r\xf4les ou les permissions implicites ?"),(0,r.kt)("p",null,"Lorsqu'un utilisateur h\xe9rite d'un r\xf4le ou d'une permission via la hi\xe9rarchie RBAC au lieu de se les voir attribuer directement dans une r\xe8gle de politique, nous appelons ce type d'attribution \"implicite\". Pour interroger de telles relations implicites, vous devez utiliser ces deux API : ",(0,r.kt)("inlineCode",{parentName:"p"},"GetImplicitRolesForUser()")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"GetImplicitPermissionsForUser()")," au lieu de ",(0,r.kt)("inlineCode",{parentName:"p"},"GetRolesForUser()")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"GetPermissionsForUser()"),". Pour plus de d\xe9tails, veuillez consulter ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/issues/137"},"cette question GitHub"),"."),(0,r.kt)("h2",{id:"utilisation-de-la-correspondance-de-motifs-dans-rbac"},"Utilisation de la correspondance de motifs dans RBAC"),(0,r.kt)("p",null,"Voir ",(0,r.kt)("a",{parentName:"p",href:"/docs/rbac-with-pattern"},"RBAC avec motif")),(0,r.kt)("h2",{id:"gestionnaire-de-r\xf4les"},"Gestionnaire de r\xf4les"),(0,r.kt)("p",null,"Voir la section ",(0,r.kt)("a",{parentName:"p",href:"/docs/role-managers"},"Gestionnaires de r\xf4les")," pour plus de d\xe9tails."))}d.isMDXComponent=!0}}]);