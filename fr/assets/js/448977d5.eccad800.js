"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[1],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return m}});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var u=a.createContext({}),s=function(e){var n=a.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=s(e.components);return a.createElement(u.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,u=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=s(t),m=r,f=p["".concat(u,".").concat(m)]||p[m]||d[m]||i;return t?a.createElement(f,o(o({ref:n},c),{},{components:t})):a.createElement(f,o({ref:n},c))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=p;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=t[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},5162:function(e,n,t){t.d(n,{Z:function(){return o}});var a=t(7294),r=t(6010),i="tabItem_Ymn6";function o(e){var n=e.children,t=e.hidden,o=e.className;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(i,o),hidden:t},n)}},5488:function(e,n,t){t.d(n,{Z:function(){return m}});var a=t(3117),r=t(7294),i=t(6010),o=t(2389),l=t(7392),u=t(7094),s=t(2466),c="tabList__CuJ",d="tabItem_LNqP";function p(e){var n,t,o=e.lazy,p=e.block,m=e.defaultValue,f=e.values,v=e.groupId,b=e.className,k=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),g=null!=f?f:k.map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes}})),h=(0,l.l)(g,(function(e,n){return e.value===n.value}));if(h.length>0)throw new Error('Docusaurus error: Duplicate values "'+h.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var N=null===m?m:null!=(n=null!=m?m:null==(t=k.find((function(e){return e.props.default})))?void 0:t.props.value)?n:k[0].props.value;if(null!==N&&!g.some((function(e){return e.value===N})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+N+'" but none of its children has the corresponding value. Available values are: '+g.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var y=(0,u.U)(),w=y.tabGroupChoices,C=y.setTabGroupChoices,x=(0,r.useState)(N),T=x[0],q=x[1],O=[],E=(0,s.o5)().blockElementScrollPositionUntilNextRender;if(null!=v){var M=w[v];null!=M&&M!==T&&g.some((function(e){return e.value===M}))&&q(M)}var j=function(e){var n=e.currentTarget,t=O.indexOf(n),a=g[t].value;a!==T&&(E(n),q(a),null!=v&&C(v,String(a)))},A=function(e){var n,t=null;switch(e.key){case"ArrowRight":var a,r=O.indexOf(e.currentTarget)+1;t=null!=(a=O[r])?a:O[0];break;case"ArrowLeft":var i,o=O.indexOf(e.currentTarget)-1;t=null!=(i=O[o])?i:O[O.length-1]}null==(n=t)||n.focus()};return r.createElement("div",{className:(0,i.Z)("tabs-container",c)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":p},b)},g.map((function(e){var n=e.value,t=e.label,o=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:T===n?0:-1,"aria-selected":T===n,key:n,ref:function(e){return O.push(e)},onKeyDown:A,onFocus:j,onClick:j},o,{className:(0,i.Z)("tabs__item",d,null==o?void 0:o.className,{"tabs__item--active":T===n})}),null!=t?t:n)}))),o?(0,r.cloneElement)(k.filter((function(e){return e.props.value===T}))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},k.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==T})}))))}function m(e){var n=(0,o.Z)();return r.createElement(p,(0,a.Z)({key:String(n)},e))}},2452:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return c},default:function(){return v},frontMatter:function(){return s},metadata:function(){return d},toc:function(){return m}});var a=t(3117),r=t(102),i=(t(7294),t(3905)),o=t(5488),l=t(5162),u=["components"],s={id:"rbac-with-pattern",title:"RBAC avec motif"},c=void 0,d={unversionedId:"rbac-with-pattern",id:"rbac-with-pattern",title:"RBAC avec motif",description:"D\xe9marrage rapide",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/RBACWithPattern.mdx",sourceDirName:".",slug:"/rbac-with-pattern",permalink:"/fr/docs/rbac-with-pattern",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBACWithPattern.mdx",tags:[],version:"current",frontMatter:{id:"rbac-with-pattern",title:"RBAC avec motif"},sidebar:"docs",previous:{title:"RBAC",permalink:"/fr/docs/rbac"},next:{title:"RBAC avec domaines",permalink:"/fr/docs/rbac-with-domains"}},p={},m=[{value:"D\xe9marrage rapide",id:"d\xe9marrage-rapide",level:2},{value:"Utiliser la correspondance de motif dans RBAC",id:"utiliser-la-correspondance-de-motif-dans-rbac",level:2}],f={toc:m};function v(e){var n=e.components,s=(0,r.Z)(e,u);return(0,i.kt)("wrapper",(0,a.Z)({},f,s,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"d\xe9marrage-rapide"},"D\xe9marrage rapide"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"utiliser le mod\xe8le dans ",(0,i.kt)("inlineCode",{parentName:"p"},"g(_,_)")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},'e, _ := NewEnforcer("./example.conf", "./example.csv")\ne.AddNamedMatchingFunc("g","KeyMatch2",util.KeyMatch2)\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"utiliser le mod\xe8le avec le domaine"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedDomainMatchingFunc("g","KeyMatch2",util.KeyMatch2)\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"utiliser tous les mod\xe8les"),(0,i.kt)("p",{parentName:"li"},"juste l'utilisation combin\xe9e de deux API"))),(0,i.kt)("p",null,"Comme indiqu\xe9 ci-dessus, apr\xe8s que vous ayez cr\xe9\xe9 l'instance ",(0,i.kt)("inlineCode",{parentName:"p"},"de contr\xf4le")," vous devez activer le pattern matching via ",(0,i.kt)("inlineCode",{parentName:"p"},"AddNamedMatchingFunc")," et ",(0,i.kt)("inlineCode",{parentName:"p"},"AddNamedMatchingFunc")," API, qui d\xe9terminent la fa\xe7on dont le masque correspond."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Si vous utilisez l'\xe9diteur en ligne, il sp\xe9cifie la fonction de recherche de motifs dans le coin inf\xe9rieur gauche. ",(0,i.kt)("img",{alt:"conseils-\xe9diteur",src:t(9523).Z,width:"480",height:"272"})))),(0,i.kt)("h2",{id:"utiliser-la-correspondance-de-motif-dans-rbac"},"Utiliser la correspondance de motif dans RBAC"),(0,i.kt)("p",null,"Parfois, vous voulez que certains sujets, objets ou domaines/locataires avec le mod\xe8le sp\xe9cifique soient automatiquement attribu\xe9s \xe0 un r\xf4le. Les fonctions de masquage dans RBAC peuvent vous aider \xe0 le faire. Une fonction de correspondance de patron partage les m\xeames param\xe8tres et la m\xeame valeur de retour que la fonction de recherche ",(0,i.kt)("a",{parentName:"p",href:"/docs/syntax-for-models#functions-in-matchers"},"pr\xe9c\xe9dente"),"."),(0,i.kt)("p",null,"La fonction de recherche de motifs supporte chaque param\xe8tre de g."),(0,i.kt)("p",null,"Nous savons que normalement RBAC est exprim\xe9 comme ",(0,i.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub)")," dans le matcher. Ensuite, nous utiliserons une politique comme:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"p, alice, book_group, read\ng, /book/1, book_group\ng, /book/2, book_group\n")),(0,i.kt)("p",null,"Ainsi, ",(0,i.kt)("inlineCode",{parentName:"p"},"alice")," peut lire tous les livres y compris le ",(0,i.kt)("inlineCode",{parentName:"p"},"livre 1")," et ",(0,i.kt)("inlineCode",{parentName:"p"},"livre 2"),". Mais il peut y avoir des milliers de livres et il est tr\xe8s ennuyeux d'ajouter chaque livre au r\xf4le (ou groupe) du livre avec une r\xe8gle de politique ",(0,i.kt)("inlineCode",{parentName:"p"},"g"),"."),(0,i.kt)("p",null,"Mais avec les fonctions de recherche de masques, vous pouvez \xe9crire la politique avec une seule ligne :"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"g, /book/:id, book_group\n")),(0,i.kt)("p",null,"Casbin fera automatiquement correspondre ",(0,i.kt)("inlineCode",{parentName:"p"},"/book/1")," et ",(0,i.kt)("inlineCode",{parentName:"p"},"/book/2")," dans le patron ",(0,i.kt)("inlineCode",{parentName:"p"},"/book/:id")," pour vous. Vous devez seulement enregistrer la fonction avec le responsable comme :"),(0,i.kt)(o.Z,{mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedMatchingFunc("g","KeyMatch2",util.KeyMatch2)\n'))),(0,i.kt)(l.Z,{value:"Node.js",label:"Node.js",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"await e.addNamedMatchingFunc('g', Util.keyMatch2Func);\n")))),(0,i.kt)("p",null,"Lorsque vous utilisez une fonction de masquage dans les domaines/locataires, vous devez enregistrer la fonction pour la faire fonctionner et la mod\xe9liser."),(0,i.kt)(o.Z,{mdxType:"Tabs"},(0,i.kt)(l.Z,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedDomainMatchingFunc("g","KeyMatch2",util.KeyMatch2)\n'))),(0,i.kt)(l.Z,{value:"Node.js",label:"Node.js",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"await e.addNamedDomainMatchingFunc('g', Util.keyMatch2Func);\n")))),(0,i.kt)("p",null,"Si vous ne comprenez pas ce que signifie ",(0,i.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub, r.dom)")," , veuillez lire ",(0,i.kt)("a",{parentName:"p",href:"/docs/rbac-with-domains"},"rbac-with-domains"),". En bref, ",(0,i.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub, r.dom)")," v\xe9rifiera si l'utilisateur ",(0,i.kt)("inlineCode",{parentName:"p"},"r. ub")," a un r\xf4le ",(0,i.kt)("inlineCode",{parentName:"p"},"p.sub")," dans le domaine ",(0,i.kt)("inlineCode",{parentName:"p"},"r.dom"),". Voil\xe0 donc comment fonctionne le matcher. Vous pouvez voir l'exemple complet ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/dbdb6cbe2e7a80863e4951f9ff36da07fef01b75/model_test.go#L278-L307"},"ici"),"."),(0,i.kt)("p",null,"En dehors de la syntaxe de masques correspondant \xe0 la syntaxe ci-dessus, nous pouvons \xe9galement utiliser un motif de domaine pur."),(0,i.kt)("p",null,"Par exemple, si nous voulons que ",(0,i.kt)("inlineCode",{parentName:"p"},"sous")," ait acc\xe8s dans diff\xe9rents domaines, ",(0,i.kt)("inlineCode",{parentName:"p"},"domain1")," et ",(0,i.kt)("inlineCode",{parentName:"p"},"domain2"),", nous pouvons utiliser le mod\xe8le de domaine pur :"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"p, admin, domain1, data1, read\np, admin, domain1, data1, write\np, admin, domain2, data2, read\np, admin, domain2, data2, write\n\ng, alice, admin, *\ng, bob, admin, domain2\n")),(0,i.kt)("p",null,"Dans cet exemple, nous voulons que ",(0,i.kt)("inlineCode",{parentName:"p"},"alice")," lise et \xe9crive des donn\xe9es `",(0,i.kt)("inlineCode",{parentName:"p"},"dans les domaines 1 et 2, le masque correspondant \xe0"),"*",(0,i.kt)("inlineCode",{parentName:"p"},"dans"),"g",(0,i.kt)("inlineCode",{parentName:"p"},"fait"),"alice` ont acc\xe8s \xe0 deux domaines."),(0,i.kt)("p",null,"En utilisant le masque de correspondance, surtout dans les sc\xe9narios qui sont plus compliqu\xe9s et il y a beaucoup de domaines ou d'objets que nous devons prendre en consid\xe9ration, nous pouvons impl\xe9menter la ",(0,i.kt)("inlineCode",{parentName:"p"},"policy_definition")," plus \xe9l\xe9gante et efficace."))}v.isMDXComponent=!0},9523:function(e,n,t){n.Z=t.p+"assets/images/editor-tips-4f3fd45a1ea048f308e3e31da355ff79.png"}}]);