"use strict";(globalThis.webpackChunkcasbin_website_v2=globalThis.webpackChunkcasbin_website_v2||[]).push([[9347],{1698:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"frontend","title":"Frontend Usage","description":"Casbin.js est un addon Casbin qui facilite la gestion de votre contr\xf4le d\'acc\xe8s dans l\'application frontend","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/FrontendUsage.mdx","sourceDirName":".","slug":"/frontend","permalink":"/fr/docs/frontend","draft":false,"unlisted":false,"editUrl":"https://github.com/casbin/casbin-website-v2/edit/master/docs/FrontendUsage.mdx","tags":[],"version":"current","frontMatter":{"id":"frontend","title":"Frontend Usage","description":"Casbin.js est un addon Casbin qui facilite la gestion de votre contr\xf4le d\'acc\xe8s dans l\'application frontend","keywords":["Casbin.js","react-authz","rbac-react","vue-authz","angular-authz"],"authors":["hsluoyz"]},"sidebar":"docs","previous":{"title":"Log & Error Handling","permalink":"/fr/docs/log-error"},"next":{"title":"Editor","permalink":"/fr/docs/category/editor"}}');var t=s(4848),r=s(8453);const a={id:"frontend",title:"Frontend Usage",description:"Casbin.js est un addon Casbin qui facilite la gestion de votre contr\xf4le d'acc\xe8s dans l'application frontend",keywords:["Casbin.js","react-authz","rbac-react","vue-authz","angular-authz"],authors:["hsluoyz"]},o=void 0,c={},l=[{value:"Installation",id:"installation",level:2},{value:"Middlewares Frontend",id:"middlewares-frontend",level:2},{value:"D\xe9marrage rapide",id:"d\xe9marrage-rapide",level:2},{value:"Objet de permission",id:"objet-de-permission",level:3},{value:"Utilisation avanc\xe9e",id:"utilisation-avanc\xe9e",level:2},{value:"Liste des API",id:"liste-des-api",level:2},{value:"<code>setPermission(permission: string)</code>",id:"setpermissionpermission-string",level:3},{value:"<code>setUser(user: string)</code>",id:"setuseruser-string",level:3},{value:"<code>can(action: string, object: string)</code>",id:"canaction-string-object-string",level:3},{value:"<code>cannot(action: string, object: string)</code>",id:"cannotaction-string-object-string",level:3},{value:"<code>canAll(action: string, objects: Array&lt;object&gt;)</code>",id:"canallaction-string-objects-arrayobject",level:3},{value:"<code>canAny(action: string, objects: Array&lt;object&gt;)</code>",id:"cananyaction-string-objects-arrayobject",level:3},{value:"Pourquoi Casbin.js",id:"pourquoi-casbinjs",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://github.com/casbin/casbin.js",children:"Casbin.js"})," est un addon Casbin qui facilite la gestion de votre contr\xf4le d'acc\xe8s dans l'application frontend."]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm install casbin.js\nnpm install casbin\n"})}),"\n",(0,t.jsx)(n.p,{children:"ou"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"yarn add casbin.js\n"})}),"\n",(0,t.jsx)(n.h2,{id:"middlewares-frontend",children:"Middlewares Frontend"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Middleware"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Auteur"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://github.com/casbin-js/react-authz",children:"react-authz"})}),(0,t.jsx)(n.td,{children:"React"}),(0,t.jsx)(n.td,{children:"Casbin"}),(0,t.jsx)(n.td,{children:"Enveloppe React pour Casbin.js"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://github.com/daobeng/rbac-react",children:"rbac-react"})}),(0,t.jsx)(n.td,{children:"React"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://github.com/daobeng",children:"@daobeng"})}),(0,t.jsx)(n.td,{children:"Contr\xf4le d'acc\xe8s bas\xe9 sur les r\xf4les dans React en utilisant HOCs, CASL et Casbin.js"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://github.com/casbin-js/vue-authz",children:"vue-authz"})}),(0,t.jsx)(n.td,{children:"Vue"}),(0,t.jsx)(n.td,{children:"Casbin"}),(0,t.jsx)(n.td,{children:"Enveloppe Vue pour Casbin.js"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"https://github.com/casbin-js/angular-authz",children:"angular-authz"})}),(0,t.jsx)(n.td,{children:"Angular"}),(0,t.jsx)(n.td,{children:"Casbin"}),(0,t.jsx)(n.td,{children:"Enveloppe Angular pour Casbin.js"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"d\xe9marrage-rapide",children:"D\xe9marrage rapide"}),"\n",(0,t.jsxs)(n.p,{children:["Vous pouvez utiliser le mode ",(0,t.jsx)(n.code,{children:"manuel"})," dans votre application frontend et d\xe9finir les permissions quand vous le souhaitez."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:'const casbinjs = require("casbin.js");\n// Set the user\'s permission:\n// He/She can read `data1` and `data2` objects and can write `data1` object\nconst permission = {\n    "read": ["data1", "data2"],\n    "write": ["data1"]\n}\n\n// Run casbin.js in manual mode, which requires you to set the permission manually.\nconst authorizer = new casbinjs.Authorizer("manual");\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Nous avons maintenant un authorizer, ",(0,t.jsx)(n.code,{children:"authorizer"}),". Nous pouvons obtenir des r\xe8gles de permission de celui-ci en utilisant les APIs ",(0,t.jsx)(n.code,{children:"authorizer.can()"})," et ",(0,t.jsx)(n.code,{children:"authorizer.cannot()"}),". Les valeurs de retour de ces 2 APIs sont des Promesses JavaScript (",(0,t.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises",children:"d\xe9tails ici"}),"), nous devrions donc utiliser la m\xe9thode ",(0,t.jsx)(n.code,{children:"then()"})," de la valeur de retour comme ceci:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:'result = authorizer.can("write", "data1");\nresult.then((success, failed) => {\n    if (success) {\n        console.log("you can write data1");\n    } else {\n        console.log("you cannot write data1");\n    }\n});\n// output: you can write data1\n'})}),"\n",(0,t.jsxs)(n.p,{children:["L'API ",(0,t.jsx)(n.code,{children:"cannot()"})," est utilis\xe9e de la m\xeame mani\xe8re :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:'result = authorizer.cannot("read", "data2");\nresult.then((success, failed) => {\n    if (success) {\n        console.log("you cannot read data2");\n    } else {\n        console.log("you can read data2");\n    }\n});\n// output: you can read data2\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Dans le code ci-dessus, la variable ",(0,t.jsx)(n.code,{children:"success"})," dans les param\xe8tres signifie que la requ\xeate obtient le r\xe9sultat sans lancer d'erreur et ne signifie pas que la r\xe8gle d'autorisation est ",(0,t.jsx)(n.code,{children:"true"}),". La variable ",(0,t.jsx)(n.code,{children:"failed"})," n'est \xe9galement pas li\xe9e aux r\xe8gles d'autorisation. Cela n'a de sens que lorsque quelque chose se passe mal dans le processus de la requ\xeate."]}),"\n",(0,t.jsxs)(n.p,{children:["Vous pouvez vous r\xe9f\xe9rer \xe0 notre ",(0,t.jsx)(n.a,{href:"https://github.com/casbin-js/examples",children:"exemple React"})," pour voir une utilisation pratique de Casbin.js."]}),"\n",(0,t.jsx)(n.h3,{id:"objet-de-permission",children:"Objet de permission"}),"\n",(0,t.jsx)(n.p,{children:"Casbin.js acceptera un objet JSON pour manipuler la permission correspondante d'un visiteur. Par exemple :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "read": ["data1", "data2"],\n    "write": ["data1"]\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["L'objet de permission ci-dessus montre que le visiteur peut ",(0,t.jsx)(n.code,{children:"lire"})," les objets ",(0,t.jsx)(n.code,{children:"data1"})," et ",(0,t.jsx)(n.code,{children:"data2"}),", tandis qu'ils ne peuvent ",(0,t.jsx)(n.code,{children:"\xe9crire"})," que les objets ",(0,t.jsx)(n.code,{children:"data1"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"utilisation-avanc\xe9e",children:"Utilisation avanc\xe9e"}),"\n",(0,t.jsx)(n.p,{children:"Casbin.js fournit une solution parfaite pour int\xe9grer votre gestion de contr\xf4le d'acc\xe8s frontend avec votre service Casbin backend."}),"\n",(0,t.jsxs)(n.p,{children:["Utilisez le mode ",(0,t.jsx)(n.code,{children:"auto"})," et sp\xe9cifiez votre point de terminaison lors de l'initialisation de l'",(0,t.jsx)(n.code,{children:"Authorizer"})," Casbin.js, il synchronisera automatiquement la permission et manipulera le statut frontend."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const casbinjs = require('casbin.js');\n\n// Set your backend Casbin service URL\nconst authorizer = new casbinjs.Authorizer(\n    'auto', // mode\n    {endpoint: 'http://your_endpoint/api/casbin'}\n);\n\n// Set your visitor.\n// Casbin.js will automatically sync the permission with your backend Casbin service.\nauthorizer.setUser(\"Tom\");\n\n// Evaluate the permission\nresult = authorizer.can(\"read\", \"data1\");\nresult.then((success, failed) => {\n    if (success) {\n        // Some frontend procedure ...\n    }\n});\n"})}),"\n",(0,t.jsxs)(n.p,{children:["En cons\xe9quence, vous devez exposer une interface (par exemple, une RestAPI) pour g\xe9n\xe9rer l'objet de permission et le passer au frontend. Dans votre contr\xf4leur API, appelez ",(0,t.jsx)(n.code,{children:"CasbinJsGetUserPermission"})," pour construire l'objet de permission. Voici un exemple dans Beego :"]}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"Votre serveur de point de terminaison devrait retourner quelque chose comme"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "other":"other",\n    "data": "What you get from `CasbinJsGetPermissionForUser`"\n}\n'})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:'// Router\nbeego.Router("api/casbin", &controllers.APIController{}, "GET:GetFrontendPermission")\n\n// Controller\nfunc (c *APIController) GetFrontendPermission() {\n    // Get the visitor from the GET parameters. (The key is "casbin_subject")\n    visitor := c.Input().Get("casbin_subject")\n    // `e` is an initialized instance of Casbin Enforcer\n    c.Data["perm"] = casbin.CasbinJsGetPermissionForUser(e, visitor)\n    // Pass the data to the frontend.\n    c.ServeJSON()\n}\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Actuellement, l'API ",(0,t.jsx)(n.code,{children:"CasbinJsGetPermissionForUser"})," n'est prise en charge que dans Go Casbin et Node-Casbin. Si vous souhaitez que cette API soit prise en charge dans d'autres langues, veuillez ",(0,t.jsx)(n.a,{href:"https://github.com/casbin/casbin.js/issues",children:"soulever un probl\xe8me"})," ou laisser un commentaire ci-dessous."]})}),"\n",(0,t.jsx)(n.h2,{id:"liste-des-api",children:"Liste des API"}),"\n",(0,t.jsx)(n.h3,{id:"setpermissionpermission-string",children:(0,t.jsx)(n.code,{children:"setPermission(permission: string)"})}),"\n",(0,t.jsxs)(n.p,{children:["D\xe9finir l'objet de permission. Toujours utilis\xe9 en mode ",(0,t.jsx)(n.code,{children:"manuel"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"setuseruser-string",children:(0,t.jsx)(n.code,{children:"setUser(user: string)"})}),"\n",(0,t.jsxs)(n.p,{children:["D\xe9finir l'identit\xe9 du visiteur et mettre \xe0 jour la permission. Toujours utilis\xe9 en mode ",(0,t.jsx)(n.code,{children:"auto"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"canaction-string-object-string",children:(0,t.jsx)(n.code,{children:"can(action: string, object: string)"})}),"\n",(0,t.jsxs)(n.p,{children:["V\xe9rifiez si l'utilisateur peut effectuer ",(0,t.jsx)(n.code,{children:"action"})," sur ",(0,t.jsx)(n.code,{children:"object"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"cannotaction-string-object-string",children:(0,t.jsx)(n.code,{children:"cannot(action: string, object: string)"})}),"\n",(0,t.jsxs)(n.p,{children:["V\xe9rifiez si l'utilisateur ",(0,t.jsx)(n.strong,{children:"ne peut pas"})," effectuer ",(0,t.jsx)(n.code,{children:"action"})," sur ",(0,t.jsx)(n.code,{children:"object"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"canallaction-string-objects-arrayobject",children:(0,t.jsx)(n.code,{children:"canAll(action: string, objects: Array<object>)"})}),"\n",(0,t.jsxs)(n.p,{children:["V\xe9rifiez si l'utilisateur peut effectuer ",(0,t.jsx)(n.code,{children:"action"})," sur ",(0,t.jsx)(n.strong,{children:"tous"})," les objets dans ",(0,t.jsx)(n.code,{children:"objects"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"cananyaction-string-objects-arrayobject",children:(0,t.jsx)(n.code,{children:"canAny(action: string, objects: Array<object>)"})}),"\n",(0,t.jsxs)(n.p,{children:["V\xe9rifiez si l'utilisateur peut effectuer ",(0,t.jsx)(n.code,{children:"action"})," sur ",(0,t.jsx)(n.strong,{children:"l'un quelconque"})," des ",(0,t.jsx)(n.code,{children:"objects"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"pourquoi-casbinjs",children:"Pourquoi Casbin.js"}),"\n",(0,t.jsx)(n.p,{children:"Les gens peuvent se demander quelle est la diff\xe9rence entre Node-Casbin et Casbin.js. En un mot, Node-Casbin est le c\u0153ur de Casbin impl\xe9ment\xe9 dans l'environnement NodeJS, et il est normalement utilis\xe9 comme une bo\xeete \xe0 outils de gestion de contr\xf4le d'acc\xe8s aux extr\xe9mit\xe9s du serveur. Casbin.js est une biblioth\xe8que frontend qui vous aide \xe0 utiliser Casbin pour autoriser vos utilisateurs de pages Web c\xf4t\xe9 client."}),"\n",(0,t.jsx)(n.p,{children:"Normalement, il n'est pas appropri\xe9 de construire directement un service Casbin et d'effectuer les t\xe2ches d'autorisation/application \xe0 une application frontend Web en raison des probl\xe8mes suivants :"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Lorsque quelqu'un allume le client, l'ex\xe9cuteur sera initialis\xe9, et il tirera toutes les politiques des couches persistantes du backend. Une haute concurrence pourrait exercer une forte pression sur les bases de donn\xe9es et co\xfbter beaucoup de d\xe9bit r\xe9seau."}),"\n",(0,t.jsx)(n.li,{children:"Charger toutes les politiques sur le c\xf4t\xe9 client pourrait pr\xe9senter des risques de s\xe9curit\xe9."}),"\n",(0,t.jsx)(n.li,{children:"Il est difficile de s\xe9parer le client et le serveur ainsi que de faciliter le d\xe9veloppement agile."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Nous avons besoin d'un outil qui facilite l'utilisation de Casbin \xe0 l'extr\xe9mit\xe9 frontend. En fait, le c\u0153ur de Casbin.js est la manipulation de la permission de l'utilisateur actuel c\xf4t\xe9 client. Comme vous l'avez mentionn\xe9, Casbin.js effectue une r\xe9cup\xe9ration \xe0 partir d'un point d'extr\xe9mit\xe9 sp\xe9cifi\xe9. Cette proc\xe9dure synchronisera la permission de l'utilisateur avec le service Casbin du backend. Apr\xe8s avoir obtenu les donn\xe9es de permission, les d\xe9veloppeurs peuvent utiliser les interfaces Casbin.js pour g\xe9rer le comportement de l'utilisateur c\xf4t\xe9 frontend."}),"\n",(0,t.jsx)(n.p,{children:"Casbin.js \xe9vite les deux probl\xe8mes mentionn\xe9s ci-dessus : le service Casbin ne sera plus tir\xe9 \xe0 plusieurs reprises, et la taille des messages passant entre le client et le serveur est r\xe9duite. Nous \xe9vitons \xe9galement de stocker toutes les politiques \xe0 l'extr\xe9mit\xe9 frontend. L'utilisateur ne peut acc\xe9der qu'\xe0 sa propre permission, mais n'a aucune connaissance du mod\xe8le de contr\xf4le d'acc\xe8s et des permissions des autres utilisateurs. De plus, Casbin.js peut \xe9galement d\xe9coupler efficacement le client et le serveur dans la gestion de l'autorisation."})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var i=s(6540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);