"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[4850],{3905:(e,r,t)=>{t.d(r,{Zo:()=>u,kt:()=>m});var i=t(7294);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?n(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(e,r){if(null==e)return{};var t,i,a=function(e,r){if(null==e)return{};var t,i,a={},n=Object.keys(e);for(i=0;i<n.length;i++)t=n[i],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)t=n[i],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=i.createContext({}),s=function(e){var r=i.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):o(o({},r),e)),t},u=function(e){var r=s(e.components);return i.createElement(p.Provider,{value:r},e.children)},c={inlineCode:"code",wrapper:function(e){var r=e.children;return i.createElement(i.Fragment,{},r)}},d=i.forwardRef((function(e,r){var t=e.components,a=e.mdxType,n=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(t),m=a,b=d["".concat(p,".").concat(m)]||d[m]||c[m]||n;return t?i.createElement(b,o(o({ref:r},u),{},{components:t})):i.createElement(b,o({ref:r},u))}));function m(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var n=t.length,o=new Array(n);o[0]=d;var l={};for(var p in r)hasOwnProperty.call(r,p)&&(l[p]=r[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var s=2;s<n;s++)o[s]=t[s];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}d.displayName="MDXCreateElement"},8040:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>n,metadata:()=>l,toc:()=>s});var i=t(7462),a=(t(7294),t(3905));const n={id:"priority-model",title:"Priority Model",description:"Mod\xe8le de priorit\xe9 de Casbin pour g\xe9rer les politiques avec diff\xe9rentes priorit\xe9s",keywords:["priority model"],authors:["hsluoyz"]},o=void 0,l={unversionedId:"priority-model",id:"priority-model",title:"Priority Model",description:"Mod\xe8le de priorit\xe9 de Casbin pour g\xe9rer les politiques avec diff\xe9rentes priorit\xe9s",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/PriorityModel.mdx",sourceDirName:".",slug:"/priority-model",permalink:"/fr/docs/priority-model",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/PriorityModel.mdx",tags:[],version:"current",frontMatter:{id:"priority-model",title:"Priority Model",description:"Mod\xe8le de priorit\xe9 de Casbin pour g\xe9rer les politiques avec diff\xe9rentes priorit\xe9s",keywords:["priority model"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Biba",permalink:"/fr/docs/biba"},next:{title:"Super Admin",permalink:"/fr/docs/superadmin"}},p={},s=[{value:"Charger la politique avec priorit\xe9 implicite",id:"charger-la-politique-avec-priorit\xe9-implicite",level:2},{value:"Charger la politique avec priorit\xe9 explicite",id:"charger-la-politique-avec-priorit\xe9-explicite",level:2},{value:"Charger la politique avec priorit\xe9 bas\xe9e sur la hi\xe9rarchie des r\xf4les et des utilisateurs",id:"charger-la-politique-avec-priorit\xe9-bas\xe9e-sur-la-hi\xe9rarchie-des-r\xf4les-et-des-utilisateurs",level:2}],u={toc:s};function c(e){let{components:r,...t}=e;return(0,a.kt)("wrapper",(0,i.Z)({},u,t,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Casbin prend en charge le chargement des politiques avec priorit\xe9."),(0,a.kt)("h2",{id:"charger-la-politique-avec-priorit\xe9-implicite"},"Charger la politique avec priorit\xe9 implicite"),(0,a.kt)("p",null,"C'est assez simple : l'ordre d\xe9termine la priorit\xe9 ; les politiques qui apparaissent plus t\xf4t ont une priorit\xe9 plus \xe9lev\xe9e."),(0,a.kt)("p",null,"model.conf:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"[policy_effect]\ne = priority(p.eft) || deny\n")),(0,a.kt)("h2",{id:"charger-la-politique-avec-priorit\xe9-explicite"},"Charger la politique avec priorit\xe9 explicite"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Voir aussi : ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/issues/550"},"casbin#550"))),(0,a.kt)("p",null,"Une valeur de priorit\xe9 plus petite indique une priorit\xe9 plus \xe9lev\xe9e. S'il y a un caract\xe8re non num\xe9rique dans la priorit\xe9, il sera plac\xe9 en dernier au lieu de g\xe9n\xe9rer une erreur."),(0,a.kt)("admonition",{title:"Convention de nom de jeton",type:"info"},(0,a.kt)("p",{parentName:"admonition"},'Le nom de jeton de priorit\xe9 conventionnellement utilis\xe9 dans la d\xe9finition de la politique est "priorit\xe9". Pour en utiliser un personnalis\xe9, vous devez invoquer ',(0,a.kt)("inlineCode",{parentName:"p"},"e.SetFieldIndex()")," et recharger les politiques (voir l'exemple complet sur ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/pull/1044"},"TestCustomizedFieldIndex"),")."),(0,a.kt)("p",{parentName:"admonition"},"model.conf :"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"[policy_definition]\np = customized_priority, sub, obj, act, eft\n")),(0,a.kt)("p",{parentName:"admonition"},"Exemple de code Golang :"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-go"},'e, _ := NewEnforcer("./example/priority_model_explicit_customized.conf",\n                    "./example/priority_policy_explicit_customized.csv")\n// Due to the customized priority token, the enforcer fails to handle the priority.\nok, err := e.Enforce("bob", "data2", "read") // the result will be `true, nil`\n// Set PriorityIndex and reload\ne.SetFieldIndex("p", constant.PriorityIndex, 0)\nerr := e.LoadPolicy()\nif err != nil {\n    log.Fatalf("LoadPolicy: %v", err)\n}\nok, err := e.Enforce("bob", "data2", "read") // the result will be `false, nil`\n'))),(0,a.kt)("p",null,"Actuellement, la priorit\xe9 explicite ne prend en charge que ",(0,a.kt)("inlineCode",{parentName:"p"},"AddPolicy")," & ",(0,a.kt)("inlineCode",{parentName:"p"},"AddPolicies"),". Si ",(0,a.kt)("inlineCode",{parentName:"p"},"UpdatePolicy")," a \xe9t\xe9 appel\xe9, vous ne devriez pas changer l'attribut de priorit\xe9."),(0,a.kt)("p",null,"model.conf :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"[request_definition]\nr = sub, obj, act\n\n[policy_definition]\np = priority, sub, obj, act, eft\n\n[role_definition]\ng = _, _\n\n[policy_effect]\ne = priority(p.eft) || deny\n\n[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act\n")),(0,a.kt)("p",null,"policy.csv"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"p, 10, data1_deny_group, data1, read, deny\np, 10, data1_deny_group, data1, write, deny\np, 10, data2_allow_group, data2, read, allow\np, 10, data2_allow_group, data2, write, allow\n\n\np, 1, alice, data1, write, allow\np, 1, alice, data1, read, allow\np, 1, bob, data2, read, deny\n\ng, bob, data2_allow_group\ng, alice, data1_deny_group\n")),(0,a.kt)("p",null,"demande :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"alice, data1, write --\x3e true // because `p, 1, alice, data1, write, allow` has the highest priority\nbob, data2, read --\x3e false\nbob, data2, write --\x3e true // because bob has the role of `data2_allow_group` which has the right to write data2, and there's no deny policy with higher priority \n")),(0,a.kt)("h2",{id:"charger-la-politique-avec-priorit\xe9-bas\xe9e-sur-la-hi\xe9rarchie-des-r\xf4les-et-des-utilisateurs"},"Charger la politique avec priorit\xe9 bas\xe9e sur la hi\xe9rarchie des r\xf4les et des utilisateurs"),(0,a.kt)("p",null,"La structure h\xe9rit\xe9e des r\xf4les et des utilisateurs ne peut \xeatre que plusieurs arbres, pas des graphes. Si un utilisateur a plusieurs r\xf4les, vous devez vous assurer que l'utilisateur a le m\xeame niveau dans diff\xe9rents arbres. Si deux r\xf4les ont le m\xeame niveau, la politique (associ\xe9e au r\xf4le) qui est apparue plus t\xf4t a une priorit\xe9 plus \xe9lev\xe9e. Pour plus de d\xe9tails, voir aussi ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/pull/833"},"casbin#833")," et ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/issues/831"},"casbin#831"),"."),(0,a.kt)("p",null,"model.conf:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"[request_definition]\nr = sub, obj, act\n\n[policy_definition]\np = sub, obj, act, eft\n\n[role_definition]\ng = _, _\n\n[policy_effect]\ne = subjectPriority(p.eft) || deny\n\n[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act \n")),(0,a.kt)("p",null,"policy.csv"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"p, root, data1, read, deny\np, admin, data1, read, deny\n\np, editor, data1, read, deny\np, subscriber, data1, read, deny\n\np, jane, data1, read, allow\np, alice, data1, read, allow\n\ng, admin, root\n\ng, editor, admin\ng, subscriber, admin\n\ng, jane, editor\ng, alice, subscriber \n")),(0,a.kt)("p",null,"Demande :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"jane, data1, read --\x3e true // because jane is at the bottom, her priority is higher than that of editor, admin, and root\nalice, data1, read --\x3e true\n")),(0,a.kt)("p",null,"La hi\xe9rarchie des r\xf4les ressemble \xe0 ceci :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"role: root\n \u2514\u2500 role: admin\n    \u251c\u2500 role editor\n    \u2502  \u2514\u2500 user: jane\n    \u2502\n    \u2514\u2500 role: subscriber\n       \u2514\u2500 user: alice\n")),(0,a.kt)("p",null,"La priorit\xe9 ressemble automatiquement \xe0 ceci :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"role: root                 # auto priority: 30\n \u2514\u2500 role: admin            # auto priority: 20\n     \u251c\u2500 role: editor       # auto priority: 10\n     \u2514\u2500 role: subscriber   # auto priority: 10\n")))}c.isMDXComponent=!0}}]);