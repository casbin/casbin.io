"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[178],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=i.createContext({}),u=function(e){var t=i.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return i.createElement(o.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(n),m=r,b=c["".concat(o,".").concat(m)]||c[m]||d[m]||a;return n?i.createElement(b,l(l({ref:t},p),{},{components:n})):i.createElement(b,l({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,l=new Array(a);l[0]=c;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:r,l[1]=s;for(var u=2;u<a;u++)l[u]=n[u];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},4391:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>u});var i=n(7462),r=(n(7294),n(3905));const a={id:"rbac",title:"RBAC",description:"Casbin RBAC usage",keywords:["RBAC","role definition","role hierarchy"],authors:["hsluoyz"]},l=void 0,s={unversionedId:"rbac",id:"rbac",title:"RBAC",description:"Casbin RBAC usage",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/RBAC.mdx",sourceDirName:".",slug:"/rbac",permalink:"/fr/docs/rbac",draft:!1,editUrl:"https://crowdin.com/project/casbin-website/fr",tags:[],version:"current",frontMatter:{id:"rbac",title:"RBAC",description:"Casbin RBAC usage",keywords:["RBAC","role definition","role hierarchy"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"Fonction",permalink:"/fr/docs/function"},next:{title:"RBAC avec motif",permalink:"/fr/docs/rbac-with-pattern"}},o={},u=[{value:"D\xe9finition du r\xf4le",id:"d\xe9finition-du-r\xf4le",level:2},{value:"Hi\xe9rarchie des r\xf4les",id:"hi\xe9rarchie-des-r\xf4les",level:2},{value:"Comment distinguer le r\xf4le de l&#39;utilisateur ?",id:"comment-distinguer-le-r\xf4le-de-lutilisateur-",level:2},{value:"Comment interroger des r\xf4les ou des permissions implicites ?",id:"comment-interroger-des-r\xf4les-ou-des-permissions-implicites-",level:2},{value:"Utiliser la correspondance de motif dans RBAC",id:"utiliser-la-correspondance-de-motif-dans-rbac",level:2},{value:"Responsable du r\xf4le",id:"responsable-du-r\xf4le",level:2}],p={toc:u};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"d\xe9finition-du-r\xf4le"},"D\xe9finition du r\xf4le"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"[role_definition]")," est la d\xe9finition des relations d'h\xe9ritage de r\xf4le RBAC. Casbin prend en charge plusieurs instances de syst\xe8mes RBAC, par ex. les utilisateurs peuvent avoir des r\xf4les et leurs relations d'h\xe9ritage, et les ressources peuvent \xe9galement avoir des r\xf4les et des relations d'h\xe9ritage. Ces deux syst\xe8mes RBAC n'interf\xe9reront pas."),(0,r.kt)("p",null,"Cette section est facultative. Si vous n'utilisez pas les r\xf4les RBAC dans le mod\xe8le, alors omettez cette section."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"[role_definition]\ng = _, _\ng2 = _, _\n")),(0,r.kt)("p",null,"La d\xe9finition de r\xf4le ci-dessus montre que ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," est un syst\xe8me RBAC, et que ",(0,r.kt)("inlineCode",{parentName:"p"},"g2")," est un autre syst\xe8me RBAC. ",(0,r.kt)("inlineCode",{parentName:"p"},"_, _")," signifie qu'il y a deux parties \xe0 l'int\xe9rieur d'une relation d'h\xe9ritage. Comme cas courant, vous utilisez g\xe9n\xe9ralement ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," seul si vous avez seulement besoin de r\xf4les sur les utilisateurs.  Vous pouvez \xe9galement utiliser ",(0,r.kt)("inlineCode",{parentName:"p"},"g")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"g2")," lorsque vous avez besoin de r\xf4les (ou de groupes) pour les utilisateurs et les ressources. Veuillez consulter les ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_model.conf"},"rbac_model.conf")," et ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_with_resource_roles_model.conf"},"rbac_model_with_resource_roles.conf")," pour des exemples."),(0,r.kt)("p",null,"Casbin stocke la v\xe9ritable cartographie des r\xf4les utilisateur (ou la cartographie des r\xf4les des ressources si vous utilisez des r\xf4les sur les ressources) dans la politique, par exemple :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"p, data2_admin, data2, read\ng, alice, data2_admin\n")),(0,r.kt)("p",null,"Cela signifie que ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," h\xe9rite/est un membre du r\xf4le ",(0,r.kt)("inlineCode",{parentName:"p"},"data2_admin"),". ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," ici peut \xeatre un utilisateur, une ressource ou un r\xf4le. Casbin ne le reconna\xeet que comme une cha\xeene."),(0,r.kt)("p",null,"Ensuite, dans un matcher, vous devriez v\xe9rifier le r\xf4le comme ci-dessous:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act\n")),(0,r.kt)("p",null,"Cela signifie que ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," dans la requ\xeate devrait avoir le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," dans la politique."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"Casbin stocke uniquement la cartographie des r\xf4les utilisateur."),(0,r.kt)("li",{parentName:"ol"},"Casbin ne v\xe9rifie pas si un utilisateur est un utilisateur valide, ou un r\xf4le est un r\xf4le valide. Cela devrait \xeatre r\xe9gl\xe9 par l'authentification."),(0,r.kt)("li",{parentName:"ol"},"N'utilisez pas le m\xeame nom pour un utilisateur et un r\xf4le dans un syst\xe8me RBAC, car Casbin reconna\xeet les utilisateurs et les r\xf4les comme des cha\xeenes, et il n'y a aucun moyen pour Casbin de savoir si vous sp\xe9cifiez l'utilisateur ",(0,r.kt)("inlineCode",{parentName:"li"},"alice")," ou le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"li"},"alice"),". Vous pouvez simplement le r\xe9soudre en utilisant ",(0,r.kt)("inlineCode",{parentName:"li"},"role_alice"),"."),(0,r.kt)("li",{parentName:"ol"},"Si ",(0,r.kt)("inlineCode",{parentName:"li"},"A")," a le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"li"},"B"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"B")," a le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"li"},"C"),", puis ",(0,r.kt)("inlineCode",{parentName:"li"},"A")," a le r\xf4le ",(0,r.kt)("inlineCode",{parentName:"li"},"C"),". Cette transitivit\xe9 est infinie pour l'instant."))),(0,r.kt)("admonition",{title:"Token name convention",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Conventionally subject token name in policy definition is ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," and placed in the beginning. Now Golang Casbin supports customized token name & place. If the subject token name is ",(0,r.kt)("inlineCode",{parentName:"p"},"sub"),", the subject token can be placed at an arbitrary place and no extra action needs.  If the subject token name is not ",(0,r.kt)("inlineCode",{parentName:"p"},"sub")," , ",(0,r.kt)("inlineCode",{parentName:"p"},"e.SetFieldIndex()")," for ",(0,r.kt)("inlineCode",{parentName:"p"},"constant.SubjectIndex")," should be called after the enforcer is initialized regardless of its position."),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-ini"},"# `subject` here for sub\n[policy_definition]\np =  obj, act, subject\n")),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-go"},'e.SetFieldIndex("p", constant.SubjectIndex, 2) // index start from 0\nok, err := e.DeleteUser("alice") // without SetFieldIndex, it will raise an error\n'))),(0,r.kt)("h2",{id:"hi\xe9rarchie-des-r\xf4les"},"Hi\xe9rarchie des r\xf4les"),(0,r.kt)("p",null,"Le RBAC de Casbin prend en charge la fonction de hi\xe9rarchie des r\xf4les RBAC1, c'est-\xe0-dire si ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," a ",(0,r.kt)("inlineCode",{parentName:"p"},"r\xf4le1"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"r\xf4le1")," a ",(0,r.kt)("inlineCode",{parentName:"p"},"r\xf4le2"),", puis ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," aura \xe9galement ",(0,r.kt)("inlineCode",{parentName:"p"},"r\xf4le2")," et h\xe9ritera de ses permissions."),(0,r.kt)("p",null,"Voici un concept appel\xe9 niveau hi\xe9rarchique. Le niveau de hi\xe9rarchie pour cet exemple est donc 2. Pour le gestionnaire de r\xf4le int\xe9gr\xe9 dans Casbin, vous pouvez sp\xe9cifier le niveau max de la hi\xe9rarchie. La valeur par d\xe9faut est 10. Cela signifie qu'un utilisateur final comme ",(0,r.kt)("inlineCode",{parentName:"p"},"alice")," ne peut h\xe9riter que de 10 niveaux de r\xf4les."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},"// NewRoleManager est le constructeur pour cr\xe9er une instance de l'impl\xe9mentation\n// RoleManager par d\xe9faut.\nfunc NewRoleManager(maxHierarchyLevel int) rbac.RoleManager {\n    rm := RoleManager{}\n    rm.allRoles = &sync. ap{}\n    rm.maxHierarchyLevel = maxHierarchyLevel\n    rm. asPattern = faux\n\n    retour &rm\n}\n")),(0,r.kt)("h2",{id:"comment-distinguer-le-r\xf4le-de-lutilisateur-"},"Comment distinguer le r\xf4le de l'utilisateur ?"),(0,r.kt)("p",null,"Casbin ne distingue pas le r\xf4le de l'utilisateur dans son RBAC. Ils sont tous trait\xe9s comme des cordes. Si vous n'utilisez qu'un seul niveau RBAC (un r\xf4le ne sera jamais membre d'un autre r\xf4le). Vous pouvez utiliser ",(0,r.kt)("inlineCode",{parentName:"p"},"e.GetAllSubjects()")," pour obtenir tous les utilisateurs et ",(0,r.kt)("inlineCode",{parentName:"p"},"e.GetAllRoles()")," pour obtenir tous les r\xf4les. Ils listent seulement tous les ",(0,r.kt)("inlineCode",{parentName:"p"},"u")," et tous les ",(0,r.kt)("inlineCode",{parentName:"p"},"r")," respectivement dans toutes les r\xe8gles ",(0,r.kt)("inlineCode",{parentName:"p"},"g, u, r"),"."),(0,r.kt)("p",null,"Mais si vous utilisez RBAC \xe0 plusieurs niveaux (avec hi\xe9rarchie de r\xf4les), et votre application n'enregistre pas si un nom (cha\xeene) est un utilisateur ou un r\xf4le, ou si vous avez un utilisateur et un r\xf4le avec le m\xeame nom. Vous pouvez ajouter un pr\xe9fixe au r\xf4le comme ",(0,r.kt)("inlineCode",{parentName:"p"},"role::admin")," avant de le passer \xe0 Casbin. Vous saurez donc si c'est un r\xf4le en v\xe9rifiant ce pr\xe9fixe."),(0,r.kt)("h2",{id:"comment-interroger-des-r\xf4les-ou-des-permissions-implicites-"},"Comment interroger des r\xf4les ou des permissions implicites ?"),(0,r.kt)("p",null,"Lorsqu'un utilisateur h\xe9rite d'un r\xf4le ou d'une permission via la hi\xe9rarchie RBAC au lieu de les assigner directement dans une r\xe8gle de r\xe8gle, nous appelons un tel type d'affectation comme ",(0,r.kt)("inlineCode",{parentName:"p"},"implicite"),". Interroger de telles relations implicites, vous devez utiliser ces 2 API : ",(0,r.kt)("inlineCode",{parentName:"p"},"GetImplicitRolesForUser()")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"GetImplicitPermissionsForUser()")," au lieu de ",(0,r.kt)("inlineCode",{parentName:"p"},"GetRolesForUser()")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"GetPermissionsForUser()"),". Pour plus de d\xe9tails, veuillez consulter ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/issues/137"},"ce probl\xe8me GitHub"),"."),(0,r.kt)("h2",{id:"utiliser-la-correspondance-de-motif-dans-rbac"},"Utiliser la correspondance de motif dans RBAC"),(0,r.kt)("p",null,"Voir ",(0,r.kt)("a",{parentName:"p",href:"/docs/rbac-with-pattern"},"RBAC avec le mod\xe8le")),(0,r.kt)("h2",{id:"responsable-du-r\xf4le"},"Responsable du r\xf4le"),(0,r.kt)("p",null,"Voir la section ",(0,r.kt)("a",{parentName:"p",href:"/docs/role-managers"},"Responsables de r\xf4le")," pour plus de d\xe9tails."))}d.isMDXComponent=!0}}]);