"use strict";(globalThis.webpackChunkcasbin_website_v2=globalThis.webpackChunkcasbin_website_v2||[]).push([[2956],{591:(e,o,n)=>{n.d(o,{A:()=>a});const a=n.p+"assets/images/editor-tips-2c4bf3155a73f079c976e5ad118d5518.png"},1347:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>r,contentTitle:()=>i,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"rbac-with-pattern","title":"RBAC with Pattern","description":"RBAC com Padr\xe3o","source":"@site/i18n/pt/docusaurus-plugin-content-docs/current/RBACWithPattern.mdx","sourceDirName":".","slug":"/rbac-with-pattern","permalink":"/pt/docs/rbac-with-pattern","draft":false,"unlisted":false,"editUrl":"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBACWithPattern.mdx","tags":[],"version":"current","frontMatter":{"id":"rbac-with-pattern","title":"RBAC with Pattern","description":"RBAC com Padr\xe3o","keywords":["RBAC with pattern","pattern matching"],"authors":["hsluoyz"]},"sidebar":"docs","previous":{"title":"RBAC","permalink":"/pt/docs/rbac"},"next":{"title":"RBAC with Domains","permalink":"/pt/docs/rbac-with-domains"}}');var s=n(4848),d=n(8453);const c={id:"rbac-with-pattern",title:"RBAC with Pattern",description:"RBAC com Padr\xe3o",keywords:["RBAC with pattern","pattern matching"],authors:["hsluoyz"]},i=void 0,r={},t=[{value:"In\xedcio R\xe1pido",id:"in\xedcio-r\xe1pido",level:2},{value:"Use correspond\xeancia de padr\xf5es em RBAC",id:"use-correspond\xeancia-de-padr\xf5es-em-rbac",level:2}];function l(e){const o={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components},{TabItem:a,Tabs:c}=o;return a||m("TabItem",!0),c||m("Tabs",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.h2,{id:"in\xedcio-r\xe1pido",children:"In\xedcio R\xe1pido"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsxs)(o.p,{children:["Use padr\xe3o em ",(0,s.jsx)(o.code,{children:"g(_, _)"}),"."]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-go",children:'e, _ := NewEnforcer("./example.conf", "./example.csv")\ne.AddNamedMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'})}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Use padr\xe3o com dom\xednio."}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-go",children:'e.AddNamedDomainMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'})}),"\n"]}),"\n",(0,s.jsxs)(o.li,{children:["\n",(0,s.jsx)(o.p,{children:"Use todos os padr\xf5es."}),"\n",(0,s.jsx)(o.p,{children:"Apenas combine o uso de ambas as APIs."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:["Como mostrado acima, depois de criar a inst\xe2ncia ",(0,s.jsx)(o.code,{children:"enforcer"}),", voc\xea precisa ativar a correspond\xeancia de padr\xf5es atrav\xe9s das APIs ",(0,s.jsx)(o.code,{children:"AddNamedMatchingFunc"})," e ",(0,s.jsx)(o.code,{children:"AddNamedDomainMatchingFunc"}),", que determinam como o padr\xe3o corresponde."]}),"\n",(0,s.jsx)(o.admonition,{type:"note",children:(0,s.jsxs)(o.p,{children:['If you use the online editor, You can add a pattern matching function by clicking the "Add Role Matching" button in the lower left corner.\n',(0,s.jsx)(o.img,{alt:"editor-tips",src:n(591).A+"",width:"690",height:"480"})]})}),"\n",(0,s.jsx)(o.h2,{id:"use-correspond\xeancia-de-padr\xf5es-em-rbac",children:"Use correspond\xeancia de padr\xf5es em RBAC"}),"\n",(0,s.jsxs)(o.p,{children:["\xc0s vezes, voc\xea quer que certos sujeitos, objetos ou dom\xednios/inquilinos com um padr\xe3o espec\xedfico sejam automaticamente concedidos uma fun\xe7\xe3o. As fun\xe7\xf5es de correspond\xeancia de padr\xf5es em RBAC podem ajud\xe1-lo a fazer isso. Uma fun\xe7\xe3o de correspond\xeancia de padr\xf5es compartilha os mesmos par\xe2metros e valor de retorno que a ",(0,s.jsx)(o.a,{href:"/docs/syntax-for-models#functions-in-matchers",children:"fun\xe7\xe3o de correspond\xeancia"})," anterior."]}),"\n",(0,s.jsxs)(o.p,{children:["A fun\xe7\xe3o de correspond\xeancia de padr\xf5es suporta cada par\xe2metro de ",(0,s.jsx)(o.code,{children:"g"}),"."]}),"\n",(0,s.jsxs)(o.p,{children:["Sabemos que normalmente RBAC \xe9 expresso como ",(0,s.jsx)(o.code,{children:"g(r.sub, p.sub)"})," em um correspondente. Ent\xe3o podemos usar uma pol\xedtica como:"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-csv",children:"p, alice, book_group, read\ng, /book/1, book_group\ng, /book/2, book_group\n"})}),"\n",(0,s.jsxs)(o.p,{children:["Ent\xe3o ",(0,s.jsx)(o.code,{children:"alice"})," pode ler todos os livros incluindo ",(0,s.jsx)(o.code,{children:"book 1"})," e ",(0,s.jsx)(o.code,{children:"book 2"}),". Mas pode haver milhares de livros, e \xe9 muito tedioso adicionar cada livro ao papel de livro (ou grupo) com uma regra de pol\xedtica ",(0,s.jsx)(o.code,{children:"g"}),"."]}),"\n",(0,s.jsx)(o.p,{children:"Mas com fun\xe7\xf5es de correspond\xeancia de padr\xf5es, voc\xea pode escrever a pol\xedtica com apenas uma linha:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-csv",children:"g, /book/:id, book_group\n"})}),"\n",(0,s.jsxs)(o.p,{children:["Casbin ir\xe1 automaticamente combinar ",(0,s.jsx)(o.code,{children:"/book/1"})," e ",(0,s.jsx)(o.code,{children:"/book/2"})," no padr\xe3o ",(0,s.jsx)(o.code,{children:"/book/:id"})," para voc\xea. Voc\xea s\xf3 precisa registrar a fun\xe7\xe3o com o enforcer como:"]}),"\n",(0,s.jsxs)(c,{groupId:"langs",children:[(0,s.jsx)(a,{value:"Go",label:"Go",default:!0,children:(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-go",children:'e.AddNamedMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'})})}),(0,s.jsx)(a,{value:"Node.js",label:"Node.js",children:(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-typescript",children:"await e.addNamedMatchingFunc('g', Util.keyMatch2Func);\n"})})})]}),"\n",(0,s.jsx)(o.p,{children:"Ao usar uma fun\xe7\xe3o de correspond\xeancia de padr\xf5es em dom\xednios/inquilinos, voc\xea precisa registrar a fun\xe7\xe3o com o enforcer e o modelo."}),"\n",(0,s.jsxs)(c,{groupId:"langs",children:[(0,s.jsx)(a,{value:"Go",label:"Go",default:!0,children:(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-go",children:'e.AddNamedDomainMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'})})}),(0,s.jsx)(a,{value:"Node.js",label:"Node.js",children:(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-typescript",children:"await e.addNamedDomainMatchingFunc('g', Util.keyMatch2Func);\n"})})})]}),"\n",(0,s.jsxs)(o.p,{children:["Se voc\xea n\xe3o entende o que ",(0,s.jsx)(o.code,{children:"g(r.sub, p.sub, r.dom)"})," significa, por favor leia ",(0,s.jsx)(o.a,{href:"/docs/rbac-with-domains",children:"rbac-with-domains"}),". Em resumo, ",(0,s.jsx)(o.code,{children:"g(r.sub, p.sub, r.dom)"})," verificar\xe1 se o usu\xe1rio ",(0,s.jsx)(o.code,{children:"r.sub"})," tem um papel ",(0,s.jsx)(o.code,{children:"p.sub"})," no dom\xednio ",(0,s.jsx)(o.code,{children:"r.dom"}),". Ent\xe3o \xe9 assim que o correspondente funciona. Voc\xea pode ver o exemplo completo ",(0,s.jsx)(o.a,{href:"https://github.com/casbin/casbin/blob/dbdb6cbe2e7a80863e4951f9ff36da07fef01b75/model_test.go#L278-L307",children:"aqui"}),"."]}),"\n",(0,s.jsx)(o.p,{children:"Al\xe9m da sintaxe de correspond\xeancia de padr\xf5es acima, tamb\xe9m podemos usar padr\xe3o de dom\xednio puro."}),"\n",(0,s.jsxs)(o.p,{children:["Por exemplo, se quisermos que ",(0,s.jsx)(o.code,{children:"sub"})," tenha acesso em diferentes dom\xednios, ",(0,s.jsx)(o.code,{children:"domain1"})," e ",(0,s.jsx)(o.code,{children:"domain2"}),", podemos usar o padr\xe3o de dom\xednio puro:"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-csv",children:"p, admin, domain1, data1, read\np, admin, domain1, data1, write\np, admin, domain2, data2, read\np, admin, domain2, data2, write\n\ng, alice, admin, *\ng, bob, admin, domain2\n"})}),"\n",(0,s.jsxs)(o.p,{children:["Neste exemplo, queremos que ",(0,s.jsx)(o.code,{children:"alice"})," leia e escreva ",(0,s.jsx)(o.code,{children:"data"})," no domain1 e domain2. A correspond\xeancia de padr\xf5es ",(0,s.jsx)(o.code,{children:"*"})," em ",(0,s.jsx)(o.code,{children:"g"})," faz com que ",(0,s.jsx)(o.code,{children:"alice"})," tenha acesso a dois dom\xednios."]}),"\n",(0,s.jsxs)(o.p,{children:["Ao usar correspond\xeancia de padr\xf5es, especialmente em cen\xe1rios mais complicados e com muitos dom\xednios ou objetos a considerar, podemos implementar a ",(0,s.jsx)(o.code,{children:"policy_definition"})," de uma maneira mais elegante e eficaz."]})]})}function p(e={}){const{wrapper:o}={...(0,d.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}function m(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},8453:(e,o,n)=>{n.d(o,{R:()=>c,x:()=>i});var a=n(6540);const s={},d=a.createContext(s);function c(e){const o=a.useContext(d);return a.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function i(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),a.createElement(d.Provider,{value:o},e.children)}}}]);