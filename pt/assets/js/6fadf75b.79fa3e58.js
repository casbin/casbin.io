"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[6834],{3905:(e,a,n)=>{n.d(a,{Zo:()=>s,kt:()=>u});var t=n(7294);function o(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){o(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function p(e,a){if(null==e)return{};var n,t,o=function(e,a){if(null==e)return{};var n,t,o={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||(o[n]=e[n]);return o}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=t.createContext({}),c=function(e){var a=t.useContext(d),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},s=function(e){var a=c(e.components);return t.createElement(d.Provider,{value:a},e.children)},m={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},l=t.forwardRef((function(e,a){var n=e.components,o=e.mdxType,r=e.originalType,d=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),l=c(n),u=o,k=l["".concat(d,".").concat(u)]||l[u]||m[u]||r;return n?t.createElement(k,i(i({ref:a},s),{},{components:n})):t.createElement(k,i({ref:a},s))}));function u(e,a){var n=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=l;var p={};for(var d in a)hasOwnProperty.call(a,d)&&(p[d]=a[d]);p.originalType=e,p.mdxType="string"==typeof e?e:o,i[1]=p;for(var c=2;c<r;c++)i[c]=n[c];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}l.displayName="MDXCreateElement"},1739:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>i,default:()=>k,frontMatter:()=>r,metadata:()=>p,toc:()=>c});var t=n(7462),o=(n(7294),n(3905));const r={id:"rbac-with-pattern",title:"RBAC with Pattern",description:"RBAC com Padr\xe3o",keywords:["RBAC with pattern","pattern matching"],authors:["hsluoyz"]},i=void 0,p={unversionedId:"rbac-with-pattern",id:"rbac-with-pattern",title:"RBAC with Pattern",description:"RBAC com Padr\xe3o",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/RBACWithPattern.mdx",sourceDirName:".",slug:"/rbac-with-pattern",permalink:"/pt/docs/rbac-with-pattern",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBACWithPattern.mdx",tags:[],version:"current",frontMatter:{id:"rbac-with-pattern",title:"RBAC with Pattern",description:"RBAC com Padr\xe3o",keywords:["RBAC with pattern","pattern matching"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"RBAC",permalink:"/pt/docs/rbac"},next:{title:"RBAC with Domains",permalink:"/pt/docs/rbac-with-domains"}},d={},c=[{value:"In\xedcio R\xe1pido",id:"in\xedcio-r\xe1pido",level:2},{value:"Use correspond\xeancia de padr\xf5es em RBAC",id:"use-correspond\xeancia-de-padr\xf5es-em-rbac",level:2}],s=e=>function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",a)},m=s("Tabs"),l=s("TabItem"),u={toc:c};function k(e){let{components:a,...r}=e;return(0,o.kt)("wrapper",(0,t.Z)({},u,r,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"in\xedcio-r\xe1pido"},"In\xedcio R\xe1pido"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Use padr\xe3o em ",(0,o.kt)("inlineCode",{parentName:"p"},"g(_, _)"),"."),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e, _ := NewEnforcer("./example.conf", "./example.csv")\ne.AddNamedMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Use padr\xe3o com dom\xednio."),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedDomainMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Use todos os padr\xf5es."),(0,o.kt)("p",{parentName:"li"},"Apenas combine o uso de ambas as APIs."))),(0,o.kt)("p",null,"Como mostrado acima, depois de criar a inst\xe2ncia ",(0,o.kt)("inlineCode",{parentName:"p"},"enforcer"),", voc\xea precisa ativar a correspond\xeancia de padr\xf5es atrav\xe9s das APIs ",(0,o.kt)("inlineCode",{parentName:"p"},"AddNamedMatchingFunc")," e ",(0,o.kt)("inlineCode",{parentName:"p"},"AddNamedDomainMatchingFunc"),", que determinam como o padr\xe3o corresponde."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Se voc\xea usar o editor online, ele especifica a fun\xe7\xe3o de correspond\xeancia de padr\xf5es no canto inferior esquerdo.\n",(0,o.kt)("img",{alt:"editor-tips",src:n(9523).Z,width:"480",height:"272"}))),(0,o.kt)("h2",{id:"use-correspond\xeancia-de-padr\xf5es-em-rbac"},"Use correspond\xeancia de padr\xf5es em RBAC"),(0,o.kt)("p",null,"\xc0s vezes, voc\xea quer que certos sujeitos, objetos ou dom\xednios/inquilinos com um padr\xe3o espec\xedfico sejam automaticamente concedidos uma fun\xe7\xe3o. As fun\xe7\xf5es de correspond\xeancia de padr\xf5es em RBAC podem ajud\xe1-lo a fazer isso. Uma fun\xe7\xe3o de correspond\xeancia de padr\xf5es compartilha os mesmos par\xe2metros e valor de retorno que a ",(0,o.kt)("a",{parentName:"p",href:"/docs/syntax-for-models#functions-in-matchers"},"fun\xe7\xe3o de correspond\xeancia")," anterior."),(0,o.kt)("p",null,"A fun\xe7\xe3o de correspond\xeancia de padr\xf5es suporta cada par\xe2metro de ",(0,o.kt)("inlineCode",{parentName:"p"},"g"),"."),(0,o.kt)("p",null,"Sabemos que normalmente RBAC \xe9 expresso como ",(0,o.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub)")," em um correspondente. Ent\xe3o podemos usar uma pol\xedtica como:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csv"},"p, alice, book_group, read\ng, /book/1, book_group\ng, /book/2, book_group\n")),(0,o.kt)("p",null,"Ent\xe3o ",(0,o.kt)("inlineCode",{parentName:"p"},"alice")," pode ler todos os livros incluindo ",(0,o.kt)("inlineCode",{parentName:"p"},"book 1")," e ",(0,o.kt)("inlineCode",{parentName:"p"},"book 2"),". Mas pode haver milhares de livros, e \xe9 muito tedioso adicionar cada livro ao papel de livro (ou grupo) com uma regra de pol\xedtica ",(0,o.kt)("inlineCode",{parentName:"p"},"g"),"."),(0,o.kt)("p",null,"Mas com fun\xe7\xf5es de correspond\xeancia de padr\xf5es, voc\xea pode escrever a pol\xedtica com apenas uma linha:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csv"},"g, /book/:id, book_group\n")),(0,o.kt)("p",null,"Casbin ir\xe1 automaticamente combinar ",(0,o.kt)("inlineCode",{parentName:"p"},"/book/1")," e ",(0,o.kt)("inlineCode",{parentName:"p"},"/book/2")," no padr\xe3o ",(0,o.kt)("inlineCode",{parentName:"p"},"/book/:id")," para voc\xea. Voc\xea s\xf3 precisa registrar a fun\xe7\xe3o com o enforcer como:"),(0,o.kt)(m,{groupId:"langs",mdxType:"Tabs"},(0,o.kt)(l,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'))),(0,o.kt)(l,{value:"Node.js",label:"Node.js",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"await e.addNamedMatchingFunc('g', Util.keyMatch2Func);\n")))),(0,o.kt)("p",null,"Ao usar uma fun\xe7\xe3o de correspond\xeancia de padr\xf5es em dom\xednios/inquilinos, voc\xea precisa registrar a fun\xe7\xe3o com o enforcer e o modelo."),(0,o.kt)(m,{groupId:"langs",mdxType:"Tabs"},(0,o.kt)(l,{value:"Go",label:"Go",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'e.AddNamedDomainMatchingFunc("g", "KeyMatch2", util.KeyMatch2)\n'))),(0,o.kt)(l,{value:"Node.js",label:"Node.js",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"await e.addNamedDomainMatchingFunc('g', Util.keyMatch2Func);\n")))),(0,o.kt)("p",null,"Se voc\xea n\xe3o entende o que ",(0,o.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub, r.dom)")," significa, por favor leia ",(0,o.kt)("a",{parentName:"p",href:"/docs/rbac-with-domains"},"rbac-with-domains"),". Em resumo, ",(0,o.kt)("inlineCode",{parentName:"p"},"g(r.sub, p.sub, r.dom)")," verificar\xe1 se o usu\xe1rio ",(0,o.kt)("inlineCode",{parentName:"p"},"r.sub")," tem um papel ",(0,o.kt)("inlineCode",{parentName:"p"},"p.sub")," no dom\xednio ",(0,o.kt)("inlineCode",{parentName:"p"},"r.dom"),". Ent\xe3o \xe9 assim que o correspondente funciona. Voc\xea pode ver o exemplo completo ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/dbdb6cbe2e7a80863e4951f9ff36da07fef01b75/model_test.go#L278-L307"},"aqui"),"."),(0,o.kt)("p",null,"Al\xe9m da sintaxe de correspond\xeancia de padr\xf5es acima, tamb\xe9m podemos usar padr\xe3o de dom\xednio puro."),(0,o.kt)("p",null,"Por exemplo, se quisermos que ",(0,o.kt)("inlineCode",{parentName:"p"},"sub")," tenha acesso em diferentes dom\xednios, ",(0,o.kt)("inlineCode",{parentName:"p"},"domain1")," e ",(0,o.kt)("inlineCode",{parentName:"p"},"domain2"),", podemos usar o padr\xe3o de dom\xednio puro:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csv"},"p, admin, domain1, data1, read\np, admin, domain1, data1, write\np, admin, domain2, data2, read\np, admin, domain2, data2, write\n\ng, alice, admin, *\ng, bob, admin, domain2\n")),(0,o.kt)("p",null,"Neste exemplo, queremos que ",(0,o.kt)("inlineCode",{parentName:"p"},"alice")," leia e escreva ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," no domain1 e domain2. A correspond\xeancia de padr\xf5es ",(0,o.kt)("inlineCode",{parentName:"p"},"*")," em ",(0,o.kt)("inlineCode",{parentName:"p"},"g")," faz com que ",(0,o.kt)("inlineCode",{parentName:"p"},"alice")," tenha acesso a dois dom\xednios."),(0,o.kt)("p",null,"Ao usar correspond\xeancia de padr\xf5es, especialmente em cen\xe1rios mais complicados e com muitos dom\xednios ou objetos a considerar, podemos implementar a ",(0,o.kt)("inlineCode",{parentName:"p"},"policy_definition")," de uma maneira mais elegante e eficaz."))}k.isMDXComponent=!0},9523:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/editor-tips-4f3fd45a1ea048f308e3e31da355ff79.png"}}]);