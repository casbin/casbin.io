"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[827],{3905:(e,n,a)=>{a.d(n,{Zo:()=>d,kt:()=>c});var t=a(7294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function s(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},i=Object.keys(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)a=i[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=t.createContext({}),m=function(e){var n=t.useContext(p),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},d=function(e){var n=m(e.components);return t.createElement(p.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=m(a),c=r,k=u["".concat(p,".").concat(c)]||u[c]||l[c]||i;return a?t.createElement(k,o(o({ref:n},d),{},{components:a})):t.createElement(k,o({ref:n},d))}));function c(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=u;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var m=2;m<i;m++)o[m]=a[m];return t.createElement.apply(null,o)}return t.createElement.apply(null,a)}u.displayName="MDXCreateElement"},2478:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>l,frontMatter:()=>i,metadata:()=>s,toc:()=>m});var t=a(7462),r=(a(7294),a(3905));const i={id:"menu-permissions",title:"Menu Permissions",description:"Exemplo para Permiss\xf5es de Menu",keywords:["Menu Permissions","example"],authors:["amikecoXu"]},o=void 0,s={unversionedId:"menu-permissions",id:"menu-permissions",title:"Menu Permissions",description:"Exemplo para Permiss\xf5es de Menu",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/MenuPermissions.mdx",sourceDirName:".",slug:"/menu-permissions",permalink:"/pt/docs/menu-permissions",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/MenuPermissions.mdx",tags:[],version:"current",frontMatter:{id:"menu-permissions",title:"Menu Permissions",description:"Exemplo para Permiss\xf5es de Menu",keywords:["Menu Permissions","example"],authors:["amikecoXu"]},sidebar:"docs",previous:{title:"Data Permissions",permalink:"/pt/docs/data-permissions"},next:{title:"Extensions",permalink:"/pt/docs/category/extensions"}},p={},m=[{value:"1. Arquivos de Configura\xe7\xe3o",id:"1-arquivos-de-configura\xe7\xe3o",level:3},{value:"1.1 Vis\xe3o Geral",id:"11-vis\xe3o-geral",level:4},{value:"1.2 Defini\xe7\xf5es de Permiss\xf5es (Pol\xedticas)",id:"12-defini\xe7\xf5es-de-permiss\xf5es-pol\xedticas",level:4},{value:"1.3 Pap\xe9is e Associa\xe7\xf5es de Usu\xe1rios",id:"13-pap\xe9is-e-associa\xe7\xf5es-de-usu\xe1rios",level:4},{value:"1.4 Hierarquia de Itens de Menu",id:"14-hierarquia-de-itens-de-menu",level:4},{value:"1.5 Heran\xe7a de Permiss\xf5es de Menu e Regras Padr\xe3o",id:"15-heran\xe7a-de-permiss\xf5es-de-menu-e-regras-padr\xe3o",level:4},{value:"<strong>Distin\xe7\xe3o Entre Nega\xe7\xf5es Expl\xedcitas e Padr\xe3o</strong>: Se um papel, como <code>ROLE_ADMIN</code>, \xe9 explicitamente negado acesso a um item de menu, como <code>AdminSubMenu_deny</code> (marcado como <code>deny</code>), ent\xe3o mesmo que este papel seja herdado por outro papel (por exemplo, <code>ROLE_ROOT</code>), o papel herdeiro n\xe3o \xe9 permitido acesso ao item de menu negado.",id:"distin\xe7\xe3o-entre-nega\xe7\xf5es-expl\xedcitas-e-padr\xe3o-se-um-papel-como-role_admin-\xe9-explicitamente-negado-acesso-a-um-item-de-menu-como-adminsubmenu_deny-marcado-como-deny-ent\xe3o-mesmo-que-este-papel-seja-herdado-por-outro-papel-por-exemplo-role_root-o-papel-herdeiro-n\xe3o-\xe9-permitido-acesso-ao-item-de-menu-negado",level:4},{value:"ROLE_ADMIN",id:"role_admin",level:4},{value:"2. Controle de Permiss\xe3o de Menu",id:"2-controle-de-permiss\xe3o-de-menu",level:3}],d={toc:m};function l(e){let{components:n,...a}=e;return(0,r.kt)("wrapper",(0,t.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Iniciamos apresentando um exemplo de Spring Boot que apresenta um sistema de menu. Este exemplo utiliza o jCasbin para gerenciar permiss\xf5es de menu. Em \xfaltima an\xe1lise, visa abstrair um middleware, especificamente para permiss\xf5es de menu, que poderia ser estendido para outras linguagens suportadas pelo Casbin, como Go e Python."),(0,r.kt)("h3",{id:"1-arquivos-de-configura\xe7\xe3o"},"1. Arquivos de Configura\xe7\xe3o"),(0,r.kt)("p",null,"Voc\xea precisa configurar a gest\xe3o de pap\xe9is e permiss\xf5es no arquivo ",(0,r.kt)("inlineCode",{parentName:"p"},"policy.csv"),", juntamente com as rela\xe7\xf5es de parentesco entre os itens do menu. Para mais detalhes, por favor, consulte ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/jcasbin/jcasbin-menu-permission"},"este reposit\xf3rio do GitHub"),"."),(0,r.kt)("h4",{id:"11-vis\xe3o-geral"},"1.1 Vis\xe3o Geral"),(0,r.kt)("p",null,"Usando ",(0,r.kt)("inlineCode",{parentName:"p"},"policy.csv"),", voc\xea pode configurar de forma flex\xedvel as permiss\xf5es de pap\xe9is e as estruturas de menu para um controle de acesso granular. Este arquivo de configura\xe7\xe3o define permiss\xf5es de acesso para diferentes pap\xe9is em v\xe1rios itens de menu, associa\xe7\xf5es entre usu\xe1rios e pap\xe9is, e as rela\xe7\xf5es hier\xe1rquicas entre os itens de menu."),(0,r.kt)("h4",{id:"12-defini\xe7\xf5es-de-permiss\xf5es-pol\xedticas"},"1.2 Defini\xe7\xf5es de Permiss\xf5es (Pol\xedticas)"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Regras de Pol\xedtica"),": As pol\xedticas s\xe3o definidas com um prefixo ",(0,r.kt)("inlineCode",{parentName:"li"},"p"),", especificando pap\xe9is (",(0,r.kt)("inlineCode",{parentName:"li"},"sub"),") e suas permiss\xf5es (",(0,r.kt)("inlineCode",{parentName:"li"},"act"),") em itens de menu (",(0,r.kt)("inlineCode",{parentName:"li"},"obj"),"), juntamente com o efeito da regra (",(0,r.kt)("inlineCode",{parentName:"li"},"eft"),"), onde ",(0,r.kt)("inlineCode",{parentName:"li"},"allow")," indica que a permiss\xe3o \xe9 concedida, e ",(0,r.kt)("inlineCode",{parentName:"li"},"deny")," indica que \xe9 negada.")),(0,r.kt)("p",null,"Exemplos:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"p, ROLE_ROOT, SystemMenu, read, allow")," significa que o papel ",(0,r.kt)("inlineCode",{parentName:"li"},"ROLE_ROOT")," tem acesso de leitura ao item de menu ",(0,r.kt)("inlineCode",{parentName:"li"},"SystemMenu"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"p, ROLE_ROOT, UserMenu, read, deny")," significa que o papel ",(0,r.kt)("inlineCode",{parentName:"li"},"ROLE_ROOT")," \xe9 negado o acesso de leitura ao item de menu ",(0,r.kt)("inlineCode",{parentName:"li"},"UserMenu"),".")),(0,r.kt)("h4",{id:"13-pap\xe9is-e-associa\xe7\xf5es-de-usu\xe1rios"},"1.3 Pap\xe9is e Associa\xe7\xf5es de Usu\xe1rios"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Heran\xe7a de Pap\xe9is"),": Relacionamentos de usu\xe1rio-papel e hierarquias de pap\xe9is s\xe3o definidos com um prefixo ",(0,r.kt)("inlineCode",{parentName:"li"},"g"),". Isto permite que os usu\xe1rios herdem permiss\xf5es de um ou v\xe1rios pap\xe9is.")),(0,r.kt)("p",null,"Exemplos:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"g, user, ROLE_USER")," significa que o usu\xe1rio ",(0,r.kt)("inlineCode",{parentName:"li"},"user")," \xe9 atribu\xeddo ao papel ",(0,r.kt)("inlineCode",{parentName:"li"},"ROLE_USER"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"g, ROLE_ADMIN, ROLE_USER")," significa que ",(0,r.kt)("inlineCode",{parentName:"li"},"ROLE_ADMIN")," herda permiss\xf5es de ",(0,r.kt)("inlineCode",{parentName:"li"},"ROLE_USER"),".")),(0,r.kt)("h4",{id:"14-hierarquia-de-itens-de-menu"},"1.4 Hierarquia de Itens de Menu"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Relacionamentos de Menu"),": Relacionamentos de parentesco entre itens de menu s\xe3o definidos com um prefixo ",(0,r.kt)("inlineCode",{parentName:"li"},"g2"),", auxiliando na constru\xe7\xe3o da estrutura de um menu.")),(0,r.kt)("p",null,"Exemplos:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"g2, UserSubMenu_allow, UserMenu")," indica que ",(0,r.kt)("inlineCode",{parentName:"li"},"UserSubMenu_allow")," \xe9 um submenu de ",(0,r.kt)("inlineCode",{parentName:"li"},"UserMenu"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"g2, (NULL), SystemMenu")," indica que ",(0,r.kt)("inlineCode",{parentName:"li"},"SystemMenu")," n\xe3o tem um item de submenu, significando que \xe9 um item de menu de n\xedvel superior.")),(0,r.kt)("h4",{id:"15-heran\xe7a-de-permiss\xf5es-de-menu-e-regras-padr\xe3o"},"1.5 Heran\xe7a de Permiss\xf5es de Menu e Regras Padr\xe3o"),(0,r.kt)("p",null,"Ao gerenciar permiss\xf5es de menu com jCasbin, a rela\xe7\xe3o de permiss\xe3o entre menus pai e filhos segue regras espec\xedficas de heran\xe7a, com duas regras padr\xe3o importantes:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Heran\xe7a de Permiss\xf5es do Menu Pai"),": Se um menu pai \xe9 explicitamente concedido a permiss\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"allow"),", todos os seus submenus tamb\xe9m s\xe3o padr\xe3o para a permiss\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"allow"),", a menos que especificamente marcados como ",(0,r.kt)("inlineCode",{parentName:"p"},"deny"),"."),(0,r.kt)("p",null,"Isto significa que uma vez que um menu pai \xe9 acess\xedvel, seus submenus tamb\xe9m s\xe3o acess\xedveis por padr\xe3o. ",(0,r.kt)("strong",{parentName:"p"},"Tratamento de Menus Pais Sem Configura\xe7\xf5es de Permiss\xe3o Diretas"),": Se um menu pai n\xe3o tem configura\xe7\xf5es de permiss\xe3o diretas (nem explicitamente permitidas nem negadas) mas tem pelo menos um submenu explicitamente concedido a permiss\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"allow"),", ent\xe3o o menu pai \xe9 implicitamente considerado como tendo permiss\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"allow"),"."),(0,r.kt)("p",null,"Isto garante que os usu\xe1rios possam navegar para esses submenus."),(0,r.kt)("p",null,"1.6 Regras Especiais de Heran\xe7a de Permiss\xf5es No que diz respeito \xe0 heran\xe7a de permiss\xf5es entre pap\xe9is, especialmente em cen\xe1rios envolvendo permiss\xf5es ",(0,r.kt)("inlineCode",{parentName:"p"},"deny"),", as seguintes regras devem ser seguidas para garantir a seguran\xe7a do sistema e o controle preciso das permiss\xf5es:"),(0,r.kt)("h4",{id:"distin\xe7\xe3o-entre-nega\xe7\xf5es-expl\xedcitas-e-padr\xe3o-se-um-papel-como-role_admin-\xe9-explicitamente-negado-acesso-a-um-item-de-menu-como-adminsubmenu_deny-marcado-como-deny-ent\xe3o-mesmo-que-este-papel-seja-herdado-por-outro-papel-por-exemplo-role_root-o-papel-herdeiro-n\xe3o-\xe9-permitido-acesso-ao-item-de-menu-negado"},(0,r.kt)("strong",{parentName:"h4"},"Distin\xe7\xe3o Entre Nega\xe7\xf5es Expl\xedcitas e Padr\xe3o"),": Se um papel, como ",(0,r.kt)("inlineCode",{parentName:"h4"},"ROLE_ADMIN"),", \xe9 explicitamente negado acesso a um item de menu, como ",(0,r.kt)("inlineCode",{parentName:"h4"},"AdminSubMenu_deny")," (marcado como ",(0,r.kt)("inlineCode",{parentName:"h4"},"deny"),"), ent\xe3o mesmo que este papel seja herdado por outro papel (por exemplo, ",(0,r.kt)("inlineCode",{parentName:"h4"},"ROLE_ROOT"),"), o papel herdeiro n\xe3o \xe9 permitido acesso ao item de menu negado."),(0,r.kt)("p",null,"Isto garante que pol\xedticas de seguran\xe7a expl\xedcitas n\xe3o sejam contornadas devido \xe0 heran\xe7a de pap\xe9is."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Heran\xe7a de Permiss\xf5es de Nega\xe7\xe3o Padr\xe3o"),": Por outro lado, se a nega\xe7\xe3o de acesso de um papel a um item de menu (por exemplo, ",(0,r.kt)("inlineCode",{parentName:"p"},"UserSubMenu_deny"),") \xe9 padr\xe3o (n\xe3o marcada explicitamente como ",(0,r.kt)("inlineCode",{parentName:"p"},"deny"),", mas porque n\xe3o foi explicitamente concedida ",(0,r.kt)("inlineCode",{parentName:"p"},"allow"),"), ent\xe3o quando este papel \xe9 herdado por outro papel (por exemplo, ",(0,r.kt)("inlineCode",{parentName:"p"},"ROLE_ADMIN"),"), o papel herdeiro pode substituir o status de ",(0,r.kt)("inlineCode",{parentName:"p"},"deny")," padr\xe3o, permitindo acesso a esses itens de menu."),(0,r.kt)("p",null,"1.7 Descri\xe7\xe3o do Exemplo pol\xedtica:"),(0,r.kt)("p",null,"NomeDoMenu"),(0,r.kt)("p",null,"ROLE","_","ROOT"),(0,r.kt)("h4",{id:"role_admin"},"ROLE","_","ADMIN"),(0,r.kt)("p",null,"ROLE","_","USER"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csv"},"p, ROLE_ROOT, SystemMenu, read, allow\np, ROLE_ROOT, AdminMenu, read, allow\np, ROLE_ROOT, UserMenu, read, deny\np, ROLE_ADMIN, UserMenu, read, allow\np, ROLE_ADMIN, AdminMenu, read, allow\np, ROLE_ADMIN, AdminSubMenu_deny, read, deny\np, ROLE_USER, UserSubMenu_allow, read, allow\n\ng, user, ROLE_USER\ng, admin, ROLE_ADMIN\ng, root, ROLE_ROOT\ng, ROLE_ADMIN, ROLE_USER\n\ng2, UserSubMenu_allow, UserMenu\ng2, UserSubMenu_deny, UserMenu\ng2, UserSubSubMenu, UserSubMenu_allow\ng2, AdminSubMenu_allow, AdminMenu\ng2, AdminSubMenu_deny, AdminMenu\ng2, (NULL), SystemMenu\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("th",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("th",{parentName:"tr",align:"center"},"ROLE","_","ADMIN"),(0,r.kt)("th",{parentName:"tr",align:"center"},"ROLE","_","USER"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"SystemMenu"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"UserMenu"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"UserSubMenu","_","allow"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"UserSubSubMenu"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"UserSubMenu","_","deny"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"AdminMenu"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"AdminSubMenu","_","allow"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"AdminSubMenu","_","deny"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c")))),(0,r.kt)("h3",{id:"2-controle-de-permiss\xe3o-de-menu"},"2. Controle de Permiss\xe3o de Menu"),(0,r.kt)("p",null,"A lista de todos os itens de menu acess\xedveis por um determinado nome de usu\xe1rio pode ser identificada atrav\xe9s da fun\xe7\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"findAccessibleMenus()")," dispon\xedvel no ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/jcasbin/jcasbin-menu-permission/blob/master/src/main/java/org/casbin/service/MenuService.java"},"MenuService"),". Para verificar se um usu\xe1rio espec\xedfico tem direitos de acesso a um item de menu designado, o m\xe9todo ",(0,r.kt)("inlineCode",{parentName:"p"},"checkMenuAccess()")," pode ser utilizado. Esta abordagem garante que as permiss\xf5es de menu sejam efetivamente controladas, aproveitando as capacidades do jCasbin para gerenciar direitos de acesso de forma eficiente."))}l.isMDXComponent=!0}}]);