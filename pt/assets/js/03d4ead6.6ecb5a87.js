"use strict";(self.webpackChunkcasbin_website_v2=self.webpackChunkcasbin_website_v2||[]).push([[1434],{3905:(e,n,o)=>{o.d(n,{Zo:()=>m,kt:()=>u});var t=o(7294);function a(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function i(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function r(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?i(Object(o),!0).forEach((function(n){a(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function d(e,n){if(null==e)return{};var o,t,a=function(e,n){if(null==e)return{};var o,t,a={},i=Object.keys(e);for(t=0;t<i.length;t++)o=i[t],n.indexOf(o)>=0||(a[o]=e[o]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)o=i[t],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var p=t.createContext({}),s=function(e){var n=t.useContext(p),o=n;return e&&(o="function"==typeof e?e(n):r(r({},n),e)),o},m=function(e){var n=s(e.components);return t.createElement(p.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},c=t.forwardRef((function(e,n){var o=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,m=d(e,["components","mdxType","originalType","parentName"]),c=s(o),u=a,f=c["".concat(p,".").concat(u)]||c[u]||l[u]||i;return o?t.createElement(f,r(r({ref:n},m),{},{components:o})):t.createElement(f,r({ref:n},m))}));function u(e,n){var o=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=o.length,r=new Array(i);r[0]=c;var d={};for(var p in n)hasOwnProperty.call(n,p)&&(d[p]=n[p]);d.originalType=e,d.mdxType="string"==typeof e?e:a,r[1]=d;for(var s=2;s<i;s++)r[s]=o[s];return t.createElement.apply(null,r)}return t.createElement.apply(null,o)}c.displayName="MDXCreateElement"},5069:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>p,contentTitle:()=>r,default:()=>l,frontMatter:()=>i,metadata:()=>d,toc:()=>s});var t=o(7462),a=(o(7294),o(3905));const i={id:"rbac-with-domains",title:"RBAC with Domains",description:"Uso de RBAC com dom\xednios",keywords:["RBAC with domains"],authors:["hsluoyz"]},r=void 0,d={unversionedId:"rbac-with-domains",id:"rbac-with-domains",title:"RBAC with Domains",description:"Uso de RBAC com dom\xednios",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/RBACWithDomains.mdx",sourceDirName:".",slug:"/rbac-with-domains",permalink:"/pt/docs/rbac-with-domains",draft:!1,editUrl:"https://github.com/casbin/casbin-website-v2/edit/master/docs/RBACWithDomains.mdx",tags:[],version:"current",frontMatter:{id:"rbac-with-domains",title:"RBAC with Domains",description:"Uso de RBAC com dom\xednios",keywords:["RBAC with domains"],authors:["hsluoyz"]},sidebar:"docs",previous:{title:"RBAC with Pattern",permalink:"/pt/docs/rbac-with-pattern"},next:{title:"RBAC with Conditions",permalink:"/pt/docs/rbac-with-conditions"}},p={},s=[{value:"Defini\xe7\xe3o de Papel com Locat\xe1rios de Dom\xednio",id:"defini\xe7\xe3o-de-papel-com-locat\xe1rios-de-dom\xednio",level:2}],m={toc:s};function l(e){let{components:n,...o}=e;return(0,a.kt)("wrapper",(0,t.Z)({},m,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"defini\xe7\xe3o-de-papel-com-locat\xe1rios-de-dom\xednio"},"Defini\xe7\xe3o de Papel com Locat\xe1rios de Dom\xednio"),(0,a.kt)("p",null,"As fun\xe7\xf5es RBAC no Casbin podem ser globais ou espec\xedficas de dom\xednio. Pap\xe9is espec\xedficos de dom\xednio significam que os pap\xe9is de um usu\xe1rio podem ser diferentes quando o usu\xe1rio est\xe1 em diferentes dom\xednios/locat\xe1rios. Isto \xe9 muito \xfatil para sistemas grandes como uma nuvem, pois os usu\xe1rios geralmente est\xe3o em diferentes locat\xe1rios."),(0,a.kt)("p",null,"A defini\xe7\xe3o de papel com dom\xednios/locat\xe1rios deve parecer assim:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"[role_definition]\ng = _, _, _\n")),(0,a.kt)("p",null,"O terceiro ",(0,a.kt)("inlineCode",{parentName:"p"},"_")," representa o nome do dom\xednio/locat\xe1rio, e esta parte n\xe3o deve ser alterada. Ent\xe3o a pol\xedtica pode ser:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csv"},"p, admin, tenant1, data1, read\np, admin, tenant2, data2, read\n\ng, alice, admin, tenant1\ng, alice, user, tenant2\n")),(0,a.kt)("p",null,"Isto significa que o papel de ",(0,a.kt)("inlineCode",{parentName:"p"},"admin")," em ",(0,a.kt)("inlineCode",{parentName:"p"},"tenant1")," pode ler ",(0,a.kt)("inlineCode",{parentName:"p"},"data1"),". E ",(0,a.kt)("inlineCode",{parentName:"p"},"alice")," tem o papel de ",(0,a.kt)("inlineCode",{parentName:"p"},"admin")," em ",(0,a.kt)("inlineCode",{parentName:"p"},"tenant1")," e o papel de ",(0,a.kt)("inlineCode",{parentName:"p"},"user")," em ",(0,a.kt)("inlineCode",{parentName:"p"},"tenant2"),". Portanto, ela pode ler ",(0,a.kt)("inlineCode",{parentName:"p"},"data1"),". No entanto, como ",(0,a.kt)("inlineCode",{parentName:"p"},"alice")," n\xe3o \xe9 uma ",(0,a.kt)("inlineCode",{parentName:"p"},"admin")," em ",(0,a.kt)("inlineCode",{parentName:"p"},"tenant2"),", ela n\xe3o pode ler ",(0,a.kt)("inlineCode",{parentName:"p"},"data2"),"."),(0,a.kt)("p",null,"Ent\xe3o, em um comparador, voc\xea deve verificar o papel da seguinte forma:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"[matchers]\nm = g(r.sub, p.sub, r.dom) && r.dom == p.dom && r.obj == p.obj && r.act == p.act\n")),(0,a.kt)("p",null,"Por favor, consulte o ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/casbin/casbin/blob/master/examples/rbac_with_domains_model.conf"},"rbac","_","with","_","domains","_","model.conf")," para exemplos."),(0,a.kt)("admonition",{title:"Conven\xe7\xe3o de Nome de Token",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Observa\xe7\xe3o: Convencionalmente, o nome do token de dom\xednio na defini\xe7\xe3o de pol\xedtica \xe9 ",(0,a.kt)("inlineCode",{parentName:"p"},"dom")," e \xe9 colocado como o segundo token (",(0,a.kt)("inlineCode",{parentName:"p"},"sub, dom, obj, act"),").\nAgora, o Casbin em Golang suporta nomes de tokens personalizados e coloca\xe7\xe3o. Se o nome do token de dom\xednio for ",(0,a.kt)("inlineCode",{parentName:"p"},"dom"),", o token de dom\xednio pode ser colocado em uma posi\xe7\xe3o arbitr\xe1ria sem nenhuma a\xe7\xe3o adicional. Se o nome do token de dom\xednio n\xe3o for ",(0,a.kt)("inlineCode",{parentName:"p"},"dom"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"e.SetFieldIndex()")," para ",(0,a.kt)("inlineCode",{parentName:"p"},"constant.DomainIndex")," deve ser chamado ap\xf3s o inicializador ser inicializado, independentemente de sua posi\xe7\xe3o."),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"# `domain` here for `dom`\n[policy_definition]\np = sub, obj, act, domain\n")),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-go"},'e.SetFieldIndex("p", constant.DomainIndex, 3) // index starts from 0\nusers := e.GetAllUsersByDomain("domain1") // without SetFieldIndex, it will raise an error\n'))))}l.isMDXComponent=!0}}]);